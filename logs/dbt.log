[0m19:12:41.732680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2142f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c715130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c714da0>]}


============================== 19:12:41.740040 | 000a935f-c3cd-4bf2-9389-66db1aa47a71 ==============================
[0m19:12:41.740040 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:12:41.740824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinv/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt init dbt_scooters', 'send_anonymous_usage_stats': 'True'}
[0m19:12:41.770171 [debug] [MainThread]: Starter project path: /opt/anaconda3/lib/python3.12/site-packages/dbt/include/starter_project
[0m19:12:41.783206 [info ] [MainThread]: 
Your new dbt project "dbt_scooters" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m19:12:41.783910 [info ] [MainThread]: Setting up your profile.
[0m19:15:27.570821 [info ] [MainThread]: Profile dbt_scooters written to /Users/flerinv/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m19:15:27.578038 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 165.92365, "process_in_blocks": "0", "process_kernel_time": 0.518342, "process_mem_max_rss": "97734656", "process_out_blocks": "0", "process_user_time": 1.960099}
[0m19:15:27.578887 [debug] [MainThread]: Command `dbt init` succeeded at 19:15:27.578681 after 165.92 seconds
[0m19:15:27.579566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c715250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c59ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c36b380>]}
[0m19:15:27.580177 [debug] [MainThread]: Flushing usage events
[0m19:15:28.239969 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:31:41.628929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cd1c0>]}


============================== 19:31:41.636865 | 86b25d89-0e7b-4328-bb0a-fdfb24fca212 ==============================
[0m19:31:41.636865 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:31:41.638182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/Users/flerinv/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:31:41.639158 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/flerinv/Desktop/db/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m19:31:41.644102 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.11682542, "process_in_blocks": "0", "process_kernel_time": 0.44756, "process_mem_max_rss": "94085120", "process_out_blocks": "0", "process_user_time": 1.788362}
[0m19:31:41.644916 [debug] [MainThread]: Command `dbt compile` failed at 19:31:41.644729 after 0.12 seconds
[0m19:31:41.645335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cd6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cee10>]}
[0m19:31:41.645846 [debug] [MainThread]: Flushing usage events
[0m19:31:42.239022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:25.412273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a57290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109299a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109299790>]}


============================== 21:41:25.421999 | 0c9a9325-1a64-441f-8f36-1826de85fb61 ==============================
[0m21:41:25.421999 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:41:25.423071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinv/.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:41:25.423638 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/flerinv/Desktop/db/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m21:41:25.428701 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": false, "command_wall_clock_time": 0.12551336, "process_in_blocks": "0", "process_kernel_time": 0.435274, "process_mem_max_rss": "94400512", "process_out_blocks": "0", "process_user_time": 1.69647}
[0m21:41:25.429363 [debug] [MainThread]: Command `dbt ls` failed at 21:41:25.429233 after 0.13 seconds
[0m21:41:25.429983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e20f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109299a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10929b380>]}
[0m21:41:25.430488 [debug] [MainThread]: Flushing usage events
[0m21:41:26.023783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:54.923110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d334d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722bb10>]}


============================== 16:17:54.925061 | 4f6d5268-b3ee-426c-9a84-5abb0586f2ef ==============================
[0m16:17:54.925061 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:17:54.925318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed -s scooters', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:17:54.925541 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/flerinvs/dbt_scooters/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:17:54.926187 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.029389083, "process_in_blocks": "0", "process_kernel_time": 0.060353, "process_mem_max_rss": "108281856", "process_out_blocks": "0", "process_user_time": 0.504394}
[0m16:17:54.926473 [debug] [MainThread]: Command `dbt seed` failed at 16:17:54.926403 after 0.03 seconds
[0m16:17:54.926632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107113360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071269f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c18c0>]}
[0m16:17:54.926764 [debug] [MainThread]: Flushing usage events
[0m16:17:58.070092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:18:01.227479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080bb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b3b10>]}


============================== 16:18:01.229164 | e47767d0-0a6c-4e1f-8816-ac5c88a4d779 ==============================
[0m16:18:01.229164 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:18:01.229425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed -s scooters', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:18:01.229634 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/flerinvs/dbt_scooters/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:18:01.230232 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.026656333, "process_in_blocks": "0", "process_kernel_time": 0.054709, "process_mem_max_rss": "106692608", "process_out_blocks": "0", "process_user_time": 0.492152}
[0m16:18:01.230428 [debug] [MainThread]: Command `dbt seed` failed at 16:18:01.230392 after 0.03 seconds
[0m16:18:01.230553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949b360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ae9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094498c0>]}
[0m16:18:01.230673 [debug] [MainThread]: Flushing usage events
[0m16:18:07.925776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:18:20.643501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fbb10>]}


============================== 16:18:20.645296 | 6c0d1a36-7df1-4310-acb5-8d6492e07b43 ==============================
[0m16:18:20.645296 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:18:20.645558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:18:20.651841 [info ] [MainThread]: dbt version: 1.10.6
[0m16:18:20.652013 [info ] [MainThread]: python version: 3.13.5
[0m16:18:20.652141 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m16:18:20.652254 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit-Mach-O
[0m16:18:20.673786 [info ] [MainThread]: Using profiles dir at /Users/flerinvs/.dbt
[0m16:18:20.674008 [info ] [MainThread]: Using profiles.yml file at /Users/flerinvs/.dbt/profiles.yml
[0m16:18:20.674123 [info ] [MainThread]: Using dbt_project.yml file at /Users/flerinvs/dbt_scooters/dbt_project.yml
[0m16:18:20.674318 [info ] [MainThread]: adapter type: postgres
[0m16:18:20.674418 [info ] [MainThread]: adapter version: 1.9.0
[0m16:18:20.674531 [info ] [MainThread]: Configuration:
[0m16:18:20.674646 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:18:20.674748 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m16:18:20.674845 [info ] [MainThread]: Required dependencies:
[0m16:18:20.674984 [debug] [MainThread]: Executing "git --help"
[0m16:18:20.684785 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:18:20.685213 [debug] [MainThread]: STDERR: "b''"
[0m16:18:20.685357 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:18:20.685491 [info ] [MainThread]: Connection:
[0m16:18:20.685708 [info ] [MainThread]:   host: dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com
[0m16:18:20.685808 [info ] [MainThread]:   port: 5432
[0m16:18:20.685896 [info ] [MainThread]:   user: admin
[0m16:18:20.685989 [info ] [MainThread]:   database: dev_ohwk
[0m16:18:20.686079 [info ] [MainThread]:   schema: dbt
[0m16:18:20.686170 [info ] [MainThread]:   connect_timeout: 10
[0m16:18:20.686264 [info ] [MainThread]:   role: None
[0m16:18:20.686352 [info ] [MainThread]:   search_path: None
[0m16:18:20.686445 [info ] [MainThread]:   keepalives_idle: 0
[0m16:18:20.686533 [info ] [MainThread]:   sslmode: None
[0m16:18:20.686625 [info ] [MainThread]:   sslcert: None
[0m16:18:20.686719 [info ] [MainThread]:   sslkey: None
[0m16:18:20.686802 [info ] [MainThread]:   sslrootcert: None
[0m16:18:20.686889 [info ] [MainThread]:   application_name: dbt
[0m16:18:20.686975 [info ] [MainThread]:   retries: 1
[0m16:18:20.687248 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:18:20.719917 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:18:20.738287 [debug] [MainThread]: Using postgres connection "debug"
[0m16:18:20.738489 [debug] [MainThread]: On debug: select 1 as id
[0m16:18:20.738602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:21.581993 [debug] [MainThread]: SQL status: SELECT 1 in 0.843 seconds
[0m16:18:21.585616 [debug] [MainThread]: On debug: Close
[0m16:18:21.587189 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:18:21.587738 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:18:21.588127 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/flerinvs/dbt_scooters/dbt_project.yml> not found

[0m16:18:21.590604 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.9711258, "process_in_blocks": "0", "process_kernel_time": 0.093434, "process_mem_max_rss": "125698048", "process_out_blocks": "0", "process_user_time": 0.562186}
[0m16:18:21.591630 [debug] [MainThread]: Command `dbt debug` failed at 16:18:21.591395 after 0.97 seconds
[0m16:18:21.592125 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:18:21.592566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f25810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d96a0>]}
[0m16:18:21.593081 [debug] [MainThread]: Flushing usage events
[0m16:18:23.672161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:14.130098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f53b10>]}


============================== 16:19:14.131752 | b1e38b6a-1b6e-42d6-b589-65e39bb13da7 ==============================
[0m16:19:14.131752 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:19:14.132014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:20:16.352838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067374d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a1fb10>]}


============================== 16:20:16.354570 | 8fb14e0b-7a33-4b22-92d0-9ea36a3eaaa3 ==============================
[0m16:20:16.354570 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:20:16.354839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:20:16.360654 [info ] [MainThread]: dbt version: 1.10.6
[0m16:20:16.360810 [info ] [MainThread]: python version: 3.13.5
[0m16:20:16.360924 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m16:20:16.361033 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit-Mach-O
[0m16:20:16.382062 [info ] [MainThread]: Using profiles dir at /Users/flerinvs/.dbt
[0m16:20:16.382315 [info ] [MainThread]: Using profiles.yml file at /Users/flerinvs/.dbt/profiles.yml
[0m16:20:16.382478 [info ] [MainThread]: Using dbt_project.yml file at /Users/flerinvs/dbt_scooters/dbt_project.yml
[0m16:20:16.382702 [info ] [MainThread]: adapter type: postgres
[0m16:20:16.382860 [info ] [MainThread]: adapter version: 1.9.0
[0m16:20:16.382983 [info ] [MainThread]: Configuration:
[0m16:20:16.383081 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:20:16.383186 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m16:20:16.383282 [info ] [MainThread]: Required dependencies:
[0m16:20:16.383434 [debug] [MainThread]: Executing "git --help"
[0m16:20:16.392261 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:20:16.392643 [debug] [MainThread]: STDERR: "b''"
[0m16:20:16.392772 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:20:16.392900 [info ] [MainThread]: Connection:
[0m16:20:16.393042 [info ] [MainThread]:   host: dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com
[0m16:20:16.393145 [info ] [MainThread]:   port: 5432
[0m16:20:16.393328 [info ] [MainThread]:   user: admin
[0m16:20:16.393498 [info ] [MainThread]:   database: dev_ohwk
[0m16:20:16.393603 [info ] [MainThread]:   schema: dbt
[0m16:20:16.393697 [info ] [MainThread]:   connect_timeout: 10
[0m16:20:16.393800 [info ] [MainThread]:   role: None
[0m16:20:16.393900 [info ] [MainThread]:   search_path: None
[0m16:20:16.394002 [info ] [MainThread]:   keepalives_idle: 0
[0m16:20:16.394094 [info ] [MainThread]:   sslmode: None
[0m16:20:16.394193 [info ] [MainThread]:   sslcert: None
[0m16:20:16.394293 [info ] [MainThread]:   sslkey: None
[0m16:20:16.394380 [info ] [MainThread]:   sslrootcert: None
[0m16:20:16.394475 [info ] [MainThread]:   application_name: dbt
[0m16:20:16.394597 [info ] [MainThread]:   retries: 1
[0m16:20:16.394964 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:20:16.426456 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:20:16.440342 [debug] [MainThread]: Using postgres connection "debug"
[0m16:20:16.440506 [debug] [MainThread]: On debug: select 1 as id
[0m16:20:16.440635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:17.260986 [debug] [MainThread]: SQL status: SELECT 1 in 0.820 seconds
[0m16:20:17.263043 [debug] [MainThread]: On debug: Close
[0m16:20:17.264138 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:20:17.264687 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:20:17.265208 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/flerinvs/dbt_scooters/dbt_project.yml> not found

[0m16:20:17.268105 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.94013417, "process_in_blocks": "0", "process_kernel_time": 0.097744, "process_mem_max_rss": "125861888", "process_out_blocks": "0", "process_user_time": 0.567374}
[0m16:20:17.268869 [debug] [MainThread]: Command `dbt debug` failed at 16:20:17.268731 after 0.94 seconds
[0m16:20:17.269388 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:20:17.269869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11174d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110be6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110afd6a0>]}
[0m16:20:17.270486 [debug] [MainThread]: Flushing usage events
[0m16:20:22.556778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:08.114927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b1fb10>]}


============================== 16:22:08.116876 | f1dea4b0-56e4-4683-bcb1-d4e84ac6f018 ==============================
[0m16:22:08.116876 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:22:08.117126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:22:08.120177 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m16:22:08.120956 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.032071292, "process_in_blocks": "0", "process_kernel_time": 0.055934, "process_mem_max_rss": "107429888", "process_out_blocks": "0", "process_user_time": 0.502277}
[0m16:22:08.121166 [debug] [MainThread]: Command `cli deps` failed at 16:22:08.121121 after 0.03 seconds
[0m16:22:08.121298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0b360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a22c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109bd7b0>]}
[0m16:22:08.121434 [debug] [MainThread]: Flushing usage events
[0m16:22:10.078519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:46.734517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ff620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c1fb10>]}


============================== 16:23:46.736267 | 8de417f3-c5b3-4b22-aedd-c05d68fb61ec ==============================
[0m16:23:46.736267 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:23:46.736538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:23:46.777986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8de417f3-c5b3-4b22-aedd-c05d68fb61ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11132b490>]}
[0m16:23:46.782493 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:23:46.783037 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:23:46.783835 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.07387383, "process_in_blocks": "0", "process_kernel_time": 0.059156, "process_mem_max_rss": "113295360", "process_out_blocks": "0", "process_user_time": 0.529441}
[0m16:23:46.784046 [debug] [MainThread]: Command `cli deps` succeeded at 16:23:46.784004 after 0.07 seconds
[0m16:23:46.784175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129bd8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129be360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129a3450>]}
[0m16:23:46.784295 [debug] [MainThread]: Flushing usage events
[0m16:23:48.054507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:57.343591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075074d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fbb10>]}


============================== 16:23:57.345310 | 461684ff-d55e-4a2f-b255-37fed8fa6136 ==============================
[0m16:23:57.345310 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:23:57.345568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:23:57.351292 [info ] [MainThread]: dbt version: 1.10.6
[0m16:23:57.351454 [info ] [MainThread]: python version: 3.13.5
[0m16:23:57.351629 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m16:23:57.351778 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit-Mach-O
[0m16:23:57.373694 [info ] [MainThread]: Using profiles dir at /Users/flerinvs/.dbt
[0m16:23:57.373916 [info ] [MainThread]: Using profiles.yml file at /Users/flerinvs/.dbt/profiles.yml
[0m16:23:57.374036 [info ] [MainThread]: Using dbt_project.yml file at /Users/flerinvs/dbt_scooters/dbt_project.yml
[0m16:23:57.374249 [info ] [MainThread]: adapter type: postgres
[0m16:23:57.374355 [info ] [MainThread]: adapter version: 1.9.0
[0m16:23:57.410029 [info ] [MainThread]: Configuration:
[0m16:23:57.410254 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:23:57.410380 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:23:57.410482 [info ] [MainThread]: Required dependencies:
[0m16:23:57.410639 [debug] [MainThread]: Executing "git --help"
[0m16:23:57.420782 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:23:57.421259 [debug] [MainThread]: STDERR: "b''"
[0m16:23:57.421459 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:23:57.421620 [info ] [MainThread]: Connection:
[0m16:23:57.421769 [info ] [MainThread]:   host: dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com
[0m16:23:57.421874 [info ] [MainThread]:   port: 5432
[0m16:23:57.421986 [info ] [MainThread]:   user: admin
[0m16:23:57.422078 [info ] [MainThread]:   database: dev_ohwk
[0m16:23:57.422170 [info ] [MainThread]:   schema: dbt
[0m16:23:57.422263 [info ] [MainThread]:   connect_timeout: 10
[0m16:23:57.422361 [info ] [MainThread]:   role: None
[0m16:23:57.422455 [info ] [MainThread]:   search_path: None
[0m16:23:57.422546 [info ] [MainThread]:   keepalives_idle: 0
[0m16:23:57.422634 [info ] [MainThread]:   sslmode: None
[0m16:23:57.422729 [info ] [MainThread]:   sslcert: None
[0m16:23:57.422815 [info ] [MainThread]:   sslkey: None
[0m16:23:57.422904 [info ] [MainThread]:   sslrootcert: None
[0m16:23:57.423003 [info ] [MainThread]:   application_name: dbt
[0m16:23:57.423094 [info ] [MainThread]:   retries: 1
[0m16:23:57.423371 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:23:57.454251 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:23:57.468622 [debug] [MainThread]: Using postgres connection "debug"
[0m16:23:57.468765 [debug] [MainThread]: On debug: select 1 as id
[0m16:23:57.468870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:58.460466 [debug] [MainThread]: SQL status: SELECT 1 in 0.991 seconds
[0m16:23:58.464797 [debug] [MainThread]: On debug: Close
[0m16:23:58.466241 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:23:58.467008 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:23:58.470111 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1504844, "process_in_blocks": "0", "process_kernel_time": 0.099429, "process_mem_max_rss": "127369216", "process_out_blocks": "0", "process_user_time": 0.599057}
[0m16:23:58.470927 [debug] [MainThread]: Command `dbt debug` succeeded at 16:23:58.470774 after 1.15 seconds
[0m16:23:58.471427 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:23:58.471956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b5ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109065eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad48d0>]}
[0m16:23:58.472555 [debug] [MainThread]: Flushing usage events
[0m16:23:59.008463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:26.927544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccbb10>]}


============================== 16:24:26.929267 | 8cea40dc-8b97-49f4-9459-59df0364f412 ==============================
[0m16:24:26.929267 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:24:26.929535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed -s scooters', 'send_anonymous_usage_stats': 'True'}
[0m16:24:26.992630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcb490>]}
[0m16:24:27.013901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b62030>]}
[0m16:24:27.014226 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:24:27.048550 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:24:27.090377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:27.090534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:27.106755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794af50>]}
[0m16:24:27.138492 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:24:27.139797 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:24:27.145924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a19130>]}
[0m16:24:27.146099 [info ] [MainThread]: Found 11 models, 1 seed, 12 sources, 434 macros
[0m16:24:27.146235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f5b70>]}
[0m16:24:27.146878 [info ] [MainThread]: 
[0m16:24:27.147011 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:24:27.147110 [info ] [MainThread]: 
[0m16:24:27.147298 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:24:27.147666 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:24:27.165078 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:24:27.165279 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:24:27.165402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:27.809683 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.644 seconds
[0m16:24:27.812453 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:24:27.819730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:24:27.825456 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:24:27.825735 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:24:27.825947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:28.468252 [debug] [ThreadPool]: SQL status: BEGIN in 0.642 seconds
[0m16:24:28.469090 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:24:28.469576 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:24:28.526110 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.056 seconds
[0m16:24:28.531008 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:24:28.577057 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:24:28.587907 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:28.588386 [debug] [MainThread]: On master: BEGIN
[0m16:24:28.588729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:29.299392 [debug] [MainThread]: SQL status: BEGIN in 0.710 seconds
[0m16:24:29.300722 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:29.301931 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:24:29.357290 [debug] [MainThread]: SQL status: SELECT 3 in 0.054 seconds
[0m16:24:29.361342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d80c80>]}
[0m16:24:29.362246 [debug] [MainThread]: On master: ROLLBACK
[0m16:24:29.408869 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:29.409797 [debug] [MainThread]: On master: BEGIN
[0m16:24:29.521965 [debug] [MainThread]: SQL status: BEGIN in 0.111 seconds
[0m16:24:29.523215 [debug] [MainThread]: On master: COMMIT
[0m16:24:29.523949 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:29.524531 [debug] [MainThread]: On master: COMMIT
[0m16:24:29.570418 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m16:24:29.571321 [debug] [MainThread]: On master: Close
[0m16:24:29.579574 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.scooters
[0m16:24:29.580339 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.scooters ............................................ [RUN]
[0m16:24:29.580927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.scooters)
[0m16:24:29.581864 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.scooters
[0m16:24:29.582319 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.scooters
[0m16:24:29.608306 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:24:29.608582 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: BEGIN
[0m16:24:29.608771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:31.138375 [debug] [Thread-1 (]: SQL status: BEGIN in 1.529 seconds
[0m16:24:31.139889 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:24:31.140580 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_ohwk"."dbt"."scooters"
[0m16:24:31.202049 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.061 seconds
[0m16:24:31.230152 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:24:31.230604 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_ohwk"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m16:24:31.282698 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.052 seconds
[0m16:24:31.291217 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m16:24:31.305515 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m16:24:31.305792 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:24:31.306011 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m16:24:31.356459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.050 seconds
[0m16:24:31.358280 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: Close
[0m16:24:31.360700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b734d0>]}
[0m16:24:31.361216 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt.scooters ........................................ [[32mINSERT 10[0m in 1.78s]
[0m16:24:31.361690 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.scooters
[0m16:24:31.362717 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:31.362942 [debug] [MainThread]: On master: BEGIN
[0m16:24:31.363127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:32.193879 [debug] [MainThread]: SQL status: BEGIN in 0.830 seconds
[0m16:24:32.195006 [debug] [MainThread]: On master: COMMIT
[0m16:24:32.195657 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:32.196202 [debug] [MainThread]: On master: COMMIT
[0m16:24:32.247133 [debug] [MainThread]: SQL status: COMMIT in 0.050 seconds
[0m16:24:32.248177 [debug] [MainThread]: On master: Close
[0m16:24:32.249614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:32.250160 [debug] [MainThread]: Connection 'seed.dbt_scooters.scooters' was properly closed.
[0m16:24:32.250719 [info ] [MainThread]: 
[0m16:24:32.251436 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m16:24:32.252741 [debug] [MainThread]: Command end result
[0m16:24:32.278719 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:24:32.280091 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:24:32.284115 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:24:32.284299 [info ] [MainThread]: 
[0m16:24:32.284512 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:32.284662 [info ] [MainThread]: 
[0m16:24:32.284833 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:24:32.285793 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 5.3843775, "process_in_blocks": "0", "process_kernel_time": 0.116253, "process_mem_max_rss": "136134656", "process_out_blocks": "0", "process_user_time": 0.892786}
[0m16:24:32.286054 [debug] [MainThread]: Command `dbt seed` succeeded at 16:24:32.285998 after 5.38 seconds
[0m16:24:32.286270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d841b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f12d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f12e90>]}
[0m16:24:32.286472 [debug] [MainThread]: Flushing usage events
[0m16:24:40.106089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:38.260359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040af620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c27b10>]}


============================== 16:25:38.262701 | a0a3407e-7cc3-46e8-9a33-d684370ae8b0 ==============================
[0m16:25:38.262701 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:25:38.262964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:25:38.327697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0a3407e-7cc3-46e8-9a33-d684370ae8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2b490>]}
[0m16:25:38.348406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0a3407e-7cc3-46e8-9a33-d684370ae8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bebe0>]}
[0m16:25:38.348826 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:25:38.383780 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m16:25:38.421177 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:25:38.421400 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m16:25:38.421546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a0a3407e-7cc3-46e8-9a33-d684370ae8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689be50>]}
[0m16:25:38.892441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0a3407e-7cc3-46e8-9a33-d684370ae8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aea030>]}
[0m16:25:38.921395 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:25:38.922250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:25:38.927772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0a3407e-7cc3-46e8-9a33-d684370ae8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107069b70>]}
[0m16:25:38.927989 [info ] [MainThread]: Found 12 models, 1 seed, 12 sources, 434 macros
[0m16:25:38.928199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0a3407e-7cc3-46e8-9a33-d684370ae8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c5cc0>]}
[0m16:25:38.928888 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:25:38.929135 [debug] [MainThread]: Command end result
[0m16:25:38.938936 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:25:38.939774 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:25:38.941083 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:25:38.941741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7083914, "process_in_blocks": "0", "process_kernel_time": 0.095342, "process_mem_max_rss": "128974848", "process_out_blocks": "0", "process_user_time": 1.152532}
[0m16:25:38.941898 [debug] [MainThread]: Command `cli run` succeeded at 16:25:38.941866 after 0.71 seconds
[0m16:25:38.942036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b0cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714c1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714c730>]}
[0m16:25:38.942152 [debug] [MainThread]: Flushing usage events
[0m16:25:42.353135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:29.528183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079574d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e53b10>]}


============================== 16:26:29.529915 | 7d951edc-6b48-455b-8129-df94d2f2ed20 ==============================
[0m16:26:29.529915 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:26:29.530181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -s scooters+', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:26:29.591592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108153490>]}
[0m16:26:29.611899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cea030>]}
[0m16:26:29.612216 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:26:29.645718 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:26:29.687853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:29.688013 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:29.704306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad3250>]}
[0m16:26:29.736401 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:26:29.737232 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:26:29.749244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d2bf20>]}
[0m16:26:29.749436 [info ] [MainThread]: Found 13 models, 1 seed, 12 sources, 434 macros
[0m16:26:29.750245 [info ] [MainThread]: 
[0m16:26:29.750382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:26:29.750480 [info ] [MainThread]: 
[0m16:26:29.750664 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:26:29.752085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:26:29.770961 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:26:29.771150 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:26:29.771255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:30.550189 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.779 seconds
[0m16:26:30.553634 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:26:30.558499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:26:30.566726 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:26:30.567194 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:26:30.567484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:31.408732 [debug] [ThreadPool]: SQL status: BEGIN in 0.841 seconds
[0m16:26:31.410176 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:26:31.411185 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:26:31.459828 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.048 seconds
[0m16:26:31.462699 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:26:31.507828 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:26:31.520408 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:31.521014 [debug] [MainThread]: On master: BEGIN
[0m16:26:31.521303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:32.562393 [debug] [MainThread]: SQL status: BEGIN in 1.041 seconds
[0m16:26:32.563920 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:32.565147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:26:32.620619 [debug] [MainThread]: SQL status: SELECT 3 in 0.054 seconds
[0m16:26:32.626225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5b3f0>]}
[0m16:26:32.626934 [debug] [MainThread]: On master: ROLLBACK
[0m16:26:32.672719 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:32.673482 [debug] [MainThread]: On master: BEGIN
[0m16:26:32.763529 [debug] [MainThread]: SQL status: BEGIN in 0.089 seconds
[0m16:26:32.764175 [debug] [MainThread]: On master: COMMIT
[0m16:26:32.764589 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:32.765085 [debug] [MainThread]: On master: COMMIT
[0m16:26:32.811437 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m16:26:32.811816 [debug] [MainThread]: On master: Close
[0m16:26:32.814991 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.scooters
[0m16:26:32.815484 [info ] [Thread-1 (]: 1 of 2 START seed file dbt.scooters ............................................ [RUN]
[0m16:26:32.815865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.scooters)
[0m16:26:32.816142 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.scooters
[0m16:26:32.816389 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.scooters
[0m16:26:32.838110 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:32.838387 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: BEGIN
[0m16:26:32.838554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:33.492773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.654 seconds
[0m16:26:33.494612 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:33.495710 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_ohwk"."dbt"."scooters"
[0m16:26:33.574484 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.078 seconds
[0m16:26:33.601024 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:33.601454 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_ohwk"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m16:26:33.651715 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.050 seconds
[0m16:26:33.660567 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m16:26:33.674088 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m16:26:33.674396 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:33.674628 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m16:26:33.733041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.058 seconds
[0m16:26:33.735812 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: Close
[0m16:26:33.737918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0fa000>]}
[0m16:26:33.738487 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file dbt.scooters ........................................ [[32mINSERT 10[0m in 0.92s]
[0m16:26:33.738983 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.scooters
[0m16:26:33.739857 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies
[0m16:26:33.740371 [info ] [Thread-2 (]: 2 of 2 START sql view model dbt.companies ...................................... [RUN]
[0m16:26:33.740845 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.companies'
[0m16:26:33.741137 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies
[0m16:26:33.747659 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m16:26:33.749200 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies
[0m16:26:33.768925 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m16:26:33.769429 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:33.769608 [debug] [Thread-2 (]: On model.dbt_scooters.companies: BEGIN
[0m16:26:33.769759 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:26:34.530540 [debug] [Thread-2 (]: SQL status: BEGIN in 0.760 seconds
[0m16:26:34.532358 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:34.533219 [debug] [Thread-2 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  create view "dev_ohwk"."dbt"."companies__dbt_tmp"
    
    
  as (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_ohwk"."dbt"."scooters"
group by
    1
  );
[0m16:26:34.582913 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m16:26:34.595365 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:34.596017 [debug] [Thread-2 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies" rename to "companies__dbt_backup"
[0m16:26:34.642771 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:26:34.646342 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:34.646532 [debug] [Thread-2 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies__dbt_tmp" rename to "companies"
[0m16:26:34.692608 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:26:34.695164 [debug] [Thread-2 (]: On model.dbt_scooters.companies: COMMIT
[0m16:26:34.695390 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:34.695580 [debug] [Thread-2 (]: On model.dbt_scooters.companies: COMMIT
[0m16:26:34.743336 [debug] [Thread-2 (]: SQL status: COMMIT in 0.048 seconds
[0m16:26:34.748833 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."companies__dbt_backup"
[0m16:26:34.752791 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:34.753047 [debug] [Thread-2 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_ohwk"."dbt"."companies__dbt_backup" cascade
[0m16:26:34.802870 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.049 seconds
[0m16:26:34.805104 [debug] [Thread-2 (]: On model.dbt_scooters.companies: Close
[0m16:26:34.806435 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d89b50>]}
[0m16:26:34.807305 [info ] [Thread-2 (]: 2 of 2 OK created sql view model dbt.companies ................................. [[32mCREATE VIEW[0m in 1.07s]
[0m16:26:34.807929 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies
[0m16:26:34.809379 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:34.809798 [debug] [MainThread]: On master: BEGIN
[0m16:26:34.810094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:35.439357 [debug] [MainThread]: SQL status: BEGIN in 0.629 seconds
[0m16:26:35.440946 [debug] [MainThread]: On master: COMMIT
[0m16:26:35.441607 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:35.442090 [debug] [MainThread]: On master: COMMIT
[0m16:26:35.489498 [debug] [MainThread]: SQL status: COMMIT in 0.047 seconds
[0m16:26:35.490662 [debug] [MainThread]: On master: Close
[0m16:26:35.492536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:35.493194 [debug] [MainThread]: Connection 'seed.dbt_scooters.scooters' was properly closed.
[0m16:26:35.493605 [debug] [MainThread]: Connection 'model.dbt_scooters.companies' was properly closed.
[0m16:26:35.494138 [info ] [MainThread]: 
[0m16:26:35.494726 [info ] [MainThread]: Finished running 1 seed, 1 view model in 0 hours 0 minutes and 5.74 seconds (5.74s).
[0m16:26:35.496087 [debug] [MainThread]: Command end result
[0m16:26:35.562949 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:26:35.564006 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:26:35.566817 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:26:35.566955 [info ] [MainThread]: 
[0m16:26:35.567116 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:26:35.567234 [info ] [MainThread]: 
[0m16:26:35.567361 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m16:26:35.568134 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.0642834, "process_in_blocks": "0", "process_kernel_time": 0.128987, "process_mem_max_rss": "137510912", "process_out_blocks": "0", "process_user_time": 1.002742}
[0m16:26:35.568325 [debug] [MainThread]: Command `dbt build` succeeded at 16:26:35.568285 after 6.06 seconds
[0m16:26:35.568477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cff120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0837f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a083610>]}
[0m16:26:35.568619 [debug] [MainThread]: Flushing usage events
[0m16:26:36.830055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:46.586227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107527b10>]}


============================== 16:26:46.588054 | 26736b32-ad61-4cc5-8845-0fb37e21b6a8 ==============================
[0m16:26:46.588054 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:26:46.588312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build -s +companies_trips', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:26:46.653298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106427490>]}
[0m16:26:46.674857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073be030>]}
[0m16:26:46.675214 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:26:46.708745 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:26:46.750614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:46.750781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:46.767597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11120b450>]}
[0m16:26:46.801321 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:26:46.802245 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:26:46.812830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111653f20>]}
[0m16:26:46.813041 [info ] [MainThread]: Found 13 models, 1 seed, 12 sources, 434 macros
[0m16:26:46.813913 [info ] [MainThread]: 
[0m16:26:46.814058 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:26:46.814174 [info ] [MainThread]: 
[0m16:26:46.814387 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:26:46.815856 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:26:46.833473 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:26:46.833677 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:26:46.833790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:47.507388 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.673 seconds
[0m16:26:47.510610 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:26:47.515736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:26:47.524849 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:26:47.525404 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:26:47.525711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:48.163868 [debug] [ThreadPool]: SQL status: BEGIN in 0.638 seconds
[0m16:26:48.164179 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:26:48.164367 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:26:48.224700 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.060 seconds
[0m16:26:48.225502 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:26:48.270945 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:26:48.274211 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:48.274352 [debug] [MainThread]: On master: BEGIN
[0m16:26:48.274451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:50.016553 [debug] [MainThread]: SQL status: BEGIN in 1.742 seconds
[0m16:26:50.017690 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:50.018631 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:26:50.115485 [debug] [MainThread]: SQL status: SELECT 4 in 0.096 seconds
[0m16:26:50.120615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111683850>]}
[0m16:26:50.121454 [debug] [MainThread]: On master: ROLLBACK
[0m16:26:50.165790 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:50.166374 [debug] [MainThread]: On master: BEGIN
[0m16:26:50.257544 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m16:26:50.258776 [debug] [MainThread]: On master: COMMIT
[0m16:26:50.259705 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:50.260257 [debug] [MainThread]: On master: COMMIT
[0m16:26:50.307016 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m16:26:50.307970 [debug] [MainThread]: On master: Close
[0m16:26:50.315034 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.scooters
[0m16:26:50.315678 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m16:26:50.316336 [info ] [Thread-2 (]: 2 of 4 START seed file dbt.scooters ............................................ [RUN]
[0m16:26:50.316940 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt.trips_prep ..................................... [RUN]
[0m16:26:50.317700 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.dbt_scooters.scooters'
[0m16:26:50.318202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.trips_prep)
[0m16:26:50.318611 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.scooters
[0m16:26:50.318981 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m16:26:50.319337 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.scooters
[0m16:26:50.326874 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m16:26:50.348120 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:50.348420 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: BEGIN
[0m16:26:50.348600 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:26:50.348808 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m16:26:50.365266 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m16:26:50.365798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:26:50.365970 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m16:26:50.366119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:51.100666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.734 seconds
[0m16:26:51.102010 [debug] [Thread-2 (]: SQL status: BEGIN in 0.753 seconds
[0m16:26:51.102923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:26:51.103729 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:51.104470 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_ohwk"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  );
[0m16:26:51.105201 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_ohwk"."dbt"."scooters"
[0m16:26:51.161809 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.056 seconds
[0m16:26:51.170195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:26:51.170676 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.065 seconds
[0m16:26:51.171025 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m16:26:51.186226 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:51.186544 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_ohwk"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m16:26:51.229294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:26:51.234429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:26:51.234695 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m16:26:51.237905 [debug] [Thread-2 (]: SQL status: INSERT 0 10 in 0.051 seconds
[0m16:26:51.241611 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m16:26:51.250572 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: COMMIT
[0m16:26:51.250797 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:51.250967 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: COMMIT
[0m16:26:51.281076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:26:51.283388 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m16:26:51.283618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:26:51.283815 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m16:26:51.298199 [debug] [Thread-2 (]: SQL status: COMMIT in 0.047 seconds
[0m16:26:51.299559 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: Close
[0m16:26:51.300949 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111afcc80>]}
[0m16:26:51.301375 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file dbt.scooters ........................................ [[32mINSERT 10[0m in 0.98s]
[0m16:26:51.301797 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.scooters
[0m16:26:51.302249 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies
[0m16:26:51.302663 [info ] [Thread-3 (]: 3 of 4 START sql view model dbt.companies ...................................... [RUN]
[0m16:26:51.303040 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.companies'
[0m16:26:51.303266 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies
[0m16:26:51.304996 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m16:26:51.305450 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies
[0m16:26:51.339401 [debug] [Thread-1 (]: SQL status: COMMIT in 0.055 seconds
[0m16:26:51.340705 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m16:26:51.343522 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_prep__dbt_backup"
[0m16:26:51.345766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:26:51.345920 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_ohwk"."dbt"."trips_prep__dbt_backup" cascade
[0m16:26:51.346201 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:51.346344 [debug] [Thread-3 (]: On model.dbt_scooters.companies: BEGIN
[0m16:26:51.346472 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:26:51.393584 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.047 seconds
[0m16:26:51.394563 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m16:26:51.394989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116134d0>]}
[0m16:26:51.395348 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt.trips_prep ................................ [[32mCREATE VIEW[0m in 1.08s]
[0m16:26:51.395650 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m16:26:52.017700 [debug] [Thread-3 (]: SQL status: BEGIN in 0.671 seconds
[0m16:26:52.018353 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:52.018759 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  create view "dev_ohwk"."dbt"."companies__dbt_tmp"
    
    
  as (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_ohwk"."dbt"."scooters"
group by
    1
  );
[0m16:26:52.067518 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m16:26:52.073572 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:52.074072 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies" rename to "companies__dbt_backup"
[0m16:26:52.120322 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:26:52.125011 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:52.125423 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies__dbt_tmp" rename to "companies"
[0m16:26:52.173284 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m16:26:52.176253 [debug] [Thread-3 (]: On model.dbt_scooters.companies: COMMIT
[0m16:26:52.176883 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:52.177267 [debug] [Thread-3 (]: On model.dbt_scooters.companies: COMMIT
[0m16:26:52.223791 [debug] [Thread-3 (]: SQL status: COMMIT in 0.046 seconds
[0m16:26:52.228565 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."companies__dbt_backup"
[0m16:26:52.229512 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:52.229916 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop view if exists "dev_ohwk"."dbt"."companies__dbt_backup" cascade
[0m16:26:52.278153 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.048 seconds
[0m16:26:52.280842 [debug] [Thread-3 (]: On model.dbt_scooters.companies: Close
[0m16:26:52.282376 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11162eba0>]}
[0m16:26:52.283434 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dbt.companies ................................. [[32mCREATE VIEW[0m in 0.98s]
[0m16:26:52.284154 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies
[0m16:26:52.285062 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies_trips
[0m16:26:52.285677 [info ] [Thread-4 (]: 4 of 4 START sql view model dbt.companies_trips ................................ [RUN]
[0m16:26:52.286272 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.companies_trips'
[0m16:26:52.286645 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies_trips
[0m16:26:52.289787 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m16:26:52.290657 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies_trips
[0m16:26:52.293487 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m16:26:52.294037 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:26:52.294272 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m16:26:52.294498 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:26:52.941882 [debug] [Thread-4 (]: SQL status: BEGIN in 0.647 seconds
[0m16:26:52.943003 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:26:52.943779 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  create view "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
    
    
  as (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
[0m16:26:52.999003 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m16:26:53.002946 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:26:53.003338 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m16:26:53.050014 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:26:53.051351 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m16:26:53.051634 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:26:53.051843 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m16:26:53.098186 [debug] [Thread-4 (]: SQL status: COMMIT in 0.046 seconds
[0m16:26:53.100293 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m16:26:53.100877 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:26:53.101175 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop view if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m16:26:53.147271 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.046 seconds
[0m16:26:53.149633 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: Close
[0m16:26:53.150635 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f1810>]}
[0m16:26:53.151334 [info ] [Thread-4 (]: 4 of 4 OK created sql view model dbt.companies_trips ........................... [[32mCREATE VIEW[0m in 0.86s]
[0m16:26:53.152027 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies_trips
[0m16:26:53.153544 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:53.153860 [debug] [MainThread]: On master: BEGIN
[0m16:26:53.154103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:54.598493 [debug] [MainThread]: SQL status: BEGIN in 1.444 seconds
[0m16:26:54.600227 [debug] [MainThread]: On master: COMMIT
[0m16:26:54.602892 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:54.603832 [debug] [MainThread]: On master: COMMIT
[0m16:26:54.652477 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m16:26:54.653458 [debug] [MainThread]: On master: Close
[0m16:26:54.654402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:54.654823 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_prep' was properly closed.
[0m16:26:54.655098 [debug] [MainThread]: Connection 'seed.dbt_scooters.scooters' was properly closed.
[0m16:26:54.655354 [debug] [MainThread]: Connection 'model.dbt_scooters.companies' was properly closed.
[0m16:26:54.655575 [debug] [MainThread]: Connection 'model.dbt_scooters.companies_trips' was properly closed.
[0m16:26:54.655938 [info ] [MainThread]: 
[0m16:26:54.656266 [info ] [MainThread]: Finished running 1 seed, 3 view models in 0 hours 0 minutes and 7.84 seconds (7.84s).
[0m16:26:54.657336 [debug] [MainThread]: Command end result
[0m16:26:54.678165 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:26:54.679615 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:26:54.683459 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:26:54.683638 [info ] [MainThread]: 
[0m16:26:54.683832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:26:54.683977 [info ] [MainThread]: 
[0m16:26:54.684134 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:26:54.685029 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.124219, "process_in_blocks": "0", "process_kernel_time": 0.128543, "process_mem_max_rss": "138838016", "process_out_blocks": "0", "process_user_time": 1.018167}
[0m16:26:54.685260 [debug] [MainThread]: Command `dbt build` succeeded at 16:26:54.685210 after 8.12 seconds
[0m16:26:54.685468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107547230>]}
[0m16:26:54.685652 [debug] [MainThread]: Flushing usage events
[0m16:27:01.581394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:23.083953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112027b10>]}


============================== 16:29:23.085672 | a2bb543a-7e7f-474c-8078-273b462802f8 ==============================
[0m16:29:23.085672 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:29:23.085930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed -s event_types', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:23.147007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110727490>]}
[0m16:29:23.167231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ebe030>]}
[0m16:29:23.167554 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:29:23.200173 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:29:23.242762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:29:23.243028 [debug] [MainThread]: Partial parsing: added file: dbt_scooters://seeds/event_types.csv
[0m16:29:23.326120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c53250>]}
[0m16:29:23.357143 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:29:23.358043 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:29:23.363905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d25130>]}
[0m16:29:23.364120 [info ] [MainThread]: Found 13 models, 2 seeds, 12 sources, 434 macros
[0m16:29:23.364276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11306bcb0>]}
[0m16:29:23.364899 [info ] [MainThread]: 
[0m16:29:23.365041 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:29:23.365142 [info ] [MainThread]: 
[0m16:29:23.365330 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:29:23.365647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:29:23.383567 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:29:23.383781 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:29:23.383895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:25.004385 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.620 seconds
[0m16:29:25.007547 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:29:25.015539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:29:25.022672 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:29:25.023146 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:29:25.023399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:25.746695 [debug] [ThreadPool]: SQL status: BEGIN in 0.723 seconds
[0m16:29:25.747825 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:29:25.748488 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:29:25.804996 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.056 seconds
[0m16:29:25.809197 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:29:25.863636 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:29:25.874554 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:25.874993 [debug] [MainThread]: On master: BEGIN
[0m16:29:25.875275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:26.544488 [debug] [MainThread]: SQL status: BEGIN in 0.669 seconds
[0m16:29:26.544825 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:26.545041 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:29:26.617609 [debug] [MainThread]: SQL status: SELECT 7 in 0.072 seconds
[0m16:29:26.619354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11317f790>]}
[0m16:29:26.619674 [debug] [MainThread]: On master: ROLLBACK
[0m16:29:26.665874 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:26.666165 [debug] [MainThread]: On master: BEGIN
[0m16:29:26.767583 [debug] [MainThread]: SQL status: BEGIN in 0.101 seconds
[0m16:29:26.768672 [debug] [MainThread]: On master: COMMIT
[0m16:29:26.769370 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:26.769960 [debug] [MainThread]: On master: COMMIT
[0m16:29:26.817503 [debug] [MainThread]: SQL status: COMMIT in 0.047 seconds
[0m16:29:26.818696 [debug] [MainThread]: On master: Close
[0m16:29:26.827411 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.event_types
[0m16:29:26.828775 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.event_types ......................................... [RUN]
[0m16:29:26.829731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.event_types)
[0m16:29:26.830226 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.event_types
[0m16:29:26.830613 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.event_types
[0m16:29:26.854485 [debug] [Thread-1 (]: Compilation Error in seed event_types (seeds/event_types.csv)
  value was undefined because a callable raised a StopIteration exception
[0m16:29:26.855679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cfba10>]}
[0m16:29:26.856032 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file dbt.event_types ................................. [[31mERROR[0m in 0.03s]
[0m16:29:26.856372 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.event_types
[0m16:29:26.856726 [debug] [Thread-7 (]: Marking all children of 'seed.dbt_scooters.event_types' to be skipped because of status 'error'.  Reason: Compilation Error in seed event_types (seeds/event_types.csv)
  value was undefined because a callable raised a StopIteration exception.
[0m16:29:26.857995 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:26.858172 [debug] [MainThread]: On master: BEGIN
[0m16:29:26.858316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:27.570487 [debug] [MainThread]: SQL status: BEGIN in 0.712 seconds
[0m16:29:27.571612 [debug] [MainThread]: On master: COMMIT
[0m16:29:27.572372 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:27.572892 [debug] [MainThread]: On master: COMMIT
[0m16:29:27.617555 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m16:29:27.618486 [debug] [MainThread]: On master: Close
[0m16:29:27.619878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:27.620402 [debug] [MainThread]: Connection 'seed.dbt_scooters.event_types' was properly closed.
[0m16:29:27.620958 [info ] [MainThread]: 
[0m16:29:27.621545 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m16:29:27.622707 [debug] [MainThread]: Command end result
[0m16:29:27.688695 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:29:27.689690 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:29:27.692451 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:29:27.692591 [info ] [MainThread]: 
[0m16:29:27.692752 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:29:27.692869 [info ] [MainThread]: 
[0m16:29:27.693020 [error] [MainThread]: [31mFailure in seed event_types (seeds/event_types.csv)[0m
[0m16:29:27.693158 [error] [MainThread]:   Compilation Error in seed event_types (seeds/event_types.csv)
  value was undefined because a callable raised a StopIteration exception
[0m16:29:27.693263 [info ] [MainThread]: 
[0m16:29:27.693379 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:29:27.694183 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.634324, "process_in_blocks": "0", "process_kernel_time": 0.11959, "process_mem_max_rss": "137428992", "process_out_blocks": "0", "process_user_time": 0.918972}
[0m16:29:27.694370 [debug] [MainThread]: Command `dbt seed` failed at 16:29:27.694330 after 4.63 seconds
[0m16:29:27.694529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131460a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113005c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130059f0>]}
[0m16:29:27.694671 [debug] [MainThread]: Flushing usage events
[0m16:29:28.943046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:57.275827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067274d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122127b10>]}


============================== 16:29:57.277546 | 432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b ==============================
[0m16:29:57.277546 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:29:57.277813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed -s event_types', 'send_anonymous_usage_stats': 'True'}
[0m16:29:57.339138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e27490>]}
[0m16:29:57.360047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204be030>]}
[0m16:29:57.360401 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:29:57.394516 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:29:57.436299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:57.436454 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:57.452523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122bdb150>]}
[0m16:29:57.484397 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:29:57.485217 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:29:57.491277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122cad130>]}
[0m16:29:57.491490 [info ] [MainThread]: Found 13 models, 2 seeds, 12 sources, 434 macros
[0m16:29:57.491640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12248baf0>]}
[0m16:29:57.492329 [info ] [MainThread]: 
[0m16:29:57.492466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:29:57.492569 [info ] [MainThread]: 
[0m16:29:57.492762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:29:57.493119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:29:57.510442 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:29:57.510648 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:29:57.510758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:58.145049 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.634 seconds
[0m16:29:58.149288 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:29:58.158569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:29:58.166780 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:29:58.167370 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:29:58.167671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:59.023470 [debug] [ThreadPool]: SQL status: BEGIN in 0.855 seconds
[0m16:29:59.025027 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:29:59.026019 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:29:59.076171 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.049 seconds
[0m16:29:59.081321 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:29:59.125878 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:29:59.137354 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:59.138011 [debug] [MainThread]: On master: BEGIN
[0m16:29:59.138376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:00.005460 [debug] [MainThread]: SQL status: BEGIN in 0.867 seconds
[0m16:30:00.006510 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:00.007192 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:30:00.070206 [debug] [MainThread]: SQL status: SELECT 7 in 0.062 seconds
[0m16:30:00.078173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123019300>]}
[0m16:30:00.079313 [debug] [MainThread]: On master: ROLLBACK
[0m16:30:00.123287 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:00.124057 [debug] [MainThread]: On master: BEGIN
[0m16:30:00.212904 [debug] [MainThread]: SQL status: BEGIN in 0.088 seconds
[0m16:30:00.213966 [debug] [MainThread]: On master: COMMIT
[0m16:30:00.214863 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:00.215647 [debug] [MainThread]: On master: COMMIT
[0m16:30:00.266786 [debug] [MainThread]: SQL status: COMMIT in 0.050 seconds
[0m16:30:00.267941 [debug] [MainThread]: On master: Close
[0m16:30:00.276022 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.event_types
[0m16:30:00.276731 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.event_types ......................................... [RUN]
[0m16:30:00.277286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.event_types)
[0m16:30:00.277665 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.event_types
[0m16:30:00.277997 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.event_types
[0m16:30:00.301119 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m16:30:00.301399 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: BEGIN
[0m16:30:00.301594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:01.967797 [debug] [Thread-1 (]: SQL status: BEGIN in 1.666 seconds
[0m16:30:01.968727 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m16:30:01.969326 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_ohwk"."dbt"."event_types"
[0m16:30:02.019824 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.050 seconds
[0m16:30:02.043394 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m16:30:02.043907 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_ohwk"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m16:30:02.093096 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.049 seconds
[0m16:30:02.100981 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m16:30:02.113854 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: COMMIT
[0m16:30:02.114196 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m16:30:02.114475 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: COMMIT
[0m16:30:02.160228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.045 seconds
[0m16:30:02.162225 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: Close
[0m16:30:02.163960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122df34d0>]}
[0m16:30:02.164453 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt.event_types ..................................... [[32mINSERT 4[0m in 1.89s]
[0m16:30:02.164954 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.event_types
[0m16:30:02.166134 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:02.166389 [debug] [MainThread]: On master: BEGIN
[0m16:30:02.166610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:02.995541 [debug] [MainThread]: SQL status: BEGIN in 0.829 seconds
[0m16:30:02.996795 [debug] [MainThread]: On master: COMMIT
[0m16:30:02.997510 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:02.998041 [debug] [MainThread]: On master: COMMIT
[0m16:30:03.042597 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m16:30:03.042944 [debug] [MainThread]: On master: Close
[0m16:30:03.043350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:03.043507 [debug] [MainThread]: Connection 'seed.dbt_scooters.event_types' was properly closed.
[0m16:30:03.043668 [info ] [MainThread]: 
[0m16:30:03.043845 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m16:30:03.044245 [debug] [MainThread]: Command end result
[0m16:30:03.063346 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:30:03.064756 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:30:03.069000 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:30:03.069249 [info ] [MainThread]: 
[0m16:30:03.069507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:03.069686 [info ] [MainThread]: 
[0m16:30:03.069885 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:30:03.071243 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 5.8195925, "process_in_blocks": "0", "process_kernel_time": 0.115103, "process_mem_max_rss": "136183808", "process_out_blocks": "0", "process_user_time": 0.878995}
[0m16:30:03.071598 [debug] [MainThread]: Command `dbt seed` succeeded at 16:30:03.071532 after 5.82 seconds
[0m16:30:03.071834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12301d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12309b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12309a8f0>]}
[0m16:30:03.072050 [debug] [MainThread]: Flushing usage events
[0m16:30:08.373075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:59.476261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031bf620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d7b10>]}


============================== 16:30:59.478270 | b2574b94-25df-46a2-8ae6-a4cc3a56a071 ==============================
[0m16:30:59.478270 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:30:59.478550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:30:59.544184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039df490>]}
[0m16:30:59.566176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10456ebe0>]}
[0m16:30:59.566587 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:30:59.601711 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m16:30:59.637941 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:30:59.638162 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m16:30:59.638309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105534250>]}
[0m16:31:00.124071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e8d70>]}
[0m16:31:00.155526 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:31:00.156405 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:31:00.169082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058dd9b0>]}
[0m16:31:00.169310 [info ] [MainThread]: Found 14 models, 2 seeds, 14 sources, 434 macros
[0m16:31:00.170277 [info ] [MainThread]: 
[0m16:31:00.170448 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:31:00.170562 [info ] [MainThread]: 
[0m16:31:00.170795 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:00.171177 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:31:00.188944 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:31:00.189136 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:31:00.189243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:01.545188 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.356 seconds
[0m16:31:01.547492 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:31:01.556313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:31:01.564652 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:31:01.565188 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:31:01.565475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:02.193622 [debug] [ThreadPool]: SQL status: BEGIN in 0.628 seconds
[0m16:31:02.194915 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:31:02.195378 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:31:02.247970 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.052 seconds
[0m16:31:02.250261 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:31:02.296295 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:31:02.306771 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:02.307354 [debug] [MainThread]: On master: BEGIN
[0m16:31:02.307603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:03.810933 [debug] [MainThread]: SQL status: BEGIN in 1.503 seconds
[0m16:31:03.811859 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:03.812896 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:31:03.870503 [debug] [MainThread]: SQL status: SELECT 7 in 0.057 seconds
[0m16:31:03.874452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b9a340>]}
[0m16:31:03.875141 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:03.920161 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:03.921361 [debug] [MainThread]: On master: BEGIN
[0m16:31:04.011006 [debug] [MainThread]: SQL status: BEGIN in 0.089 seconds
[0m16:31:04.012018 [debug] [MainThread]: On master: COMMIT
[0m16:31:04.012404 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:04.012835 [debug] [MainThread]: On master: COMMIT
[0m16:31:04.061179 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m16:31:04.062089 [debug] [MainThread]: On master: Close
[0m16:31:04.066772 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_full
[0m16:31:04.067580 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt.events_full .................................... [RUN]
[0m16:31:04.068397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_full)
[0m16:31:04.068862 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_full
[0m16:31:04.078902 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m16:31:04.080210 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_full
[0m16:31:04.106384 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m16:31:04.106938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:31:04.107126 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: BEGIN
[0m16:31:04.107289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:05.709004 [debug] [Thread-1 (]: SQL status: BEGIN in 1.601 seconds
[0m16:31:05.709937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:31:05.710495 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_ohwk"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_ohwk"."dbt"."events_clean"
    left join "dev_ohwk"."dbt"."event_types"
        using (type_id)
  );
[0m16:31:05.758264 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.047 seconds
[0m16:31:05.771377 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:31:05.772268 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m16:31:05.827360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.054 seconds
[0m16:31:05.833149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:31:05.833574 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m16:31:05.879081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m16:31:05.896682 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m16:31:05.897094 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:31:05.897347 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m16:31:05.946934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m16:31:05.953357 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."events_full__dbt_backup"
[0m16:31:05.957572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:31:05.957845 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_ohwk"."dbt"."events_full__dbt_backup" cascade
[0m16:31:06.004104 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.046 seconds
[0m16:31:06.008183 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: Close
[0m16:31:06.010467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105946810>]}
[0m16:31:06.011127 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt.events_full ............................... [[32mCREATE VIEW[0m in 1.94s]
[0m16:31:06.011642 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_full
[0m16:31:06.013150 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:06.013433 [debug] [MainThread]: On master: BEGIN
[0m16:31:06.013680 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:07.505027 [debug] [MainThread]: SQL status: BEGIN in 1.491 seconds
[0m16:31:07.506342 [debug] [MainThread]: On master: COMMIT
[0m16:31:07.507010 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:07.507536 [debug] [MainThread]: On master: COMMIT
[0m16:31:07.553235 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m16:31:07.554689 [debug] [MainThread]: On master: Close
[0m16:31:07.556563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:07.557246 [debug] [MainThread]: Connection 'model.dbt_scooters.events_full' was properly closed.
[0m16:31:07.557835 [info ] [MainThread]: 
[0m16:31:07.558426 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.39 seconds (7.39s).
[0m16:31:07.559611 [debug] [MainThread]: Command end result
[0m16:31:07.588016 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:31:07.589507 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:31:07.593415 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:31:07.593604 [info ] [MainThread]: 
[0m16:31:07.593823 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:07.593980 [info ] [MainThread]: 
[0m16:31:07.594341 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:31:07.595578 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.145414, "process_in_blocks": "0", "process_kernel_time": 0.128928, "process_mem_max_rss": "146128896", "process_out_blocks": "0", "process_user_time": 1.385202}
[0m16:31:07.595863 [debug] [MainThread]: Command `cli build` succeeded at 16:31:07.595803 after 8.15 seconds
[0m16:31:07.596076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105975ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7d8b0>]}
[0m16:31:07.596281 [debug] [MainThread]: Flushing usage events
[0m16:31:12.986920 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:54.795753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104257620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106127b10>]}


============================== 16:31:54.797688 | 2986c9a5-357f-4fa2-870d-ef889351ea0d ==============================
[0m16:31:54.797688 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:31:54.797985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:54.862031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2986c9a5-357f-4fa2-870d-ef889351ea0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2f490>]}
[0m16:31:54.883442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2986c9a5-357f-4fa2-870d-ef889351ea0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbebe0>]}
[0m16:31:54.883894 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:31:54.919719 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m16:31:54.957514 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:31:54.957767 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m16:31:54.957923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2986c9a5-357f-4fa2-870d-ef889351ea0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce4250>]}
[0m16:31:55.429029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2986c9a5-357f-4fa2-870d-ef889351ea0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9d130>]}
[0m16:31:55.458342 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:31:55.459237 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:31:55.469892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2986c9a5-357f-4fa2-870d-ef889351ea0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a6270>]}
[0m16:31:55.470110 [info ] [MainThread]: Found 15 models, 2 seeds, 15 sources, 434 macros
[0m16:31:55.470839 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:31:55.471100 [debug] [MainThread]: Command end result
[0m16:31:55.480797 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:31:55.481602 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:31:55.482914 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:31:55.483724 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.71339893, "process_in_blocks": "0", "process_kernel_time": 0.098323, "process_mem_max_rss": "130826240", "process_out_blocks": "0", "process_user_time": 1.162757}
[0m16:31:55.483946 [debug] [MainThread]: Command `cli build` succeeded at 16:31:55.483907 after 0.71 seconds
[0m16:31:55.484095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107127d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f10dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f30650>]}
[0m16:31:55.484233 [debug] [MainThread]: Flushing usage events
[0m16:31:58.941813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:43.327211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109327b10>]}


============================== 21:19:43.329588 | 317adf4f-b077-4403-a16d-12ddff316202 ==============================
[0m21:19:43.329588 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:19:43.329850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed -s scooters', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:19:43.406631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108627490>]}
[0m21:19:43.428020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091be030>]}
[0m21:19:43.428540 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:19:43.464180 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:19:43.514664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:19:43.514841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:19:43.532353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa7150>]}
[0m21:19:43.566580 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:19:43.567834 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:19:43.578797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0854f0>]}
[0m21:19:43.579050 [info ] [MainThread]: Found 15 models, 3 seeds, 15 sources, 434 macros
[0m21:19:43.579203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109853d90>]}
[0m21:19:43.579911 [info ] [MainThread]: 
[0m21:19:43.580051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:19:43.580152 [info ] [MainThread]: 
[0m21:19:43.580386 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:19:43.580754 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:19:43.603498 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:19:43.603684 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:19:43.603801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:45.861412 [debug] [ThreadPool]: SQL status: SELECT 16 in 2.257 seconds
[0m21:19:45.864244 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:19:45.872526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:19:45.882036 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:19:45.882607 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:19:45.882904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:46.983991 [debug] [ThreadPool]: SQL status: BEGIN in 1.101 seconds
[0m21:19:46.984829 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:19:46.985371 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:19:47.055627 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.069 seconds
[0m21:19:47.058149 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:19:47.123069 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:19:47.134932 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:47.135441 [debug] [MainThread]: On master: BEGIN
[0m21:19:47.135784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:48.824947 [debug] [MainThread]: SQL status: BEGIN in 1.689 seconds
[0m21:19:48.826089 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:48.827239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:19:48.891653 [debug] [MainThread]: SQL status: SELECT 7 in 0.063 seconds
[0m21:19:48.895680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f17e0>]}
[0m21:19:48.896667 [debug] [MainThread]: On master: ROLLBACK
[0m21:19:48.960789 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:48.961349 [debug] [MainThread]: On master: BEGIN
[0m21:19:49.484203 [debug] [MainThread]: SQL status: BEGIN in 0.522 seconds
[0m21:19:49.485287 [debug] [MainThread]: On master: COMMIT
[0m21:19:49.485698 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:49.486075 [debug] [MainThread]: On master: COMMIT
[0m21:19:49.547446 [debug] [MainThread]: SQL status: COMMIT in 0.061 seconds
[0m21:19:49.548176 [debug] [MainThread]: On master: Close
[0m21:19:49.555116 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.scooters
[0m21:19:49.556045 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.scooters ............................................ [RUN]
[0m21:19:49.556652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.scooters)
[0m21:19:49.557076 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.scooters
[0m21:19:49.557479 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.scooters
[0m21:19:49.587284 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m21:19:49.587648 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: BEGIN
[0m21:19:49.587876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:50.364149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.776 seconds
[0m21:19:50.364998 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m21:19:50.366090 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_ohwk"."dbt"."scooters"
[0m21:19:50.435324 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.068 seconds
[0m21:19:50.462373 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m21:19:50.462792 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_ohwk"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m21:19:50.526702 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.063 seconds
[0m21:19:50.535335 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m21:19:50.550161 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m21:19:50.550520 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m21:19:50.550771 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m21:19:50.614737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.063 seconds
[0m21:19:50.617861 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: Close
[0m21:19:50.621450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1cf7d0>]}
[0m21:19:50.622143 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt.scooters ........................................ [[32mINSERT 10[0m in 1.06s]
[0m21:19:50.622723 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.scooters
[0m21:19:50.624148 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:50.624548 [debug] [MainThread]: On master: BEGIN
[0m21:19:50.624851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:19:51.431677 [debug] [MainThread]: SQL status: BEGIN in 0.807 seconds
[0m21:19:51.432638 [debug] [MainThread]: On master: COMMIT
[0m21:19:51.433481 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:51.434400 [debug] [MainThread]: On master: COMMIT
[0m21:19:51.483003 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m21:19:51.484323 [debug] [MainThread]: On master: Close
[0m21:19:51.485803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:51.486328 [debug] [MainThread]: Connection 'seed.dbt_scooters.scooters' was properly closed.
[0m21:19:51.486813 [info ] [MainThread]: 
[0m21:19:51.487300 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 7.91 seconds (7.91s).
[0m21:19:51.488423 [debug] [MainThread]: Command end result
[0m21:19:51.517087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:19:51.518588 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:19:51.523057 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:19:51.523238 [info ] [MainThread]: 
[0m21:19:51.523453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:51.523608 [info ] [MainThread]: 
[0m21:19:51.523785 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:19:51.525162 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.225017, "process_in_blocks": "0", "process_kernel_time": 0.151458, "process_mem_max_rss": "136085504", "process_out_blocks": "0", "process_user_time": 0.936847}
[0m21:19:51.525425 [debug] [MainThread]: Command `dbt seed` succeeded at 21:19:51.525374 after 8.23 seconds
[0m21:19:51.525640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3dc3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c176b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ef390>]}
[0m21:19:51.525837 [debug] [MainThread]: Flushing usage events
[0m21:19:52.303854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:20.824520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ff620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d27b10>]}


============================== 21:27:20.826512 | 1330b93b-81ed-4f10-bba7-15213b4e6e7e ==============================
[0m21:27:20.826512 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:27:20.826787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m21:27:20.891108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1330b93b-81ed-4f10-bba7-15213b4e6e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2f490>]}
[0m21:27:20.912137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1330b93b-81ed-4f10-bba7-15213b4e6e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bbebe0>]}
[0m21:27:20.912539 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:27:20.950260 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:27:20.987854 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:27:20.988098 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m21:27:20.988253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1330b93b-81ed-4f10-bba7-15213b4e6e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110be0250>]}
[0m21:27:21.465935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1330b93b-81ed-4f10-bba7-15213b4e6e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108f6030>]}
[0m21:27:21.500807 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:27:21.502018 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:27:21.514876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1330b93b-81ed-4f10-bba7-15213b4e6e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11105a350>]}
[0m21:27:21.515114 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:27:21.515878 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:27:21.516138 [debug] [MainThread]: Command end result
[0m21:27:21.526195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:27:21.527064 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:27:21.528468 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:27:21.529552 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7334606, "process_in_blocks": "0", "process_kernel_time": 0.101276, "process_mem_max_rss": "129826816", "process_out_blocks": "0", "process_user_time": 1.176559}
[0m21:27:21.529747 [debug] [MainThread]: Command `cli build` succeeded at 21:27:21.529703 after 0.73 seconds
[0m21:27:21.529976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110d7d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dc8650>]}
[0m21:27:21.530191 [debug] [MainThread]: Flushing usage events
[0m21:27:22.235562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:30.325800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107433620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894bb10>]}


============================== 21:27:30.327675 | 6b8fb0ff-302d-4426-b204-e4104d40472c ==============================
[0m21:27:30.327675 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:27:30.327974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:27:30.390630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b8fb0ff-302d-4426-b204-e4104d40472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c53490>]}
[0m21:27:30.411531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b8fb0ff-302d-4426-b204-e4104d40472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e2be0>]}
[0m21:27:30.411910 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:27:30.450283 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:27:30.488745 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:27:30.488984 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m21:27:30.489133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b8fb0ff-302d-4426-b204-e4104d40472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097b0250>]}
[0m21:27:30.984331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b8fb0ff-302d-4426-b204-e4104d40472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ba030>]}
[0m21:27:31.016812 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:27:31.017728 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:27:31.028943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b8fb0ff-302d-4426-b204-e4104d40472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b62270>]}
[0m21:27:31.029171 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:27:31.029936 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:27:31.030223 [debug] [MainThread]: Command end result
[0m21:27:31.040194 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:27:31.041012 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:27:31.042340 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:27:31.043005 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7434084, "process_in_blocks": "0", "process_kernel_time": 0.091336, "process_mem_max_rss": "129105920", "process_out_blocks": "0", "process_user_time": 1.189786}
[0m21:27:31.043187 [debug] [MainThread]: Command `cli build` succeeded at 21:27:31.043151 after 0.74 seconds
[0m21:27:31.043327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ba3d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108830dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aac650>]}
[0m21:27:31.043452 [debug] [MainThread]: Flushing usage events
[0m21:27:32.205697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:39.058300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ff620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112127b10>]}


============================== 21:27:39.060141 | c901338c-94f5-4c7c-87a9-58df7be52e58 ==============================
[0m21:27:39.060141 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:27:39.060391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m21:27:39.123273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c901338c-94f5-4c7c-87a9-58df7be52e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11102f490>]}
[0m21:27:39.144157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c901338c-94f5-4c7c-87a9-58df7be52e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fbebe0>]}
[0m21:27:39.144551 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:27:39.179713 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:27:39.223798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:27:39.223985 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:27:39.241042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c901338c-94f5-4c7c-87a9-58df7be52e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11306f750>]}
[0m21:27:39.275098 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:27:39.276014 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:27:39.281964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c901338c-94f5-4c7c-87a9-58df7be52e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121a97c0>]}
[0m21:27:39.282161 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:27:39.282294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c901338c-94f5-4c7c-87a9-58df7be52e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112607d90>]}
[0m21:27:39.282924 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:27:39.283732 [debug] [MainThread]: Command end result
[0m21:27:39.293332 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:27:39.294110 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:27:39.295509 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:27:39.296286 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.26338124, "process_in_blocks": "0", "process_kernel_time": 0.085465, "process_mem_max_rss": "119685120", "process_out_blocks": "0", "process_user_time": 0.705375}
[0m21:27:39.296487 [debug] [MainThread]: Command `cli run` succeeded at 21:27:39.296445 after 0.26 seconds
[0m21:27:39.296640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121c18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112010dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11383dfd0>]}
[0m21:27:39.296774 [debug] [MainThread]: Flushing usage events
[0m21:27:40.328836 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:42.496925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10319f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104827b10>]}


============================== 21:28:42.498649 | 4bb506e1-3ae3-4bfc-9fa3-141d8bfd47f9 ==============================
[0m21:28:42.498649 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:28:42.498916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed -s age_grops', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:28:42.562524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bb506e1-3ae3-4bfc-9fa3-141d8bfd47f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103997490>]}
[0m21:28:42.583134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bb506e1-3ae3-4bfc-9fa3-141d8bfd47f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046be030>]}
[0m21:28:42.583467 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:28:42.617795 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:28:42.661032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:28:42.661204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:28:42.677935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bb506e1-3ae3-4bfc-9fa3-141d8bfd47f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105453150>]}
[0m21:28:42.711115 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:28:42.712009 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:28:42.717871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bb506e1-3ae3-4bfc-9fa3-141d8bfd47f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d54f0>]}
[0m21:28:42.718052 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:28:42.718190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bb506e1-3ae3-4bfc-9fa3-141d8bfd47f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cfbaf0>]}
[0m21:28:42.718472 [warn ] [MainThread]: The selection criterion 'age_grops' does not match any enabled nodes
[0m21:28:42.718978 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:28:42.719740 [debug] [MainThread]: Command end result
[0m21:28:42.729600 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:28:42.730747 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:28:42.732178 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:28:42.732298 [info ] [MainThread]: 
[0m21:28:42.732450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:28:42.732565 [info ] [MainThread]: 
[0m21:28:42.732680 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m21:28:42.733530 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.26134217, "process_in_blocks": "0", "process_kernel_time": 0.087367, "process_mem_max_rss": "119111680", "process_out_blocks": "0", "process_user_time": 0.705531}
[0m21:28:42.733714 [debug] [MainThread]: Command `dbt seed` succeeded at 21:28:42.733676 after 0.26 seconds
[0m21:28:42.733864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104704d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106025c10>]}
[0m21:28:42.733986 [debug] [MainThread]: Flushing usage events
[0m21:28:43.418613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:30:12.125593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5bb10>]}


============================== 21:30:12.127302 | 0f3f6b68-cb19-45da-aac9-ea4527bd11c3 ==============================
[0m21:30:12.127302 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:30:12.127558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed -s age_groups', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:30:12.192824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405b490>]}
[0m21:30:12.214333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf2030>]}
[0m21:30:12.214679 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:30:12.249279 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:30:12.294832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:30:12.295005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:30:12.312366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059db150>]}
[0m21:30:12.347051 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:30:12.347977 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:30:12.354292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab54f0>]}
[0m21:30:12.354484 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:30:12.354626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105283af0>]}
[0m21:30:12.355287 [info ] [MainThread]: 
[0m21:30:12.355426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:30:12.355536 [info ] [MainThread]: 
[0m21:30:12.355736 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:12.356098 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:30:12.375173 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:30:12.375366 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:30:12.375480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:13.125182 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.749 seconds
[0m21:30:13.128884 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:30:13.136920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:30:13.142861 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:30:13.143199 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:30:13.143440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:13.778765 [debug] [ThreadPool]: SQL status: BEGIN in 0.635 seconds
[0m21:30:13.779401 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:30:13.779743 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:30:13.830061 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.050 seconds
[0m21:30:13.833829 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:30:13.880506 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:30:13.894323 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:13.894879 [debug] [MainThread]: On master: BEGIN
[0m21:30:13.895253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:14.571458 [debug] [MainThread]: SQL status: BEGIN in 0.676 seconds
[0m21:30:14.572203 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:14.572668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:14.623018 [debug] [MainThread]: SQL status: SELECT 7 in 0.050 seconds
[0m21:30:14.626947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e298b0>]}
[0m21:30:14.627846 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:14.672307 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:14.673536 [debug] [MainThread]: On master: BEGIN
[0m21:30:14.761376 [debug] [MainThread]: SQL status: BEGIN in 0.087 seconds
[0m21:30:14.762143 [debug] [MainThread]: On master: COMMIT
[0m21:30:14.762486 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:14.762763 [debug] [MainThread]: On master: COMMIT
[0m21:30:14.809324 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m21:30:14.810623 [debug] [MainThread]: On master: Close
[0m21:30:14.818641 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.age_groups
[0m21:30:14.819611 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.age_groups .......................................... [RUN]
[0m21:30:14.820250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.age_groups)
[0m21:30:14.820694 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.age_groups
[0m21:30:14.821075 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.age_groups
[0m21:30:14.847929 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:30:14.848245 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m21:30:14.848449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:15.783586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.934 seconds
[0m21:30:15.785317 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:30:15.786297 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    create table "dev_ohwk"."dbt"."age_groups" ("group" text,"age_start" integer,"age_end" integer)
  
[0m21:30:15.888774 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.101 seconds
[0m21:30:15.914126 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:30:15.914672 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_ohwk"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m21:30:15.969710 [debug] [Thread-1 (]: SQL status: INSERT 0 8 in 0.054 seconds
[0m21:30:15.978740 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m21:30:15.995470 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:30:15.995753 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:30:15.995963 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:30:16.084128 [debug] [Thread-1 (]: SQL status: COMMIT in 0.088 seconds
[0m21:30:16.087964 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: Close
[0m21:30:16.092320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c07f50>]}
[0m21:30:16.093176 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt.age_groups ...................................... [[32mINSERT 8[0m in 1.27s]
[0m21:30:16.093878 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.age_groups
[0m21:30:16.095728 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:16.096253 [debug] [MainThread]: On master: BEGIN
[0m21:30:16.096583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:16.808488 [debug] [MainThread]: SQL status: BEGIN in 0.712 seconds
[0m21:30:16.809337 [debug] [MainThread]: On master: COMMIT
[0m21:30:16.809884 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:16.810321 [debug] [MainThread]: On master: COMMIT
[0m21:30:16.864746 [debug] [MainThread]: SQL status: COMMIT in 0.054 seconds
[0m21:30:16.865504 [debug] [MainThread]: On master: Close
[0m21:30:16.866928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:16.867378 [debug] [MainThread]: Connection 'seed.dbt_scooters.age_groups' was properly closed.
[0m21:30:16.867801 [info ] [MainThread]: 
[0m21:30:16.868324 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m21:30:16.869614 [debug] [MainThread]: Command end result
[0m21:30:16.900225 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:30:16.901611 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:30:16.905411 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:30:16.905612 [info ] [MainThread]: 
[0m21:30:16.905834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:30:16.905993 [info ] [MainThread]: 
[0m21:30:16.906163 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:30:16.907303 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.80745, "process_in_blocks": "0", "process_kernel_time": 0.127498, "process_mem_max_rss": "136003584", "process_out_blocks": "0", "process_user_time": 0.92673}
[0m21:30:16.907546 [debug] [MainThread]: Command `dbt seed` succeeded at 21:30:16.907497 after 4.81 seconds
[0m21:30:16.907755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc79d0>]}
[0m21:30:16.907944 [debug] [MainThread]: Flushing usage events
[0m21:30:17.678422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:31:03.014417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb3b10>]}


============================== 21:31:03.016303 | 067fc28f-c946-4227-8914-c4bb9fe2a8f5 ==============================
[0m21:31:03.016303 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:31:03.016595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:31:03.109535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '067fc28f-c946-4227-8914-c4bb9fe2a8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082bb490>]}
[0m21:31:03.130765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '067fc28f-c946-4227-8914-c4bb9fe2a8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e4abe0>]}
[0m21:31:03.131175 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:31:03.166379 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:31:03.203742 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:31:03.203977 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m21:31:03.204129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '067fc28f-c946-4227-8914-c4bb9fe2a8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e18250>]}
[0m21:31:03.690099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '067fc28f-c946-4227-8914-c4bb9fe2a8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d3e030>]}
[0m21:31:03.720756 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:31:03.721752 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:31:03.734734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '067fc28f-c946-4227-8914-c4bb9fe2a8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a192270>]}
[0m21:31:03.734966 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:31:03.735744 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:31:03.735980 [debug] [MainThread]: Command end result
[0m21:31:03.746242 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:31:03.747186 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:31:03.748659 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:31:03.749354 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7609447, "process_in_blocks": "0", "process_kernel_time": 0.093233, "process_mem_max_rss": "133201920", "process_out_blocks": "0", "process_user_time": 1.180793}
[0m21:31:03.749510 [debug] [MainThread]: Command `cli build` succeeded at 21:31:03.749477 after 0.76 seconds
[0m21:31:03.749638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a20fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e98dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a134650>]}
[0m21:31:03.749760 [debug] [MainThread]: Flushing usage events
[0m21:31:04.436042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:31:11.078544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bfb10>]}


============================== 21:31:11.080422 | f7e973e5-4725-40e8-a478-72042f728dd4 ==============================
[0m21:31:11.080422 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:31:11.080677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:31:11.144042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7e973e5-4725-40e8-a478-72042f728dd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c7490>]}
[0m21:31:11.165351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7e973e5-4725-40e8-a478-72042f728dd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106556be0>]}
[0m21:31:11.165737 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:31:11.201318 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:31:11.246997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:31:11.247178 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:31:11.264968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7e973e5-4725-40e8-a478-72042f728dd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d37750>]}
[0m21:31:11.300297 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:31:11.301273 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:31:11.307676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7e973e5-4725-40e8-a478-72042f728dd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067417c0>]}
[0m21:31:11.307908 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:31:11.308050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e973e5-4725-40e8-a478-72042f728dd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf3d90>]}
[0m21:31:11.308712 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:31:11.309520 [debug] [MainThread]: Command end result
[0m21:31:11.319764 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:31:11.320607 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:31:11.321961 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:31:11.322618 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.269466, "process_in_blocks": "0", "process_kernel_time": 0.086279, "process_mem_max_rss": "119881728", "process_out_blocks": "0", "process_user_time": 0.711774}
[0m21:31:11.322810 [debug] [MainThread]: Command `cli run` succeeded at 21:31:11.322772 after 0.27 seconds
[0m21:31:11.322959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067598b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107575fd0>]}
[0m21:31:11.323084 [debug] [MainThread]: Flushing usage events
[0m21:31:12.757777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:46.000951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac7b10>]}


============================== 21:32:46.002657 | b3c6c2d2-d5db-43e6-8958-9f6d0c5432bc ==============================
[0m21:32:46.002657 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:32:46.002918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:32:46.010288 [info ] [MainThread]: dbt version: 1.10.6
[0m21:32:46.010490 [info ] [MainThread]: python version: 3.13.5
[0m21:32:46.010608 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m21:32:46.010711 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit-Mach-O
[0m21:32:46.031680 [info ] [MainThread]: Using profiles dir at /Users/flerinvs/.dbt
[0m21:32:46.031928 [info ] [MainThread]: Using profiles.yml file at /Users/flerinvs/.dbt/profiles.yml
[0m21:32:46.032041 [info ] [MainThread]: Using dbt_project.yml file at /Users/flerinvs/dbt_scooters/dbt_project.yml
[0m21:32:46.032244 [info ] [MainThread]: adapter type: postgres
[0m21:32:46.032349 [info ] [MainThread]: adapter version: 1.9.0
[0m21:32:46.068922 [info ] [MainThread]: Configuration:
[0m21:32:46.069175 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:32:46.069302 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:32:46.069411 [info ] [MainThread]: Required dependencies:
[0m21:32:46.069566 [debug] [MainThread]: Executing "git --help"
[0m21:32:46.079308 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:32:46.079806 [debug] [MainThread]: STDERR: "b''"
[0m21:32:46.079938 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:32:46.080059 [info ] [MainThread]: Connection:
[0m21:32:46.080200 [info ] [MainThread]:   host: dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com
[0m21:32:46.080306 [info ] [MainThread]:   port: 5432
[0m21:32:46.080399 [info ] [MainThread]:   user: admin
[0m21:32:46.080497 [info ] [MainThread]:   database: dev_ohwk
[0m21:32:46.080589 [info ] [MainThread]:   schema: dbt
[0m21:32:46.080685 [info ] [MainThread]:   connect_timeout: 10
[0m21:32:46.080781 [info ] [MainThread]:   role: None
[0m21:32:46.080868 [info ] [MainThread]:   search_path: None
[0m21:32:46.080960 [info ] [MainThread]:   keepalives_idle: 0
[0m21:32:46.081053 [info ] [MainThread]:   sslmode: None
[0m21:32:46.081145 [info ] [MainThread]:   sslcert: None
[0m21:32:46.081236 [info ] [MainThread]:   sslkey: None
[0m21:32:46.081331 [info ] [MainThread]:   sslrootcert: None
[0m21:32:46.081429 [info ] [MainThread]:   application_name: dbt
[0m21:32:46.081527 [info ] [MainThread]:   retries: 1
[0m21:32:46.081783 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:32:46.113665 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:32:46.127357 [debug] [MainThread]: Using postgres connection "debug"
[0m21:32:46.127534 [debug] [MainThread]: On debug: select 1 as id
[0m21:32:46.127640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:48.047912 [debug] [MainThread]: SQL status: SELECT 1 in 1.920 seconds
[0m21:32:48.050140 [debug] [MainThread]: On debug: Close
[0m21:32:48.051245 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:32:48.051901 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:32:48.055045 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.0785975, "process_in_blocks": "0", "process_kernel_time": 0.098027, "process_mem_max_rss": "128761856", "process_out_blocks": "0", "process_user_time": 0.608003}
[0m21:32:48.056102 [debug] [MainThread]: Command `dbt debug` succeeded at 21:32:48.055898 after 2.08 seconds
[0m21:32:48.056660 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:32:48.057105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107181ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107131eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba08d0>]}
[0m21:32:48.057835 [debug] [MainThread]: Flushing usage events
[0m21:32:48.856653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:49.572258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbfb10>]}


============================== 21:32:49.574055 | f0779d3a-6132-47ea-a19e-fc92d54164ea ==============================
[0m21:32:49.574055 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:32:49.574308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -s age_groups+', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:32:49.637446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042bf490>]}
[0m21:32:49.657993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e56030>]}
[0m21:32:49.658340 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:32:49.691279 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:32:49.727330 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:32:49.727555 [debug] [MainThread]: previous checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, current checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7
[0m21:32:49.727690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3fe50>]}
[0m21:32:50.210444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d488c0>]}
[0m21:32:50.241103 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:32:50.241912 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:32:50.252788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061da270>]}
[0m21:32:50.252992 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:32:50.253799 [info ] [MainThread]: 
[0m21:32:50.253938 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:32:50.254045 [info ] [MainThread]: 
[0m21:32:50.254231 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:32:50.254562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:32:50.271320 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:32:50.271528 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:32:50.271639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:50.897280 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.625 seconds
[0m21:32:50.901117 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:32:50.909230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:32:50.915956 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:32:50.916419 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:32:50.916669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:51.802617 [debug] [ThreadPool]: SQL status: BEGIN in 0.886 seconds
[0m21:32:51.804123 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:32:51.804620 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:32:51.878947 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.074 seconds
[0m21:32:51.881700 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:32:51.945928 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:32:51.959668 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:51.960246 [debug] [MainThread]: On master: BEGIN
[0m21:32:51.960542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:52.800453 [debug] [MainThread]: SQL status: BEGIN in 0.840 seconds
[0m21:32:52.801788 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:52.803235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:32:52.870276 [debug] [MainThread]: SQL status: SELECT 7 in 0.066 seconds
[0m21:32:52.875664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064325b0>]}
[0m21:32:52.876782 [debug] [MainThread]: On master: ROLLBACK
[0m21:32:52.944144 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:52.945360 [debug] [MainThread]: On master: BEGIN
[0m21:32:53.081086 [debug] [MainThread]: SQL status: BEGIN in 0.135 seconds
[0m21:32:53.082583 [debug] [MainThread]: On master: COMMIT
[0m21:32:53.083417 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:53.083822 [debug] [MainThread]: On master: COMMIT
[0m21:32:53.126652 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m21:32:53.127440 [debug] [MainThread]: On master: Close
[0m21:32:53.135656 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.age_groups
[0m21:32:53.136650 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.age_groups .......................................... [RUN]
[0m21:32:53.137429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.age_groups)
[0m21:32:53.137926 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.age_groups
[0m21:32:53.138365 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.age_groups
[0m21:32:53.166406 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:32:53.166710 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m21:32:53.166916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:53.878823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.711 seconds
[0m21:32:53.879965 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:32:53.880479 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_ohwk"."dbt"."age_groups"
[0m21:32:53.931705 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.050 seconds
[0m21:32:53.957324 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:32:53.957745 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_ohwk"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m21:32:54.006429 [debug] [Thread-1 (]: SQL status: INSERT 0 8 in 0.048 seconds
[0m21:32:54.015216 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m21:32:54.028381 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:32:54.028695 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:32:54.028939 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:32:54.076656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.047 seconds
[0m21:32:54.079864 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: Close
[0m21:32:54.082709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fa990>]}
[0m21:32:54.083330 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt.age_groups ...................................... [[32mINSERT 8[0m in 0.94s]
[0m21:32:54.083901 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.age_groups
[0m21:32:54.085133 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:54.085395 [debug] [MainThread]: On master: BEGIN
[0m21:32:54.085612 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:56.518259 [debug] [MainThread]: SQL status: BEGIN in 2.432 seconds
[0m21:32:56.519818 [debug] [MainThread]: On master: COMMIT
[0m21:32:56.520684 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:56.521070 [debug] [MainThread]: On master: COMMIT
[0m21:32:56.583809 [debug] [MainThread]: SQL status: COMMIT in 0.062 seconds
[0m21:32:56.584664 [debug] [MainThread]: On master: Close
[0m21:32:56.585894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:56.586304 [debug] [MainThread]: Connection 'seed.dbt_scooters.age_groups' was properly closed.
[0m21:32:56.587026 [info ] [MainThread]: 
[0m21:32:56.587850 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.33 seconds (6.33s).
[0m21:32:56.588980 [debug] [MainThread]: Command end result
[0m21:32:56.619121 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:32:56.620667 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:32:56.624704 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:32:56.624907 [info ] [MainThread]: 
[0m21:32:56.625142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:32:56.625300 [info ] [MainThread]: 
[0m21:32:56.625491 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:32:56.626595 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.0799794, "process_in_blocks": "0", "process_kernel_time": 0.121994, "process_mem_max_rss": "145719296", "process_out_blocks": "0", "process_user_time": 1.383364}
[0m21:32:56.626858 [debug] [MainThread]: Command `dbt build` succeeded at 21:32:56.626804 after 7.08 seconds
[0m21:32:56.627072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106220aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660edf0>]}
[0m21:32:56.627272 [debug] [MainThread]: Flushing usage events
[0m21:32:57.221238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:33:01.117030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a8f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f879d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f87b10>]}


============================== 21:33:01.118740 | b68c5be0-6e16-451e-a289-d4ba7b5e28c3 ==============================
[0m21:33:01.118740 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:33:01.119012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -s age_groups+', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:33:01.197874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b68c5be0-6e16-451e-a289-d4ba7b5e28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104287490>]}
[0m21:33:01.219674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b68c5be0-6e16-451e-a289-d4ba7b5e28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e1e030>]}
[0m21:33:01.220009 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:33:01.254628 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:33:01.300040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:33:01.300225 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:33:01.317599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b68c5be0-6e16-451e-a289-d4ba7b5e28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c07450>]}
[0m21:33:01.352047 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:33:01.352929 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:33:01.363792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b68c5be0-6e16-451e-a289-d4ba7b5e28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7de50>]}
[0m21:33:01.364007 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:33:01.364821 [info ] [MainThread]: 
[0m21:33:01.364970 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:01.365078 [info ] [MainThread]: 
[0m21:33:01.365280 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:33:01.365634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:33:01.382956 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:33:01.383147 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:33:01.383255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:02.006004 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.622 seconds
[0m21:33:02.010149 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:33:02.019198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:33:02.026004 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:33:02.026403 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:33:02.026648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:02.640842 [debug] [ThreadPool]: SQL status: BEGIN in 0.614 seconds
[0m21:33:02.641848 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:33:02.642476 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:33:02.690490 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.047 seconds
[0m21:33:02.693903 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:33:02.737736 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:33:02.750795 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:02.751320 [debug] [MainThread]: On master: BEGIN
[0m21:33:02.751711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:04.255721 [debug] [MainThread]: SQL status: BEGIN in 1.504 seconds
[0m21:33:04.256593 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:04.257269 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:33:04.353818 [debug] [MainThread]: SQL status: SELECT 7 in 0.096 seconds
[0m21:33:04.358220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b68c5be0-6e16-451e-a289-d4ba7b5e28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e97e70>]}
[0m21:33:04.359022 [debug] [MainThread]: On master: ROLLBACK
[0m21:33:04.424079 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:04.424399 [debug] [MainThread]: On master: BEGIN
[0m21:33:04.562762 [debug] [MainThread]: SQL status: BEGIN in 0.138 seconds
[0m21:33:04.563456 [debug] [MainThread]: On master: COMMIT
[0m21:33:04.564127 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:04.564774 [debug] [MainThread]: On master: COMMIT
[0m21:33:04.629836 [debug] [MainThread]: SQL status: COMMIT in 0.064 seconds
[0m21:33:04.630832 [debug] [MainThread]: On master: Close
[0m21:33:04.638239 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.age_groups
[0m21:33:04.639200 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.age_groups .......................................... [RUN]
[0m21:33:04.639886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.age_groups)
[0m21:33:04.640318 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.age_groups
[0m21:33:04.640734 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.age_groups
[0m21:33:04.669936 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:33:04.670283 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m21:33:04.670473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:05.432976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.762 seconds
[0m21:33:05.434230 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:33:05.435367 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_ohwk"."dbt"."age_groups"
[0m21:33:05.511276 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.075 seconds
[0m21:33:05.533908 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:33:05.534403 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_ohwk"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m21:33:05.601162 [debug] [Thread-1 (]: SQL status: INSERT 0 8 in 0.066 seconds
[0m21:33:05.609617 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m21:33:05.622751 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:33:05.623081 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:33:05.623330 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:33:05.691801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.068 seconds
[0m21:33:05.695212 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: Close
[0m21:33:05.698687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b68c5be0-6e16-451e-a289-d4ba7b5e28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ea680>]}
[0m21:33:05.699339 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt.age_groups ...................................... [[32mINSERT 8[0m in 1.06s]
[0m21:33:05.699936 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.age_groups
[0m21:33:05.701390 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:05.701694 [debug] [MainThread]: On master: BEGIN
[0m21:33:05.701946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:33:07.299579 [debug] [MainThread]: SQL status: BEGIN in 1.597 seconds
[0m21:33:07.300487 [debug] [MainThread]: On master: COMMIT
[0m21:33:07.300980 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:07.301380 [debug] [MainThread]: On master: COMMIT
[0m21:33:07.368236 [debug] [MainThread]: SQL status: COMMIT in 0.066 seconds
[0m21:33:07.369593 [debug] [MainThread]: On master: Close
[0m21:33:07.370935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:07.371229 [debug] [MainThread]: Connection 'seed.dbt_scooters.age_groups' was properly closed.
[0m21:33:07.371689 [info ] [MainThread]: 
[0m21:33:07.372146 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.01 seconds (6.01s).
[0m21:33:07.373159 [debug] [MainThread]: Command end result
[0m21:33:07.434422 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:33:07.435506 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:33:07.438434 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:33:07.438572 [info ] [MainThread]: 
[0m21:33:07.438747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:33:07.438863 [info ] [MainThread]: 
[0m21:33:07.438994 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:33:07.439836 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.347812, "process_in_blocks": "0", "process_kernel_time": 0.121323, "process_mem_max_rss": "136626176", "process_out_blocks": "0", "process_user_time": 0.956909}
[0m21:33:07.440036 [debug] [MainThread]: Command `dbt build` succeeded at 21:33:07.439993 after 6.35 seconds
[0m21:33:07.440197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e64d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3b540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3ac50>]}
[0m21:33:07.440359 [debug] [MainThread]: Flushing usage events
[0m21:33:08.292674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:47.311376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1fb10>]}


============================== 15:42:47.313465 | c861ae9f-6ff5-4eaa-833f-226947a8a424 ==============================
[0m15:42:47.313465 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:42:47.313724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:42:47.358655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c861ae9f-6ff5-4eaa-833f-226947a8a424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2b490>]}
[0m15:42:47.364600 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:42:47.365182 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:42:47.395400 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11549904, "process_in_blocks": "0", "process_kernel_time": 0.067118, "process_mem_max_rss": "111460352", "process_out_blocks": "0", "process_user_time": 0.54846}
[0m15:42:47.395648 [debug] [MainThread]: Command `cli deps` succeeded at 15:42:47.395600 after 0.12 seconds
[0m15:42:47.395808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abd8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abe360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa3450>]}
[0m15:42:47.395954 [debug] [MainThread]: Flushing usage events
[0m15:42:48.054322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:58.383990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ccf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113027b10>]}


============================== 16:08:58.385987 | d6522f68-8fb0-489c-a22d-a6abb85e5f46 ==============================
[0m16:08:58.385987 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:08:58.386265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:08:58.454480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111727490>]}
[0m16:08:58.476326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ebe030>]}
[0m16:08:58.476673 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:08:58.514602 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:08:58.559791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:58.559979 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:58.577164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dfb450>]}
[0m16:08:58.611459 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:08:58.612520 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:08:58.618856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130a59a0>]}
[0m16:08:58.619073 [info ] [MainThread]: Found 17 models, 3 seeds, 16 sources, 435 macros
[0m16:08:58.619217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134af5b0>]}
[0m16:08:58.620199 [info ] [MainThread]: 
[0m16:08:58.620349 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:08:58.620464 [info ] [MainThread]: 
[0m16:08:58.620665 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:08:58.622406 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:08:58.640298 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:08:58.640499 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:08:58.640610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:00.389166 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.748 seconds
[0m16:09:00.391868 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:09:00.394542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:09:00.400296 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:09:00.400638 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:09:00.400884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:01.331726 [debug] [ThreadPool]: SQL status: BEGIN in 0.931 seconds
[0m16:09:01.332242 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:09:01.332615 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:09:01.388330 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.055 seconds
[0m16:09:01.390424 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:09:01.437106 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:09:01.448925 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:01.449405 [debug] [MainThread]: On master: BEGIN
[0m16:09:01.449796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:02.151729 [debug] [MainThread]: SQL status: BEGIN in 0.702 seconds
[0m16:09:02.153125 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:02.154308 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:02.217990 [debug] [MainThread]: SQL status: SELECT 7 in 0.063 seconds
[0m16:09:02.220812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114251a50>]}
[0m16:09:02.221362 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:02.272905 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:02.273420 [debug] [MainThread]: On master: BEGIN
[0m16:09:02.371739 [debug] [MainThread]: SQL status: BEGIN in 0.098 seconds
[0m16:09:02.372224 [debug] [MainThread]: On master: COMMIT
[0m16:09:02.372562 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:02.372865 [debug] [MainThread]: On master: COMMIT
[0m16:09:02.421525 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m16:09:02.421902 [debug] [MainThread]: On master: Close
[0m16:09:02.430062 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m16:09:02.430880 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m16:09:02.431533 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m16:09:02.432158 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_clean
[0m16:09:02.433032 [info ] [Thread-3 (]: 3 of 17 START sql incremental model dbt.trips_concurrency ...................... [RUN]
[0m16:09:02.433641 [info ] [Thread-1 (]: 1 of 17 START sql view model dbt.companies ..................................... [RUN]
[0m16:09:02.434203 [info ] [Thread-4 (]: 4 of 17 START sql view model dbt.trips_geom .................................... [RUN]
[0m16:09:02.434751 [info ] [Thread-2 (]: 2 of 17 START sql incremental model dbt.events_clean ........................... [RUN]
[0m16:09:02.435516 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m16:09:02.436000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.companies)
[0m16:09:02.436525 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m16:09:02.436938 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean'
[0m16:09:02.437283 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m16:09:02.437607 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m16:09:02.437904 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m16:09:02.438208 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_clean
[0m16:09:02.454485 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m16:09:02.461864 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m16:09:02.464613 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m16:09:02.467073 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m16:09:02.468508 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m16:09:02.468768 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m16:09:02.469067 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m16:09:02.469577 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_clean
[0m16:09:02.504192 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m16:09:02.506966 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:02.508197 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m16:09:02.509622 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:02.509868 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp160902492534"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency
from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m16:09:02.510134 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp160902509075"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id
from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m16:09:02.510345 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:09:02.510511 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:09:02.510777 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:09:02.510993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:09:02.511168 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m16:09:02.511304 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m16:09:02.511430 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:09:02.511548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:03.716311 [debug] [Thread-4 (]: SQL status: BEGIN in 1.205 seconds
[0m16:09:03.717160 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:09:03.717666 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_ohwk"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_ohwk"."scooters_raw"."trips"
  );
[0m16:09:03.811653 [debug] [Thread-1 (]: SQL status: BEGIN in 1.300 seconds
[0m16:09:03.812687 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:09:03.813122 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  create view "dev_ohwk"."dbt"."companies__dbt_tmp"
    
    
  as (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_ohwk"."dbt"."scooters"
group by
    1
  );
[0m16:09:04.005835 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.192 seconds
[0m16:09:04.006680 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.289 seconds
[0m16:09:04.017787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:09:04.027946 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:09:04.028510 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies" rename to "companies__dbt_backup"
[0m16:09:04.028870 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m16:09:04.100308 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.071 seconds
[0m16:09:04.101118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.072 seconds
[0m16:09:04.105706 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:09:04.108777 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:09:04.109270 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m16:09:04.109728 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies__dbt_tmp" rename to "companies"
[0m16:09:04.203902 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m16:09:04.204625 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m16:09:04.255276 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m16:09:04.256031 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m16:09:04.256249 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:09:04.256405 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:09:04.256552 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m16:09:04.256695 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m16:09:04.404769 [debug] [Thread-4 (]: SQL status: COMMIT in 0.148 seconds
[0m16:09:04.405561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.149 seconds
[0m16:09:04.414390 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_geom__dbt_backup"
[0m16:09:04.416851 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."companies__dbt_backup"
[0m16:09:04.421530 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:09:04.423516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:09:04.423819 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop table if exists "dev_ohwk"."dbt"."trips_geom__dbt_backup" cascade
[0m16:09:04.424092 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop view if exists "dev_ohwk"."dbt"."companies__dbt_backup" cascade
[0m16:09:04.608072 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.183 seconds
[0m16:09:04.614075 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m16:09:04.618719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a8ca10>]}
[0m16:09:04.619639 [info ] [Thread-1 (]: 1 of 17 OK created sql view model dbt.companies ................................ [[32mCREATE VIEW[0m in 2.18s]
[0m16:09:04.620360 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m16:09:04.620830 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m16:09:04.621429 [info ] [Thread-1 (]: 5 of 17 START sql view model dbt.trips_prep .................................... [RUN]
[0m16:09:04.621979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.trips_prep)
[0m16:09:04.622368 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m16:09:04.625951 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m16:09:04.627256 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m16:09:04.631418 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m16:09:04.632432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:09:04.632742 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m16:09:04.633024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:04.690739 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.266 seconds
[0m16:09:04.692513 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: Close
[0m16:09:04.693339 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fff8b0>]}
[0m16:09:04.694022 [info ] [Thread-4 (]: 4 of 17 OK created sql view model dbt.trips_geom ............................... [[32mCREATE VIEW[0m in 2.26s]
[0m16:09:04.694611 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m16:09:04.695014 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m16:09:04.695606 [info ] [Thread-4 (]: 6 of 17 START sql view model dbt.trips_stat_daily .............................. [RUN]
[0m16:09:04.696177 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.trips_stat_daily)
[0m16:09:04.696560 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m16:09:04.698118 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m16:09:04.698739 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m16:09:04.701282 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m16:09:04.701827 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:09:04.702114 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m16:09:04.702379 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:05.285170 [debug] [Thread-2 (]: SQL status: SELECT 0 in 2.774 seconds
[0m16:09:05.307161 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:05.307745 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: BEGIN
[0m16:09:05.386647 [debug] [Thread-2 (]: SQL status: BEGIN in 0.078 seconds
[0m16:09:05.387536 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:05.388330 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp160902509075'
        
      order by ordinal_position

  
[0m16:09:05.685332 [debug] [Thread-1 (]: SQL status: BEGIN in 1.052 seconds
[0m16:09:05.687064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:09:05.687859 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_ohwk"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  );
[0m16:09:05.691094 [debug] [Thread-4 (]: SQL status: BEGIN in 0.989 seconds
[0m16:09:05.691595 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:09:05.692011 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  create view "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp"
    
    
  as (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
[0m16:09:05.889186 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.500 seconds
[0m16:09:05.894982 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:05.895440 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.203 seconds
[0m16:09:05.895836 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:09:05.898785 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:09:05.899290 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m16:09:05.984215 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.295 seconds
[0m16:09:05.991424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:09:05.992060 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m16:09:05.992743 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m16:09:05.995912 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:09:05.996448 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m16:09:06.086789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m16:09:06.088407 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m16:09:06.093541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:09:06.095177 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m16:09:06.095620 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m16:09:06.096023 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:09:06.096484 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m16:09:06.183420 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.284 seconds
[0m16:09:06.184265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m16:09:06.191059 [debug] [Thread-4 (]: SQL status: COMMIT in 0.094 seconds
[0m16:09:06.194848 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:06.196393 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m16:09:06.199033 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup"
[0m16:09:06.199467 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:09:06.199867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:09:06.200424 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:09:06.200884 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m16:09:06.201282 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m16:09:06.290512 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.089 seconds
[0m16:09:06.292189 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.090 seconds
[0m16:09:06.293462 [debug] [Thread-1 (]: SQL status: COMMIT in 0.092 seconds
[0m16:09:06.308472 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m16:09:06.310829 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m16:09:06.312989 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_prep__dbt_backup"
[0m16:09:06.313680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:09:06.314174 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b07570>]}
[0m16:09:06.314524 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_ohwk"."dbt"."trips_prep__dbt_backup" cascade
[0m16:09:06.315145 [info ] [Thread-4 (]: 6 of 17 OK created sql view model dbt.trips_stat_daily ......................... [[32mCREATE VIEW[0m in 1.62s]
[0m16:09:06.315870 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m16:09:06.316271 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:06.316619 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m16:09:06.317014 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id")
    (
        select "user_id", "timestamp", "type_id"
        from "events_clean__dbt_tmp160902509075"
    )


  
[0m16:09:06.317412 [info ] [Thread-4 (]: 7 of 17 START sql view model dbt.parking_finish_stat ........................... [RUN]
[0m16:09:06.317824 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.parking_finish_stat)
[0m16:09:06.318147 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m16:09:06.320210 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m16:09:06.321509 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m16:09:06.324274 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m16:09:06.325132 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:09:06.325376 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m16:09:06.325576 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:06.387762 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.070 seconds
[0m16:09:06.389246 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m16:09:06.389687 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.074 seconds
[0m16:09:06.390132 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:06.391598 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m16:09:06.391989 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m16:09:06.392728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142c1d50>]}
[0m16:09:06.393312 [info ] [Thread-1 (]: 5 of 17 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 1.77s]
[0m16:09:06.393808 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m16:09:06.394155 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m16:09:06.394630 [info ] [Thread-1 (]: 8 of 17 START sql view model dbt.parking_start_stat ............................ [RUN]
[0m16:09:06.395120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_start_stat)
[0m16:09:06.395461 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m16:09:06.397847 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m16:09:06.398529 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m16:09:06.401137 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m16:09:06.401601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:09:06.401840 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m16:09:06.402064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:06.484956 [debug] [Thread-2 (]: SQL status: COMMIT in 0.092 seconds
[0m16:09:06.486323 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: Close
[0m16:09:06.487330 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114343b60>]}
[0m16:09:06.488135 [info ] [Thread-2 (]: 2 of 17 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 4.05s]
[0m16:09:06.488695 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_clean
[0m16:09:06.489086 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies_trips
[0m16:09:06.489594 [info ] [Thread-2 (]: 9 of 17 START sql view model dbt.companies_trips ............................... [RUN]
[0m16:09:06.490134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.companies_trips)
[0m16:09:06.490497 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies_trips
[0m16:09:06.494553 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m16:09:06.495731 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies_trips
[0m16:09:06.499061 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m16:09:06.499755 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:09:06.500048 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m16:09:06.500320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:06.693688 [debug] [Thread-3 (]: SQL status: SELECT 0 in 4.183 seconds
[0m16:09:06.700020 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:06.700890 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m16:09:06.745221 [debug] [Thread-3 (]: SQL status: BEGIN in 0.043 seconds
[0m16:09:06.746568 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:06.747193 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp160902492534'
        
      order by ordinal_position

  
[0m16:09:06.810195 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.062 seconds
[0m16:09:06.811900 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:06.812120 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:09:06.885422 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.073 seconds
[0m16:09:06.888787 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:06.889120 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:09:06.935166 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.045 seconds
[0m16:09:06.938350 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m16:09:06.939806 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:06.940440 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency")
    (
        select "timestamp", "concurrency"
        from "trips_concurrency__dbt_tmp160902492534"
    )


  
[0m16:09:06.984617 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.044 seconds
[0m16:09:06.987573 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m16:09:06.988325 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:06.988838 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m16:09:07.270672 [debug] [Thread-3 (]: SQL status: COMMIT in 0.281 seconds
[0m16:09:07.272320 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m16:09:07.273739 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143d5cd0>]}
[0m16:09:07.274675 [info ] [Thread-3 (]: 3 of 17 OK created sql incremental model dbt.trips_concurrency ................. [[32mINSERT 0 0[0m in 4.84s]
[0m16:09:07.275356 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m16:09:07.275819 [debug] [Thread-3 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:09:07.276404 [info ] [Thread-3 (]: 10 of 17 START sql view model dbt.revenue_daily ................................ [RUN]
[0m16:09:07.277111 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.revenue_daily)
[0m16:09:07.277532 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:09:07.281312 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:09:07.282724 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:09:07.287110 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:09:07.288520 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:09:07.289105 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:09:07.289481 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:07.383255 [debug] [Thread-4 (]: SQL status: BEGIN in 1.058 seconds
[0m16:09:07.383787 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:09:07.384159 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  create view "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp"
    
    
  as (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
where
    st_intersects(st_transform(t.finish_point, 3857), hex.geom)
group by
    1
  );
[0m16:09:07.454840 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.070 seconds
[0m16:09:07.460419 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:09:07.461437 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m16:09:07.479821 [debug] [Thread-2 (]: SQL status: BEGIN in 0.979 seconds
[0m16:09:07.480500 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:09:07.480987 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  create view "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
    
    
  as (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
[0m16:09:07.531379 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.069 seconds
[0m16:09:07.534673 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:09:07.535064 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m16:09:07.548932 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.067 seconds
[0m16:09:07.557598 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:09:07.558127 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m16:09:07.603544 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m16:09:07.605767 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m16:09:07.606377 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:09:07.606807 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m16:09:07.627175 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.069 seconds
[0m16:09:07.628709 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m16:09:07.629127 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:09:07.629502 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m16:09:07.719503 [debug] [Thread-2 (]: SQL status: COMMIT in 0.089 seconds
[0m16:09:07.720423 [debug] [Thread-4 (]: SQL status: COMMIT in 0.113 seconds
[0m16:09:07.723735 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m16:09:07.726975 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup"
[0m16:09:07.727770 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:09:07.728404 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:09:07.728880 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop view if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m16:09:07.729336 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m16:09:07.791055 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.061 seconds
[0m16:09:07.791831 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.062 seconds
[0m16:09:07.793991 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: Close
[0m16:09:07.795839 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m16:09:07.797186 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143d75f0>]}
[0m16:09:07.797701 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cab10>]}
[0m16:09:07.798471 [info ] [Thread-2 (]: 9 of 17 OK created sql view model dbt.companies_trips .......................... [[32mCREATE VIEW[0m in 1.31s]
[0m16:09:07.799164 [info ] [Thread-4 (]: 7 of 17 OK created sql view model dbt.parking_finish_stat ...................... [[32mCREATE VIEW[0m in 1.48s]
[0m16:09:07.799834 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies_trips
[0m16:09:07.800370 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m16:09:07.800835 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m16:09:07.801319 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m16:09:07.801827 [info ] [Thread-2 (]: 11 of 17 START sql view model dbt.trips_stat ................................... [RUN]
[0m16:09:07.802309 [info ] [Thread-4 (]: 12 of 17 START sql incremental model dbt.trips_users ........................... [RUN]
[0m16:09:07.802871 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_stat)
[0m16:09:07.803339 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.trips_users)
[0m16:09:07.803785 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m16:09:07.804217 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m16:09:07.808070 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m16:09:07.812318 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m16:09:07.813319 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m16:09:07.813657 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m16:09:07.817601 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m16:09:07.820446 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:07.820866 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp160907819309"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age
from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m16:09:07.821150 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:07.821636 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:09:07.821893 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m16:09:07.822123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:07.968676 [debug] [Thread-1 (]: SQL status: BEGIN in 1.566 seconds
[0m16:09:07.969648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:09:07.970236 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  create view "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp"
    
    
  as (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
where
    st_intersects(st_transform(t.start_point, 3857), hex.geom)
group by
    1
  );
[0m16:09:08.037119 [debug] [Thread-3 (]: SQL status: BEGIN in 0.747 seconds
[0m16:09:08.037983 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.067 seconds
[0m16:09:08.038497 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:09:08.043967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:09:08.044506 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

  create view "dev_ohwk"."dbt"."revenue_daily__dbt_tmp"
    
    
  as (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"
group by
    2
order by
    2
  );
[0m16:09:08.045189 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m16:09:08.103537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.058 seconds
[0m16:09:08.104337 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.059 seconds
[0m16:09:08.108428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:09:08.111498 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:09:08.111992 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m16:09:08.112448 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
alter table "dev_ohwk"."dbt"."revenue_daily__dbt_tmp" rename to "revenue_daily"
[0m16:09:08.158912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:09:08.161514 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m16:09:08.162184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:09:08.162633 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.050 seconds
[0m16:09:08.163026 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m16:09:08.164562 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:09:08.165194 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:09:08.165559 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:09:08.210700 [debug] [Thread-1 (]: SQL status: COMMIT in 0.046 seconds
[0m16:09:08.214003 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_start_stat__dbt_backup"
[0m16:09:08.214610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:09:08.214986 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_ohwk"."dbt"."parking_start_stat__dbt_backup" cascade
[0m16:09:08.217966 [debug] [Thread-3 (]: SQL status: COMMIT in 0.052 seconds
[0m16:09:08.220244 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."revenue_daily__dbt_backup"
[0m16:09:08.220822 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:09:08.221198 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
drop view if exists "dev_ohwk"."dbt"."revenue_daily__dbt_backup" cascade
[0m16:09:08.272894 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.051 seconds
[0m16:09:08.274509 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:09:08.274904 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.060 seconds
[0m16:09:08.276199 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m16:09:08.276770 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cad50>]}
[0m16:09:08.278008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cadb0>]}
[0m16:09:08.277546 [info ] [Thread-3 (]: 10 of 17 OK created sql view model dbt.revenue_daily ........................... [[32mCREATE VIEW[0m in 1.00s]
[0m16:09:08.278712 [info ] [Thread-1 (]: 8 of 17 OK created sql view model dbt.parking_start_stat ....................... [[32mCREATE VIEW[0m in 1.88s]
[0m16:09:08.279331 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:09:08.279854 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m16:09:08.280271 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_full
[0m16:09:08.280915 [info ] [Thread-3 (]: 13 of 17 START sql view model dbt.events_full .................................. [RUN]
[0m16:09:08.281383 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.events_full)
[0m16:09:08.281754 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_full
[0m16:09:08.284826 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m16:09:08.286995 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_full
[0m16:09:08.291389 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m16:09:08.292777 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:09:08.293205 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: BEGIN
[0m16:09:08.293536 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:08.814537 [debug] [Thread-2 (]: SQL status: BEGIN in 0.992 seconds
[0m16:09:08.815110 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:09:08.815511 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  create view "dev_ohwk"."dbt"."trips_stat__dbt_tmp"
    
    
  as (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_ohwk"."dbt"."trips_prep"
  );
[0m16:09:08.891706 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.076 seconds
[0m16:09:08.894971 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:09:08.895365 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m16:09:08.988637 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m16:09:08.991981 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:09:08.992354 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m16:09:09.086074 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m16:09:09.088054 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m16:09:09.088564 [debug] [Thread-4 (]: SQL status: SELECT 0 in 1.267 seconds
[0m16:09:09.088982 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:09:09.092170 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:09.092626 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m16:09:09.092992 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m16:09:09.139666 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m16:09:09.140547 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:09.141073 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp160907819309'
        
      order by ordinal_position

  
[0m16:09:09.141524 [debug] [Thread-2 (]: SQL status: COMMIT in 0.048 seconds
[0m16:09:09.144875 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat__dbt_backup"
[0m16:09:09.145660 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:09:09.146153 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_stat__dbt_backup" cascade
[0m16:09:09.203916 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.057 seconds
[0m16:09:09.205665 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m16:09:09.206475 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f130b0>]}
[0m16:09:09.207094 [info ] [Thread-2 (]: 11 of 17 OK created sql view model dbt.trips_stat .............................. [[32mCREATE VIEW[0m in 1.40s]
[0m16:09:09.207626 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m16:09:09.208848 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.067 seconds
[0m16:09:09.212518 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:09.212892 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:09:09.251621 [debug] [Thread-3 (]: SQL status: BEGIN in 0.958 seconds
[0m16:09:09.252418 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:09:09.252948 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_ohwk"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_ohwk"."dbt"."events_clean"
    left join "dev_ohwk"."dbt"."event_types"
        using (type_id)
  );
[0m16:09:09.290061 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.077 seconds
[0m16:09:09.294457 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:09.294914 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:09:09.311012 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.057 seconds
[0m16:09:09.315516 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:09:09.315949 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m16:09:09.362885 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:09:09.366476 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:09:09.366838 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m16:09:09.413639 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.118 seconds
[0m16:09:09.416254 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m16:09:09.417438 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:09.417843 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age"
        from "trips_users__dbt_tmp160907819309"
    )


  
[0m16:09:09.463111 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.096 seconds
[0m16:09:09.464696 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m16:09:09.465089 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:09:09.465415 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m16:09:09.483390 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.065 seconds
[0m16:09:09.484865 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m16:09:09.485233 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:09.485548 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m16:09:09.517886 [debug] [Thread-3 (]: SQL status: COMMIT in 0.052 seconds
[0m16:09:09.522869 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."events_full__dbt_backup"
[0m16:09:09.523895 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:09:09.524439 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_ohwk"."dbt"."events_full__dbt_backup" cascade
[0m16:09:09.591687 [debug] [Thread-4 (]: SQL status: COMMIT in 0.105 seconds
[0m16:09:09.593730 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m16:09:09.595335 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a67b90>]}
[0m16:09:09.596166 [info ] [Thread-4 (]: 12 of 17 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 1.79s]
[0m16:09:09.597025 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m16:09:09.598042 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_daily
[0m16:09:09.598664 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.074 seconds
[0m16:09:09.599223 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m16:09:09.599899 [info ] [Thread-1 (]: 14 of 17 START sql view model dbt.trips_age_daily .............................. [RUN]
[0m16:09:09.602054 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: Close
[0m16:09:09.602603 [info ] [Thread-2 (]: 15 of 17 START sql view model dbt.trips_age_group .............................. [RUN]
[0m16:09:09.603101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.trips_age_daily)
[0m16:09:09.603666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_age_group)
[0m16:09:09.604206 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cab70>]}
[0m16:09:09.604603 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m16:09:09.605060 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m16:09:09.610054 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m16:09:09.605652 [info ] [Thread-3 (]: 13 of 17 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 1.32s]
[0m16:09:09.614071 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m16:09:09.614794 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_full
[0m16:09:09.615520 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m16:09:09.618320 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m16:09:09.618695 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m16:09:09.619039 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m16:09:09.621838 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m16:09:09.622322 [info ] [Thread-4 (]: 16 of 17 START sql view model dbt.events_stat .................................. [RUN]
[0m16:09:09.623051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:09:09.623393 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.events_stat)
[0m16:09:09.623677 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m16:09:09.623986 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m16:09:09.624250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:09.624530 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:09:09.626227 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m16:09:09.626594 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m16:09:09.626897 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:09.627253 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m16:09:09.629517 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m16:09:09.629947 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:09:09.630148 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m16:09:09.630343 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:11.318875 [debug] [Thread-4 (]: SQL status: BEGIN in 1.688 seconds
[0m16:09:11.319661 [debug] [Thread-1 (]: SQL status: BEGIN in 1.695 seconds
[0m16:09:11.320191 [debug] [Thread-2 (]: SQL status: BEGIN in 1.693 seconds
[0m16:09:11.320668 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:09:11.321247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:09:11.321704 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:09:11.322125 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  create view "dev_ohwk"."dbt"."events_stat__dbt_tmp"
    
    
  as (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_ohwk"."dbt"."events_full"
  );
[0m16:09:11.322558 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  create view "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp"
    
    
  as (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users"
group by
    1,
    2
  );
[0m16:09:11.322955 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  create view "dev_ohwk"."dbt"."trips_age_group__dbt_tmp"
    
    
  as (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users" as tu
    cross join "dev_ohwk"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
[0m16:09:11.389258 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.065 seconds
[0m16:09:11.390533 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.067 seconds
[0m16:09:11.391300 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.068 seconds
[0m16:09:11.396278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:09:11.403900 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:09:11.406238 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:09:11.406594 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m16:09:11.406907 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m16:09:11.407205 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_ohwk"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m16:09:11.486507 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.079 seconds
[0m16:09:11.487146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.080 seconds
[0m16:09:11.487612 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.080 seconds
[0m16:09:11.489105 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m16:09:11.492245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:09:11.493707 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m16:09:11.494131 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:09:11.494513 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m16:09:11.494890 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:09:11.495233 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m16:09:11.495643 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m16:09:11.561188 [debug] [Thread-4 (]: SQL status: COMMIT in 0.065 seconds
[0m16:09:11.561696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.066 seconds
[0m16:09:11.562162 [debug] [Thread-2 (]: SQL status: COMMIT in 0.066 seconds
[0m16:09:11.564894 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."events_stat__dbt_backup"
[0m16:09:11.566237 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m16:09:11.568163 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_group__dbt_backup"
[0m16:09:11.568705 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:09:11.569062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:09:11.569564 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:09:11.569936 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop view if exists "dev_ohwk"."dbt"."events_stat__dbt_backup" cascade
[0m16:09:11.570336 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m16:09:11.570739 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_group__dbt_backup" cascade
[0m16:09:11.634946 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.064 seconds
[0m16:09:11.635443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.064 seconds
[0m16:09:11.637022 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m16:09:11.637401 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.066 seconds
[0m16:09:11.639729 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily__dbt_backup"
[0m16:09:11.641136 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m16:09:11.641905 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a64710>]}
[0m16:09:11.642660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:09:11.643955 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily__dbt_backup" cascade
[0m16:09:11.643586 [info ] [Thread-4 (]: 16 of 17 OK created sql view model dbt.events_stat ............................. [[32mCREATE VIEW[0m in 2.02s]
[0m16:09:11.644571 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a64710>]}
[0m16:09:11.645196 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m16:09:11.645730 [info ] [Thread-2 (]: 15 of 17 OK created sql view model dbt.trips_age_group ......................... [[32mCREATE VIEW[0m in 2.04s]
[0m16:09:11.646391 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m16:09:11.704394 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.059 seconds
[0m16:09:11.706088 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: Close
[0m16:09:11.706847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cab70>]}
[0m16:09:11.707493 [info ] [Thread-1 (]: 14 of 17 OK created sql view model dbt.trips_age_daily ......................... [[32mCREATE VIEW[0m in 2.10s]
[0m16:09:11.708095 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m16:09:11.708964 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m16:09:11.709516 [info ] [Thread-3 (]: 17 of 17 START sql view model dbt.trips_age_daily_stat ......................... [RUN]
[0m16:09:11.709930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_age_daily_stat)
[0m16:09:11.710244 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m16:09:11.713351 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:11.714130 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m16:09:11.716677 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:11.717199 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:11.717454 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m16:09:11.717688 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:12.491225 [debug] [Thread-3 (]: SQL status: BEGIN in 0.773 seconds
[0m16:09:12.491559 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:12.491778 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  create view "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp"
    
    
  as (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_ohwk"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
[0m16:09:12.543033 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m16:09:12.549659 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:12.550434 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m16:09:12.610695 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.059 seconds
[0m16:09:12.617887 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:12.618710 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m16:09:12.667282 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m16:09:12.671453 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m16:09:12.672336 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:12.673006 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m16:09:12.724237 [debug] [Thread-3 (]: SQL status: COMMIT in 0.050 seconds
[0m16:09:12.729967 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup"
[0m16:09:12.731207 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:12.731917 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m16:09:12.807217 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.074 seconds
[0m16:09:12.811525 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m16:09:12.813591 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cb890>]}
[0m16:09:12.814846 [info ] [Thread-3 (]: 17 of 17 OK created sql view model dbt.trips_age_daily_stat .................... [[32mCREATE VIEW[0m in 1.10s]
[0m16:09:12.815912 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m16:09:12.818770 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:12.819239 [debug] [MainThread]: On master: BEGIN
[0m16:09:12.819627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:13.528260 [debug] [MainThread]: SQL status: BEGIN in 0.708 seconds
[0m16:09:13.529140 [debug] [MainThread]: On master: COMMIT
[0m16:09:13.529740 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:13.530265 [debug] [MainThread]: On master: COMMIT
[0m16:09:13.578399 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m16:09:13.579366 [debug] [MainThread]: On master: Close
[0m16:09:13.580701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:13.581243 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m16:09:13.581699 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m16:09:13.582111 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m16:09:13.582469 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m16:09:13.583213 [info ] [MainThread]: 
[0m16:09:13.583673 [info ] [MainThread]: Finished running 3 incremental models, 14 view models in 0 hours 0 minutes and 14.96 seconds (14.96s).
[0m16:09:13.587717 [debug] [MainThread]: Command end result
[0m16:09:13.615654 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:09:13.617099 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:09:13.621713 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:09:13.621912 [info ] [MainThread]: 
[0m16:09:13.622137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:13.622308 [info ] [MainThread]: 
[0m16:09:13.622487 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=17
[0m16:09:13.624268 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.26882, "process_in_blocks": "0", "process_kernel_time": 0.204503, "process_mem_max_rss": "140820480", "process_out_blocks": "0", "process_user_time": 1.577208}
[0m16:09:13.624620 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:13.624550 after 15.27 seconds
[0m16:09:13.624861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b9f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b9f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b9fd70>]}
[0m16:09:13.625149 [debug] [MainThread]: Flushing usage events
[0m16:09:14.479508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:08.312405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115027b10>]}


============================== 16:17:08.314703 | 76a6ace6-c55f-47f1-8e2e-d8a2c2e81657 ==============================
[0m16:17:08.314703 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:17:08.314977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:17:08.380155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11372f490>]}
[0m16:17:08.401191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146bebe0>]}
[0m16:17:08.401621 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:17:08.440414 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m16:17:08.478102 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:17:08.478345 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m16:17:08.478497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ce4250>]}
[0m16:17:08.971361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ad2030>]}
[0m16:17:09.002492 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:17:09.003903 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:17:09.010392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11545ea50>]}
[0m16:17:09.010609 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:17:09.010750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a89bf0>]}
[0m16:17:09.011423 [info ] [MainThread]: 
[0m16:17:09.011558 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:17:09.011699 [info ] [MainThread]: 
[0m16:17:09.011972 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:17:09.012388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:17:09.029263 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:17:09.029538 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:17:09.029714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:10.116807 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.087 seconds
[0m16:17:10.118020 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:17:10.122537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:17:10.126483 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:17:10.126760 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:17:10.126942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:10.801313 [debug] [ThreadPool]: SQL status: BEGIN in 0.674 seconds
[0m16:17:10.802254 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:17:10.802656 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:17:10.848597 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.045 seconds
[0m16:17:10.851453 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:17:10.897395 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:17:10.910542 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:10.911194 [debug] [MainThread]: On master: BEGIN
[0m16:17:10.911466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:17:11.608817 [debug] [MainThread]: SQL status: BEGIN in 0.697 seconds
[0m16:17:11.609289 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:11.609680 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:17:11.663695 [debug] [MainThread]: SQL status: SELECT 18 in 0.054 seconds
[0m16:17:11.667963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a23c50>]}
[0m16:17:11.668493 [debug] [MainThread]: On master: ROLLBACK
[0m16:17:11.709882 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:11.710471 [debug] [MainThread]: On master: BEGIN
[0m16:17:11.795108 [debug] [MainThread]: SQL status: BEGIN in 0.084 seconds
[0m16:17:11.796936 [debug] [MainThread]: On master: COMMIT
[0m16:17:11.797620 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:11.797985 [debug] [MainThread]: On master: COMMIT
[0m16:17:11.842194 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m16:17:11.842696 [debug] [MainThread]: On master: Close
[0m16:17:11.849564 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:17:11.850271 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:17:11.850966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:17:11.851330 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:17:11.860941 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:17:11.862019 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:17:11.901056 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:17:11.901620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:17:11.901791 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:17:11.901939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:13.489540 [debug] [Thread-1 (]: SQL status: BEGIN in 1.587 seconds
[0m16:17:13.490226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:17:13.490631 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_ohwk"."dbt"."revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

group by
    2
order by
    2
  );
  
  
[0m16:17:15.161056 [debug] [Thread-1 (]: SQL status: SELECT 91 in 1.670 seconds
[0m16:17:15.170291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:17:15.170639 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
alter table "dev_ohwk"."dbt"."revenue_daily" rename to "revenue_daily__dbt_backup"
[0m16:17:15.214401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m16:17:15.216545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:17:15.216801 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
alter table "dev_ohwk"."dbt"."revenue_daily__dbt_tmp" rename to "revenue_daily"
[0m16:17:15.261038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m16:17:15.275151 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:17:15.275477 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:17:15.275701 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:17:15.317888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m16:17:15.323054 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."revenue_daily__dbt_backup"
[0m16:17:15.326166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:17:15.326447 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
drop view if exists "dev_ohwk"."dbt"."revenue_daily__dbt_backup" cascade
[0m16:17:15.371273 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.045 seconds
[0m16:17:15.373561 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:17:15.376050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116192e60>]}
[0m16:17:15.376580 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mSELECT 91[0m in 3.52s]
[0m16:17:15.377026 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:17:15.378081 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:15.378361 [debug] [MainThread]: On master: BEGIN
[0m16:17:15.378569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:17:16.016266 [debug] [MainThread]: SQL status: BEGIN in 0.638 seconds
[0m16:17:16.017179 [debug] [MainThread]: On master: COMMIT
[0m16:17:16.017743 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:16.018279 [debug] [MainThread]: On master: COMMIT
[0m16:17:16.058964 [debug] [MainThread]: SQL status: COMMIT in 0.040 seconds
[0m16:17:16.059401 [debug] [MainThread]: On master: Close
[0m16:17:16.059882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:16.060066 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:17:16.060261 [info ] [MainThread]: 
[0m16:17:16.060467 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.05 seconds (7.05s).
[0m16:17:16.060932 [debug] [MainThread]: Command end result
[0m16:17:16.080590 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:17:16.082197 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:17:16.085243 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:17:16.085406 [info ] [MainThread]: 
[0m16:17:16.085683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:16.085883 [info ] [MainThread]: 
[0m16:17:16.086154 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:17:16.088063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.803939, "process_in_blocks": "0", "process_kernel_time": 0.128026, "process_mem_max_rss": "145670144", "process_out_blocks": "0", "process_user_time": 1.375166}
[0m16:17:16.088296 [debug] [MainThread]: Command `cli run` succeeded at 16:17:16.088251 after 7.80 seconds
[0m16:17:16.088472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115de51d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fb3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a13cd0>]}
[0m16:17:16.088651 [debug] [MainThread]: Flushing usage events
[0m16:17:16.791058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:46.209441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108227b10>]}


============================== 16:20:46.211879 | 054a913c-a53e-4191-9ded-e14a426d1ae9 ==============================
[0m16:20:46.211879 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:20:46.212152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models revenue_daily', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:20:46.212363 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m16:20:46.212509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10810ed70>]}
[0m16:20:46.278053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbe030>]}
[0m16:20:46.298820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa3b50>]}
[0m16:20:46.299572 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:20:46.337245 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:20:46.374351 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:20:46.374578 [debug] [MainThread]: previous checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, current checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7
[0m16:20:46.374725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db9310>]}
[0m16:20:46.869988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820a7b0>]}
[0m16:20:46.902223 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:20:46.903388 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:20:46.913303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a59d090>]}
[0m16:20:46.913514 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:20:46.913663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d90f50>]}
[0m16:20:46.914347 [info ] [MainThread]: 
[0m16:20:46.914479 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:20:46.914587 [info ] [MainThread]: 
[0m16:20:46.914779 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:46.915129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:20:46.936161 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:20:46.936371 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:20:46.936480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:48.711978 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.775 seconds
[0m16:20:48.716150 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:20:48.725694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:20:48.733814 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:20:48.734357 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:20:48.734620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:49.528082 [debug] [ThreadPool]: SQL status: BEGIN in 0.793 seconds
[0m16:20:49.529051 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:20:49.529613 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:20:49.680114 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.150 seconds
[0m16:20:49.684769 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:20:49.733726 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:20:49.747488 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:49.747939 [debug] [MainThread]: On master: BEGIN
[0m16:20:49.748214 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:50.444759 [debug] [MainThread]: SQL status: BEGIN in 0.696 seconds
[0m16:20:50.445715 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:50.446320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:50.507205 [debug] [MainThread]: SQL status: SELECT 17 in 0.060 seconds
[0m16:20:50.516759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a78eaf0>]}
[0m16:20:50.517745 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:50.571459 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:50.572904 [debug] [MainThread]: On master: BEGIN
[0m16:20:50.673716 [debug] [MainThread]: SQL status: BEGIN in 0.100 seconds
[0m16:20:50.675158 [debug] [MainThread]: On master: COMMIT
[0m16:20:50.676241 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:50.677182 [debug] [MainThread]: On master: COMMIT
[0m16:20:50.731126 [debug] [MainThread]: SQL status: COMMIT in 0.053 seconds
[0m16:20:50.732024 [debug] [MainThread]: On master: Close
[0m16:20:50.739580 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:20:50.740532 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:20:50.741589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:20:50.742147 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:20:50.753977 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:20:50.755151 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:20:50.790126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:50.790436 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp162050777453"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:20:50.790613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:52.479788 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.689 seconds
[0m16:20:52.499116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:52.499657 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:20:52.551789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m16:20:52.552817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:52.553348 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp162050777453'
        
      order by ordinal_position

  
[0m16:20:52.611550 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.057 seconds
[0m16:20:52.622307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:52.622926 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:20:52.678346 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.055 seconds
[0m16:20:52.691438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:52.692137 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:20:52.748075 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.055 seconds
[0m16:20:52.768516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:20:52.769696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:52.770148 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp162050777453"
    )


  
[0m16:20:52.821589 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.051 seconds
[0m16:20:52.842881 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:20:52.843318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:52.843612 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:20:52.917311 [debug] [Thread-1 (]: SQL status: COMMIT in 0.073 seconds
[0m16:20:52.922042 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:20:52.927148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffc910>]}
[0m16:20:52.928226 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 2.18s]
[0m16:20:52.929033 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:20:52.931417 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:52.931815 [debug] [MainThread]: On master: BEGIN
[0m16:20:52.932139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:54.018407 [debug] [MainThread]: SQL status: BEGIN in 1.086 seconds
[0m16:20:54.019463 [debug] [MainThread]: On master: COMMIT
[0m16:20:54.019946 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:54.020337 [debug] [MainThread]: On master: COMMIT
[0m16:20:54.093275 [debug] [MainThread]: SQL status: COMMIT in 0.072 seconds
[0m16:20:54.094464 [debug] [MainThread]: On master: Close
[0m16:20:54.096459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:54.097032 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:20:54.097604 [info ] [MainThread]: 
[0m16:20:54.098161 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.18 seconds (7.18s).
[0m16:20:54.099129 [debug] [MainThread]: Command end result
[0m16:20:54.132083 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:20:54.133454 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:20:54.137137 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:20:54.137339 [info ] [MainThread]: 
[0m16:20:54.137575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:54.137750 [info ] [MainThread]: 
[0m16:20:54.137927 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:20:54.138240 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:20:54.139963 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9579806, "process_in_blocks": "0", "process_kernel_time": 0.160621, "process_mem_max_rss": "147292160", "process_out_blocks": "0", "process_user_time": 1.458232}
[0m16:20:54.140280 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:54.140217 after 7.96 seconds
[0m16:20:54.140508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6ea4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108247230>]}
[0m16:20:54.140728 [debug] [MainThread]: Flushing usage events
[0m16:20:54.793833 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:29.361250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c134d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910bb10>]}


============================== 16:24:29.363279 | 7afc0209-06f2-40a5-89d4-e232bd76bbf0 ==============================
[0m16:24:29.363279 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:24:29.363556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:24:29.425892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840f490>]}
[0m16:24:29.446715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa2030>]}
[0m16:24:29.447087 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:24:29.482636 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:24:29.526678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:29.526852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:29.543687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8b450>]}
[0m16:24:29.577187 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:24:29.578347 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:24:29.584565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091899a0>]}
[0m16:24:29.584751 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:24:29.584890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10963b3f0>]}
[0m16:24:29.585934 [info ] [MainThread]: 
[0m16:24:29.586074 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:24:29.586179 [info ] [MainThread]: 
[0m16:24:29.586368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:24:29.588149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:24:29.607641 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:24:29.607856 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:24:29.607977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:31.145243 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.537 seconds
[0m16:24:31.149509 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:24:31.154732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:24:31.162756 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:24:31.163206 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:24:31.163448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:32.947830 [debug] [ThreadPool]: SQL status: BEGIN in 1.784 seconds
[0m16:24:32.949165 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:24:32.950257 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:24:33.010935 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.060 seconds
[0m16:24:33.014089 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:24:33.055947 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:24:33.070160 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:33.070612 [debug] [MainThread]: On master: BEGIN
[0m16:24:33.070938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:33.772126 [debug] [MainThread]: SQL status: BEGIN in 0.701 seconds
[0m16:24:33.773134 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:33.774010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:24:33.832230 [debug] [MainThread]: SQL status: SELECT 17 in 0.057 seconds
[0m16:24:33.838194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1e1bf0>]}
[0m16:24:33.839050 [debug] [MainThread]: On master: ROLLBACK
[0m16:24:33.888821 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:33.889478 [debug] [MainThread]: On master: BEGIN
[0m16:24:33.984160 [debug] [MainThread]: SQL status: BEGIN in 0.094 seconds
[0m16:24:33.985189 [debug] [MainThread]: On master: COMMIT
[0m16:24:33.986226 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:33.987134 [debug] [MainThread]: On master: COMMIT
[0m16:24:34.046906 [debug] [MainThread]: SQL status: COMMIT in 0.059 seconds
[0m16:24:34.047889 [debug] [MainThread]: On master: Close
[0m16:24:34.056237 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m16:24:34.056965 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m16:24:34.057505 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m16:24:34.058002 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_clean
[0m16:24:34.058743 [info ] [Thread-1 (]: 1 of 17 START sql view model dbt.companies ..................................... [RUN]
[0m16:24:34.059459 [info ] [Thread-3 (]: 3 of 17 START sql incremental model dbt.trips_concurrency ...................... [RUN]
[0m16:24:34.060103 [info ] [Thread-4 (]: 4 of 17 START sql view model dbt.trips_geom .................................... [RUN]
[0m16:24:34.060566 [info ] [Thread-2 (]: 2 of 17 START sql incremental model dbt.events_clean ........................... [RUN]
[0m16:24:34.061115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.companies)
[0m16:24:34.061664 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m16:24:34.062152 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m16:24:34.062584 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean'
[0m16:24:34.062934 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m16:24:34.063264 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m16:24:34.063581 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m16:24:34.064053 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_clean
[0m16:24:34.072495 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m16:24:34.080716 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m16:24:34.082347 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m16:24:34.084271 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m16:24:34.084937 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m16:24:34.085234 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m16:24:34.098024 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m16:24:34.110771 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_clean
[0m16:24:34.120153 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m16:24:34.121408 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m16:24:34.125146 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:34.126678 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:34.126948 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp162434109283"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency
from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m16:24:34.127132 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp162434126108"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id
from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m16:24:34.127295 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:24:34.127486 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:24:34.127703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:24:34.127871 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:24:34.128080 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m16:24:34.128239 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m16:24:34.128381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:34.128515 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:24:35.272853 [debug] [Thread-1 (]: SQL status: BEGIN in 1.144 seconds
[0m16:24:35.274341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:24:35.275017 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  create view "dev_ohwk"."dbt"."companies__dbt_tmp"
    
    
  as (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_ohwk"."dbt"."scooters"
group by
    1
  );
[0m16:24:35.481034 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.205 seconds
[0m16:24:35.495026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:24:35.496024 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies" rename to "companies__dbt_backup"
[0m16:24:35.571580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.075 seconds
[0m16:24:35.583695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:24:35.584240 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies__dbt_tmp" rename to "companies"
[0m16:24:35.671703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.087 seconds
[0m16:24:35.692359 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m16:24:35.692878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:24:35.693161 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m16:24:35.776582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.083 seconds
[0m16:24:35.780774 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."companies__dbt_backup"
[0m16:24:35.783561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:24:35.783801 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop view if exists "dev_ohwk"."dbt"."companies__dbt_backup" cascade
[0m16:24:35.975353 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.191 seconds
[0m16:24:35.981122 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m16:24:35.986152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41c290>]}
[0m16:24:35.987197 [info ] [Thread-1 (]: 1 of 17 OK created sql view model dbt.companies ................................ [[32mCREATE VIEW[0m in 1.92s]
[0m16:24:35.988060 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m16:24:35.988624 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m16:24:35.989291 [info ] [Thread-1 (]: 5 of 17 START sql view model dbt.trips_prep .................................... [RUN]
[0m16:24:35.989946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.trips_prep)
[0m16:24:35.990384 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m16:24:36.039685 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m16:24:36.040243 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m16:24:36.041696 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m16:24:36.042051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:24:36.042210 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m16:24:36.042354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:36.373895 [debug] [Thread-4 (]: SQL status: BEGIN in 2.245 seconds
[0m16:24:36.375103 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:24:36.375910 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_ohwk"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_ohwk"."scooters_raw"."trips"
  );
[0m16:24:36.475287 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.098 seconds
[0m16:24:36.476542 [debug] [Thread-2 (]: SQL status: SELECT 0 in 2.349 seconds
[0m16:24:36.482872 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:24:36.499545 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:36.500118 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m16:24:36.500537 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: BEGIN
[0m16:24:36.574939 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.074 seconds
[0m16:24:36.575586 [debug] [Thread-2 (]: SQL status: BEGIN in 0.075 seconds
[0m16:24:36.581170 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:24:36.581848 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:36.582443 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m16:24:36.583079 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp162434126108'
        
      order by ordinal_position

  
[0m16:24:36.672107 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m16:24:36.675853 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m16:24:36.676560 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:24:36.677083 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m16:24:36.793746 [debug] [Thread-4 (]: SQL status: COMMIT in 0.116 seconds
[0m16:24:36.797858 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_geom__dbt_backup"
[0m16:24:36.798819 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:24:36.799351 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_ohwk"."dbt"."trips_geom__dbt_backup" cascade
[0m16:24:36.876180 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.076 seconds
[0m16:24:36.877005 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.293 seconds
[0m16:24:36.880401 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: Close
[0m16:24:36.889445 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:36.890081 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:36.890976 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c2ba0>]}
[0m16:24:36.891970 [info ] [Thread-4 (]: 4 of 17 OK created sql view model dbt.trips_geom ............................... [[32mCREATE VIEW[0m in 2.83s]
[0m16:24:36.892682 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m16:24:36.893163 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m16:24:36.893739 [info ] [Thread-4 (]: 6 of 17 START sql view model dbt.trips_stat_daily .............................. [RUN]
[0m16:24:36.894403 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.trips_stat_daily)
[0m16:24:36.894922 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m16:24:36.897724 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m16:24:36.898673 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m16:24:36.901501 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m16:24:36.902236 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:24:36.902554 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m16:24:36.902837 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:24:36.978370 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.087 seconds
[0m16:24:36.989967 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:36.990444 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:37.021953 [debug] [Thread-1 (]: SQL status: BEGIN in 0.979 seconds
[0m16:24:37.022886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:24:37.023508 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_ohwk"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  );
[0m16:24:37.072682 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m16:24:37.080081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:24:37.080846 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.090 seconds
[0m16:24:37.081487 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m16:24:37.096355 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m16:24:37.097275 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:37.097615 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id")
    (
        select "user_id", "timestamp", "type_id"
        from "events_clean__dbt_tmp162434126108"
    )


  
[0m16:24:37.418900 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.321 seconds
[0m16:24:37.422959 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m16:24:37.423609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.329 seconds
[0m16:24:37.424111 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:37.429505 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:24:37.430235 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m16:24:37.430826 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m16:24:37.575597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.144 seconds
[0m16:24:37.576688 [debug] [Thread-2 (]: SQL status: COMMIT in 0.145 seconds
[0m16:24:37.579922 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m16:24:37.581354 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: Close
[0m16:24:37.581925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:24:37.582596 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m16:24:37.583630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a468e10>]}
[0m16:24:37.584823 [info ] [Thread-2 (]: 2 of 17 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 3.52s]
[0m16:24:37.585628 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_clean
[0m16:24:37.586171 [debug] [Thread-2 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m16:24:37.586863 [info ] [Thread-2 (]: 7 of 17 START sql view model dbt.parking_finish_stat ........................... [RUN]
[0m16:24:37.587626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.parking_finish_stat)
[0m16:24:37.588100 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m16:24:37.592010 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m16:24:37.592846 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m16:24:37.596791 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m16:24:37.597785 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:24:37.598381 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m16:24:37.598735 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:24:37.782337 [debug] [Thread-1 (]: SQL status: COMMIT in 0.198 seconds
[0m16:24:37.787529 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_prep__dbt_backup"
[0m16:24:37.788621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:24:37.789113 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_ohwk"."dbt"."trips_prep__dbt_backup" cascade
[0m16:24:38.170536 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.380 seconds
[0m16:24:38.175130 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m16:24:38.176650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a245850>]}
[0m16:24:38.177719 [info ] [Thread-1 (]: 5 of 17 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 2.19s]
[0m16:24:38.178713 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m16:24:38.179393 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m16:24:38.180319 [info ] [Thread-1 (]: 8 of 17 START sql view model dbt.parking_start_stat ............................ [RUN]
[0m16:24:38.181172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_start_stat)
[0m16:24:38.181659 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m16:24:38.185765 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m16:24:38.187033 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m16:24:38.191187 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m16:24:38.192021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:24:38.192386 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m16:24:38.192698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:39.637873 [debug] [Thread-3 (]: SQL status: SELECT 0 in 5.510 seconds
[0m16:24:39.643624 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:39.644194 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m16:24:39.971304 [debug] [Thread-3 (]: SQL status: BEGIN in 0.326 seconds
[0m16:24:39.972478 [debug] [Thread-4 (]: SQL status: BEGIN in 3.070 seconds
[0m16:24:39.973234 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:39.974030 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:24:39.974911 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp162434109283'
        
      order by ordinal_position

  
[0m16:24:39.975639 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  create view "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp"
    
    
  as (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
[0m16:24:40.042001 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.065 seconds
[0m16:24:40.043400 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.067 seconds
[0m16:24:40.049658 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:24:40.053977 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:40.054500 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m16:24:40.055150 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:40.109793 [debug] [Thread-2 (]: SQL status: BEGIN in 2.511 seconds
[0m16:24:40.110766 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.055 seconds
[0m16:24:40.111830 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.056 seconds
[0m16:24:40.112712 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:24:40.118455 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:40.122915 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:24:40.123550 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  create view "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp"
    
    
  as (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
where
    st_intersects(st_transform(t.finish_point, 3857), hex.geom)
group by
    1
  );
[0m16:24:40.124172 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:40.124682 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m16:24:40.195923 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.070 seconds
[0m16:24:40.198669 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m16:24:40.199342 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:24:40.199899 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.075 seconds
[0m16:24:40.200362 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m16:24:40.200859 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.076 seconds
[0m16:24:40.203504 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m16:24:40.207997 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:24:40.208683 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m16:24:40.209721 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:40.210128 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency")
    (
        select "timestamp", "concurrency"
        from "trips_concurrency__dbt_tmp162434109283"
    )


  
[0m16:24:40.268087 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.059 seconds
[0m16:24:40.269208 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.058 seconds
[0m16:24:40.270151 [debug] [Thread-4 (]: SQL status: COMMIT in 0.066 seconds
[0m16:24:40.272592 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m16:24:40.274756 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m16:24:40.278493 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup"
[0m16:24:40.279079 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:24:40.280449 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:40.281143 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:24:40.281579 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m16:24:40.281957 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m16:24:40.282301 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop view if exists "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m16:24:40.346213 [debug] [Thread-2 (]: SQL status: COMMIT in 0.063 seconds
[0m16:24:40.347407 [debug] [Thread-3 (]: SQL status: COMMIT in 0.065 seconds
[0m16:24:40.348031 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.065 seconds
[0m16:24:40.352056 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup"
[0m16:24:40.353505 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m16:24:40.355515 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m16:24:40.356351 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:24:40.357087 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop view if exists "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m16:24:40.357844 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4609f0>]}
[0m16:24:40.358363 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a460a60>]}
[0m16:24:40.359304 [info ] [Thread-3 (]: 3 of 17 OK created sql incremental model dbt.trips_concurrency ................. [[32mINSERT 0 0[0m in 6.30s]
[0m16:24:40.360672 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m16:24:40.359992 [info ] [Thread-4 (]: 6 of 17 OK created sql view model dbt.trips_stat_daily ......................... [[32mCREATE VIEW[0m in 3.46s]
[0m16:24:40.361262 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_full
[0m16:24:40.361923 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m16:24:40.362464 [info ] [Thread-3 (]: 9 of 17 START sql view model dbt.events_full ................................... [RUN]
[0m16:24:40.362991 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies_trips
[0m16:24:40.363508 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.events_full)
[0m16:24:40.364005 [info ] [Thread-4 (]: 10 of 17 START sql view model dbt.companies_trips .............................. [RUN]
[0m16:24:40.364419 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_full
[0m16:24:40.364808 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.companies_trips)
[0m16:24:40.367872 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m16:24:40.368304 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies_trips
[0m16:24:40.371690 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m16:24:40.372313 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_full
[0m16:24:40.372688 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies_trips
[0m16:24:40.375311 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m16:24:40.380546 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m16:24:40.381117 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:24:40.381375 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:24:40.381593 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: BEGIN
[0m16:24:40.381826 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m16:24:40.382057 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:24:40.382268 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:24:40.420224 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.061 seconds
[0m16:24:40.421454 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m16:24:40.422025 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f97bf0>]}
[0m16:24:40.422574 [info ] [Thread-2 (]: 7 of 17 OK created sql view model dbt.parking_finish_stat ...................... [[32mCREATE VIEW[0m in 2.83s]
[0m16:24:40.423036 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m16:24:40.423331 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:24:40.423681 [info ] [Thread-2 (]: 11 of 17 START sql incremental model dbt.revenue_daily ......................... [RUN]
[0m16:24:40.424000 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.revenue_daily)
[0m16:24:40.424258 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:24:40.426562 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:24:40.427028 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:24:40.429435 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:40.429733 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp162440428318"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:24:40.429987 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:24:41.132066 [debug] [Thread-3 (]: SQL status: BEGIN in 0.750 seconds
[0m16:24:41.133178 [debug] [Thread-4 (]: SQL status: BEGIN in 0.751 seconds
[0m16:24:41.134129 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:24:41.134918 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:24:41.135637 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_ohwk"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_ohwk"."dbt"."events_clean"
    left join "dev_ohwk"."dbt"."event_types"
        using (type_id)
  );
[0m16:24:41.136340 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  create view "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
    
    
  as (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
[0m16:24:41.280019 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.143 seconds
[0m16:24:41.287539 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.150 seconds
[0m16:24:41.287898 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:24:41.291053 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:24:41.291587 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m16:24:41.291978 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m16:24:41.344188 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.052 seconds
[0m16:24:41.349938 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:24:41.350676 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m16:24:41.362618 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.070 seconds
[0m16:24:41.366092 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m16:24:41.366817 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:24:41.367432 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m16:24:41.416967 [debug] [Thread-1 (]: SQL status: BEGIN in 3.224 seconds
[0m16:24:41.417967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:24:41.418493 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.067 seconds
[0m16:24:41.419067 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  create view "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp"
    
    
  as (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
where
    st_intersects(st_transform(t.start_point, 3857), hex.geom)
group by
    1
  );
[0m16:24:41.421830 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m16:24:41.422341 [debug] [Thread-4 (]: SQL status: COMMIT in 0.054 seconds
[0m16:24:41.423059 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:24:41.426501 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m16:24:41.427086 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m16:24:41.427941 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:24:41.428503 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop view if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m16:24:41.592601 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.163 seconds
[0m16:24:41.593927 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.171 seconds
[0m16:24:41.594533 [debug] [Thread-3 (]: SQL status: COMMIT in 0.166 seconds
[0m16:24:41.597093 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: Close
[0m16:24:41.601940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:24:41.605612 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."events_full__dbt_backup"
[0m16:24:41.606232 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m16:24:41.606988 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25b470>]}
[0m16:24:41.607623 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:24:41.608670 [info ] [Thread-4 (]: 10 of 17 OK created sql view model dbt.companies_trips ......................... [[32mCREATE VIEW[0m in 1.24s]
[0m16:24:41.609137 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_ohwk"."dbt"."events_full__dbt_backup" cascade
[0m16:24:41.609789 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies_trips
[0m16:24:41.610552 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat
[0m16:24:41.611237 [info ] [Thread-4 (]: 12 of 17 START sql view model dbt.trips_stat ................................... [RUN]
[0m16:24:41.611756 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_stat)
[0m16:24:41.612120 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat
[0m16:24:41.614938 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m16:24:41.615733 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat
[0m16:24:41.618492 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m16:24:41.619136 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:24:41.619435 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m16:24:41.619780 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:24:41.715330 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.107 seconds
[0m16:24:41.719690 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m16:24:41.720430 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.110 seconds
[0m16:24:41.721103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:24:41.723209 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: Close
[0m16:24:41.723706 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m16:24:41.724953 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3641d0>]}
[0m16:24:41.725874 [info ] [Thread-3 (]: 9 of 17 OK created sql view model dbt.events_full .............................. [[32mCREATE VIEW[0m in 1.36s]
[0m16:24:41.726587 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_full
[0m16:24:41.727074 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_users
[0m16:24:41.727676 [info ] [Thread-3 (]: 13 of 17 START sql incremental model dbt.trips_users ........................... [RUN]
[0m16:24:41.728370 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_users)
[0m16:24:41.728768 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_users
[0m16:24:41.733167 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m16:24:41.734051 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_users
[0m16:24:41.737411 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:41.737799 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp162441736046"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age
from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m16:24:41.738144 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:24:41.798606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.074 seconds
[0m16:24:41.803811 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_start_stat__dbt_backup"
[0m16:24:41.804673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:24:41.805214 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop view if exists "dev_ohwk"."dbt"."parking_start_stat__dbt_backup" cascade
[0m16:24:41.865007 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.059 seconds
[0m16:24:41.868956 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m16:24:41.870854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3652b0>]}
[0m16:24:41.872185 [info ] [Thread-1 (]: 8 of 17 OK created sql view model dbt.parking_start_stat ....................... [[32mCREATE VIEW[0m in 3.69s]
[0m16:24:41.873144 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m16:24:41.873876 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_stat
[0m16:24:41.874754 [info ] [Thread-1 (]: 14 of 17 START sql view model dbt.events_stat .................................. [RUN]
[0m16:24:41.875461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.events_stat)
[0m16:24:41.875980 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_stat
[0m16:24:41.880509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m16:24:41.881901 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_stat
[0m16:24:41.886486 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m16:24:41.887487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:24:41.887856 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: BEGIN
[0m16:24:41.888151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:42.590961 [debug] [Thread-2 (]: SQL status: SELECT 3 in 2.160 seconds
[0m16:24:42.597310 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:42.598439 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:24:42.657093 [debug] [Thread-2 (]: SQL status: BEGIN in 0.057 seconds
[0m16:24:42.657837 [debug] [Thread-4 (]: SQL status: BEGIN in 1.038 seconds
[0m16:24:42.658329 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:42.659069 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:24:42.659699 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp162440428318'
        
      order by ordinal_position

  
[0m16:24:42.660214 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  create view "dev_ohwk"."dbt"."trips_stat__dbt_tmp"
    
    
  as (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_ohwk"."dbt"."trips_prep"
  );
[0m16:24:42.745229 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.084 seconds
[0m16:24:42.746647 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.086 seconds
[0m16:24:42.752255 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:42.757475 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:24:42.758055 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:42.758546 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m16:24:42.824668 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m16:24:42.825814 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.067 seconds
[0m16:24:42.828230 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m16:24:42.833171 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:42.833896 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:24:42.834428 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:42.834876 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m16:24:42.992545 [debug] [Thread-4 (]: SQL status: COMMIT in 0.157 seconds
[0m16:24:42.993666 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.158 seconds
[0m16:24:42.996933 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat__dbt_backup"
[0m16:24:42.999728 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:24:43.000814 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:24:43.001571 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop view if exists "dev_ohwk"."dbt"."trips_stat__dbt_backup" cascade
[0m16:24:43.002768 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:43.003238 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp162440428318"
    )


  
[0m16:24:43.092188 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.088 seconds
[0m16:24:43.093447 [debug] [Thread-3 (]: SQL status: SELECT 0 in 1.355 seconds
[0m16:24:43.096735 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.095 seconds
[0m16:24:43.100066 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:24:43.104187 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:43.105809 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: Close
[0m16:24:43.106314 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:43.106796 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: BEGIN
[0m16:24:43.107321 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:24:43.108148 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a2330>]}
[0m16:24:43.109109 [info ] [Thread-4 (]: 12 of 17 OK created sql view model dbt.trips_stat .............................. [[32mCREATE VIEW[0m in 1.50s]
[0m16:24:43.109802 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat
[0m16:24:43.170285 [debug] [Thread-2 (]: SQL status: COMMIT in 0.061 seconds
[0m16:24:43.171151 [debug] [Thread-3 (]: SQL status: BEGIN in 0.063 seconds
[0m16:24:43.172562 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:24:43.173033 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:43.173520 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp162441736046'
        
      order by ordinal_position

  
[0m16:24:43.174173 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ab230>]}
[0m16:24:43.174989 [info ] [Thread-2 (]: 11 of 17 OK created sql incremental model dbt.revenue_daily .................... [[32mINSERT 0 3[0m in 2.75s]
[0m16:24:43.175648 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:24:43.389021 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.214 seconds
[0m16:24:43.395940 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:43.396713 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:43.462334 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.064 seconds
[0m16:24:43.470039 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:43.470868 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:43.534216 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.062 seconds
[0m16:24:43.538337 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m16:24:43.540250 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:43.541012 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age"
        from "trips_users__dbt_tmp162441736046"
    )


  
[0m16:24:43.601739 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.060 seconds
[0m16:24:43.605369 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m16:24:43.605946 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:43.606441 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m16:24:43.670134 [debug] [Thread-3 (]: SQL status: COMMIT in 0.063 seconds
[0m16:24:43.672494 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: Close
[0m16:24:43.674141 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a31d0>]}
[0m16:24:43.675430 [info ] [Thread-3 (]: 13 of 17 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 1.95s]
[0m16:24:43.676335 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_users
[0m16:24:43.677231 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m16:24:43.677867 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_daily
[0m16:24:43.678619 [info ] [Thread-2 (]: 16 of 17 START sql view model dbt.trips_age_group .............................. [RUN]
[0m16:24:43.679523 [info ] [Thread-4 (]: 15 of 17 START sql view model dbt.trips_age_daily .............................. [RUN]
[0m16:24:43.680367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_age_group)
[0m16:24:43.680969 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_age_daily)
[0m16:24:43.681503 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m16:24:43.682005 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m16:24:43.686609 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m16:24:43.689919 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m16:24:43.691498 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m16:24:43.691999 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m16:24:43.695707 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m16:24:43.698084 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m16:24:43.698702 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:24:43.699024 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:24:43.699292 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m16:24:43.699546 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m16:24:43.699796 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:24:43.700052 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:24:43.820847 [debug] [Thread-1 (]: SQL status: BEGIN in 1.932 seconds
[0m16:24:43.822255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:24:43.822896 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  create view "dev_ohwk"."dbt"."events_stat__dbt_tmp"
    
    
  as (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_ohwk"."dbt"."events_full"
  );
[0m16:24:43.895342 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.071 seconds
[0m16:24:43.902915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:24:43.903467 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_ohwk"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m16:24:43.966816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.062 seconds
[0m16:24:43.970655 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: COMMIT
[0m16:24:43.971441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:24:43.971999 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: COMMIT
[0m16:24:44.033820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.061 seconds
[0m16:24:44.039211 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."events_stat__dbt_backup"
[0m16:24:44.040251 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:24:44.040810 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop view if exists "dev_ohwk"."dbt"."events_stat__dbt_backup" cascade
[0m16:24:44.101923 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.060 seconds
[0m16:24:44.105180 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: Close
[0m16:24:44.106695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a0950>]}
[0m16:24:44.108196 [info ] [Thread-1 (]: 14 of 17 OK created sql view model dbt.events_stat ............................. [[32mCREATE VIEW[0m in 2.23s]
[0m16:24:44.109219 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_stat
[0m16:24:44.406667 [debug] [Thread-4 (]: SQL status: BEGIN in 0.706 seconds
[0m16:24:44.407926 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:24:44.409182 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  create view "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp"
    
    
  as (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users"
group by
    1,
    2
  );
[0m16:24:44.414743 [debug] [Thread-2 (]: SQL status: BEGIN in 0.715 seconds
[0m16:24:44.415342 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:24:44.415948 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  create view "dev_ohwk"."dbt"."trips_age_group__dbt_tmp"
    
    
  as (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users" as tu
    cross join "dev_ohwk"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
[0m16:24:44.467559 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.057 seconds
[0m16:24:44.472905 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:24:44.473429 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.057 seconds
[0m16:24:44.473925 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m16:24:44.485072 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:24:44.485667 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m16:24:44.530479 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m16:24:44.535327 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:24:44.535845 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.050 seconds
[0m16:24:44.536265 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m16:24:44.539336 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:24:44.539864 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m16:24:44.583647 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m16:24:44.587569 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m16:24:44.588228 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m16:24:44.588882 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:24:44.591064 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m16:24:44.591768 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m16:24:44.592347 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:24:44.592883 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m16:24:44.637955 [debug] [Thread-4 (]: SQL status: COMMIT in 0.045 seconds
[0m16:24:44.643022 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily__dbt_backup"
[0m16:24:44.643420 [debug] [Thread-2 (]: SQL status: COMMIT in 0.050 seconds
[0m16:24:44.644342 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:24:44.647444 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_group__dbt_backup"
[0m16:24:44.647932 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_daily__dbt_backup" cascade
[0m16:24:44.648757 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:24:44.649263 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_group__dbt_backup" cascade
[0m16:24:44.696682 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.047 seconds
[0m16:24:44.700397 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: Close
[0m16:24:44.701046 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.051 seconds
[0m16:24:44.703229 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m16:24:44.704178 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ffd7f0>]}
[0m16:24:44.705880 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25b950>]}
[0m16:24:44.705176 [info ] [Thread-4 (]: 15 of 17 OK created sql view model dbt.trips_age_daily ......................... [[32mCREATE VIEW[0m in 1.02s]
[0m16:24:44.706841 [info ] [Thread-2 (]: 16 of 17 OK created sql view model dbt.trips_age_group ......................... [[32mCREATE VIEW[0m in 1.03s]
[0m16:24:44.707607 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m16:24:44.708227 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m16:24:44.708946 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m16:24:44.709489 [info ] [Thread-3 (]: 17 of 17 START sql view model dbt.trips_age_daily_stat ......................... [RUN]
[0m16:24:44.709951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily_stat)
[0m16:24:44.710304 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m16:24:44.714693 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:44.715625 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m16:24:44.718945 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:44.719591 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:44.719897 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m16:24:44.720170 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:24:45.859959 [debug] [Thread-3 (]: SQL status: BEGIN in 1.140 seconds
[0m16:24:45.860267 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:45.860486 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  create view "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp"
    
    
  as (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_ohwk"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
[0m16:24:45.984277 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.123 seconds
[0m16:24:45.988405 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:45.988897 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m16:24:46.212208 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.223 seconds
[0m16:24:46.213511 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m16:24:46.213803 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:46.214024 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m16:24:46.411146 [debug] [Thread-3 (]: SQL status: COMMIT in 0.196 seconds
[0m16:24:46.417316 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup"
[0m16:24:46.418424 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:46.419103 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m16:24:46.524605 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.104 seconds
[0m16:24:46.527019 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m16:24:46.528243 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc8650>]}
[0m16:24:46.529099 [info ] [Thread-3 (]: 17 of 17 OK created sql view model dbt.trips_age_daily_stat .................... [[32mCREATE VIEW[0m in 1.82s]
[0m16:24:46.529970 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m16:24:46.532582 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:46.533210 [debug] [MainThread]: On master: BEGIN
[0m16:24:46.533641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:48.251377 [debug] [MainThread]: SQL status: BEGIN in 1.718 seconds
[0m16:24:48.252405 [debug] [MainThread]: On master: COMMIT
[0m16:24:48.253085 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:48.253635 [debug] [MainThread]: On master: COMMIT
[0m16:24:48.323728 [debug] [MainThread]: SQL status: COMMIT in 0.070 seconds
[0m16:24:48.324561 [debug] [MainThread]: On master: Close
[0m16:24:48.326076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:48.326514 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m16:24:48.326924 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m16:24:48.327249 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m16:24:48.327566 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m16:24:48.328117 [info ] [MainThread]: 
[0m16:24:48.328602 [info ] [MainThread]: Finished running 4 incremental models, 13 view models in 0 hours 0 minutes and 18.74 seconds (18.74s).
[0m16:24:48.332214 [debug] [MainThread]: Command end result
[0m16:24:48.360358 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:24:48.361755 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:24:48.366216 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:24:48.366415 [info ] [MainThread]: 
[0m16:24:48.366636 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:48.366810 [info ] [MainThread]: 
[0m16:24:48.366984 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=17
[0m16:24:48.368363 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.033909, "process_in_blocks": "0", "process_kernel_time": 0.232934, "process_mem_max_rss": "138330112", "process_out_blocks": "0", "process_user_time": 1.745579}
[0m16:24:48.368705 [debug] [MainThread]: Command `dbt run` succeeded at 16:24:48.368639 after 19.03 seconds
[0m16:24:48.368943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad4bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a44fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a44fdd0>]}
[0m16:24:48.369167 [debug] [MainThread]: Flushing usage events
[0m16:24:49.290814 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:18.015357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879bb10>]}


============================== 16:25:18.017328 | 7454961c-a9f4-4d01-a4a2-ac5e0dde2859 ==============================
[0m16:25:18.017328 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:25:18.017594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:25:18.082094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa3490>]}
[0m16:25:18.104085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108636be0>]}
[0m16:25:18.104537 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:25:18.140602 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m16:25:18.177457 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:25:18.177694 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m16:25:18.177848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109604250>]}
[0m16:25:18.665768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109616120>]}
[0m16:25:18.697811 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:25:18.698759 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:25:18.704895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e63850>]}
[0m16:25:18.705110 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:25:18.705274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095dd7e0>]}
[0m16:25:18.706165 [info ] [MainThread]: 
[0m16:25:18.706331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:25:18.706493 [info ] [MainThread]: 
[0m16:25:18.706736 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:25:18.707105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:25:18.737619 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:25:18.737826 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:25:18.737931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:20.284982 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.547 seconds
[0m16:25:20.286861 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:25:20.292913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:25:20.297874 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:25:20.298183 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:25:20.298395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:20.974541 [debug] [ThreadPool]: SQL status: BEGIN in 0.675 seconds
[0m16:25:20.976071 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:25:20.976739 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:25:21.053977 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.076 seconds
[0m16:25:21.057463 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:25:21.103161 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:25:21.112511 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:21.112920 [debug] [MainThread]: On master: BEGIN
[0m16:25:21.113158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:22.191509 [debug] [MainThread]: SQL status: BEGIN in 1.078 seconds
[0m16:25:22.192581 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:22.193209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:25:22.397292 [debug] [MainThread]: SQL status: SELECT 17 in 0.203 seconds
[0m16:25:22.405477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109487c50>]}
[0m16:25:22.406420 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:22.470076 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:22.471078 [debug] [MainThread]: On master: BEGIN
[0m16:25:22.657111 [debug] [MainThread]: SQL status: BEGIN in 0.185 seconds
[0m16:25:22.658312 [debug] [MainThread]: On master: COMMIT
[0m16:25:22.659049 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:22.659639 [debug] [MainThread]: On master: COMMIT
[0m16:25:22.723710 [debug] [MainThread]: SQL status: COMMIT in 0.063 seconds
[0m16:25:22.724955 [debug] [MainThread]: On master: Close
[0m16:25:22.731255 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:25:22.732344 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:25:22.733357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:25:22.734008 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:25:22.745603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:25:22.746612 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:25:22.781399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:22.781713 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp162522768622"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:25:22.781897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:24.476740 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.695 seconds
[0m16:25:24.494656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:24.495275 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:25:24.540579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m16:25:24.541369 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:24.541749 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp162522768622'
        
      order by ordinal_position

  
[0m16:25:24.602988 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.061 seconds
[0m16:25:24.608937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:24.609450 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:25:24.658330 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.048 seconds
[0m16:25:24.671214 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:24.672020 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:25:24.721463 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.049 seconds
[0m16:25:24.734151 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:25:24.734954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:24.735314 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp162522768622"
    )


  
[0m16:25:24.782015 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.046 seconds
[0m16:25:24.797024 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:25:24.797412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:24.797675 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:25:24.847162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m16:25:24.848496 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:25:24.849651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099aedb0>]}
[0m16:25:24.850103 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 2.12s]
[0m16:25:24.850793 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:25:24.851683 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:24.851872 [debug] [MainThread]: On master: BEGIN
[0m16:25:24.852014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:26.440705 [debug] [MainThread]: SQL status: BEGIN in 1.589 seconds
[0m16:25:26.441456 [debug] [MainThread]: On master: COMMIT
[0m16:25:26.441950 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:26.442308 [debug] [MainThread]: On master: COMMIT
[0m16:25:26.506175 [debug] [MainThread]: SQL status: COMMIT in 0.063 seconds
[0m16:25:26.506674 [debug] [MainThread]: On master: Close
[0m16:25:26.507312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:26.507591 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:25:26.507899 [info ] [MainThread]: 
[0m16:25:26.508222 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.80 seconds (7.80s).
[0m16:25:26.509279 [debug] [MainThread]: Command end result
[0m16:25:26.539327 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:25:26.540818 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:25:26.544820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:25:26.545010 [info ] [MainThread]: 
[0m16:25:26.545229 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:26.545390 [info ] [MainThread]: 
[0m16:25:26.545592 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:25:26.546690 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.558575, "process_in_blocks": "0", "process_kernel_time": 0.130135, "process_mem_max_rss": "146489344", "process_out_blocks": "0", "process_user_time": 1.407664}
[0m16:25:26.547054 [debug] [MainThread]: Command `cli run` succeeded at 16:25:26.546974 after 8.56 seconds
[0m16:25:26.547305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d54410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109447410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064070d0>]}
[0m16:25:26.547542 [debug] [MainThread]: Flushing usage events
[0m16:25:27.157200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:28:48.361112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056bf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb7b10>]}


============================== 16:28:48.363561 | e1660d4a-5445-46c6-92c3-dda2f39cbbba ==============================
[0m16:28:48.363561 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:28:48.363822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s revenue_daily', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:28:48.429759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebb490>]}
[0m16:28:48.450993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4e030>]}
[0m16:28:48.451685 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:28:48.488333 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:28:48.540029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:28:48.540216 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:28:48.557244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782f450>]}
[0m16:28:48.591317 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:28:48.592497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:28:48.602343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c359a0>]}
[0m16:28:48.602556 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:28:48.602703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e33f0>]}
[0m16:28:48.603398 [info ] [MainThread]: 
[0m16:28:48.603537 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:28:48.603645 [info ] [MainThread]: 
[0m16:28:48.603845 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:28:48.604203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:28:48.625907 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:28:48.626138 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:28:48.626267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:49.853826 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.227 seconds
[0m16:28:49.855961 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:28:49.861962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:28:49.866982 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:28:49.867278 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:28:49.867495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:50.589532 [debug] [ThreadPool]: SQL status: BEGIN in 0.722 seconds
[0m16:28:50.591236 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:28:50.592365 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:28:50.649657 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.056 seconds
[0m16:28:50.653981 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:28:50.706278 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:28:50.720994 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:50.721464 [debug] [MainThread]: On master: BEGIN
[0m16:28:50.721790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:51.370920 [debug] [MainThread]: SQL status: BEGIN in 0.649 seconds
[0m16:28:51.372327 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:51.373677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:28:51.476137 [debug] [MainThread]: SQL status: SELECT 17 in 0.101 seconds
[0m16:28:51.484490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c61bf0>]}
[0m16:28:51.485445 [debug] [MainThread]: On master: ROLLBACK
[0m16:28:51.534932 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:51.536717 [debug] [MainThread]: On master: BEGIN
[0m16:28:51.645640 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m16:28:51.647018 [debug] [MainThread]: On master: COMMIT
[0m16:28:51.647766 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:51.648368 [debug] [MainThread]: On master: COMMIT
[0m16:28:51.692044 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m16:28:51.693249 [debug] [MainThread]: On master: Close
[0m16:28:51.699868 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:28:51.700542 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:28:51.701162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:28:51.701765 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:28:51.717924 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:28:51.718794 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:28:51.753772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:51.754090 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp162851741158"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:28:51.754272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:54.279128 [debug] [Thread-1 (]: SQL status: SELECT 3 in 2.525 seconds
[0m16:28:54.302959 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:54.303558 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:28:54.374033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m16:28:54.375087 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:54.375726 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp162851741158'
        
      order by ordinal_position

  
[0m16:28:54.453124 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.077 seconds
[0m16:28:54.463274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:54.464079 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:28:54.514570 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.050 seconds
[0m16:28:54.526476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:54.527021 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:28:54.613769 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.086 seconds
[0m16:28:54.631305 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:28:54.632679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:54.633093 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp162851741158"
    )


  
[0m16:28:54.685522 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.052 seconds
[0m16:28:54.703694 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:28:54.704269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:54.704651 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:28:54.777044 [debug] [Thread-1 (]: SQL status: COMMIT in 0.072 seconds
[0m16:28:54.778431 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:28:54.780478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e981d0>]}
[0m16:28:54.780934 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 3.08s]
[0m16:28:54.781332 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:28:54.782303 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:54.782577 [debug] [MainThread]: On master: BEGIN
[0m16:28:54.782778 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:28:56.397275 [debug] [MainThread]: SQL status: BEGIN in 1.614 seconds
[0m16:28:56.398384 [debug] [MainThread]: On master: COMMIT
[0m16:28:56.399040 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:56.399470 [debug] [MainThread]: On master: COMMIT
[0m16:28:56.478715 [debug] [MainThread]: SQL status: COMMIT in 0.079 seconds
[0m16:28:56.479418 [debug] [MainThread]: On master: Close
[0m16:28:56.480249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:56.480568 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:28:56.481197 [info ] [MainThread]: 
[0m16:28:56.481882 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m16:28:56.482991 [debug] [MainThread]: Command end result
[0m16:28:56.551598 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:28:56.552687 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:28:56.555437 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:28:56.555583 [info ] [MainThread]: 
[0m16:28:56.555763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:56.555884 [info ] [MainThread]: 
[0m16:28:56.556027 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:28:56.558000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.224507, "process_in_blocks": "0", "process_kernel_time": 0.145747, "process_mem_max_rss": "137297920", "process_out_blocks": "0", "process_user_time": 1.02418}
[0m16:28:56.558203 [debug] [MainThread]: Command `dbt run` succeeded at 16:28:56.558162 after 8.22 seconds
[0m16:28:56.558364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107239d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107239e50>]}
[0m16:28:56.558515 [debug] [MainThread]: Flushing usage events
[0m16:28:57.803774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:48.323641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111727b10>]}


============================== 16:30:48.326172 | be3252d8-c7b4-4b5e-b322-da40a85b61d9 ==============================
[0m16:30:48.326172 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:30:48.326443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s revenue_ddaiily', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:30:48.394086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be3252d8-c7b4-4b5e-b322-da40a85b61d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11052b490>]}
[0m16:30:48.415874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be3252d8-c7b4-4b5e-b322-da40a85b61d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114be030>]}
[0m16:30:48.416482 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:30:48.453092 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:30:48.497470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:30:48.497657 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:30:48.516866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be3252d8-c7b4-4b5e-b322-da40a85b61d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121db450>]}
[0m16:30:48.550101 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:30:48.551299 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:30:48.561445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be3252d8-c7b4-4b5e-b322-da40a85b61d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117a59a0>]}
[0m16:30:48.561634 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:30:48.561777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be3252d8-c7b4-4b5e-b322-da40a85b61d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b38910>]}
[0m16:30:48.562066 [warn ] [MainThread]: The selection criterion 'revenue_ddaiily' does not match any enabled nodes
[0m16:30:48.562570 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:30:48.563349 [debug] [MainThread]: Command end result
[0m16:30:48.573663 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:30:48.574560 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:30:48.575955 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:30:48.576852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.28060505, "process_in_blocks": "0", "process_kernel_time": 0.105406, "process_mem_max_rss": "119668736", "process_out_blocks": "0", "process_user_time": 0.711622}
[0m16:30:48.577040 [debug] [MainThread]: Command `dbt run` succeeded at 16:30:48.577003 after 0.28 seconds
[0m16:30:48.577190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117c1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111504dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112452450>]}
[0m16:30:48.577321 [debug] [MainThread]: Flushing usage events
[0m16:30:50.521967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:14.673296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053234d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681bb10>]}


============================== 16:31:14.675005 | d549dd18-d1ea-4635-99cd-b3acf5b8ce9e ==============================
[0m16:31:14.675005 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:31:14.675266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s revenue_daily', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:14.738203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1b490>]}
[0m16:31:14.759214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b2030>]}
[0m16:31:14.759590 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:31:14.793461 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:31:14.840345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:14.840522 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:14.859828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107497450>]}
[0m16:31:14.893605 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:31:14.894484 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:31:14.900747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068999a0>]}
[0m16:31:14.900953 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:31:14.901105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df8910>]}
[0m16:31:14.901824 [info ] [MainThread]: 
[0m16:31:14.901971 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:31:14.902078 [info ] [MainThread]: 
[0m16:31:14.902273 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:14.902652 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:31:14.924954 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:31:14.925153 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:31:14.925264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:15.863849 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.938 seconds
[0m16:31:15.865282 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:31:15.870218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:31:15.874683 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:31:15.874919 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:31:15.875094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:18.304417 [debug] [ThreadPool]: SQL status: BEGIN in 2.429 seconds
[0m16:31:18.305175 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:31:18.305625 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:31:18.372753 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.066 seconds
[0m16:31:18.375947 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:31:18.440937 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:31:18.455206 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:18.455752 [debug] [MainThread]: On master: BEGIN
[0m16:31:18.456157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:19.314444 [debug] [MainThread]: SQL status: BEGIN in 0.858 seconds
[0m16:31:19.315971 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:19.317117 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:31:19.382704 [debug] [MainThread]: SQL status: SELECT 17 in 0.065 seconds
[0m16:31:19.391752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fec30>]}
[0m16:31:19.392651 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:19.456361 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:19.457756 [debug] [MainThread]: On master: BEGIN
[0m16:31:19.685409 [debug] [MainThread]: SQL status: BEGIN in 0.226 seconds
[0m16:31:19.686901 [debug] [MainThread]: On master: COMMIT
[0m16:31:19.687879 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:19.688393 [debug] [MainThread]: On master: COMMIT
[0m16:31:19.754800 [debug] [MainThread]: SQL status: COMMIT in 0.066 seconds
[0m16:31:19.755619 [debug] [MainThread]: On master: Close
[0m16:31:19.763596 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:31:19.764563 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:31:19.765324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:31:19.765863 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:31:19.782322 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:31:19.783219 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:31:19.817022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:19.817301 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp163119804473"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:31:19.817480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:20.901294 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.084 seconds
[0m16:31:20.916175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:20.916624 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:31:20.980258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m16:31:20.981317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:20.982130 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp163119804473'
        
      order by ordinal_position

  
[0m16:31:21.086709 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.104 seconds
[0m16:31:21.090416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:21.090745 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:31:21.140786 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.050 seconds
[0m16:31:21.147044 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:21.147339 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:31:21.206936 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.059 seconds
[0m16:31:21.222907 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:31:21.223742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:21.224065 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp163119804473" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp163119804473"
    )
  
[0m16:31:21.275032 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.050 seconds
[0m16:31:21.287894 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:31:21.288295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:21.288542 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:31:21.394078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.104 seconds
[0m16:31:21.399350 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:31:21.403548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b80350>]}
[0m16:31:21.404371 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 1.64s]
[0m16:31:21.405024 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:31:21.406452 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:21.406847 [debug] [MainThread]: On master: BEGIN
[0m16:31:21.407140 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:22.514657 [debug] [MainThread]: SQL status: BEGIN in 1.107 seconds
[0m16:31:22.515624 [debug] [MainThread]: On master: COMMIT
[0m16:31:22.516148 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:22.516580 [debug] [MainThread]: On master: COMMIT
[0m16:31:22.581491 [debug] [MainThread]: SQL status: COMMIT in 0.064 seconds
[0m16:31:22.582612 [debug] [MainThread]: On master: Close
[0m16:31:22.583839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:22.584385 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:31:22.585111 [info ] [MainThread]: 
[0m16:31:22.585640 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.68 seconds (7.68s).
[0m16:31:22.586520 [debug] [MainThread]: Command end result
[0m16:31:22.662834 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:31:22.663884 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:31:22.666498 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:31:22.666636 [info ] [MainThread]: 
[0m16:31:22.666805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:22.666920 [info ] [MainThread]: 
[0m16:31:22.667045 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:31:22.667801 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.020097, "process_in_blocks": "0", "process_kernel_time": 0.12987, "process_mem_max_rss": "136560640", "process_out_blocks": "0", "process_user_time": 1.01102}
[0m16:31:22.667992 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:22.667955 after 8.02 seconds
[0m16:31:22.668154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9de50>]}
[0m16:31:22.668295 [debug] [MainThread]: Flushing usage events
[0m16:31:23.316698 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:37.295660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705bb10>]}


============================== 16:38:37.298085 | fb724f97-1ac7-49b2-b859-e99f6116665f ==============================
[0m16:38:37.298085 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:38:37.298344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s revenue_daily', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:38:37.363837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635f490>]}
[0m16:38:37.384626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef2030>]}
[0m16:38:37.385320 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:38:37.422623 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:38:37.474996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:37.475174 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:37.494277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdb450>]}
[0m16:38:37.527541 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:38:37.528603 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:38:37.538309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d99a0>]}
[0m16:38:37.538519 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:38:37.538667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107638910>]}
[0m16:38:37.539391 [info ] [MainThread]: 
[0m16:38:37.539534 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:37.539643 [info ] [MainThread]: 
[0m16:38:37.539845 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:38:37.540202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:38:37.561832 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:38:37.562057 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:38:37.562188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:38.539344 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.977 seconds
[0m16:38:38.543324 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:38:38.551388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:38:38.557468 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:38:38.557828 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:38:38.558061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:39.395603 [debug] [ThreadPool]: SQL status: BEGIN in 0.837 seconds
[0m16:38:39.396458 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:38:39.396924 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:38:39.489565 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.092 seconds
[0m16:38:39.490996 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:38:39.532847 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:38:39.538492 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:39.538720 [debug] [MainThread]: On master: BEGIN
[0m16:38:39.538877 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:40.208912 [debug] [MainThread]: SQL status: BEGIN in 0.670 seconds
[0m16:38:40.210570 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:40.211623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:38:40.275439 [debug] [MainThread]: SQL status: SELECT 17 in 0.063 seconds
[0m16:38:40.284201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10813ac30>]}
[0m16:38:40.285026 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:40.335840 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:40.337096 [debug] [MainThread]: On master: BEGIN
[0m16:38:40.435530 [debug] [MainThread]: SQL status: BEGIN in 0.097 seconds
[0m16:38:40.436828 [debug] [MainThread]: On master: COMMIT
[0m16:38:40.437276 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:40.437707 [debug] [MainThread]: On master: COMMIT
[0m16:38:40.483346 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m16:38:40.484154 [debug] [MainThread]: On master: Close
[0m16:38:40.491139 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:38:40.492144 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:38:40.492967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:38:40.493493 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:38:40.509855 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:38:40.510753 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:38:40.538499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:40.538787 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp163840527068"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:38:40.538975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:42.177712 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.638 seconds
[0m16:38:42.198503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:42.198953 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:38:42.242918 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m16:38:42.243688 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:42.244194 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp163840527068'
        
      order by ordinal_position

  
[0m16:38:42.309281 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.064 seconds
[0m16:38:42.318961 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:42.319512 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:38:42.373656 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.053 seconds
[0m16:38:42.385281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:42.385765 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:38:42.436202 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.050 seconds
[0m16:38:42.456998 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:38:42.457967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:42.458339 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp163840527068" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp163840527068"
    )
  
[0m16:38:42.502539 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.044 seconds
[0m16:38:42.519698 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:38:42.520009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:42.520251 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:38:42.564380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.044 seconds
[0m16:38:42.567668 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:38:42.570828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c0350>]}
[0m16:38:42.571574 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 2.08s]
[0m16:38:42.572212 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:38:42.573521 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:42.573817 [debug] [MainThread]: On master: BEGIN
[0m16:38:42.574064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:43.259718 [debug] [MainThread]: SQL status: BEGIN in 0.685 seconds
[0m16:38:43.260661 [debug] [MainThread]: On master: COMMIT
[0m16:38:43.261145 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:43.261908 [debug] [MainThread]: On master: COMMIT
[0m16:38:43.306144 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m16:38:43.307303 [debug] [MainThread]: On master: Close
[0m16:38:43.309081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:43.309602 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:38:43.310164 [info ] [MainThread]: 
[0m16:38:43.310780 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m16:38:43.311987 [debug] [MainThread]: Command end result
[0m16:38:43.374521 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:38:43.375609 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:38:43.378435 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:38:43.378580 [info ] [MainThread]: 
[0m16:38:43.378757 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:43.378886 [info ] [MainThread]: 
[0m16:38:43.379022 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:38:43.380403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1114373, "process_in_blocks": "0", "process_kernel_time": 0.140209, "process_mem_max_rss": "136265728", "process_out_blocks": "0", "process_user_time": 0.99446}
[0m16:38:43.380634 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:43.380590 after 6.11 seconds
[0m16:38:43.380810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10818d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ddd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076dde50>]}
[0m16:38:43.380972 [debug] [MainThread]: Flushing usage events
[0m16:38:44.074821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:41.440338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d27b10>]}


============================== 16:39:41.442816 | cb657d32-ffa5-491b-91d3-b754d1141ae2 ==============================
[0m16:39:41.442816 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:39:41.443087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s revenue_daily', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:39:41.509988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c2b490>]}
[0m16:39:41.531686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113abe030>]}
[0m16:39:41.532403 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:39:41.568745 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:39:41.613097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:41.613284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:41.632276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11470b450>]}
[0m16:39:41.665393 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:39:41.666502 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:39:41.676568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113da59a0>]}
[0m16:39:41.676776 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:39:41.676924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fa4910>]}
[0m16:39:41.677641 [info ] [MainThread]: 
[0m16:39:41.677778 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:39:41.677888 [info ] [MainThread]: 
[0m16:39:41.678079 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:41.678432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:39:41.699147 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:39:41.699339 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:39:41.699451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:42.344526 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.645 seconds
[0m16:39:42.347909 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:39:42.356315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:39:42.363156 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:39:42.363600 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:39:42.363850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:43.873411 [debug] [ThreadPool]: SQL status: BEGIN in 1.509 seconds
[0m16:39:43.874901 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:39:43.875913 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:39:43.922846 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.046 seconds
[0m16:39:43.925904 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:39:43.972731 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:39:43.986723 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:43.987214 [debug] [MainThread]: On master: BEGIN
[0m16:39:43.987540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:44.955545 [debug] [MainThread]: SQL status: BEGIN in 0.968 seconds
[0m16:39:44.956536 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:44.957068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:45.035897 [debug] [MainThread]: SQL status: SELECT 17 in 0.078 seconds
[0m16:39:45.044904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b6ac30>]}
[0m16:39:45.046108 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:45.092493 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:45.093896 [debug] [MainThread]: On master: BEGIN
[0m16:39:45.216657 [debug] [MainThread]: SQL status: BEGIN in 0.122 seconds
[0m16:39:45.217583 [debug] [MainThread]: On master: COMMIT
[0m16:39:45.218062 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:45.218435 [debug] [MainThread]: On master: COMMIT
[0m16:39:45.261886 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m16:39:45.263464 [debug] [MainThread]: On master: Close
[0m16:39:45.270819 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:39:45.271913 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:39:45.272740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:39:45.273319 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:39:45.289171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:39:45.290167 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:39:45.324486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:45.324754 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp163945311466"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:39:45.324929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:46.168327 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.843 seconds
[0m16:39:46.190920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.191477 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:39:46.235706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m16:39:46.236691 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.237358 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp163945311466'
        
      order by ordinal_position

  
[0m16:39:46.292169 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.054 seconds
[0m16:39:46.304099 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.304896 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:39:46.388802 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.083 seconds
[0m16:39:46.409628 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.410126 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp163945311466'
        
      order by ordinal_position

  
[0m16:39:46.456998 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.046 seconds
[0m16:39:46.463439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.463901 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:39:46.509827 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.045 seconds
[0m16:39:46.524868 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:39:46.537064 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:39:46.537858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.538158 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp163945311466" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp163945311466"
    )
  
[0m16:39:46.583871 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.045 seconds
[0m16:39:46.596979 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:39:46.597311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.597555 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:39:46.656696 [debug] [Thread-1 (]: SQL status: COMMIT in 0.059 seconds
[0m16:39:46.661008 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:39:46.664613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e00350>]}
[0m16:39:46.665350 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 1.39s]
[0m16:39:46.665909 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:39:46.667238 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:46.667515 [debug] [MainThread]: On master: BEGIN
[0m16:39:46.667742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:47.464394 [debug] [MainThread]: SQL status: BEGIN in 0.796 seconds
[0m16:39:47.465609 [debug] [MainThread]: On master: COMMIT
[0m16:39:47.466404 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:47.467009 [debug] [MainThread]: On master: COMMIT
[0m16:39:47.511963 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m16:39:47.513041 [debug] [MainThread]: On master: Close
[0m16:39:47.514587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:47.515219 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:39:47.515867 [info ] [MainThread]: 
[0m16:39:47.516728 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m16:39:47.518821 [debug] [MainThread]: Command end result
[0m16:39:47.585673 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:39:47.586707 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:39:47.589397 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:39:47.589532 [info ] [MainThread]: 
[0m16:39:47.589702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:39:47.589819 [info ] [MainThread]: 
[0m16:39:47.589947 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:39:47.591421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.176956, "process_in_blocks": "0", "process_kernel_time": 0.144844, "process_mem_max_rss": "136888320", "process_out_blocks": "0", "process_user_time": 1.037071}
[0m16:39:47.591674 [debug] [MainThread]: Command `dbt run` succeeded at 16:39:47.591630 after 6.18 seconds
[0m16:39:47.591845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bbc680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114049d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114049e50>]}
[0m16:39:47.592001 [debug] [MainThread]: Flushing usage events
[0m16:39:48.155240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:01.399028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c774d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b027b10>]}


============================== 16:40:01.400791 | f4f811ba-c667-404e-96ad-cafb9c87c780 ==============================
[0m16:40:01.400791 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:40:01.401064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s revenue_daily', 'send_anonymous_usage_stats': 'True'}
[0m16:40:01.462503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109727490>]}
[0m16:40:01.483186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aebe030>]}
[0m16:40:01.483535 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:40:01.516774 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:40:01.561512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:01.561707 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:01.580287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbff450>]}
[0m16:40:01.612509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:40:01.613347 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:40:01.619259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a59a0>]}
[0m16:40:01.619456 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:40:01.619599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b55c910>]}
[0m16:40:01.620315 [info ] [MainThread]: 
[0m16:40:01.620469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:01.620579 [info ] [MainThread]: 
[0m16:40:01.620774 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:01.621134 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:40:01.640845 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:40:01.641040 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:40:01.641152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:02.400599 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.759 seconds
[0m16:40:02.403889 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:40:02.413084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:40:02.420857 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:40:02.421349 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:40:02.421674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:03.757805 [debug] [ThreadPool]: SQL status: BEGIN in 1.336 seconds
[0m16:40:03.758904 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:40:03.759461 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:40:03.806764 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.047 seconds
[0m16:40:03.811081 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:40:03.854389 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:40:03.869508 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:03.869976 [debug] [MainThread]: On master: BEGIN
[0m16:40:03.870298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:04.586890 [debug] [MainThread]: SQL status: BEGIN in 0.717 seconds
[0m16:40:04.587231 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:04.587529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:04.652259 [debug] [MainThread]: SQL status: SELECT 17 in 0.064 seconds
[0m16:40:04.658842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c05ec30>]}
[0m16:40:04.659432 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:04.704987 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:04.705822 [debug] [MainThread]: On master: BEGIN
[0m16:40:04.798337 [debug] [MainThread]: SQL status: BEGIN in 0.092 seconds
[0m16:40:04.799860 [debug] [MainThread]: On master: COMMIT
[0m16:40:04.800822 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:04.801243 [debug] [MainThread]: On master: COMMIT
[0m16:40:04.851088 [debug] [MainThread]: SQL status: COMMIT in 0.049 seconds
[0m16:40:04.852029 [debug] [MainThread]: On master: Close
[0m16:40:04.855236 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:40:04.855902 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:40:04.856419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:40:04.856800 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:40:04.869050 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:40:04.869768 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:40:04.900484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:04.900749 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp164004888632"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    now() at time zone 'utc' as updated_at
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m16:40:04.900915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:06.563092 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.662 seconds
[0m16:40:06.580459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.580986 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:40:06.624660 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m16:40:06.625608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.626394 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp164004888632'
        
      order by ordinal_position

  
[0m16:40:06.677800 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.050 seconds
[0m16:40:06.688614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.689320 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:40:06.762983 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.073 seconds
[0m16:40:06.784725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.785259 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp164004888632'
        
      order by ordinal_position

  
[0m16:40:06.839678 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.054 seconds
[0m16:40:06.846442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.846999 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:40:06.895934 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.048 seconds
[0m16:40:06.908229 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: [PostgresColumn(column='updated_at', dtype='timestamp without time zone', char_size=None, numeric_precision=None, numeric_scale=None)]
        Target columns not in source: []
        New column types: []
  
[0m16:40:06.918320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.918657 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    alter table "dev_ohwk"."dbt"."revenue_daily"

            
               add column "updated_at" timestamp without time zone
            

            
  
[0m16:40:06.961714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m16:40:06.962871 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: [PostgresColumn(column='updated_at', dtype='timestamp without time zone', char_size=None, numeric_precision=None, numeric_scale=None)]
        Columns removed: 
        Data types changed: 
  
[0m16:40:06.974123 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:40:06.974855 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.975138 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp164004888632" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp164004888632"
    )
  
[0m16:40:07.018294 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.043 seconds
[0m16:40:07.029623 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:40:07.029889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:07.030104 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:40:07.073420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m16:40:07.075211 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:40:07.077037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2fc410>]}
[0m16:40:07.077651 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 2.22s]
[0m16:40:07.078178 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:40:07.079457 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:07.079724 [debug] [MainThread]: On master: BEGIN
[0m16:40:07.079966 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:07.768518 [debug] [MainThread]: SQL status: BEGIN in 0.688 seconds
[0m16:40:07.770065 [debug] [MainThread]: On master: COMMIT
[0m16:40:07.771219 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:07.771932 [debug] [MainThread]: On master: COMMIT
[0m16:40:07.814949 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m16:40:07.816102 [debug] [MainThread]: On master: Close
[0m16:40:07.817517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:07.818106 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:40:07.818749 [info ] [MainThread]: 
[0m16:40:07.819421 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.20 seconds (6.20s).
[0m16:40:07.820833 [debug] [MainThread]: Command end result
[0m16:40:07.885489 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:40:07.886569 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:40:07.889245 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:40:07.889387 [info ] [MainThread]: 
[0m16:40:07.889556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:07.889673 [info ] [MainThread]: 
[0m16:40:07.889802 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:40:07.890642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5163918, "process_in_blocks": "0", "process_kernel_time": 0.129864, "process_mem_max_rss": "137396224", "process_out_blocks": "0", "process_user_time": 1.024023}
[0m16:40:07.890829 [debug] [MainThread]: Command `dbt run` succeeded at 16:40:07.890791 after 6.52 seconds
[0m16:40:07.890996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b601d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b601e50>]}
[0m16:40:07.891146 [debug] [MainThread]: Flushing usage events
[0m16:40:08.671477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:50.523932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109827b10>]}


============================== 16:44:50.526477 | bc797b92-22f1-4d31-806c-a83c94043a9d ==============================
[0m16:44:50.526477 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:44:50.526738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s revenue_daily --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m16:44:50.592510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10882b490>]}
[0m16:44:50.614440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095be030>]}
[0m16:44:50.615094 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:44:50.652500 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:44:50.702950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:50.703119 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:50.722194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8f450>]}
[0m16:44:50.755705 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:44:50.756846 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:44:50.766597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a59a0>]}
[0m16:44:50.766795 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:44:50.766937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b74910>]}
[0m16:44:50.767633 [info ] [MainThread]: 
[0m16:44:50.767776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:44:50.767885 [info ] [MainThread]: 
[0m16:44:50.768080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:50.768483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:44:50.790476 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:44:50.790670 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:44:50.790795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:51.556535 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.766 seconds
[0m16:44:51.557617 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:44:51.561120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:44:51.564357 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:44:51.564565 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:44:51.564712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:52.236767 [debug] [ThreadPool]: SQL status: BEGIN in 0.672 seconds
[0m16:44:52.238419 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:44:52.239493 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:44:52.291441 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.051 seconds
[0m16:44:52.297130 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:44:52.342092 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:44:52.355100 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:52.355529 [debug] [MainThread]: On master: BEGIN
[0m16:44:52.355822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:53.241026 [debug] [MainThread]: SQL status: BEGIN in 0.885 seconds
[0m16:44:53.241451 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:53.241779 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:44:53.304269 [debug] [MainThread]: SQL status: SELECT 17 in 0.062 seconds
[0m16:44:53.307203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b05ec30>]}
[0m16:44:53.307727 [debug] [MainThread]: On master: ROLLBACK
[0m16:44:53.355066 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:53.356154 [debug] [MainThread]: On master: BEGIN
[0m16:44:53.438375 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m16:44:53.438932 [debug] [MainThread]: On master: COMMIT
[0m16:44:53.439277 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:53.439566 [debug] [MainThread]: On master: COMMIT
[0m16:44:53.492143 [debug] [MainThread]: SQL status: COMMIT in 0.052 seconds
[0m16:44:53.493209 [debug] [MainThread]: On master: Close
[0m16:44:53.501069 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:44:53.502092 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:44:53.503032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:44:53.503494 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:44:53.517561 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:44:53.518580 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:44:53.551174 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:44:53.551832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:44:53.552011 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:44:53.552165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:54.237885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.685 seconds
[0m16:44:54.239130 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:44:54.239768 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_ohwk"."dbt"."revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    now() at time zone 'utc' as updated_at
from
    "dev_ohwk"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
  );
  
  
[0m16:44:55.133699 [debug] [Thread-1 (]: SQL status: SELECT 91 in 0.893 seconds
[0m16:44:55.148808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:44:55.149324 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
alter table "dev_ohwk"."dbt"."revenue_daily" rename to "revenue_daily__dbt_backup"
[0m16:44:55.193185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m16:44:55.203235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:44:55.203592 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
alter table "dev_ohwk"."dbt"."revenue_daily__dbt_tmp" rename to "revenue_daily"
[0m16:44:55.245481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.041 seconds
[0m16:44:55.268021 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:44:55.268509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:44:55.268835 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:44:55.313480 [debug] [Thread-1 (]: SQL status: COMMIT in 0.044 seconds
[0m16:44:55.322192 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."revenue_daily__dbt_backup"
[0m16:44:55.327384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:44:55.327777 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
drop table if exists "dev_ohwk"."dbt"."revenue_daily__dbt_backup" cascade
[0m16:44:55.376596 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.048 seconds
[0m16:44:55.381570 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:44:55.385373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac7b710>]}
[0m16:44:55.386297 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mSELECT 91[0m in 1.88s]
[0m16:44:55.387042 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:44:55.388568 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:55.388904 [debug] [MainThread]: On master: BEGIN
[0m16:44:55.389181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:56.092071 [debug] [MainThread]: SQL status: BEGIN in 0.703 seconds
[0m16:44:56.093300 [debug] [MainThread]: On master: COMMIT
[0m16:44:56.094387 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:56.095009 [debug] [MainThread]: On master: COMMIT
[0m16:44:56.558409 [debug] [MainThread]: SQL status: COMMIT in 0.463 seconds
[0m16:44:56.559921 [debug] [MainThread]: On master: Close
[0m16:44:56.561328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:56.561689 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:44:56.562453 [info ] [MainThread]: 
[0m16:44:56.563454 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.79 seconds (5.79s).
[0m16:44:56.564392 [debug] [MainThread]: Command end result
[0m16:44:56.626495 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:44:56.627551 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:44:56.630288 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:44:56.630438 [info ] [MainThread]: 
[0m16:44:56.630623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:56.630747 [info ] [MainThread]: 
[0m16:44:56.630890 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:44:56.632237 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.134803, "process_in_blocks": "0", "process_kernel_time": 0.143117, "process_mem_max_rss": "137183232", "process_out_blocks": "0", "process_user_time": 0.966875}
[0m16:44:56.632440 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:56.632402 after 6.14 seconds
[0m16:44:56.632611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0acaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c19e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c19db0>]}
[0m16:44:56.632775 [debug] [MainThread]: Flushing usage events
[0m16:44:57.257578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:43:24.308904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c834d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091779d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109177b10>]}


============================== 20:43:24.311455 | c923e30e-bcc5-4e73-b597-4fcec8398100 ==============================
[0m20:43:24.311455 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:43:24.311721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:43:24.385020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10847f490>]}
[0m20:43:24.406329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10900ebe0>]}
[0m20:43:24.406907 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:43:24.445407 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m20:43:24.483296 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:43:24.483539 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m20:43:24.483688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe0250>]}
[0m20:43:24.974434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fde210>]}
[0m20:43:25.006461 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m20:43:25.007671 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m20:43:25.025626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a35da90>]}
[0m20:43:25.025850 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m20:43:25.026671 [info ] [MainThread]: 
[0m20:43:25.026811 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:43:25.026924 [info ] [MainThread]: 
[0m20:43:25.027115 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:43:25.027495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m20:43:25.049835 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m20:43:25.050028 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m20:43:25.050144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:43:25.809803 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.760 seconds
[0m20:43:25.811932 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m20:43:25.820111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m20:43:25.828421 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m20:43:25.828915 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m20:43:25.829222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:26.594809 [debug] [ThreadPool]: SQL status: BEGIN in 0.765 seconds
[0m20:43:26.595515 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m20:43:26.596101 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m20:43:27.101298 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.505 seconds
[0m20:43:27.104275 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m20:43:27.160835 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m20:43:27.175046 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:27.175661 [debug] [MainThread]: On master: BEGIN
[0m20:43:27.176063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:43:27.896333 [debug] [MainThread]: SQL status: BEGIN in 0.720 seconds
[0m20:43:27.897353 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:27.898015 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:43:27.954867 [debug] [MainThread]: SQL status: SELECT 17 in 0.056 seconds
[0m20:43:27.960691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5eab60>]}
[0m20:43:27.961370 [debug] [MainThread]: On master: ROLLBACK
[0m20:43:28.008612 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:28.009570 [debug] [MainThread]: On master: BEGIN
[0m20:43:28.100718 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m20:43:28.101714 [debug] [MainThread]: On master: COMMIT
[0m20:43:28.102281 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:28.102832 [debug] [MainThread]: On master: COMMIT
[0m20:43:28.151652 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m20:43:28.152600 [debug] [MainThread]: On master: Close
[0m20:43:28.161375 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m20:43:28.162202 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m20:43:28.163831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m20:43:28.164510 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m20:43:28.176877 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m20:43:28.178233 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m20:43:28.213062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:28.213370 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp204328199917"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    now() at time zone 'utc' as updated_at
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m20:43:28.213594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:30.122516 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.909 seconds
[0m20:43:30.143342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.143893 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m20:43:30.198673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m20:43:30.199493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.199859 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp204328199917'
        
      order by ordinal_position

  
[0m20:43:30.259388 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.059 seconds
[0m20:43:30.267023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.267504 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m20:43:30.315865 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.048 seconds
[0m20:43:30.333556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.334198 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp204328199917'
        
      order by ordinal_position

  
[0m20:43:30.404955 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.070 seconds
[0m20:43:30.410266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.410749 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m20:43:30.491883 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.080 seconds
[0m20:43:30.505601 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:43:30.521532 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m20:43:30.522432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.522750 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp204328199917" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp204328199917"
    )
  
[0m20:43:30.588073 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.065 seconds
[0m20:43:30.604269 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m20:43:30.605134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.605451 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m20:43:30.671499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.066 seconds
[0m20:43:30.674233 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m20:43:30.677583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3be750>]}
[0m20:43:30.678474 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 2.51s]
[0m20:43:30.679147 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m20:43:30.681285 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:30.681734 [debug] [MainThread]: On master: BEGIN
[0m20:43:30.682000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:43:31.473383 [debug] [MainThread]: SQL status: BEGIN in 0.791 seconds
[0m20:43:31.474338 [debug] [MainThread]: On master: COMMIT
[0m20:43:31.474879 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:31.475356 [debug] [MainThread]: On master: COMMIT
[0m20:43:31.518718 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m20:43:31.519618 [debug] [MainThread]: On master: Close
[0m20:43:31.520933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:31.521528 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m20:43:31.522265 [info ] [MainThread]: 
[0m20:43:31.522723 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.50 seconds (6.50s).
[0m20:43:31.523668 [debug] [MainThread]: Command end result
[0m20:43:31.557195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m20:43:31.558603 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m20:43:31.562189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m20:43:31.562377 [info ] [MainThread]: 
[0m20:43:31.562600 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:43:31.563051 [info ] [MainThread]: 
[0m20:43:31.563336 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:43:31.565137 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.2848167, "process_in_blocks": "0", "process_kernel_time": 0.161966, "process_mem_max_rss": "149061632", "process_out_blocks": "0", "process_user_time": 1.463572}
[0m20:43:31.565434 [debug] [MainThread]: Command `cli build` succeeded at 20:43:31.565371 after 7.29 seconds
[0m20:43:31.565662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f1de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a71edf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a71ed50>]}
[0m20:43:31.565879 [debug] [MainThread]: Flushing usage events
[0m20:43:32.224554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:06:53.497983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10564b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b439d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b43b10>]}


============================== 21:06:53.500454 | 849a4981-e59a-426f-a6ed-6076793b7c66 ==============================
[0m21:06:53.500454 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:06:53.500717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls -s config.materialized:incremental', 'send_anonymous_usage_stats': 'True'}
[0m21:06:53.567846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '849a4981-e59a-426f-a6ed-6076793b7c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e43490>]}
[0m21:06:53.589377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '849a4981-e59a-426f-a6ed-6076793b7c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069da140>]}
[0m21:06:53.589792 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:06:53.625926 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:06:53.677978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:06:53.678159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:06:53.694785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '849a4981-e59a-426f-a6ed-6076793b7c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c3150>]}
[0m21:06:53.727191 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:06:53.730096 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:06:53.738783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '849a4981-e59a-426f-a6ed-6076793b7c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a56d0>]}
[0m21:06:53.738972 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:06:53.739114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '849a4981-e59a-426f-a6ed-6076793b7c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706f310>]}
[0m21:06:53.739426 [info ] [MainThread]: dbt_scooters.events_clean
[0m21:06:53.739553 [info ] [MainThread]: dbt_scooters.revenue_daily
[0m21:06:53.739652 [info ] [MainThread]: dbt_scooters.trips_concurrency
[0m21:06:53.739753 [info ] [MainThread]: dbt_scooters.trips_users
[0m21:06:53.741069 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.26988965, "process_in_blocks": "0", "process_kernel_time": 0.105278, "process_mem_max_rss": "119422976", "process_out_blocks": "0", "process_user_time": 0.701449}
[0m21:06:53.741243 [debug] [MainThread]: Command `dbt ls` succeeded at 21:06:53.741208 after 0.27 seconds
[0m21:06:53.741385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a20dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107946990>]}
[0m21:06:53.741503 [debug] [MainThread]: Flushing usage events
[0m21:06:54.400435 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:12:00.602773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036ef4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be7b10>]}


============================== 21:12:00.605253 | 4dac914a-398c-4275-81c2-dc4fb443d1c8 ==============================
[0m21:12:00.605253 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:12:00.605550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -s config.materialized:incremental', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:12:00.670099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee7490>]}
[0m21:12:00.690247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7e030>]}
[0m21:12:00.690931 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:12:00.727435 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:12:00.772055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:12:00.772238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:12:00.789563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105867450>]}
[0m21:12:00.824122 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:12:00.825235 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:12:00.841259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae5e50>]}
[0m21:12:00.841466 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:12:00.842329 [info ] [MainThread]: 
[0m21:12:00.842474 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:12:00.842585 [info ] [MainThread]: 
[0m21:12:00.842782 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:12:00.844314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:12:00.866661 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:12:00.866852 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:12:00.866964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:02.217883 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.350 seconds
[0m21:12:02.221901 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:12:02.227121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:12:02.234856 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:12:02.235250 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:12:02.235488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:03.878925 [debug] [ThreadPool]: SQL status: BEGIN in 1.643 seconds
[0m21:12:03.880465 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:12:03.881562 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:12:03.944743 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.062 seconds
[0m21:12:03.948768 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:12:04.037656 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:12:04.050954 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:04.051443 [debug] [MainThread]: On master: BEGIN
[0m21:12:04.051788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:12:05.756967 [debug] [MainThread]: SQL status: BEGIN in 1.705 seconds
[0m21:12:05.758479 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:05.759165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:12:05.904848 [debug] [MainThread]: SQL status: SELECT 17 in 0.145 seconds
[0m21:12:05.911495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105afbd90>]}
[0m21:12:05.912475 [debug] [MainThread]: On master: ROLLBACK
[0m21:12:05.988757 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:05.990137 [debug] [MainThread]: On master: BEGIN
[0m21:12:06.104731 [debug] [MainThread]: SQL status: BEGIN in 0.114 seconds
[0m21:12:06.105668 [debug] [MainThread]: On master: COMMIT
[0m21:12:06.106636 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:06.107384 [debug] [MainThread]: On master: COMMIT
[0m21:12:06.169575 [debug] [MainThread]: SQL status: COMMIT in 0.062 seconds
[0m21:12:06.170726 [debug] [MainThread]: On master: Close
[0m21:12:06.179112 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:12:06.179780 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:12:06.180269 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:12:06.180651 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:12:06.181209 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:12:06.181832 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:12:06.182338 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:12:06.182801 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:12:06.183369 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:12:06.183752 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:12:06.184065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:12:06.184424 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:12:06.184719 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:12:06.184994 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:12:06.185255 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:12:06.185520 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:12:06.202475 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:12:06.202863 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:12:06.205237 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:12:06.207854 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:12:06.208488 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:12:06.208738 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:12:06.208951 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:12:06.209130 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:12:06.268757 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:06.270402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:06.271357 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:06.272702 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:06.272871 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp211206225970"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:12:06.273021 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp211206234723"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id
from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m21:12:06.273184 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp211206239752"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency
from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:12:06.273344 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp211206272158"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:12:06.273475 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:12:06.273593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:06.273707 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:12:06.273819 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:12:07.087163 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.813 seconds
[0m21:12:07.108531 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:07.108973 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:12:07.183792 [debug] [Thread-4 (]: SQL status: BEGIN in 0.074 seconds
[0m21:12:07.184583 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:07.185041 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp211206272158'
        
      order by ordinal_position

  
[0m21:12:07.294491 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.109 seconds
[0m21:12:07.302580 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:07.303071 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:07.506227 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.203 seconds
[0m21:12:07.517141 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:07.517816 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:07.706694 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.188 seconds
[0m21:12:07.720725 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:12:07.721939 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:07.722399 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age"
        from "trips_users__dbt_tmp211206272158"
    )


  
[0m21:12:07.804906 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.082 seconds
[0m21:12:07.828172 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:12:07.828713 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:07.829038 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:12:07.908967 [debug] [Thread-4 (]: SQL status: COMMIT in 0.080 seconds
[0m21:12:07.911266 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:12:07.914312 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b83d640>]}
[0m21:12:07.915049 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 0[0m in 1.73s]
[0m21:12:07.915639 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:12:08.393974 [debug] [Thread-2 (]: SQL status: SELECT 3 in 2.120 seconds
[0m21:12:08.398806 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:08.399363 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:12:08.502069 [debug] [Thread-1 (]: SQL status: SELECT 0 in 2.228 seconds
[0m21:12:08.502744 [debug] [Thread-2 (]: SQL status: BEGIN in 0.103 seconds
[0m21:12:08.506714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:08.507196 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:08.507600 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:12:08.507993 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp211206225970'
        
      order by ordinal_position

  
[0m21:12:08.575407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m21:12:08.575900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:08.576320 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp211206234723'
        
      order by ordinal_position

  
[0m21:12:08.705234 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.197 seconds
[0m21:12:08.708503 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:08.708940 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:08.809212 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.100 seconds
[0m21:12:08.824778 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:08.825277 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp211206225970'
        
      order by ordinal_position

  
[0m21:12:08.911454 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.085 seconds
[0m21:12:08.913089 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.336 seconds
[0m21:12:08.920464 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:08.923962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:08.924621 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:08.925135 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:09.004227 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.078 seconds
[0m21:12:09.019726 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:12:09.029819 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:12:09.030815 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:09.031198 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp211206225970" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp211206225970"
    )
  
[0m21:12:09.105808 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.074 seconds
[0m21:12:09.109122 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:12:09.109613 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:09.109963 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:12:09.302110 [debug] [Thread-2 (]: SQL status: COMMIT in 0.192 seconds
[0m21:12:09.302574 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.377 seconds
[0m21:12:09.303391 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:12:09.307103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:09.307602 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:09.308178 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b26a50>]}
[0m21:12:09.308960 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 3.12s]
[0m21:12:09.309624 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:12:09.609190 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.300 seconds
[0m21:12:09.613471 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:12:09.614969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:09.615342 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id")
    (
        select "user_id", "timestamp", "type_id"
        from "events_clean__dbt_tmp211206234723"
    )


  
[0m21:12:09.695253 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.079 seconds
[0m21:12:09.697220 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:12:09.697691 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:09.698046 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:12:09.815421 [debug] [Thread-1 (]: SQL status: COMMIT in 0.116 seconds
[0m21:12:09.817282 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:12:09.818646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abf800>]}
[0m21:12:09.819631 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 0[0m in 3.63s]
[0m21:12:09.820619 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:12:10.987318 [debug] [Thread-3 (]: SQL status: SELECT 0 in 4.713 seconds
[0m21:12:10.995524 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:10.996413 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:12:11.050085 [debug] [Thread-3 (]: SQL status: BEGIN in 0.053 seconds
[0m21:12:11.050718 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:11.051128 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp211206239752'
        
      order by ordinal_position

  
[0m21:12:11.157934 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.106 seconds
[0m21:12:11.162178 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:11.162675 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:11.232479 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.069 seconds
[0m21:12:11.234960 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:11.235306 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:11.310135 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.074 seconds
[0m21:12:11.311967 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:12:11.312747 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:11.313069 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency")
    (
        select "timestamp", "concurrency"
        from "trips_concurrency__dbt_tmp211206239752"
    )


  
[0m21:12:11.363969 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.051 seconds
[0m21:12:11.365782 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:12:11.366248 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:11.366606 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:12:11.419270 [debug] [Thread-3 (]: SQL status: COMMIT in 0.052 seconds
[0m21:12:11.421279 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:12:11.423602 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b880910>]}
[0m21:12:11.425013 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mINSERT 0 0[0m in 5.24s]
[0m21:12:11.426088 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:12:11.429034 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:11.429514 [debug] [MainThread]: On master: BEGIN
[0m21:12:11.429914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:12:12.128106 [debug] [MainThread]: SQL status: BEGIN in 0.698 seconds
[0m21:12:12.129449 [debug] [MainThread]: On master: COMMIT
[0m21:12:12.130101 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:12.130594 [debug] [MainThread]: On master: COMMIT
[0m21:12:12.180509 [debug] [MainThread]: SQL status: COMMIT in 0.049 seconds
[0m21:12:12.182314 [debug] [MainThread]: On master: Close
[0m21:12:12.183617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:12:12.184194 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:12:12.184424 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:12:12.184655 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:12:12.184863 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:12:12.185287 [info ] [MainThread]: 
[0m21:12:12.185655 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 11.34 seconds (11.34s).
[0m21:12:12.186837 [debug] [MainThread]: Command end result
[0m21:12:12.215420 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:12:12.216904 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:12:12.221132 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:12:12.221357 [info ] [MainThread]: 
[0m21:12:12.221588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:12:12.221754 [info ] [MainThread]: 
[0m21:12:12.221926 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:12:12.223472 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.648479, "process_in_blocks": "0", "process_kernel_time": 0.159917, "process_mem_max_rss": "139804672", "process_out_blocks": "0", "process_user_time": 1.166874}
[0m21:12:12.223738 [debug] [MainThread]: Command `dbt build` succeeded at 21:12:12.223684 after 11.65 seconds
[0m21:12:12.223952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105905a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105930850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c07230>]}
[0m21:12:12.224155 [debug] [MainThread]: Flushing usage events
[0m21:12:12.968789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:26:48.186836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057734d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6bb10>]}


============================== 21:26:48.189275 | 2850b532-b0d1-4bdc-90ff-a9d9de378982 ==============================
[0m21:26:48.189275 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:26:48.189550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -s config.materialized:incremental', 'send_anonymous_usage_stats': 'True'}
[0m21:26:48.257744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6b490>]}
[0m21:26:48.279495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b02030>]}
[0m21:26:48.280181 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:26:48.317388 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:26:48.361864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:26:48.362058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:26:48.378594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078eb450>]}
[0m21:26:48.412087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:26:48.413002 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:26:48.429516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b69e50>]}
[0m21:26:48.429742 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:26:48.430616 [info ] [MainThread]: 
[0m21:26:48.430757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:26:48.430869 [info ] [MainThread]: 
[0m21:26:48.431076 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:26:48.432613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:26:48.454899 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:26:48.455090 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:26:48.455200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:49.607635 [debug] [ThreadPool]: SQL status: SELECT 18 in 1.152 seconds
[0m21:26:49.610513 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:26:49.614649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:26:49.623464 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:26:49.624338 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:26:49.624834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:50.895904 [debug] [ThreadPool]: SQL status: BEGIN in 1.271 seconds
[0m21:26:50.897401 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:26:50.898056 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:26:50.973692 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.075 seconds
[0m21:26:50.978390 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:26:51.074880 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:26:51.090065 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:51.091683 [debug] [MainThread]: On master: BEGIN
[0m21:26:51.092371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:52.226695 [debug] [MainThread]: SQL status: BEGIN in 1.134 seconds
[0m21:26:52.228175 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:52.229246 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:26:52.316206 [debug] [MainThread]: SQL status: SELECT 17 in 0.086 seconds
[0m21:26:52.324171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7fd90>]}
[0m21:26:52.325099 [debug] [MainThread]: On master: ROLLBACK
[0m21:26:52.388845 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:52.389553 [debug] [MainThread]: On master: BEGIN
[0m21:26:52.484249 [debug] [MainThread]: SQL status: BEGIN in 0.094 seconds
[0m21:26:52.484618 [debug] [MainThread]: On master: COMMIT
[0m21:26:52.484804 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:52.484956 [debug] [MainThread]: On master: COMMIT
[0m21:26:52.525710 [debug] [MainThread]: SQL status: COMMIT in 0.041 seconds
[0m21:26:52.526107 [debug] [MainThread]: On master: Close
[0m21:26:52.529628 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:26:52.529936 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:26:52.530140 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:26:52.530326 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:26:52.530701 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:26:52.530983 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:26:52.531440 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:26:52.531758 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:26:52.532056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:26:52.532330 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:26:52.532575 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:26:52.532801 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:26:52.533003 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:26:52.533225 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:26:52.533440 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:26:52.533618 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:26:52.541823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:26:52.543968 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:26:52.545748 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:26:52.548205 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:26:52.548903 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:26:52.549113 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:26:52.549288 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:26:52.555762 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:26:52.580336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:52.580690 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:52.582106 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:52.629352 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:52.629597 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp212652564342"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m21:26:52.629753 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp212652568558"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:26:52.629928 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp212652581572"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() at time zone 'utc' as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:26:52.630103 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp212652628750"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:26:52.630238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:52.630358 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:26:52.630470 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:26:52.630593 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:26:55.420382 [debug] [Thread-2 (]: SQL status: SELECT 3 in 2.789 seconds
[0m21:26:55.437967 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:55.438532 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:26:55.519757 [debug] [Thread-2 (]: SQL status: BEGIN in 0.081 seconds
[0m21:26:55.520214 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:55.520597 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp212652628750'
        
      order by ordinal_position

  
[0m21:26:55.820981 [debug] [Thread-4 (]: SQL status: SELECT 0 in 3.190 seconds
[0m21:26:55.822044 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.301 seconds
[0m21:26:55.827062 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:55.835011 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:55.835610 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:26:55.836120 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:55.922456 [debug] [Thread-4 (]: SQL status: BEGIN in 0.085 seconds
[0m21:26:55.923999 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:55.926876 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp212652568558'
        
      order by ordinal_position

  
[0m21:26:56.022951 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.186 seconds
[0m21:26:56.046379 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:56.047007 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp212652628750'
        
      order by ordinal_position

  
[0m21:26:56.221324 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.174 seconds
[0m21:26:56.222384 [debug] [Thread-3 (]: SQL status: SELECT 0 in 3.592 seconds
[0m21:26:56.228769 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:56.232738 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:56.233341 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:56.233747 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:26:56.300592 [debug] [Thread-3 (]: SQL status: BEGIN in 0.066 seconds
[0m21:26:56.301182 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:56.301577 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp212652581572'
        
      order by ordinal_position

  
[0m21:26:56.319569 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.392 seconds
[0m21:26:56.320074 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.086 seconds
[0m21:26:56.323790 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:56.335252 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:26:56.335806 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:56.349273 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:26:56.350062 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:56.350339 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp212652628750" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp212652628750"
    )
  
[0m21:26:56.437022 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.086 seconds
[0m21:26:56.438273 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.090 seconds
[0m21:26:56.456947 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:26:56.460111 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:56.460416 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:56.460689 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:56.460948 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:26:56.528211 [debug] [Thread-2 (]: SQL status: COMMIT in 0.067 seconds
[0m21:26:56.532011 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:26:56.536398 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d875980>]}
[0m21:26:56.537211 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 4.00s]
[0m21:26:56.537878 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:26:56.623423 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.321 seconds
[0m21:26:56.624899 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.163 seconds
[0m21:26:56.630197 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:56.638818 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:26:56.639340 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:56.640160 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:56.640509 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age"
        from "trips_users__dbt_tmp212652568558"
    )


  
[0m21:26:56.704689 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.064 seconds
[0m21:26:56.707340 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:26:56.707917 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:56.708299 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:26:56.733512 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.094 seconds
[0m21:26:56.739480 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:56.739993 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:56.816381 [debug] [Thread-1 (]: SQL status: SELECT 0 in 4.186 seconds
[0m21:26:56.822426 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:56.823176 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.083 seconds
[0m21:26:56.823673 [debug] [Thread-4 (]: SQL status: COMMIT in 0.115 seconds
[0m21:26:56.824188 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:26:56.827413 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:26:56.828762 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:26:56.830593 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bab050>]}
[0m21:26:56.831056 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:56.831864 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 0[0m in 4.30s]
[0m21:26:56.832998 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency")
    (
        select "timestamp", "concurrency"
        from "trips_concurrency__dbt_tmp212652581572"
    )


  
[0m21:26:56.834225 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:26:56.894653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m21:26:56.894982 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.060 seconds
[0m21:26:56.895244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:56.896153 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:26:56.896404 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp212652564342'
        
      order by ordinal_position

  
[0m21:26:56.896682 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:56.896988 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:26:56.974496 [debug] [Thread-3 (]: SQL status: COMMIT in 0.077 seconds
[0m21:26:56.974954 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.078 seconds
[0m21:26:56.975584 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:26:56.978075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:56.978398 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:56.978699 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b43800>]}
[0m21:26:56.979090 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mINSERT 0 0[0m in 4.45s]
[0m21:26:56.979416 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:26:57.044453 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.066 seconds
[0m21:26:57.046023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:57.046216 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:57.116271 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.070 seconds
[0m21:26:57.117524 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:26:57.118120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:57.118335 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id")
    (
        select "user_id", "timestamp", "type_id"
        from "events_clean__dbt_tmp212652564342"
    )


  
[0m21:26:57.169572 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.051 seconds
[0m21:26:57.170731 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:26:57.171042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:57.171275 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:26:57.239019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.067 seconds
[0m21:26:57.239656 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:26:57.240149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d878190>]}
[0m21:26:57.240521 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 0[0m in 4.71s]
[0m21:26:57.240823 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:26:57.241682 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:57.241902 [debug] [MainThread]: On master: BEGIN
[0m21:26:57.242074 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:58.482878 [debug] [MainThread]: SQL status: BEGIN in 1.240 seconds
[0m21:26:58.484101 [debug] [MainThread]: On master: COMMIT
[0m21:26:58.484518 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:58.484877 [debug] [MainThread]: On master: COMMIT
[0m21:26:58.540121 [debug] [MainThread]: SQL status: COMMIT in 0.055 seconds
[0m21:26:58.541269 [debug] [MainThread]: On master: Close
[0m21:26:58.542790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:58.543392 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:26:58.543857 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:26:58.544344 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:26:58.544780 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:26:58.545486 [info ] [MainThread]: 
[0m21:26:58.546102 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 10.11 seconds (10.11s).
[0m21:26:58.547833 [debug] [MainThread]: Command end result
[0m21:26:58.574375 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:26:58.575858 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:26:58.579827 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:26:58.580034 [info ] [MainThread]: 
[0m21:26:58.580257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:26:58.580433 [info ] [MainThread]: 
[0m21:26:58.580618 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:26:58.582411 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.421572, "process_in_blocks": "0", "process_kernel_time": 0.15418, "process_mem_max_rss": "139591680", "process_out_blocks": "0", "process_user_time": 1.127919}
[0m21:26:58.582684 [debug] [MainThread]: Command `dbt build` succeeded at 21:26:58.582631 after 10.42 seconds
[0m21:26:58.582902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10798da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046132d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c8b230>]}
[0m21:26:58.583107 [debug] [MainThread]: Flushing usage events
[0m21:26:59.268611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:33:23.078546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052534d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674bb10>]}


============================== 21:33:23.080958 | 72dab404-9fdd-4f99-bac2-f530b99dc52a ==============================
[0m21:33:23.080958 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:33:23.081219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:33:23.146610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a4f490>]}
[0m21:33:23.166911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e2030>]}
[0m21:33:23.167541 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:33:23.204492 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:33:23.255901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:33:23.256075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:33:23.272355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cb450>]}
[0m21:33:23.304683 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:33:23.307608 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:33:23.317272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c99a0>]}
[0m21:33:23.317491 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:33:23.317640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7b3f0>]}
[0m21:33:23.318615 [info ] [MainThread]: 
[0m21:33:23.318755 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:23.318862 [info ] [MainThread]: 
[0m21:33:23.319061 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:33:23.320835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:33:23.342651 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:33:23.342856 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:33:23.342970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:25.063386 [debug] [ThreadPool]: SQL status: SELECT 20 in 1.720 seconds
[0m21:33:25.064603 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:33:25.066609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:33:25.071171 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:33:25.071499 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:33:25.071708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:26.193418 [debug] [ThreadPool]: SQL status: BEGIN in 1.122 seconds
[0m21:33:26.193928 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:33:26.194239 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:33:26.238777 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.044 seconds
[0m21:33:26.241856 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:33:26.286848 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:33:26.297636 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:26.298203 [debug] [MainThread]: On master: BEGIN
[0m21:33:26.298514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:26.924936 [debug] [MainThread]: SQL status: BEGIN in 0.626 seconds
[0m21:33:26.925436 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:26.925860 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:33:26.980425 [debug] [MainThread]: SQL status: SELECT 17 in 0.053 seconds
[0m21:33:26.985344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781dcc0>]}
[0m21:33:26.986254 [debug] [MainThread]: On master: ROLLBACK
[0m21:33:27.031326 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:27.032413 [debug] [MainThread]: On master: BEGIN
[0m21:33:27.140565 [debug] [MainThread]: SQL status: BEGIN in 0.107 seconds
[0m21:33:27.141633 [debug] [MainThread]: On master: COMMIT
[0m21:33:27.142077 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:27.142363 [debug] [MainThread]: On master: COMMIT
[0m21:33:27.187642 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:33:27.188611 [debug] [MainThread]: On master: Close
[0m21:33:27.196242 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:33:27.197021 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m21:33:27.197595 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m21:33:27.198038 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_clean
[0m21:33:27.199062 [info ] [Thread-3 (]: 3 of 17 START sql incremental model dbt.trips_concurrency ...................... [RUN]
[0m21:33:27.199815 [info ] [Thread-4 (]: 4 of 17 START sql view model dbt.trips_geom .................................... [RUN]
[0m21:33:27.200405 [info ] [Thread-1 (]: 1 of 17 START sql view model dbt.companies ..................................... [RUN]
[0m21:33:27.200999 [info ] [Thread-2 (]: 2 of 17 START sql incremental model dbt.events_clean ........................... [RUN]
[0m21:33:27.201842 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:33:27.202445 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m21:33:27.202859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.companies)
[0m21:33:27.203314 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean'
[0m21:33:27.203687 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:33:27.204038 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m21:33:27.204370 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m21:33:27.204697 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:33:27.220627 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m21:33:27.221649 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:33:27.223399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m21:33:27.225477 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:33:27.226369 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m21:33:27.226630 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_clean
[0m21:33:27.226908 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m21:33:27.227139 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:33:27.252851 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m21:33:27.263559 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:33:27.264867 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m21:33:27.266341 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:33:27.266991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:33:27.267188 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:33:27.267368 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:33:27.267521 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:33:27.267658 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m21:33:27.267796 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m21:33:27.267925 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:33:27.268048 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:33:27.268173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:27.268311 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:33:27.268452 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:33:27.268595 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:33:28.043459 [debug] [Thread-4 (]: SQL status: BEGIN in 0.775 seconds
[0m21:33:28.044894 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:33:28.045817 [debug] [Thread-3 (]: SQL status: BEGIN in 0.777 seconds
[0m21:33:28.046467 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_ohwk"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_ohwk"."scooters_raw"."trips"
  );
[0m21:33:28.047171 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:33:28.048054 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() at time zone 'utc' as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:33:28.108399 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.060 seconds
[0m21:33:28.121411 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:33:28.122090 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m21:33:28.204606 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.082 seconds
[0m21:33:28.219719 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:33:28.220464 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m21:33:28.301529 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.080 seconds
[0m21:33:28.321049 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m21:33:28.321599 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:33:28.321967 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m21:33:28.405858 [debug] [Thread-4 (]: SQL status: COMMIT in 0.083 seconds
[0m21:33:28.418342 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_geom__dbt_backup"
[0m21:33:28.425091 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:33:28.425706 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_ohwk"."dbt"."trips_geom__dbt_backup" cascade
[0m21:33:28.511905 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.085 seconds
[0m21:33:28.517169 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: Close
[0m21:33:28.523268 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108050350>]}
[0m21:33:28.524473 [info ] [Thread-4 (]: 4 of 17 OK created sql view model dbt.trips_geom ............................... [[32mCREATE VIEW[0m in 1.32s]
[0m21:33:28.525442 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m21:33:28.525953 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m21:33:28.526679 [info ] [Thread-4 (]: 5 of 17 START sql view model dbt.trips_prep .................................... [RUN]
[0m21:33:28.527388 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.trips_prep)
[0m21:33:28.527790 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m21:33:28.576210 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m21:33:28.576781 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m21:33:28.578173 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m21:33:28.578503 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:33:28.578651 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m21:33:28.578786 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:33:29.651988 [debug] [Thread-3 (]: SQL status: SELECT 10 in 1.603 seconds
[0m21:33:29.665426 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:33:29.666134 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m21:33:29.694002 [debug] [Thread-1 (]: SQL status: BEGIN in 2.425 seconds
[0m21:33:29.695105 [debug] [Thread-2 (]: SQL status: BEGIN in 2.426 seconds
[0m21:33:29.695866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:33:29.696550 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:33:29.697120 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  create view "dev_ohwk"."dbt"."companies__dbt_tmp"
    
    
  as (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_ohwk"."dbt"."scooters"
group by
    1
  );
[0m21:33:29.697736 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
  
    

  create  table "dev_ohwk"."dbt"."events_clean__dbt_tmp"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" < timestamp '2023-08-01'

  );
  
  
[0m21:33:29.702201 [debug] [Thread-4 (]: SQL status: BEGIN in 1.123 seconds
[0m21:33:29.702788 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:33:29.703267 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_ohwk"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  );
[0m21:33:29.712392 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m21:33:29.717568 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:33:29.718200 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m21:33:29.803570 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.085 seconds
[0m21:33:29.805566 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.102 seconds
[0m21:33:29.806413 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.108 seconds
[0m21:33:29.809435 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:33:29.815851 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:33:29.820058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:33:29.820702 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:33:29.821107 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m21:33:29.821504 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies" rename to "companies__dbt_backup"
[0m21:33:29.821856 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:33:29.903112 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.081 seconds
[0m21:33:29.903814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.081 seconds
[0m21:33:29.907860 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:33:29.908439 [debug] [Thread-3 (]: SQL status: COMMIT in 0.086 seconds
[0m21:33:29.913250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:33:29.913668 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m21:33:29.915344 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_concurrency__dbt_backup"
[0m21:33:29.915722 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies__dbt_tmp" rename to "companies"
[0m21:33:29.918308 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:33:29.918743 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_ohwk"."dbt"."trips_concurrency__dbt_backup" cascade
[0m21:33:29.960362 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m21:33:29.963269 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:33:29.963880 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:33:29.964337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m21:33:29.964806 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:33:29.966768 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m21:33:29.967305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:33:29.967599 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m21:33:30.005863 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.087 seconds
[0m21:33:30.008151 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:33:30.009197 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f7070>]}
[0m21:33:30.009841 [info ] [Thread-3 (]: 3 of 17 OK created sql incremental model dbt.trips_concurrency ................. [[32mSELECT 10[0m in 2.81s]
[0m21:33:30.010672 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:33:30.011246 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m21:33:30.012059 [info ] [Thread-3 (]: 6 of 17 START sql view model dbt.trips_stat_daily .............................. [RUN]
[0m21:33:30.012715 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.trips_stat_daily)
[0m21:33:30.013166 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m21:33:30.013721 [debug] [Thread-1 (]: SQL status: COMMIT in 0.046 seconds
[0m21:33:30.016668 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m21:33:30.020157 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."companies__dbt_backup"
[0m21:33:30.020658 [debug] [Thread-4 (]: SQL status: COMMIT in 0.053 seconds
[0m21:33:30.021357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:33:30.023751 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_prep__dbt_backup"
[0m21:33:30.024296 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop view if exists "dev_ohwk"."dbt"."companies__dbt_backup" cascade
[0m21:33:30.024974 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:33:30.025392 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m21:33:30.025854 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_ohwk"."dbt"."trips_prep__dbt_backup" cascade
[0m21:33:30.029482 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m21:33:30.030285 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:33:30.030598 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m21:33:30.030881 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:33:30.103881 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.078 seconds
[0m21:33:30.106960 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m21:33:30.108476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108075e50>]}
[0m21:33:30.109508 [info ] [Thread-1 (]: 1 of 17 OK created sql view model dbt.companies ................................ [[32mCREATE VIEW[0m in 2.91s]
[0m21:33:30.110497 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m21:33:30.111106 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m21:33:30.111677 [info ] [Thread-1 (]: 7 of 17 START sql view model dbt.parking_finish_stat ........................... [RUN]
[0m21:33:30.112310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.parking_finish_stat)
[0m21:33:30.112719 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m21:33:30.116239 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m21:33:30.117125 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m21:33:30.120796 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m21:33:30.122009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:33:30.122496 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m21:33:30.122817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:30.205165 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.175 seconds
[0m21:33:30.206247 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m21:33:30.206767 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c9b50>]}
[0m21:33:30.207146 [info ] [Thread-4 (]: 5 of 17 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 1.68s]
[0m21:33:30.207455 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m21:33:30.207667 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_start_stat
[0m21:33:30.207981 [info ] [Thread-4 (]: 8 of 17 START sql view model dbt.parking_start_stat ............................ [RUN]
[0m21:33:30.208322 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_start_stat)
[0m21:33:30.208534 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m21:33:30.210187 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m21:33:30.210719 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m21:33:30.212315 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m21:33:30.212688 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:33:30.212897 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m21:33:30.213065 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:33:31.011352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.888 seconds
[0m21:33:31.012480 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:33:31.013257 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  create view "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp"
    
    
  as (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
where
    st_intersects(st_transform(t.finish_point, 3857), hex.geom)
group by
    1
  );
[0m21:33:31.103641 [debug] [Thread-3 (]: SQL status: BEGIN in 1.072 seconds
[0m21:33:31.104800 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:33:31.105742 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  create view "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp"
    
    
  as (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
[0m21:33:31.109146 [debug] [Thread-4 (]: SQL status: BEGIN in 0.896 seconds
[0m21:33:31.110424 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:33:31.111269 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.097 seconds
[0m21:33:31.112078 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  create view "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp"
    
    
  as (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
where
    st_intersects(st_transform(t.start_point, 3857), hex.geom)
group by
    1
  );
[0m21:33:31.120157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:33:31.120858 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m21:33:31.205833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.084 seconds
[0m21:33:31.208242 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m21:33:31.208752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:33:31.209079 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m21:33:31.210384 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.090 seconds
[0m21:33:31.210850 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.104 seconds
[0m21:33:31.214930 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:33:31.218362 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:33:31.218857 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m21:33:31.219297 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m21:33:31.555894 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.336 seconds
[0m21:33:31.556954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.347 seconds
[0m21:33:31.557515 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m21:33:31.562391 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:33:31.565807 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup"
[0m21:33:31.567978 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:33:31.568526 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m21:33:31.569195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:33:31.569680 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:33:31.570218 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop view if exists "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m21:33:31.570714 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:33:31.618322 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m21:33:31.619051 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.048 seconds
[0m21:33:31.621170 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m21:33:31.621763 [debug] [Thread-4 (]: SQL status: COMMIT in 0.050 seconds
[0m21:33:31.627344 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m21:33:31.627824 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:33:31.630912 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_start_stat__dbt_backup"
[0m21:33:31.631362 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m21:33:31.631921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107633700>]}
[0m21:33:31.632473 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:33:31.633519 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop view if exists "dev_ohwk"."dbt"."parking_start_stat__dbt_backup" cascade
[0m21:33:31.633217 [info ] [Thread-1 (]: 7 of 17 OK created sql view model dbt.parking_finish_stat ...................... [[32mCREATE VIEW[0m in 1.52s]
[0m21:33:31.634141 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m21:33:31.634535 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies_trips
[0m21:33:31.635075 [info ] [Thread-1 (]: 9 of 17 START sql view model dbt.companies_trips ............................... [RUN]
[0m21:33:31.635775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.companies_trips)
[0m21:33:31.636193 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies_trips
[0m21:33:31.639639 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m21:33:31.640351 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies_trips
[0m21:33:31.644758 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m21:33:31.645947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:33:31.646294 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m21:33:31.646538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:31.731845 [debug] [Thread-3 (]: SQL status: COMMIT in 0.099 seconds
[0m21:33:31.732750 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.099 seconds
[0m21:33:31.735491 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup"
[0m21:33:31.737357 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: Close
[0m21:33:31.738027 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:33:31.738486 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop view if exists "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m21:33:31.739163 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799f650>]}
[0m21:33:31.740152 [info ] [Thread-4 (]: 8 of 17 OK created sql view model dbt.parking_start_stat ....................... [[32mCREATE VIEW[0m in 1.53s]
[0m21:33:31.740800 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m21:33:31.741181 [debug] [Thread-4 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:33:31.741712 [info ] [Thread-4 (]: 10 of 17 START sql incremental model dbt.revenue_daily ......................... [RUN]
[0m21:33:31.742248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.revenue_daily)
[0m21:33:31.742749 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:33:31.746319 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:33:31.747003 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:33:31.752582 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:31.752913 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp213331749256"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:33:31.753256 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:33:31.829519 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.089 seconds
[0m21:33:31.832112 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m21:33:31.833325 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799f3b0>]}
[0m21:33:31.834121 [info ] [Thread-3 (]: 6 of 17 OK created sql view model dbt.trips_stat_daily ......................... [[32mCREATE VIEW[0m in 1.82s]
[0m21:33:31.834641 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m21:33:31.834986 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat
[0m21:33:31.835623 [info ] [Thread-3 (]: 11 of 17 START sql view model dbt.trips_stat ................................... [RUN]
[0m21:33:31.836265 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.trips_stat)
[0m21:33:31.836679 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat
[0m21:33:31.839437 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m21:33:31.840076 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat
[0m21:33:31.847513 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m21:33:31.848389 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:33:31.848666 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m21:33:31.848905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:33:32.720159 [debug] [Thread-1 (]: SQL status: BEGIN in 1.073 seconds
[0m21:33:32.721141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:33:32.721908 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  create view "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
    
    
  as (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
[0m21:33:32.824334 [debug] [Thread-3 (]: SQL status: BEGIN in 0.975 seconds
[0m21:33:32.825455 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:33:32.826159 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  create view "dev_ohwk"."dbt"."trips_stat__dbt_tmp"
    
    
  as (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_ohwk"."dbt"."trips_prep"
  );
[0m21:33:32.933454 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.106 seconds
[0m21:33:32.935154 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.212 seconds
[0m21:33:32.940873 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:33:32.945233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:33:32.945841 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m21:33:32.946329 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m21:33:33.011633 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m21:33:33.015095 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:33:33.015943 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:33:33.016719 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:33:33.031485 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.084 seconds
[0m21:33:33.036984 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:33:33.037904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:33:33.038586 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:33:33.226270 [debug] [Thread-3 (]: SQL status: COMMIT in 0.209 seconds
[0m21:33:33.227453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.188 seconds
[0m21:33:33.231588 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat__dbt_backup"
[0m21:33:33.234700 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m21:33:33.235834 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:33:33.236695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:33:33.237324 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop view if exists "dev_ohwk"."dbt"."trips_stat__dbt_backup" cascade
[0m21:33:33.237928 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop view if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m21:33:33.326907 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.088 seconds
[0m21:33:33.327851 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.089 seconds
[0m21:33:33.330850 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: Close
[0m21:33:33.333178 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: Close
[0m21:33:33.334934 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d17cb0>]}
[0m21:33:33.335646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d718b0>]}
[0m21:33:33.336568 [info ] [Thread-3 (]: 11 of 17 OK created sql view model dbt.trips_stat .............................. [[32mCREATE VIEW[0m in 1.50s]
[0m21:33:33.337447 [info ] [Thread-1 (]: 9 of 17 OK created sql view model dbt.companies_trips .......................... [[32mCREATE VIEW[0m in 1.70s]
[0m21:33:33.338351 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat
[0m21:33:33.339088 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies_trips
[0m21:33:33.339642 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_users
[0m21:33:33.340434 [info ] [Thread-3 (]: 12 of 17 START sql incremental model dbt.trips_users ........................... [RUN]
[0m21:33:33.341033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m21:33:33.343289 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:33:33.352067 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:33:33.353402 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_users
[0m21:33:33.356810 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:33:33.357505 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:33:33.357770 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:33:33.358011 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:33:33.428474 [debug] [Thread-4 (]: SQL status: SELECT 3 in 1.675 seconds
[0m21:33:33.445876 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:33.446324 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:33:33.771598 [debug] [Thread-4 (]: SQL status: BEGIN in 0.325 seconds
[0m21:33:33.773046 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:33.774221 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp213331749256'
        
      order by ordinal_position

  
[0m21:33:34.094143 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.319 seconds
[0m21:33:34.103850 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:34.104682 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:33:34.231856 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.126 seconds
[0m21:33:34.253223 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:34.253834 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp213331749256'
        
      order by ordinal_position

  
[0m21:33:34.424067 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.169 seconds
[0m21:33:34.432584 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:34.434854 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:33:34.528629 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.093 seconds
[0m21:33:34.546182 [debug] [Thread-4 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:33:34.559374 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:33:34.560187 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:34.560489 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp213331749256" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp213331749256"
    )
  
[0m21:33:35.239476 [debug] [Thread-4 (]: SQL status: INSERT 0 3 in 0.679 seconds
[0m21:33:35.240532 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:33:35.240786 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:35.240981 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:33:35.722827 [debug] [Thread-4 (]: SQL status: COMMIT in 0.481 seconds
[0m21:33:35.724037 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:33:35.725031 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799cef0>]}
[0m21:33:35.725832 [info ] [Thread-4 (]: 10 of 17 OK created sql incremental model dbt.revenue_daily .................... [[32mINSERT 0 3[0m in 3.98s]
[0m21:33:35.726618 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:33:35.922384 [debug] [Thread-2 (]: SQL status: SELECT 221370 in 6.223 seconds
[0m21:33:35.929240 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:33:35.929877 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean" rename to "events_clean__dbt_backup"
[0m21:33:36.004360 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.074 seconds
[0m21:33:36.010378 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:33:36.010979 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean__dbt_tmp" rename to "events_clean"
[0m21:33:36.124310 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.112 seconds
[0m21:33:36.125270 [debug] [Thread-3 (]: SQL status: BEGIN in 2.767 seconds
[0m21:33:36.127894 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:33:36.128606 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:33:36.129293 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:33:36.129769 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_users__dbt_tmp"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

      where
          t.id <= 75000

  );
  
  
[0m21:33:36.130209 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:33:36.427293 [debug] [Thread-2 (]: SQL status: COMMIT in 0.296 seconds
[0m21:33:36.431391 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."events_clean__dbt_backup"
[0m21:33:36.432396 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:33:36.432930 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
drop table if exists "dev_ohwk"."dbt"."events_clean__dbt_backup" cascade
[0m21:33:36.549170 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.115 seconds
[0m21:33:36.553187 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: Close
[0m21:33:36.554868 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799f050>]}
[0m21:33:36.556092 [info ] [Thread-2 (]: 2 of 17 OK created sql incremental model dbt.events_clean ...................... [[32mSELECT 221370[0m in 9.35s]
[0m21:33:36.557098 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_clean
[0m21:33:36.558163 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_full
[0m21:33:36.559267 [info ] [Thread-1 (]: 13 of 17 START sql view model dbt.events_full .................................. [RUN]
[0m21:33:36.560213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.events_full)
[0m21:33:36.560728 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_full
[0m21:33:36.566452 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m21:33:36.568666 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_full
[0m21:33:36.572055 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m21:33:36.573004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:33:36.573431 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: BEGIN
[0m21:33:36.573744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:38.613899 [debug] [Thread-1 (]: SQL status: BEGIN in 2.040 seconds
[0m21:33:38.615383 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:33:38.615992 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_ohwk"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_ohwk"."dbt"."events_clean"
    left join "dev_ohwk"."dbt"."event_types"
        using (type_id)
  );
[0m21:33:40.144276 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 1.527 seconds
[0m21:33:40.145885 [debug] [Thread-3 (]: SQL status: SELECT 75000 in 4.015 seconds
[0m21:33:40.151311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:33:40.155385 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:33:40.155894 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m21:33:40.156574 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users" rename to "trips_users__dbt_backup"
[0m21:33:40.809211 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.652 seconds
[0m21:33:40.810838 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.654 seconds
[0m21:33:40.815860 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:33:40.817931 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m21:33:40.818674 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users__dbt_tmp" rename to "trips_users"
[0m21:33:40.819151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:33:40.819658 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m21:33:40.891329 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.072 seconds
[0m21:33:40.891981 [debug] [Thread-1 (]: SQL status: COMMIT in 0.072 seconds
[0m21:33:40.894258 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:33:40.899265 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."events_full__dbt_backup"
[0m21:33:40.899975 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:33:40.900744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:33:40.901318 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:33:40.901757 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_ohwk"."dbt"."events_full__dbt_backup" cascade
[0m21:33:40.966294 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.064 seconds
[0m21:33:40.967105 [debug] [Thread-3 (]: SQL status: COMMIT in 0.065 seconds
[0m21:33:40.969817 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: Close
[0m21:33:40.973631 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_users__dbt_backup"
[0m21:33:40.974814 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:33:40.975537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107896630>]}
[0m21:33:40.976041 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
drop table if exists "dev_ohwk"."dbt"."trips_users__dbt_backup" cascade
[0m21:33:40.976948 [info ] [Thread-1 (]: 13 of 17 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 4.42s]
[0m21:33:40.977914 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_full
[0m21:33:40.978704 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m21:33:40.979256 [info ] [Thread-4 (]: 14 of 17 START sql view model dbt.events_stat .................................. [RUN]
[0m21:33:40.979804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.events_stat)
[0m21:33:40.980249 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m21:33:40.983707 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m21:33:40.984970 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m21:33:40.988952 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m21:33:40.989845 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:33:40.990447 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m21:33:40.990875 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:33:41.042424 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.065 seconds
[0m21:33:41.044553 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: Close
[0m21:33:41.045871 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799f8f0>]}
[0m21:33:41.046765 [info ] [Thread-3 (]: 12 of 17 OK created sql incremental model dbt.trips_users ...................... [[32mSELECT 75000[0m in 7.70s]
[0m21:33:41.047422 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_users
[0m21:33:41.048037 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_daily
[0m21:33:41.048494 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_group
[0m21:33:41.048949 [info ] [Thread-2 (]: 15 of 17 START sql view model dbt.trips_age_daily .............................. [RUN]
[0m21:33:41.049471 [info ] [Thread-1 (]: 16 of 17 START sql view model dbt.trips_age_group .............................. [RUN]
[0m21:33:41.049911 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.trips_age_daily)
[0m21:33:41.050270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_age_group)
[0m21:33:41.050584 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m21:33:41.050882 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m21:33:41.053397 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m21:33:41.055737 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m21:33:41.056403 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_group
[0m21:33:41.056697 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m21:33:41.059514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m21:33:41.061686 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m21:33:41.062299 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:33:41.062592 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:33:41.062809 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m21:33:41.063037 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m21:33:41.063265 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:33:41.063488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:41.937887 [debug] [Thread-4 (]: SQL status: BEGIN in 0.947 seconds
[0m21:33:41.939212 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:33:41.940085 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  create view "dev_ohwk"."dbt"."events_stat__dbt_tmp"
    
    
  as (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_ohwk"."dbt"."events_full"
  );
[0m21:33:42.004876 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.063 seconds
[0m21:33:42.012700 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:33:42.013548 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_ohwk"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m21:33:42.110235 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.096 seconds
[0m21:33:42.111481 [debug] [Thread-2 (]: SQL status: BEGIN in 1.048 seconds
[0m21:33:42.114264 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m21:33:42.114864 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:33:42.115221 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:33:42.115529 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  create view "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp"
    
    
  as (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users"
group by
    1,
    2
  );
[0m21:33:42.115932 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m21:33:42.295218 [debug] [Thread-4 (]: SQL status: COMMIT in 0.178 seconds
[0m21:33:42.296427 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.180 seconds
[0m21:33:42.301053 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."events_stat__dbt_backup"
[0m21:33:42.312969 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:33:42.313648 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:33:42.314095 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m21:33:42.314486 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop view if exists "dev_ohwk"."dbt"."events_stat__dbt_backup" cascade
[0m21:33:42.375029 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.060 seconds
[0m21:33:42.376082 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.061 seconds
[0m21:33:42.378746 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:33:42.381155 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m21:33:42.381758 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:33:42.382355 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:33:42.383216 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108037b30>]}
[0m21:33:42.384167 [info ] [Thread-4 (]: 14 of 17 OK created sql view model dbt.events_stat ............................. [[32mCREATE VIEW[0m in 1.40s]
[0m21:33:42.385023 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m21:33:42.447778 [debug] [Thread-2 (]: SQL status: COMMIT in 0.065 seconds
[0m21:33:42.451180 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily__dbt_backup"
[0m21:33:42.451959 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:33:42.452362 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_daily__dbt_backup" cascade
[0m21:33:42.546560 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.093 seconds
[0m21:33:42.549936 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: Close
[0m21:33:42.551611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108037290>]}
[0m21:33:42.552740 [info ] [Thread-2 (]: 15 of 17 OK created sql view model dbt.trips_age_daily ......................... [[32mCREATE VIEW[0m in 1.50s]
[0m21:33:42.553582 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m21:33:42.554448 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m21:33:42.555086 [info ] [Thread-3 (]: 17 of 17 START sql view model dbt.trips_age_daily_stat ......................... [RUN]
[0m21:33:42.555759 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily_stat)
[0m21:33:42.556214 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m21:33:42.561033 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:42.562204 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m21:33:42.566544 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:42.567348 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:42.567674 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m21:33:42.567973 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:33:44.602909 [debug] [Thread-1 (]: SQL status: BEGIN in 3.539 seconds
[0m21:33:44.604345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:33:44.604878 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  create view "dev_ohwk"."dbt"."trips_age_group__dbt_tmp"
    
    
  as (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users" as tu
    cross join "dev_ohwk"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
[0m21:33:44.761610 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.156 seconds
[0m21:33:44.766969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:33:44.767637 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m21:33:44.851748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.083 seconds
[0m21:33:44.854401 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:33:44.854996 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:33:44.855538 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:33:44.919949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.063 seconds
[0m21:33:44.925217 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_group__dbt_backup"
[0m21:33:44.926397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:33:44.927199 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_group__dbt_backup" cascade
[0m21:33:44.992987 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.065 seconds
[0m21:33:44.995283 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: Close
[0m21:33:44.996193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108037e90>]}
[0m21:33:44.997088 [info ] [Thread-1 (]: 16 of 17 OK created sql view model dbt.trips_age_group ......................... [[32mCREATE VIEW[0m in 3.95s]
[0m21:33:44.997923 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_group
[0m21:33:45.946513 [debug] [Thread-3 (]: SQL status: BEGIN in 3.378 seconds
[0m21:33:45.947703 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:45.948436 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  create view "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp"
    
    
  as (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_ohwk"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
[0m21:33:46.015811 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.066 seconds
[0m21:33:46.025029 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:46.025864 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m21:33:46.102188 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.075 seconds
[0m21:33:46.105719 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:33:46.106530 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:46.107151 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:33:46.170879 [debug] [Thread-3 (]: SQL status: COMMIT in 0.063 seconds
[0m21:33:46.176741 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup"
[0m21:33:46.177643 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:46.178123 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m21:33:46.238134 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.059 seconds
[0m21:33:46.242273 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m21:33:46.244052 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080354f0>]}
[0m21:33:46.245271 [info ] [Thread-3 (]: 17 of 17 OK created sql view model dbt.trips_age_daily_stat .................... [[32mCREATE VIEW[0m in 3.69s]
[0m21:33:46.246308 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m21:33:46.248961 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:46.249425 [debug] [MainThread]: On master: BEGIN
[0m21:33:46.249813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:33:47.001376 [debug] [MainThread]: SQL status: BEGIN in 0.751 seconds
[0m21:33:47.002464 [debug] [MainThread]: On master: COMMIT
[0m21:33:47.003108 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:47.003632 [debug] [MainThread]: On master: COMMIT
[0m21:33:47.048978 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:33:47.049964 [debug] [MainThread]: On master: Close
[0m21:33:47.052070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:47.052600 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m21:33:47.052976 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m21:33:47.053313 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m21:33:47.053713 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m21:33:47.054407 [info ] [MainThread]: 
[0m21:33:47.054896 [info ] [MainThread]: Finished running 4 incremental models, 13 view models in 0 hours 0 minutes and 23.74 seconds (23.74s).
[0m21:33:47.058541 [debug] [MainThread]: Command end result
[0m21:33:47.086908 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:33:47.088428 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:33:47.092830 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:33:47.093036 [info ] [MainThread]: 
[0m21:33:47.093257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:33:47.093432 [info ] [MainThread]: 
[0m21:33:47.093609 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=17
[0m21:33:47.095390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.04306, "process_in_blocks": "0", "process_kernel_time": 0.234516, "process_mem_max_rss": "140722176", "process_out_blocks": "0", "process_user_time": 1.72513}
[0m21:33:47.095726 [debug] [MainThread]: Command `dbt run` succeeded at 21:33:47.095660 after 24.04 seconds
[0m21:33:47.095971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817b770>]}
[0m21:33:47.096197 [debug] [MainThread]: Flushing usage events
[0m21:33:47.928626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:13.719039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f574d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744fb10>]}


============================== 21:51:13.721488 | 81739301-6de8-4cd8-8871-7573ccea6d92 ==============================
[0m21:51:13.721488 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:51:13.721751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt show -s trips_prep', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:51:13.788484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81739301-6de8-4cd8-8871-7573ccea6d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106753490>]}
[0m21:51:13.810184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81739301-6de8-4cd8-8871-7573ccea6d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e6030>]}
[0m21:51:13.819863 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:51:13.859009 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:51:13.913338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:51:13.913534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:51:13.930414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81739301-6de8-4cd8-8871-7573ccea6d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817af50>]}
[0m21:51:13.962296 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:51:13.963526 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:51:13.965088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81739301-6de8-4cd8-8871-7573ccea6d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801a3f0>]}
[0m21:51:13.965293 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:51:13.965443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81739301-6de8-4cd8-8871-7573ccea6d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2c2f0>]}
[0m21:51:13.966150 [info ] [MainThread]: 
[0m21:51:13.966298 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:51:13.966403 [info ] [MainThread]: 
[0m21:51:13.966601 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:51:13.968548 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_dbt'
[0m21:51:13.991723 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:51:13.991951 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:51:13.992083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:15.032424 [debug] [ThreadPool]: SQL status: BEGIN in 1.040 seconds
[0m21:51:15.033977 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:51:15.035110 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:51:15.102644 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.066 seconds
[0m21:51:15.116031 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:51:15.161531 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:51:15.165723 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:15.165893 [debug] [MainThread]: On master: BEGIN
[0m21:51:15.166014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:16.330595 [debug] [MainThread]: SQL status: BEGIN in 1.164 seconds
[0m21:51:16.332186 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:16.333283 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:51:16.507455 [debug] [MainThread]: SQL status: SELECT 17 in 0.173 seconds
[0m21:51:16.517778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81739301-6de8-4cd8-8871-7573ccea6d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839d4a0>]}
[0m21:51:16.518448 [debug] [MainThread]: On master: ROLLBACK
[0m21:51:16.561772 [debug] [MainThread]: On master: Close
[0m21:51:16.569176 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m21:51:16.570049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.trips_prep)
[0m21:51:16.570615 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m21:51:16.580138 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m21:51:16.581216 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m21:51:16.587008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:51:16.587328 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  
  select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  
  limit 5

[0m21:51:16.587601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:17.314531 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.726 seconds
[0m21:51:17.323673 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m21:51:17.325336 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m21:51:17.327357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:17.327921 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_prep' was properly closed.
[0m21:51:17.328716 [debug] [MainThread]: Command end result
[0m21:51:17.352391 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:51:17.353537 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:51:17.357560 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:51:17.358117 [info ] [MainThread]: Previewing node 'trips_prep':
| id | user_id | scooter_hw_id   |           started_at |          finished_at | start_lat | ... |
| -- | ------- | --------------- | -------------------- | -------------------- | --------- | --- |
|  1 |    1393 | GT-GXLV2-99D4   | 2023-06-01 03:06:... | 2023-06-01 03:24:... |   55.761… | ... |
|  2 |    1987 | XM-1S-56D8X     | 2023-06-01 03:27:... | 2023-06-01 03:53:... |   55.743… | ... |
|  3 |     981 | SN-ES2-82XF4    | 2023-06-01 03:32:... | 2023-06-01 04:05:... |   55.762… | ... |
|  4 |    1629 | SN-MAXG30-56D2G | 2023-06-01 03:36:... | 2023-06-01 04:00:... |   55.743… | ... |
|  5 |     602 | SN-MAXG30-56D2G | 2023-06-01 03:42:... | 2023-06-01 04:10:... |   55.732… | ... |

[0m21:51:17.359831 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 3.666701, "process_in_blocks": "0", "process_kernel_time": 0.138045, "process_mem_max_rss": "133611520", "process_out_blocks": "0", "process_user_time": 0.825505}
[0m21:51:17.360102 [debug] [MainThread]: Command `dbt show` succeeded at 21:51:17.360050 after 3.67 seconds
[0m21:51:17.360312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108535e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108535ff0>]}
[0m21:51:17.360505 [debug] [MainThread]: Flushing usage events
[0m21:51:18.013619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:52:33.552147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11080f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112627b10>]}


============================== 21:52:33.554545 | a4743445-06b5-4e72-a575-ec2d82ec6851 ==============================
[0m21:52:33.554545 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:52:33.554807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt show -s trips_prep --output json', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:52:33.620036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4743445-06b5-4e72-a575-ec2d82ec6851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c2b490>]}
[0m21:52:33.641533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4743445-06b5-4e72-a575-ec2d82ec6851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123be030>]}
[0m21:52:33.650116 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:52:33.688205 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:52:33.741378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:52:33.741554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:52:33.758714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4743445-06b5-4e72-a575-ec2d82ec6851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134a6f50>]}
[0m21:52:33.791560 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:52:33.793596 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:52:33.795022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4743445-06b5-4e72-a575-ec2d82ec6851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133463f0>]}
[0m21:52:33.795194 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:52:33.795330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4743445-06b5-4e72-a575-ec2d82ec6851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b5c2f0>]}
[0m21:52:33.796023 [info ] [MainThread]: 
[0m21:52:33.796182 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:52:33.796286 [info ] [MainThread]: 
[0m21:52:33.796478 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:52:33.798268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_dbt'
[0m21:52:33.821158 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:52:33.821358 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:52:33.821472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:34.595686 [debug] [ThreadPool]: SQL status: BEGIN in 0.774 seconds
[0m21:52:34.597006 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:52:34.597683 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:52:34.644152 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.046 seconds
[0m21:52:34.648484 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:52:34.691516 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:52:34.705874 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:34.706388 [debug] [MainThread]: On master: BEGIN
[0m21:52:34.706716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:52:35.418923 [debug] [MainThread]: SQL status: BEGIN in 0.712 seconds
[0m21:52:35.420391 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:35.421662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:52:36.092607 [debug] [MainThread]: SQL status: SELECT 17 in 0.670 seconds
[0m21:52:36.100138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4743445-06b5-4e72-a575-ec2d82ec6851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136c54a0>]}
[0m21:52:36.100846 [debug] [MainThread]: On master: ROLLBACK
[0m21:52:36.145934 [debug] [MainThread]: On master: Close
[0m21:52:36.153885 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m21:52:36.154816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.trips_prep)
[0m21:52:36.155469 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m21:52:36.166125 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m21:52:36.167179 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m21:52:36.173726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:52:36.174082 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  
  select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  
  limit 5

[0m21:52:36.174363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:36.860952 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.686 seconds
[0m21:52:36.869941 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m21:52:36.872126 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m21:52:36.874495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:36.875011 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_prep' was properly closed.
[0m21:52:36.876141 [debug] [MainThread]: Command end result
[0m21:52:36.905067 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:52:36.906451 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:52:36.910573 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:52:36.911078 [info ] [MainThread]: {
  "node": "trips_prep",
  "show": [
    {
      "id": 1,
      "user_id": 1393,
      "scooter_hw_id": "GT-GXLV2-99D4",
      "started_at": "2023-06-01T03:06:02+00:00",
      "finished_at": "2023-06-01T03:24:49+00:00",
      "start_lat": 55.76074980015,
      "start_lon": 37.613998000366,
      "finish_lat": 55.771709800018,
      "finish_lon": 37.618098300294,
      "distance_m": 1644.9869999999992,
      "price_rub": 0.0,
      "duration_s": 1127.0,
      "is_free": true,
      "date": "2023-06-01"
    },
    {
      "id": 2,
      "user_id": 1987,
      "scooter_hw_id": "XM-1S-56D8X",
      "started_at": "2023-06-01T03:27:24+00:00",
      "finished_at": "2023-06-01T03:53:51+00:00",
      "start_lat": 55.742680999971,
      "start_lon": 37.651061899694,
      "finish_lat": 55.737762199979,
      "finish_lon": 37.601283200021,
      "distance_m": 4430.513000000002,
      "price_rub": 0.0,
      "duration_s": 1587.0,
      "is_free": true,
      "date": "2023-06-01"
    },
    {
      "id": 3,
      "user_id": 981,
      "scooter_hw_id": "SN-ES2-82XF4",
      "started_at": "2023-06-01T03:32:32+00:00",
      "finished_at": "2023-06-01T04:05:32+00:00",
      "start_lat": 55.761562000052,
      "start_lon": 37.642958999712,
      "finish_lat": 55.749707300062,
      "finish_lon": 37.589230200223,
      "distance_m": 4473.652999999999,
      "price_rub": 0.0,
      "duration_s": 1980.0,
      "is_free": true,
      "date": "2023-06-01"
    },
    {
      "id": 4,
      "user_id": 1629,
      "scooter_hw_id": "SN-MAXG30-56D2G",
      "started_at": "2023-06-01T03:36:45+00:00",
      "finished_at": "2023-06-01T04:00:30+00:00",
      "start_lat": 55.74342999992,
      "start_lon": 37.590625999817,
      "finish_lat": 55.735751999836,
      "finish_lon": 37.614239000391,
      "distance_m": 2506.7030000000004,
      "price_rub": 237.5,
      "duration_s": 1425.0,
      "is_free": false,
      "date": "2023-06-01"
    },
    {
      "id": 5,
      "user_id": 602,
      "scooter_hw_id": "SN-MAXG30-56D2G",
      "started_at": "2023-06-01T03:42:08+00:00",
      "finished_at": "2023-06-01T04:10:24+00:00",
      "start_lat": 55.7316526,
      "start_lon": 37.623907,
      "finish_lat": 55.769427999931,
      "finish_lon": 37.623846999784,
      "distance_m": 4883.543000000001,
      "price_rub": 0.0,
      "duration_s": 1696.0,
      "is_free": true,
      "date": "2023-06-01"
    }
  ]
}
[0m21:52:36.912866 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 3.3870766, "process_in_blocks": "0", "process_kernel_time": 0.134818, "process_mem_max_rss": "134119424", "process_out_blocks": "0", "process_user_time": 0.840605}
[0m21:52:36.913136 [debug] [MainThread]: Command `dbt show` succeeded at 21:52:36.913084 after 3.39 seconds
[0m21:52:36.913349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112504dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114061ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114061f40>]}
[0m21:52:36.913549 [debug] [MainThread]: Flushing usage events
[0m21:52:37.549924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:53:18.097054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c9f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c9fb10>]}


============================== 21:53:18.098843 | cb3e2d83-31ef-4c77-afff-8106497b70be ==============================
[0m21:53:18.098843 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:53:18.099115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': "dbt show --inline select current_setting('TIMEZONE')", 'send_anonymous_usage_stats': 'True'}
[0m21:53:18.162951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb3e2d83-31ef-4c77-afff-8106497b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9f490>]}
[0m21:53:18.184695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb3e2d83-31ef-4c77-afff-8106497b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b36030>]}
[0m21:53:18.189577 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:53:18.223082 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:53:18.267579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:53:18.267751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:53:18.284095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb3e2d83-31ef-4c77-afff-8106497b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099caf50>]}
[0m21:53:18.315687 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:53:18.316531 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:53:18.366377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb3e2d83-31ef-4c77-afff-8106497b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3fa70>]}
[0m21:53:18.366582 [info ] [MainThread]: Found 17 models, 3 seeds, 1 sql operation, 17 sources, 435 macros
[0m21:53:18.366728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb3e2d83-31ef-4c77-afff-8106497b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cc1c50>]}
[0m21:53:18.367536 [info ] [MainThread]: 
[0m21:53:18.367687 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:53:18.367797 [info ] [MainThread]: 
[0m21:53:18.367986 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:53:18.369833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_dbt'
[0m21:53:18.388145 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:53:18.388335 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:53:18.388448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:19.953330 [debug] [ThreadPool]: SQL status: BEGIN in 1.564 seconds
[0m21:53:19.954968 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:53:19.956021 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:53:20.004193 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.047 seconds
[0m21:53:20.009947 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:53:20.059858 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:53:20.074373 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:20.074908 [debug] [MainThread]: On master: BEGIN
[0m21:53:20.075177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:53:20.701954 [debug] [MainThread]: SQL status: BEGIN in 0.627 seconds
[0m21:53:20.702764 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:20.703244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:53:21.060749 [debug] [MainThread]: SQL status: SELECT 17 in 0.357 seconds
[0m21:53:21.067264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb3e2d83-31ef-4c77-afff-8106497b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd8120>]}
[0m21:53:21.067888 [debug] [MainThread]: On master: ROLLBACK
[0m21:53:21.111813 [debug] [MainThread]: On master: Close
[0m21:53:21.115900 [debug] [Thread-1 (]: Began running node sql_operation.dbt_scooters.inline_query
[0m21:53:21.116574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now sql_operation.dbt_scooters.inline_query)
[0m21:53:21.117104 [debug] [Thread-1 (]: Began compiling node sql_operation.dbt_scooters.inline_query
[0m21:53:21.156891 [debug] [Thread-1 (]: Writing injected SQL for node "sql_operation.dbt_scooters.inline_query"
[0m21:53:21.157540 [debug] [Thread-1 (]: Began executing node sql_operation.dbt_scooters.inline_query
[0m21:53:21.160361 [debug] [Thread-1 (]: Using postgres connection "sql_operation.dbt_scooters.inline_query"
[0m21:53:21.160550 [debug] [Thread-1 (]: On sql_operation.dbt_scooters.inline_query: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "sql_operation.dbt_scooters.inline_query"} */

  
  select current_setting('TIMEZONE')
  
  limit 5

[0m21:53:21.160684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:21.776228 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.615 seconds
[0m21:53:21.782399 [debug] [Thread-1 (]: On sql_operation.dbt_scooters.inline_query: Close
[0m21:53:21.784157 [debug] [Thread-1 (]: Finished running node sql_operation.dbt_scooters.inline_query
[0m21:53:21.785814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:53:21.786179 [debug] [MainThread]: Connection 'sql_operation.dbt_scooters.inline_query' was properly closed.
[0m21:53:21.786904 [debug] [MainThread]: Command end result
[0m21:53:21.807562 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:53:21.808678 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:53:21.812703 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:53:21.812953 [info ] [MainThread]: Previewing inline node:
| current_setting |
| --------------- |
| UTC             |

[0m21:53:21.813864 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 3.7424076, "process_in_blocks": "0", "process_kernel_time": 0.109746, "process_mem_max_rss": "136232960", "process_out_blocks": "0", "process_user_time": 0.89293}
[0m21:53:21.814105 [debug] [MainThread]: Command `dbt show` succeeded at 21:53:21.814058 after 3.74 seconds
[0m21:53:21.814300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca2af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca2c50>]}
[0m21:53:21.814484 [debug] [MainThread]: Flushing usage events
[0m21:53:22.357764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:54:55.635469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f434d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10543b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10543bb10>]}


============================== 21:54:55.637209 | 183b4641-0f0d-43d5-9005-1a4ba045c63a ==============================
[0m21:54:55.637209 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:54:55.637484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -s config.materialized:incremental --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:54:55.698904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10473f490>]}
[0m21:54:55.719249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d2030>]}
[0m21:54:55.719581 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:54:55.752708 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:54:55.795940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:54:55.796145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:54:55.814149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bb450>]}
[0m21:54:55.846024 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:54:55.846913 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:54:55.859520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106339e50>]}
[0m21:54:55.859737 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:54:55.860602 [info ] [MainThread]: 
[0m21:54:55.860743 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:54:55.860856 [info ] [MainThread]: 
[0m21:54:55.861057 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:54:55.862560 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:54:55.880197 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:54:55.880380 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:54:55.880491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:56.746155 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.865 seconds
[0m21:54:56.751275 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:54:56.756004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:54:56.763798 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:54:56.764345 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:54:56.764610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:54:57.380069 [debug] [ThreadPool]: SQL status: BEGIN in 0.615 seconds
[0m21:54:57.381584 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:54:57.382697 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:54:57.430159 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.046 seconds
[0m21:54:57.435442 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:54:57.478061 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:54:57.493077 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:57.493655 [debug] [MainThread]: On master: BEGIN
[0m21:54:57.493931 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:58.481110 [debug] [MainThread]: SQL status: BEGIN in 0.987 seconds
[0m21:54:58.482724 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:58.484026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:54:58.708390 [debug] [MainThread]: SQL status: SELECT 17 in 0.223 seconds
[0m21:54:58.720603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106352970>]}
[0m21:54:58.721407 [debug] [MainThread]: On master: ROLLBACK
[0m21:54:58.766864 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:58.767977 [debug] [MainThread]: On master: BEGIN
[0m21:54:58.857564 [debug] [MainThread]: SQL status: BEGIN in 0.089 seconds
[0m21:54:58.858700 [debug] [MainThread]: On master: COMMIT
[0m21:54:58.859710 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:58.860576 [debug] [MainThread]: On master: COMMIT
[0m21:54:58.904812 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m21:54:58.905908 [debug] [MainThread]: On master: Close
[0m21:54:58.914266 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:54:58.914795 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:54:58.915231 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:54:58.915635 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:54:58.916320 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:54:58.916891 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:54:58.917494 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:54:58.918061 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:54:58.918641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:54:58.919181 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:54:58.919856 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:54:58.920687 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:54:58.921141 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:54:58.921529 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:54:58.921886 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:54:58.922216 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:54:58.939181 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:54:58.940230 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:54:58.942340 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:54:58.944660 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:54:58.946234 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:54:58.946413 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:54:58.946566 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:54:58.946733 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:54:59.011402 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:54:59.011688 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:54:59.013220 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:54:59.014379 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:54:59.014538 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215458995907"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:54:59.014850 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:54:59.015182 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:54:59.015378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:54:59.015522 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:54:59.015650 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:54:59.015771 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:54:59.015886 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:54:59.016004 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:54:59.016118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:59.016228 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:54:59.787086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.770 seconds
[0m21:54:59.788951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:54:59.790268 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
  
    

  create  table "dev_ohwk"."dbt"."events_clean__dbt_tmp"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" < timestamp '2023-08-01'

  );
  
  
[0m21:55:00.802695 [debug] [Thread-4 (]: SQL status: BEGIN in 1.786 seconds
[0m21:55:00.804357 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:00.805576 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_users__dbt_tmp"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

      where
          t.id <= 75000

  );
  
  
[0m21:55:01.003552 [debug] [Thread-3 (]: SQL status: BEGIN in 1.987 seconds
[0m21:55:01.004221 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:01.004719 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:55:02.304592 [debug] [Thread-2 (]: SQL status: SELECT 3 in 3.289 seconds
[0m21:55:02.324910 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:02.325469 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:55:02.737017 [debug] [Thread-2 (]: SQL status: BEGIN in 0.411 seconds
[0m21:55:02.737968 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:02.738633 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215458995907'
        
      order by ordinal_position

  
[0m21:55:03.300965 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.561 seconds
[0m21:55:03.309781 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:03.310512 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:03.603953 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.292 seconds
[0m21:55:03.624408 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:03.625044 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215458995907'
        
      order by ordinal_position

  
[0m21:55:04.010289 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.384 seconds
[0m21:55:04.017546 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:04.018434 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:04.246396 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.227 seconds
[0m21:55:04.260647 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:55:04.268488 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:55:04.280230 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:55:04.281023 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:04.281317 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215458995907" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215458995907"
    )
  
[0m21:55:04.442607 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.160 seconds
[0m21:55:04.443778 [debug] [Thread-3 (]: SQL status: SELECT 10 in 3.438 seconds
[0m21:55:04.470472 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:55:04.474300 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:04.474638 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:04.474942 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m21:55:04.475207 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:55:04.571087 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m21:55:04.577448 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:04.578084 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m21:55:04.649605 [debug] [Thread-2 (]: SQL status: COMMIT in 0.174 seconds
[0m21:55:04.654060 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:55:04.657460 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f4e8f0>]}
[0m21:55:04.658662 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 5.74s]
[0m21:55:04.659379 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:55:04.703287 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.124 seconds
[0m21:55:04.708679 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:55:04.709207 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:04.709580 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:55:04.904804 [debug] [Thread-3 (]: SQL status: COMMIT in 0.195 seconds
[0m21:55:04.915596 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_concurrency__dbt_backup"
[0m21:55:04.921821 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:04.922300 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_ohwk"."dbt"."trips_concurrency__dbt_backup" cascade
[0m21:55:05.103903 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.181 seconds
[0m21:55:05.108189 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:55:05.109669 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106386990>]}
[0m21:55:05.110729 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mSELECT 10[0m in 6.19s]
[0m21:55:05.111588 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:55:08.244462 [debug] [Thread-4 (]: SQL status: SELECT 75000 in 7.437 seconds
[0m21:55:08.251391 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:08.251934 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users" rename to "trips_users__dbt_backup"
[0m21:55:08.300316 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m21:55:08.306379 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:08.307011 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users__dbt_tmp" rename to "trips_users"
[0m21:55:08.354312 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m21:55:08.358523 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:55:08.359641 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:08.360630 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:55:08.505095 [debug] [Thread-4 (]: SQL status: COMMIT in 0.143 seconds
[0m21:55:08.512076 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_users__dbt_backup"
[0m21:55:08.512928 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:08.513331 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
drop table if exists "dev_ohwk"."dbt"."trips_users__dbt_backup" cascade
[0m21:55:08.705526 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.191 seconds
[0m21:55:08.710722 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:55:08.712558 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630b8b0>]}
[0m21:55:08.713477 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mSELECT 75000[0m in 9.79s]
[0m21:55:08.714079 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:55:09.094386 [debug] [Thread-1 (]: SQL status: SELECT 221370 in 9.303 seconds
[0m21:55:09.104219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:09.104752 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean" rename to "events_clean__dbt_backup"
[0m21:55:09.147186 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.042 seconds
[0m21:55:09.152775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:09.153339 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean__dbt_tmp" rename to "events_clean"
[0m21:55:09.195813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.042 seconds
[0m21:55:09.199164 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:55:09.199848 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:09.200404 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:55:09.244172 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m21:55:09.246901 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."events_clean__dbt_backup"
[0m21:55:09.247504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:09.247880 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
drop table if exists "dev_ohwk"."dbt"."events_clean__dbt_backup" cascade
[0m21:55:09.297030 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.049 seconds
[0m21:55:09.300285 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:55:09.302269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105407bb0>]}
[0m21:55:09.303583 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mSELECT 221370[0m in 10.38s]
[0m21:55:09.304394 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:55:09.307137 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:09.307624 [debug] [MainThread]: On master: BEGIN
[0m21:55:09.307971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:10.776968 [debug] [MainThread]: SQL status: BEGIN in 1.469 seconds
[0m21:55:10.777339 [debug] [MainThread]: On master: COMMIT
[0m21:55:10.777575 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:10.777787 [debug] [MainThread]: On master: COMMIT
[0m21:55:10.829416 [debug] [MainThread]: SQL status: COMMIT in 0.051 seconds
[0m21:55:10.830159 [debug] [MainThread]: On master: Close
[0m21:55:10.831273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:10.831652 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:55:10.831981 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:55:10.832276 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:55:10.832552 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:55:10.833069 [info ] [MainThread]: 
[0m21:55:10.833476 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 14.97 seconds (14.97s).
[0m21:55:10.834756 [debug] [MainThread]: Command end result
[0m21:55:10.858398 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:55:10.859849 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:55:10.863660 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:55:10.863861 [info ] [MainThread]: 
[0m21:55:10.864084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:55:10.864254 [info ] [MainThread]: 
[0m21:55:10.864431 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:55:10.866013 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 15.257017, "process_in_blocks": "0", "process_kernel_time": 0.141741, "process_mem_max_rss": "141590528", "process_out_blocks": "0", "process_user_time": 1.212258}
[0m21:55:10.866321 [debug] [MainThread]: Command `dbt build` succeeded at 21:55:10.866258 after 15.26 seconds
[0m21:55:10.866546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106139250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545b2a0>]}
[0m21:55:10.866766 [debug] [MainThread]: Flushing usage events
[0m21:55:11.496285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:55:12.196205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078934d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8bb10>]}


============================== 21:55:12.198027 | 9fb9d5b6-d137-40e8-a03a-f0b441558545 ==============================
[0m21:55:12.198027 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:55:12.198286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build -s config.materialized:incremental', 'send_anonymous_usage_stats': 'True'}
[0m21:55:12.260451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808b490>]}
[0m21:55:12.282086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c22030>]}
[0m21:55:12.282458 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:55:12.315600 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:55:12.358774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:55:12.358954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:55:12.376777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0b450>]}
[0m21:55:12.408444 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:55:12.409248 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:55:12.422045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8de50>]}
[0m21:55:12.422278 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:55:12.423138 [info ] [MainThread]: 
[0m21:55:12.423286 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:55:12.423397 [info ] [MainThread]: 
[0m21:55:12.423594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:55:12.425082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:55:12.442627 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:55:12.442808 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:55:12.442924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:13.372794 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.929 seconds
[0m21:55:13.377410 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:55:13.382911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:55:13.391049 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:55:13.391617 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:55:13.391911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:14.100094 [debug] [ThreadPool]: SQL status: BEGIN in 0.708 seconds
[0m21:55:14.101718 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:55:14.102829 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:55:14.205117 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.101 seconds
[0m21:55:14.210958 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:55:14.300255 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:55:14.312416 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:14.312786 [debug] [MainThread]: On master: BEGIN
[0m21:55:14.313064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:14.954688 [debug] [MainThread]: SQL status: BEGIN in 0.641 seconds
[0m21:55:14.956537 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:14.957830 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:55:15.202275 [debug] [MainThread]: SQL status: SELECT 10 in 0.243 seconds
[0m21:55:15.206416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c62970>]}
[0m21:55:15.207228 [debug] [MainThread]: On master: ROLLBACK
[0m21:55:15.249162 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:15.250158 [debug] [MainThread]: On master: BEGIN
[0m21:55:15.634925 [debug] [MainThread]: SQL status: BEGIN in 0.384 seconds
[0m21:55:15.636455 [debug] [MainThread]: On master: COMMIT
[0m21:55:15.637495 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:15.638416 [debug] [MainThread]: On master: COMMIT
[0m21:55:15.708251 [debug] [MainThread]: SQL status: COMMIT in 0.069 seconds
[0m21:55:15.708795 [debug] [MainThread]: On master: Close
[0m21:55:15.711876 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:55:15.712191 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:55:15.712446 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:55:15.712647 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:55:15.712947 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:55:15.713299 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:55:15.713606 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:55:15.713948 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:55:15.714337 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:55:15.714621 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:55:15.714834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:55:15.715082 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:55:15.715288 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:55:15.715465 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:55:15.715629 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:55:15.715795 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:55:15.724958 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:55:15.727073 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:55:15.728669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:55:15.730276 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:55:15.730798 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:55:15.730997 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:55:15.731145 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:55:15.731279 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:55:15.785540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:15.785747 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:15.787131 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:15.788283 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:15.788435 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp215515750228"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m21:55:15.788582 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp215515748334"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:55:15.788724 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215515786500"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:55:15.788884 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp215515787802"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:55:15.789032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:15.789146 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:55:15.789267 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:55:15.789391 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:55:19.102006 [debug] [Thread-2 (]: SQL status: SELECT 3 in 3.312 seconds
[0m21:55:19.124039 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:19.124567 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:55:19.204305 [debug] [Thread-2 (]: SQL status: BEGIN in 0.079 seconds
[0m21:55:19.205565 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:19.206495 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215515786500'
        
      order by ordinal_position

  
[0m21:55:19.846286 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.638 seconds
[0m21:55:19.854943 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:19.855435 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:20.106033 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.250 seconds
[0m21:55:20.129355 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:20.129576 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215515786500'
        
      order by ordinal_position

  
[0m21:55:20.302706 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.172 seconds
[0m21:55:20.312767 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:20.313508 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:20.603621 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.289 seconds
[0m21:55:20.618750 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:55:20.624651 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:55:20.634578 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:55:20.635206 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:20.635468 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215515786500" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215515786500"
    )
  
[0m21:55:20.710660 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.075 seconds
[0m21:55:20.718243 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:55:20.718474 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:20.718631 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:55:20.807322 [debug] [Thread-2 (]: SQL status: COMMIT in 0.088 seconds
[0m21:55:20.809319 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:55:20.811312 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a73a5b0>]}
[0m21:55:20.811975 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 5.10s]
[0m21:55:20.812494 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:55:21.101397 [debug] [Thread-1 (]: SQL status: SELECT 101377 in 5.312 seconds
[0m21:55:21.109881 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:21.110348 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:55:21.156939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m21:55:21.157723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:21.158286 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215515750228'
        
      order by ordinal_position

  
[0m21:55:21.746818 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.587 seconds
[0m21:55:21.753695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:21.754302 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:21.805921 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.051 seconds
[0m21:55:21.812455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:21.813276 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215515750228'
        
      order by ordinal_position

  
[0m21:55:22.003633 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.189 seconds
[0m21:55:22.011305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:22.012131 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:22.508565 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.495 seconds
[0m21:55:22.512719 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:55:22.522032 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:55:22.523468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:22.523906 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp215515750228"
    )


  
[0m21:55:23.942319 [debug] [Thread-4 (]: SQL status: SELECT 30901 in 8.153 seconds
[0m21:55:23.949540 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:23.950088 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:55:24.003785 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m21:55:24.005222 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:24.006448 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215515748334'
        
      order by ordinal_position

  
[0m21:55:24.204743 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.197 seconds
[0m21:55:24.213108 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:24.213688 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:24.303790 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.089 seconds
[0m21:55:24.311302 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:24.312011 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215515748334'
        
      order by ordinal_position

  
[0m21:55:24.401496 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.089 seconds
[0m21:55:24.407792 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:24.408462 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:24.502047 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.093 seconds
[0m21:55:24.511410 [debug] [Thread-4 (]: 
    In "dev_ohwk"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:55:24.512435 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:55:24.513082 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:24.513388 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp215515748334"
    )


  
[0m21:55:26.707114 [debug] [Thread-1 (]: SQL status: INSERT 0 101377 in 4.182 seconds
[0m21:55:26.708818 [debug] [Thread-4 (]: SQL status: INSERT 0 30901 in 2.195 seconds
[0m21:55:26.712896 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:55:26.714653 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:55:26.715406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:26.715811 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:26.716167 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:55:26.716504 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:55:26.810609 [debug] [Thread-4 (]: SQL status: COMMIT in 0.093 seconds
[0m21:55:26.811906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.095 seconds
[0m21:55:26.813795 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:55:26.815116 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:55:26.816928 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd2090>]}
[0m21:55:26.817714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c56780>]}
[0m21:55:26.818921 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 30901[0m in 11.10s]
[0m21:55:26.820148 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 101377[0m in 11.10s]
[0m21:55:26.820969 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:55:26.821683 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:55:32.236598 [debug] [Thread-3 (]: SQL status: SELECT 199849 in 16.447 seconds
[0m21:55:32.241894 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:32.242632 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:55:32.287169 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m21:55:32.288082 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:32.288664 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215515787802'
        
      order by ordinal_position

  
[0m21:55:32.340046 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.050 seconds
[0m21:55:32.345722 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:32.346328 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:32.421144 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.074 seconds
[0m21:55:32.429222 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:32.429971 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215515787802'
        
      order by ordinal_position

  
[0m21:55:32.483393 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.052 seconds
[0m21:55:32.489982 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:32.490784 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:32.537370 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.046 seconds
[0m21:55:32.542931 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:55:32.545585 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:55:32.547514 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:32.547919 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp215515787802"
    )


  
[0m21:55:34.591815 [debug] [Thread-3 (]: SQL status: INSERT 0 199849 in 2.043 seconds
[0m21:55:34.594696 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:55:34.595368 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:34.595920 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:55:34.644726 [debug] [Thread-3 (]: SQL status: COMMIT in 0.048 seconds
[0m21:55:34.646625 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:55:34.648301 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a787f70>]}
[0m21:55:34.649611 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mINSERT 0 199849[0m in 18.93s]
[0m21:55:34.650858 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:55:34.653721 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:34.654263 [debug] [MainThread]: On master: BEGIN
[0m21:55:34.654647 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:36.264096 [debug] [MainThread]: SQL status: BEGIN in 1.609 seconds
[0m21:55:36.265648 [debug] [MainThread]: On master: COMMIT
[0m21:55:36.266728 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:36.267640 [debug] [MainThread]: On master: COMMIT
[0m21:55:36.313993 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:55:36.315280 [debug] [MainThread]: On master: Close
[0m21:55:36.316781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:36.317312 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:55:36.317775 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:55:36.318189 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:55:36.318579 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:55:36.319235 [info ] [MainThread]: 
[0m21:55:36.319790 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 23.90 seconds (23.90s).
[0m21:55:36.321626 [debug] [MainThread]: Command end result
[0m21:55:36.352854 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:55:36.354285 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:55:36.358133 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:55:36.358337 [info ] [MainThread]: 
[0m21:55:36.358554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:55:36.358724 [info ] [MainThread]: 
[0m21:55:36.358898 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:55:36.359865 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 24.189741, "process_in_blocks": "0", "process_kernel_time": 0.142761, "process_mem_max_rss": "138723328", "process_out_blocks": "0", "process_user_time": 1.20623}
[0m21:55:36.360119 [debug] [MainThread]: Command `dbt build` succeeded at 21:55:36.360067 after 24.19 seconds
[0m21:55:36.360314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107484250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dab230>]}
[0m21:55:36.360506 [debug] [MainThread]: Flushing usage events
[0m21:55:36.884624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:55:46.143244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106827b10>]}


============================== 21:55:46.145075 | 1419d6bf-f2f5-4682-a950-f92edb201861 ==============================
[0m21:55:46.145075 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:55:46.145339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -s config.materialized:incremental --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m21:55:46.210391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2b490>]}
[0m21:55:46.232214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebe030>]}
[0m21:55:46.232594 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:55:46.265941 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:55:46.309548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:55:46.309741 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:55:46.327895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d7450>]}
[0m21:55:46.359912 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:55:46.360788 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:55:46.371536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107551e50>]}
[0m21:55:46.371739 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:55:46.372563 [info ] [MainThread]: 
[0m21:55:46.372712 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:55:46.372835 [info ] [MainThread]: 
[0m21:55:46.373036 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:55:46.374539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:55:46.393499 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:55:46.393681 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:55:46.393791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:47.063221 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.669 seconds
[0m21:55:47.066501 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:55:47.072464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:55:47.081165 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:55:47.081769 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:55:47.082104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:47.749534 [debug] [ThreadPool]: SQL status: BEGIN in 0.667 seconds
[0m21:55:47.751157 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:55:47.752290 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:55:47.838796 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.085 seconds
[0m21:55:47.844143 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:55:47.915651 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:55:47.928754 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:47.929185 [debug] [MainThread]: On master: BEGIN
[0m21:55:47.929496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:48.667327 [debug] [MainThread]: SQL status: BEGIN in 0.737 seconds
[0m21:55:48.668951 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:48.670276 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:55:48.905327 [debug] [MainThread]: SQL status: SELECT 10 in 0.233 seconds
[0m21:55:48.913875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107536970>]}
[0m21:55:48.914398 [debug] [MainThread]: On master: ROLLBACK
[0m21:55:48.957742 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:48.958447 [debug] [MainThread]: On master: BEGIN
[0m21:55:49.051765 [debug] [MainThread]: SQL status: BEGIN in 0.093 seconds
[0m21:55:49.052728 [debug] [MainThread]: On master: COMMIT
[0m21:55:49.053201 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:49.053533 [debug] [MainThread]: On master: COMMIT
[0m21:55:49.106229 [debug] [MainThread]: SQL status: COMMIT in 0.052 seconds
[0m21:55:49.107603 [debug] [MainThread]: On master: Close
[0m21:55:49.116577 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:55:49.117287 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:55:49.117772 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:55:49.118213 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:55:49.118965 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:55:49.119601 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:55:49.120188 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:55:49.120781 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:55:49.121401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:55:49.121953 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:55:49.122422 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:55:49.122875 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:55:49.123459 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:55:49.124076 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:55:49.124491 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:55:49.124844 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:55:49.139390 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:55:49.142442 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:55:49.145001 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:55:49.146934 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:55:49.147561 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:55:49.147856 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:55:49.153728 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:55:49.167296 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:55:49.211570 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:55:49.212594 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:55:49.214014 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:55:49.215896 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:49.216228 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215549214706"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:55:49.216390 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:55:49.216647 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:49.216805 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:55:49.216947 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:55:49.217100 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:49.217337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:49.217502 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:55:49.217638 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:55:49.217754 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:55:49.217868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:49.995147 [debug] [Thread-3 (]: SQL status: BEGIN in 0.778 seconds
[0m21:55:49.997032 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:49.998467 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:55:51.303903 [debug] [Thread-4 (]: SQL status: BEGIN in 2.086 seconds
[0m21:55:51.305567 [debug] [Thread-1 (]: SQL status: BEGIN in 2.087 seconds
[0m21:55:51.306780 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:51.307993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:51.309272 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_users__dbt_tmp"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

      where
          t.id <= 75000

  );
  
  
[0m21:55:51.310412 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
  
    

  create  table "dev_ohwk"."dbt"."events_clean__dbt_tmp"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" < timestamp '2023-08-01'

  );
  
  
[0m21:55:51.411423 [debug] [Thread-3 (]: SQL status: SELECT 10 in 1.412 seconds
[0m21:55:51.427402 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:51.427886 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m21:55:51.504852 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.076 seconds
[0m21:55:51.511093 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:51.511875 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m21:55:51.604266 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m21:55:51.629608 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:55:51.629991 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:51.630241 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:55:51.904877 [debug] [Thread-3 (]: SQL status: COMMIT in 0.274 seconds
[0m21:55:51.916827 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_concurrency__dbt_backup"
[0m21:55:51.921773 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:51.922151 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_ohwk"."dbt"."trips_concurrency__dbt_backup" cascade
[0m21:55:52.308996 [debug] [Thread-2 (]: SQL status: SELECT 3 in 3.092 seconds
[0m21:55:52.310789 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.388 seconds
[0m21:55:52.329732 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:52.331976 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:55:52.332317 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:55:52.333870 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f55e60>]}
[0m21:55:52.334410 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mSELECT 10[0m in 3.21s]
[0m21:55:52.334851 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:55:52.411627 [debug] [Thread-2 (]: SQL status: BEGIN in 0.079 seconds
[0m21:55:52.412177 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:52.412532 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215549214706'
        
      order by ordinal_position

  
[0m21:55:52.819596 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.406 seconds
[0m21:55:52.830269 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:52.830784 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:53.014356 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.183 seconds
[0m21:55:53.034401 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:53.034857 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215549214706'
        
      order by ordinal_position

  
[0m21:55:53.103904 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.068 seconds
[0m21:55:53.110545 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:53.111178 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:53.309857 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.198 seconds
[0m21:55:53.325245 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:55:53.330428 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:55:53.340104 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:55:53.340736 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:53.340970 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215549214706" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215549214706"
    )
  
[0m21:55:53.405335 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.064 seconds
[0m21:55:53.406794 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:55:53.407162 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:53.407484 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:55:53.843582 [debug] [Thread-2 (]: SQL status: COMMIT in 0.435 seconds
[0m21:55:53.846908 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:55:53.849107 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a6d50>]}
[0m21:55:53.850191 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 4.73s]
[0m21:55:53.850891 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:55:57.251449 [debug] [Thread-4 (]: SQL status: SELECT 75000 in 5.940 seconds
[0m21:55:57.259575 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:57.260164 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users" rename to "trips_users__dbt_backup"
[0m21:55:57.312538 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.052 seconds
[0m21:55:57.319909 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:57.320642 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users__dbt_tmp" rename to "trips_users"
[0m21:55:57.409165 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m21:55:57.413409 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:55:57.414087 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:57.414646 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:55:57.833314 [debug] [Thread-4 (]: SQL status: COMMIT in 0.418 seconds
[0m21:55:57.838060 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_users__dbt_backup"
[0m21:55:57.838915 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:57.839423 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
drop table if exists "dev_ohwk"."dbt"."trips_users__dbt_backup" cascade
[0m21:55:58.013641 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.173 seconds
[0m21:55:58.018436 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:55:58.020386 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107533280>]}
[0m21:55:58.021570 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mSELECT 75000[0m in 8.90s]
[0m21:55:58.022327 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:56:00.135711 [debug] [Thread-1 (]: SQL status: SELECT 221370 in 8.824 seconds
[0m21:56:00.142366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:00.142859 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean" rename to "events_clean__dbt_backup"
[0m21:56:01.155797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.012 seconds
[0m21:56:01.162239 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:01.162762 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean__dbt_tmp" rename to "events_clean"
[0m21:56:01.208456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m21:56:01.213038 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:56:01.214244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:01.215259 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:56:01.266382 [debug] [Thread-1 (]: SQL status: COMMIT in 0.050 seconds
[0m21:56:01.271087 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."events_clean__dbt_backup"
[0m21:56:01.272064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:01.272637 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
drop table if exists "dev_ohwk"."dbt"."events_clean__dbt_backup" cascade
[0m21:56:01.331869 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.058 seconds
[0m21:56:01.336192 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:56:01.338554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6cc30>]}
[0m21:56:01.340153 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mSELECT 221370[0m in 12.22s]
[0m21:56:01.340863 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:56:01.342958 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:01.343389 [debug] [MainThread]: On master: BEGIN
[0m21:56:01.343741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:56:02.206971 [debug] [MainThread]: SQL status: BEGIN in 0.863 seconds
[0m21:56:02.208554 [debug] [MainThread]: On master: COMMIT
[0m21:56:02.209605 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:02.210248 [debug] [MainThread]: On master: COMMIT
[0m21:56:02.255423 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m21:56:02.256727 [debug] [MainThread]: On master: Close
[0m21:56:02.258900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:02.259566 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:56:02.260077 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:56:02.260511 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:56:02.260974 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:56:02.261652 [info ] [MainThread]: 
[0m21:56:02.262240 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 15.89 seconds (15.89s).
[0m21:56:02.264037 [debug] [MainThread]: Command end result
[0m21:56:02.292530 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:56:02.294031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:56:02.298112 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:56:02.298314 [info ] [MainThread]: 
[0m21:56:02.298533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:56:02.298697 [info ] [MainThread]: 
[0m21:56:02.298870 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:56:02.299863 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 16.181684, "process_in_blocks": "0", "process_kernel_time": 0.144575, "process_mem_max_rss": "139083776", "process_out_blocks": "0", "process_user_time": 1.205599}
[0m21:56:02.300123 [debug] [MainThread]: Command `dbt build` succeeded at 21:56:02.300069 after 16.18 seconds
[0m21:56:02.300345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca1dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c694d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068472a0>]}
[0m21:56:02.300554 [debug] [MainThread]: Flushing usage events
[0m21:56:02.897971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:56:03.578585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055af4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c27b10>]}


============================== 21:56:03.580489 | 93b758c6-e215-406e-b15d-11de98f086bb ==============================
[0m21:56:03.580489 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:56:03.580756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -s config.materialized:incremental', 'send_anonymous_usage_stats': 'True'}
[0m21:56:03.643356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da7490>]}
[0m21:56:03.663776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106abe030>]}
[0m21:56:03.664141 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:56:03.697118 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:56:03.740342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:56:03.740525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:56:03.758504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a53450>]}
[0m21:56:03.790424 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:56:03.791248 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:56:03.801812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd1e50>]}
[0m21:56:03.802016 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:56:03.802839 [info ] [MainThread]: 
[0m21:56:03.802986 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:56:03.803104 [info ] [MainThread]: 
[0m21:56:03.803317 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:56:03.804843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:56:03.822205 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:56:03.822408 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:56:03.822528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:05.353968 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.531 seconds
[0m21:56:05.358785 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:56:05.364344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:56:05.372446 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:56:05.373027 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:56:05.373354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:06.064566 [debug] [ThreadPool]: SQL status: BEGIN in 0.691 seconds
[0m21:56:06.066401 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:56:06.067516 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:56:06.120557 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.052 seconds
[0m21:56:06.125428 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:56:06.172563 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:56:06.186423 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:06.186908 [debug] [MainThread]: On master: BEGIN
[0m21:56:06.187135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:06.888692 [debug] [MainThread]: SQL status: BEGIN in 0.701 seconds
[0m21:56:06.890397 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:06.891720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:56:07.103958 [debug] [MainThread]: SQL status: SELECT 10 in 0.211 seconds
[0m21:56:07.110357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca2970>]}
[0m21:56:07.111167 [debug] [MainThread]: On master: ROLLBACK
[0m21:56:07.156399 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:07.157516 [debug] [MainThread]: On master: BEGIN
[0m21:56:07.248221 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m21:56:07.249548 [debug] [MainThread]: On master: COMMIT
[0m21:56:07.250532 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:07.251445 [debug] [MainThread]: On master: COMMIT
[0m21:56:07.300960 [debug] [MainThread]: SQL status: COMMIT in 0.049 seconds
[0m21:56:07.302225 [debug] [MainThread]: On master: Close
[0m21:56:07.309891 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:56:07.310415 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:56:07.310768 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:56:07.311082 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:56:07.311687 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:56:07.312210 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:56:07.313007 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:56:07.313641 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:56:07.314174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:56:07.314704 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:56:07.315163 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:56:07.315588 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:56:07.315958 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:56:07.316301 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:56:07.316594 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:56:07.316864 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:56:07.328965 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:56:07.332092 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:56:07.334422 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:56:07.336559 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:56:07.337255 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:56:07.337487 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:56:07.337679 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:56:07.337849 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:56:07.403497 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:07.404985 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:07.405210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:07.406372 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:07.406527 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp215607388085"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:56:07.406678 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215607404292"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:56:07.406817 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp215607396615"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m21:56:07.406973 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp215607405896"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:56:07.407121 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:56:07.407238 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:56:07.407348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:56:07.407459 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:56:09.904177 [debug] [Thread-4 (]: SQL status: SELECT 30901 in 2.496 seconds
[0m21:56:09.926038 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:09.926472 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:56:09.969893 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m21:56:09.970643 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:09.971219 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215607388085'
        
      order by ordinal_position

  
[0m21:56:10.608891 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.637 seconds
[0m21:56:10.621776 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:10.622492 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:10.809617 [debug] [Thread-2 (]: SQL status: SELECT 3 in 3.402 seconds
[0m21:56:10.811134 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.188 seconds
[0m21:56:10.817801 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:10.834104 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:10.834482 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:56:10.834782 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215607388085'
        
      order by ordinal_position

  
[0m21:56:10.907121 [debug] [Thread-2 (]: SQL status: BEGIN in 0.072 seconds
[0m21:56:10.907476 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:10.907731 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215607404292'
        
      order by ordinal_position

  
[0m21:56:10.911029 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.076 seconds
[0m21:56:10.913752 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:10.914077 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:11.107789 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.193 seconds
[0m21:56:11.121718 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.214 seconds
[0m21:56:11.127031 [debug] [Thread-4 (]: 
    In "dev_ohwk"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:56:11.129634 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:11.138585 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:56:11.138917 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:11.139621 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:11.139892 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp215607388085"
    )


  
[0m21:56:11.309504 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.170 seconds
[0m21:56:11.317447 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:11.317829 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215607404292'
        
      order by ordinal_position

  
[0m21:56:11.504836 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.186 seconds
[0m21:56:11.512067 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:11.512630 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:12.270654 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.757 seconds
[0m21:56:12.274001 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:56:12.284700 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:56:12.295253 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:56:12.296285 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:12.296633 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215607404292" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215607404292"
    )
  
[0m21:56:12.403606 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.106 seconds
[0m21:56:12.426626 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:56:12.427087 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:12.427386 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:56:12.603570 [debug] [Thread-2 (]: SQL status: COMMIT in 0.175 seconds
[0m21:56:12.607960 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:56:12.612026 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8629c0>]}
[0m21:56:12.613199 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 5.29s]
[0m21:56:12.614081 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:56:12.992609 [debug] [Thread-4 (]: SQL status: INSERT 0 30901 in 1.852 seconds
[0m21:56:12.997925 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:56:12.999271 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:13.000381 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:56:13.203137 [debug] [Thread-4 (]: SQL status: COMMIT in 0.202 seconds
[0m21:56:13.205360 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:56:13.207023 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1a810>]}
[0m21:56:13.208236 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 30901[0m in 5.89s]
[0m21:56:13.209432 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:56:16.109131 [debug] [Thread-1 (]: SQL status: SELECT 101377 in 8.701 seconds
[0m21:56:16.118976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:16.119519 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:56:16.203784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m21:56:16.204576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:16.205162 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215607396615'
        
      order by ordinal_position

  
[0m21:56:16.405999 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.200 seconds
[0m21:56:16.412616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:16.413384 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:16.503819 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.090 seconds
[0m21:56:16.510254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:16.510805 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215607396615'
        
      order by ordinal_position

  
[0m21:56:16.606117 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.095 seconds
[0m21:56:16.613948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:16.614668 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:16.716934 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.101 seconds
[0m21:56:16.721351 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:56:16.722848 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:56:16.724402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:16.725005 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp215607396615"
    )


  
[0m21:56:18.829132 [debug] [Thread-1 (]: SQL status: INSERT 0 101377 in 2.103 seconds
[0m21:56:18.833414 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:56:18.834000 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:18.834457 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:56:18.908992 [debug] [Thread-1 (]: SQL status: COMMIT in 0.074 seconds
[0m21:56:18.911411 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:56:18.913689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9e990>]}
[0m21:56:18.915554 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 101377[0m in 11.60s]
[0m21:56:18.916437 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:56:24.974779 [debug] [Thread-3 (]: SQL status: SELECT 199849 in 17.567 seconds
[0m21:56:24.979871 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:24.980505 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:56:25.026033 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m21:56:25.027121 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:25.028237 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215607405896'
        
      order by ordinal_position

  
[0m21:56:25.080110 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.051 seconds
[0m21:56:25.085979 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:25.086647 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:25.134890 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.047 seconds
[0m21:56:25.140814 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:25.141588 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215607405896'
        
      order by ordinal_position

  
[0m21:56:25.193284 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.051 seconds
[0m21:56:25.199063 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:25.199740 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:25.247439 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.047 seconds
[0m21:56:25.250272 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:56:25.251588 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:56:25.252968 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:25.253507 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp215607405896"
    )


  
[0m21:56:27.208066 [debug] [Thread-3 (]: SQL status: INSERT 0 199849 in 1.954 seconds
[0m21:56:27.210884 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:56:27.211677 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:27.212148 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:56:27.260120 [debug] [Thread-3 (]: SQL status: COMMIT in 0.047 seconds
[0m21:56:27.262748 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:56:27.264127 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089eed50>]}
[0m21:56:27.265095 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mINSERT 0 199849[0m in 19.95s]
[0m21:56:27.265904 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:56:27.268050 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:27.268420 [debug] [MainThread]: On master: BEGIN
[0m21:56:27.268905 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:56:28.007099 [debug] [MainThread]: SQL status: BEGIN in 0.738 seconds
[0m21:56:28.008227 [debug] [MainThread]: On master: COMMIT
[0m21:56:28.008924 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:28.009398 [debug] [MainThread]: On master: COMMIT
[0m21:56:28.054971 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:56:28.057174 [debug] [MainThread]: On master: Close
[0m21:56:28.058984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:28.059606 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:56:28.060103 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:56:28.060571 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:56:28.061010 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:56:28.061703 [info ] [MainThread]: 
[0m21:56:28.062303 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 24.26 seconds (24.26s).
[0m21:56:28.065808 [debug] [MainThread]: Command end result
[0m21:56:28.095218 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:56:28.096480 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:56:28.100225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:56:28.100404 [info ] [MainThread]: 
[0m21:56:28.100603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:56:28.100761 [info ] [MainThread]: 
[0m21:56:28.100924 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:56:28.101841 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 24.548256, "process_in_blocks": "0", "process_kernel_time": 0.144767, "process_mem_max_rss": "141312000", "process_out_blocks": "0", "process_user_time": 1.223772}
[0m21:56:28.102097 [debug] [MainThread]: Command `dbt build` succeeded at 21:56:28.102045 after 24.55 seconds
[0m21:56:28.102299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c47230>]}
[0m21:56:28.102490 [debug] [MainThread]: Flushing usage events
[0m21:56:29.311495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:57:18.121159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035bf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab7b10>]}


============================== 21:57:18.123071 | 5f6b9fce-7a29-4d18-830f-55606260669e ==============================
[0m21:57:18.123071 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:57:18.123343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build -s config.materialized:incremental --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:57:18.186331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dbb490>]}
[0m21:57:18.207116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494e030>]}
[0m21:57:18.207491 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:57:18.240723 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:57:18.284174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:57:18.284351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:57:18.302464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105737450>]}
[0m21:57:18.334592 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:57:18.335421 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:57:18.345953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b9e50>]}
[0m21:57:18.346152 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:57:18.347014 [info ] [MainThread]: 
[0m21:57:18.347171 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:57:18.347289 [info ] [MainThread]: 
[0m21:57:18.347506 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:57:18.348986 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:57:18.366535 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:57:18.366720 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:57:18.366833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:19.480096 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.112 seconds
[0m21:57:19.483819 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:57:19.489378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:57:19.498130 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:57:19.498632 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:57:19.498944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:20.211378 [debug] [ThreadPool]: SQL status: BEGIN in 0.712 seconds
[0m21:57:20.212824 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:57:20.213518 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:57:20.304190 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.090 seconds
[0m21:57:20.308140 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:57:20.356974 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:57:20.369578 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:20.369938 [debug] [MainThread]: On master: BEGIN
[0m21:57:20.370204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:57:21.006606 [debug] [MainThread]: SQL status: BEGIN in 0.636 seconds
[0m21:57:21.008161 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:21.008999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:57:21.224363 [debug] [MainThread]: SQL status: SELECT 10 in 0.214 seconds
[0m21:57:21.230865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ce970>]}
[0m21:57:21.231942 [debug] [MainThread]: On master: ROLLBACK
[0m21:57:21.275651 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:21.276718 [debug] [MainThread]: On master: BEGIN
[0m21:57:21.365428 [debug] [MainThread]: SQL status: BEGIN in 0.088 seconds
[0m21:57:21.366332 [debug] [MainThread]: On master: COMMIT
[0m21:57:21.367323 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:21.368204 [debug] [MainThread]: On master: COMMIT
[0m21:57:21.412976 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m21:57:21.413909 [debug] [MainThread]: On master: Close
[0m21:57:21.421596 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:57:21.422334 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:57:21.422925 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:57:21.423389 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:57:21.424127 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:57:21.424852 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:57:21.425541 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:57:21.426190 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:57:21.426865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:57:21.427458 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:57:21.427986 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:57:21.428447 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:57:21.428838 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:57:21.429788 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:57:21.430372 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:57:21.430779 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:57:21.451297 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:57:21.451861 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:57:21.454171 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:57:21.456000 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:57:21.456619 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:57:21.456846 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:57:21.457048 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:57:21.457227 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:57:21.523039 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:57:21.525234 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:21.525764 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:57:21.526922 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:57:21.527153 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215721524053"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:57:21.527496 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:57:21.527704 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:21.527946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:21.528093 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:57:21.528264 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:21.528430 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:57:21.528573 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:57:21.528702 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:57:21.528827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:21.529029 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:57:22.449812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.921 seconds
[0m21:57:22.450999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:22.452293 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
  
    

  create  table "dev_ohwk"."dbt"."events_clean__dbt_tmp"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" < timestamp '2023-08-01'

  );
  
  
[0m21:57:23.406311 [debug] [Thread-4 (]: SQL status: BEGIN in 1.877 seconds
[0m21:57:23.406762 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:23.407073 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_users__dbt_tmp"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

      where
          t.id <= 75000

  );
  
  
[0m21:57:23.413061 [debug] [Thread-3 (]: SQL status: BEGIN in 1.884 seconds
[0m21:57:23.413467 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:23.413870 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:57:24.008713 [debug] [Thread-2 (]: SQL status: SELECT 3 in 2.480 seconds
[0m21:57:24.028982 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:24.029427 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:57:24.166434 [debug] [Thread-2 (]: SQL status: BEGIN in 0.136 seconds
[0m21:57:24.167838 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:24.168429 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215721524053'
        
      order by ordinal_position

  
[0m21:57:24.415028 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.246 seconds
[0m21:57:24.424178 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:24.425125 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:24.782166 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.356 seconds
[0m21:57:24.803792 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:24.804353 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215721524053'
        
      order by ordinal_position

  
[0m21:57:25.389850 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.585 seconds
[0m21:57:25.395347 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:25.395965 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:25.705893 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.309 seconds
[0m21:57:25.721927 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:57:25.729533 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:57:25.741213 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:57:25.742039 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:25.742320 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215721524053" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215721524053"
    )
  
[0m21:57:25.804208 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.061 seconds
[0m21:57:25.819905 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:57:25.820277 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:25.820538 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:57:25.906382 [debug] [Thread-2 (]: SQL status: COMMIT in 0.085 seconds
[0m21:57:25.910857 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:57:25.916005 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e8a5b0>]}
[0m21:57:25.917162 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 4.48s]
[0m21:57:25.918026 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:57:26.104270 [debug] [Thread-3 (]: SQL status: SELECT 10 in 2.690 seconds
[0m21:57:26.120449 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:26.121148 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m21:57:26.206865 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.085 seconds
[0m21:57:26.215579 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:26.216252 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m21:57:26.302291 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.085 seconds
[0m21:57:26.309696 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:57:26.310255 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:26.310685 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:57:26.403011 [debug] [Thread-3 (]: SQL status: COMMIT in 0.092 seconds
[0m21:57:26.415019 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_concurrency__dbt_backup"
[0m21:57:26.421062 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:26.421555 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_ohwk"."dbt"."trips_concurrency__dbt_backup" cascade
[0m21:57:26.709741 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.288 seconds
[0m21:57:26.712133 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:57:26.713590 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a01f10>]}
[0m21:57:26.714775 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mSELECT 10[0m in 5.29s]
[0m21:57:26.715777 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:57:31.305558 [debug] [Thread-4 (]: SQL status: SELECT 75000 in 7.898 seconds
[0m21:57:31.308115 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:31.308413 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users" rename to "trips_users__dbt_backup"
[0m21:57:31.407997 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.099 seconds
[0m21:57:31.414682 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:31.415285 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users__dbt_tmp" rename to "trips_users"
[0m21:57:31.506335 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m21:57:31.510461 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:57:31.511285 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:31.511962 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:57:32.144394 [debug] [Thread-4 (]: SQL status: COMMIT in 0.631 seconds
[0m21:57:32.148245 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_users__dbt_backup"
[0m21:57:32.149116 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:32.149577 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
drop table if exists "dev_ohwk"."dbt"."trips_users__dbt_backup" cascade
[0m21:57:32.451922 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.301 seconds
[0m21:57:32.456923 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:57:32.458657 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105982990>]}
[0m21:57:32.459649 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mSELECT 75000[0m in 11.03s]
[0m21:57:32.460423 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:57:32.705130 [debug] [Thread-1 (]: SQL status: SELECT 221370 in 10.252 seconds
[0m21:57:32.712322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:32.713030 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean" rename to "events_clean__dbt_backup"
[0m21:57:32.763358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.049 seconds
[0m21:57:32.770809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:32.771345 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean__dbt_tmp" rename to "events_clean"
[0m21:57:32.816103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m21:57:32.820554 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:57:32.821714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:32.822726 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:57:32.869485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.046 seconds
[0m21:57:32.874477 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."events_clean__dbt_backup"
[0m21:57:32.875561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:32.876150 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
drop table if exists "dev_ohwk"."dbt"."events_clean__dbt_backup" cascade
[0m21:57:32.928099 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.051 seconds
[0m21:57:32.931610 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:57:32.933016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abc910>]}
[0m21:57:32.934248 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mSELECT 221370[0m in 11.51s]
[0m21:57:32.935266 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:57:32.937665 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:32.938231 [debug] [MainThread]: On master: BEGIN
[0m21:57:32.938735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:57:33.579777 [debug] [MainThread]: SQL status: BEGIN in 0.641 seconds
[0m21:57:33.580273 [debug] [MainThread]: On master: COMMIT
[0m21:57:33.580573 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:33.580827 [debug] [MainThread]: On master: COMMIT
[0m21:57:33.625732 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:57:33.626514 [debug] [MainThread]: On master: Close
[0m21:57:33.627483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:33.627851 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:57:33.628110 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:57:33.628371 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:57:33.628617 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:57:33.629066 [info ] [MainThread]: 
[0m21:57:33.629419 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 15.28 seconds (15.28s).
[0m21:57:33.630585 [debug] [MainThread]: Command end result
[0m21:57:33.653960 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:57:33.655619 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:57:33.659541 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:57:33.659745 [info ] [MainThread]: 
[0m21:57:33.659961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:57:33.660137 [info ] [MainThread]: 
[0m21:57:33.660314 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:57:33.661830 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 15.567552, "process_in_blocks": "0", "process_kernel_time": 0.145549, "process_mem_max_rss": "140804096", "process_out_blocks": "0", "process_user_time": 1.180753}
[0m21:57:33.662106 [debug] [MainThread]: Command `dbt build` succeeded at 21:57:33.662052 after 15.57 seconds
[0m21:57:33.662329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a39e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad72a0>]}
[0m21:57:33.662537 [debug] [MainThread]: Flushing usage events
[0m21:57:34.174188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:57:35.027157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041774d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d27b10>]}


============================== 21:57:35.029494 | e3aaf12d-d88c-43e4-87c7-cce107db9f39 ==============================
[0m21:57:35.029494 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:57:35.029757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -s config.materialized:incremental', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:57:35.094203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d27490>]}
[0m21:57:35.114714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbe030>]}
[0m21:57:35.115379 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:57:35.152084 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:57:35.201123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:57:35.201301 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:57:35.218828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aff450>]}
[0m21:57:35.249976 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:57:35.250791 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:57:35.266439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d81e50>]}
[0m21:57:35.266669 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:57:35.267553 [info ] [MainThread]: 
[0m21:57:35.267700 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:57:35.267807 [info ] [MainThread]: 
[0m21:57:35.268002 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:57:35.269484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:57:35.289943 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:57:35.290120 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:57:35.290228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:36.369363 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.079 seconds
[0m21:57:36.374703 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:57:36.378207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:57:36.384250 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:57:36.384640 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:57:36.384906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:37.101425 [debug] [ThreadPool]: SQL status: BEGIN in 0.716 seconds
[0m21:57:37.103127 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:57:37.104234 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:57:37.154746 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.049 seconds
[0m21:57:37.160037 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:57:37.205342 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:57:37.218098 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:37.218506 [debug] [MainThread]: On master: BEGIN
[0m21:57:37.218792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:57:38.732198 [debug] [MainThread]: SQL status: BEGIN in 1.513 seconds
[0m21:57:38.733785 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:38.735094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:57:38.911802 [debug] [MainThread]: SQL status: SELECT 10 in 0.175 seconds
[0m21:57:38.918067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d52970>]}
[0m21:57:38.918964 [debug] [MainThread]: On master: ROLLBACK
[0m21:57:38.962615 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:38.963779 [debug] [MainThread]: On master: BEGIN
[0m21:57:39.051675 [debug] [MainThread]: SQL status: BEGIN in 0.087 seconds
[0m21:57:39.052927 [debug] [MainThread]: On master: COMMIT
[0m21:57:39.053930 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:39.054874 [debug] [MainThread]: On master: COMMIT
[0m21:57:39.100804 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:57:39.102033 [debug] [MainThread]: On master: Close
[0m21:57:39.111469 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:57:39.111948 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:57:39.112312 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:57:39.112632 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:57:39.113235 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:57:39.113779 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:57:39.114805 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:57:39.115561 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:57:39.116161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:57:39.116701 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:57:39.117171 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:57:39.117605 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:57:39.117977 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:57:39.118281 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:57:39.118558 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:57:39.118830 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:57:39.130950 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:57:39.133947 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:57:39.136175 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:57:39.138615 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:57:39.139213 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:57:39.139450 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:57:39.139636 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:57:39.139804 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:57:39.196931 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:39.198703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:39.200254 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:39.201446 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:39.201611 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215739157365"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:57:39.201756 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp215739158690"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m21:57:39.201895 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp215739199524"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:57:39.202051 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp215739200959"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:57:39.202196 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:57:39.202309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:39.202415 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:57:39.202521 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:57:42.490736 [debug] [Thread-2 (]: SQL status: SELECT 3 in 3.288 seconds
[0m21:57:42.511626 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:42.512091 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:57:42.603859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.091 seconds
[0m21:57:42.604889 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:42.605566 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215739157365'
        
      order by ordinal_position

  
[0m21:57:43.304512 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.698 seconds
[0m21:57:43.313024 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:43.313562 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:43.508509 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.194 seconds
[0m21:57:43.518149 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:43.518507 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215739157365'
        
      order by ordinal_position

  
[0m21:57:44.333891 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.815 seconds
[0m21:57:44.343051 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:44.343659 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:44.640927 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.296 seconds
[0m21:57:44.657250 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:57:44.663404 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:57:44.674126 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:57:44.674849 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:44.675124 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215739157365" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215739157365"
    )
  
[0m21:57:44.804831 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.129 seconds
[0m21:57:44.826394 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:57:44.826787 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:44.827091 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:57:44.906507 [debug] [Thread-2 (]: SQL status: COMMIT in 0.079 seconds
[0m21:57:44.911864 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:57:44.915575 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d23a5b0>]}
[0m21:57:44.916602 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 5.80s]
[0m21:57:44.917373 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:57:46.484261 [debug] [Thread-4 (]: SQL status: SELECT 30901 in 7.281 seconds
[0m21:57:46.492651 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:46.493337 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:57:46.603584 [debug] [Thread-4 (]: SQL status: BEGIN in 0.109 seconds
[0m21:57:46.605185 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:46.606437 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215739199524'
        
      order by ordinal_position

  
[0m21:57:47.105388 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.498 seconds
[0m21:57:47.108642 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:47.109043 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:47.309292 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.200 seconds
[0m21:57:47.315120 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:47.315699 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215739199524'
        
      order by ordinal_position

  
[0m21:57:47.507164 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.190 seconds
[0m21:57:47.514627 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:47.515476 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:48.629146 [debug] [Thread-4 (]: SQL status: SELECT 17 in 1.113 seconds
[0m21:57:48.632302 [debug] [Thread-4 (]: 
    In "dev_ohwk"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:57:48.637607 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:57:48.638358 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:48.638696 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp215739199524"
    )


  
[0m21:57:49.454147 [debug] [Thread-1 (]: SQL status: SELECT 101377 in 10.251 seconds
[0m21:57:49.461545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:49.462323 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:57:49.507195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m21:57:49.508528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:49.509736 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215739158690'
        
      order by ordinal_position

  
[0m21:57:49.905245 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.394 seconds
[0m21:57:49.909809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:49.910368 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:50.106916 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.196 seconds
[0m21:57:50.111702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:50.112355 [debug] [Thread-4 (]: SQL status: INSERT 0 30901 in 1.473 seconds
[0m21:57:50.112848 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215739158690'
        
      order by ordinal_position

  
[0m21:57:50.114422 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:57:50.114959 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:50.115355 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:57:50.207093 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.092 seconds
[0m21:57:50.209604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:50.209932 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:50.306705 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.096 seconds
[0m21:57:50.311939 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:57:50.312758 [debug] [Thread-4 (]: SQL status: COMMIT in 0.197 seconds
[0m21:57:50.314382 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:57:50.315788 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:57:50.317386 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc5c10>]}
[0m21:57:50.317890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:50.318768 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 30901[0m in 11.20s]
[0m21:57:50.319208 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp215739158690"
    )


  
[0m21:57:50.319821 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:57:52.512157 [debug] [Thread-1 (]: SQL status: INSERT 0 101377 in 2.191 seconds
[0m21:57:52.516681 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:57:52.517277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:52.517709 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:57:52.607920 [debug] [Thread-1 (]: SQL status: COMMIT in 0.089 seconds
[0m21:57:52.610545 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:57:52.611864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071205d0>]}
[0m21:57:52.612742 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 101377[0m in 13.50s]
[0m21:57:52.613369 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:57:55.292591 [debug] [Thread-3 (]: SQL status: SELECT 199849 in 16.090 seconds
[0m21:57:55.297916 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:55.298771 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:57:55.344481 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m21:57:55.345369 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:55.345913 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215739200959'
        
      order by ordinal_position

  
[0m21:57:55.397655 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.051 seconds
[0m21:57:55.403705 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:55.404385 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:55.452863 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.048 seconds
[0m21:57:55.461512 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:55.462025 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215739200959'
        
      order by ordinal_position

  
[0m21:57:55.513179 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.050 seconds
[0m21:57:55.518728 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:55.519400 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:56.090621 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.570 seconds
[0m21:57:56.094743 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:57:56.095958 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:57:56.097444 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:56.097949 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp215739200959"
    )


  
[0m21:57:58.106873 [debug] [Thread-3 (]: SQL status: INSERT 0 199849 in 2.008 seconds
[0m21:57:58.108383 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:57:58.108786 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:58.109083 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:57:58.157436 [debug] [Thread-3 (]: SQL status: COMMIT in 0.048 seconds
[0m21:57:58.160339 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:57:58.161815 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2853b0>]}
[0m21:57:58.162814 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mINSERT 0 199849[0m in 19.04s]
[0m21:57:58.163692 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:57:58.165621 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:58.166140 [debug] [MainThread]: On master: BEGIN
[0m21:57:58.166561 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:57:58.954462 [debug] [MainThread]: SQL status: BEGIN in 0.788 seconds
[0m21:57:58.955871 [debug] [MainThread]: On master: COMMIT
[0m21:57:58.956835 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:58.957424 [debug] [MainThread]: On master: COMMIT
[0m21:57:59.005940 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m21:57:59.007419 [debug] [MainThread]: On master: Close
[0m21:57:59.009495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:59.010107 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:57:59.010577 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:57:59.010997 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:57:59.011415 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:57:59.012095 [info ] [MainThread]: 
[0m21:57:59.012691 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 23.74 seconds (23.74s).
[0m21:57:59.014501 [debug] [MainThread]: Command end result
[0m21:57:59.044544 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:57:59.045845 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:57:59.049638 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:57:59.049845 [info ] [MainThread]: 
[0m21:57:59.050061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:57:59.050225 [info ] [MainThread]: 
[0m21:57:59.050396 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:57:59.051357 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 24.051727, "process_in_blocks": "0", "process_kernel_time": 0.157145, "process_mem_max_rss": "138510336", "process_out_blocks": "0", "process_user_time": 1.198997}
[0m21:57:59.051615 [debug] [MainThread]: Command `dbt build` succeeded at 21:57:59.051565 after 24.05 seconds
[0m21:57:59.051808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d91350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d01c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d47230>]}
[0m21:57:59.051994 [debug] [MainThread]: Flushing usage events
[0m21:58:00.358286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:28.517143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11101f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a27b10>]}


============================== 21:58:28.519444 | 2551b046-426a-4f39-854f-8729966d45f2 ==============================
[0m21:58:28.519444 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:58:28.519707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build -s config.materialized:incremental', 'send_anonymous_usage_stats': 'True'}
[0m21:58:28.587816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a27490>]}
[0m21:58:28.609798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128be030>]}
[0m21:58:28.610375 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:58:28.647997 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:58:28.700254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:58:28.700445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:58:28.719378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138db450>]}
[0m21:58:28.752677 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:58:28.753812 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:58:28.769691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b59e50>]}
[0m21:58:28.769914 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:58:28.770781 [info ] [MainThread]: 
[0m21:58:28.770927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:58:28.771038 [info ] [MainThread]: 
[0m21:58:28.771242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:58:28.772807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:58:28.795591 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:58:28.795799 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:58:28.795922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:29.433655 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.637 seconds
[0m21:58:29.437462 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:58:29.443103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:58:29.451756 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:58:29.452393 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:58:29.452722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:30.273680 [debug] [ThreadPool]: SQL status: BEGIN in 0.821 seconds
[0m21:58:30.275232 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:58:30.276349 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:58:30.328062 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.051 seconds
[0m21:58:30.332005 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:58:30.392002 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:58:30.406513 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:30.406984 [debug] [MainThread]: On master: BEGIN
[0m21:58:30.407326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:58:31.932394 [debug] [MainThread]: SQL status: BEGIN in 1.525 seconds
[0m21:58:31.933287 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:31.933914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:58:32.040250 [debug] [MainThread]: SQL status: SELECT 10 in 0.106 seconds
[0m21:58:32.046933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b72970>]}
[0m21:58:32.047820 [debug] [MainThread]: On master: ROLLBACK
[0m21:58:32.088960 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:32.090002 [debug] [MainThread]: On master: BEGIN
[0m21:58:32.204779 [debug] [MainThread]: SQL status: BEGIN in 0.114 seconds
[0m21:58:32.205741 [debug] [MainThread]: On master: COMMIT
[0m21:58:32.206384 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:32.206938 [debug] [MainThread]: On master: COMMIT
[0m21:58:32.248119 [debug] [MainThread]: SQL status: COMMIT in 0.040 seconds
[0m21:58:32.249391 [debug] [MainThread]: On master: Close
[0m21:58:32.258921 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:58:32.259538 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:58:32.259996 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:58:32.260396 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:58:32.261092 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:58:32.261733 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:58:32.262323 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:58:32.262883 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:58:32.263515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:58:32.264120 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:58:32.264624 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:58:32.265274 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:58:32.266093 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:58:32.266546 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:58:32.266938 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:58:32.267410 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:58:32.284840 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:58:32.290004 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:58:32.293809 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:58:32.297680 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:58:32.298540 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:58:32.304833 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:58:32.305263 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:58:32.311960 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:58:32.366702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:32.368170 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:32.368800 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:32.370034 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:32.370202 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp215832354677"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m21:58:32.370360 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp215832367665"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:58:32.370539 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp215832357726"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:58:32.370715 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215832369504"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:58:32.370854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:32.370989 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:58:32.371120 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:58:32.371250 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:58:34.503732 [debug] [Thread-2 (]: SQL status: SELECT 3 in 2.132 seconds
[0m21:58:34.521653 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:34.522061 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:58:34.623660 [debug] [Thread-2 (]: SQL status: BEGIN in 0.101 seconds
[0m21:58:34.625282 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:34.626099 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215832369504'
        
      order by ordinal_position

  
[0m21:58:35.134675 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.507 seconds
[0m21:58:35.146145 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:35.146908 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:35.432139 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.284 seconds
[0m21:58:35.449832 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:35.450207 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215832369504'
        
      order by ordinal_position

  
[0m21:58:35.602399 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.151 seconds
[0m21:58:35.610064 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:35.610807 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:35.707166 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.095 seconds
[0m21:58:35.723027 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:58:35.728849 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:58:35.738851 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:58:35.739436 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:35.739681 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215832369504" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215832369504"
    )
  
[0m21:58:35.806507 [debug] [Thread-4 (]: SQL status: SELECT 0 in 3.435 seconds
[0m21:58:35.811176 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:35.811774 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.072 seconds
[0m21:58:35.812161 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:58:35.825467 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:58:35.825790 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:35.826045 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:58:35.871155 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m21:58:35.871608 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:35.871991 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215832367665'
        
      order by ordinal_position

  
[0m21:58:35.903610 [debug] [Thread-1 (]: SQL status: SELECT 0 in 3.533 seconds
[0m21:58:35.908748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:35.909260 [debug] [Thread-2 (]: SQL status: COMMIT in 0.083 seconds
[0m21:58:35.909752 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:58:35.912637 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:58:35.916686 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11464e0d0>]}
[0m21:58:35.917441 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 3.65s]
[0m21:58:35.918085 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:58:36.006159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.093 seconds
[0m21:58:36.006957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:36.007333 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215832354677'
        
      order by ordinal_position

  
[0m21:58:36.203561 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.195 seconds
[0m21:58:36.211772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:36.212345 [debug] [Thread-3 (]: SQL status: SELECT 0 in 3.841 seconds
[0m21:58:36.212840 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:36.215931 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.216536 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:58:36.304905 [debug] [Thread-3 (]: SQL status: BEGIN in 0.088 seconds
[0m21:58:36.306105 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.307154 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.435 seconds
[0m21:58:36.308389 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215832357726'
        
      order by ordinal_position

  
[0m21:58:36.309605 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.093 seconds
[0m21:58:36.313982 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:36.317430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:36.317894 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:36.318496 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215832354677'
        
      order by ordinal_position

  
[0m21:58:36.407136 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.088 seconds
[0m21:58:36.408599 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.089 seconds
[0m21:58:36.409818 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.095 seconds
[0m21:58:36.414921 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:36.418380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:36.421396 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.421915 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215832367665'
        
      order by ordinal_position

  
[0m21:58:36.422331 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:36.422729 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:36.507218 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.084 seconds
[0m21:58:36.508501 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.085 seconds
[0m21:58:36.509384 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.086 seconds
[0m21:58:36.513070 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:58:36.518933 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:36.522960 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.529811 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:58:36.530308 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:36.530697 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215832357726'
        
      order by ordinal_position

  
[0m21:58:36.531565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:36.531893 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp215832354677"
    )


  
[0m21:58:36.603695 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.071 seconds
[0m21:58:36.604854 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.074 seconds
[0m21:58:36.607669 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:58:36.608337 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.077 seconds
[0m21:58:36.612908 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.613381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:36.616498 [debug] [Thread-4 (]: 
    In "dev_ohwk"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:58:36.616865 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:36.617183 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:58:36.618007 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:58:36.618815 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:36.619261 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp215832367665"
    )


  
[0m21:58:36.696394 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.077 seconds
[0m21:58:36.697806 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:58:36.698220 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.080 seconds
[0m21:58:36.698591 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:36.698887 [debug] [Thread-1 (]: SQL status: COMMIT in 0.081 seconds
[0m21:58:36.700330 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:58:36.700692 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:58:36.701359 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:58:36.702032 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:58:36.702686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ba5910>]}
[0m21:58:36.703622 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.703296 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 0[0m in 4.44s]
[0m21:58:36.704055 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp215832357726"
    )


  
[0m21:58:36.704490 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:58:36.750887 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.046 seconds
[0m21:58:36.751291 [debug] [Thread-4 (]: SQL status: COMMIT in 0.049 seconds
[0m21:58:36.752879 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:58:36.753466 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:58:36.753755 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.754061 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:58:36.754464 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b1a570>]}
[0m21:58:36.755057 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 0[0m in 4.49s]
[0m21:58:36.755507 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:58:36.800417 [debug] [Thread-3 (]: SQL status: COMMIT in 0.046 seconds
[0m21:58:36.801256 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:58:36.801950 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146ef9d0>]}
[0m21:58:36.802632 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mINSERT 0 0[0m in 4.54s]
[0m21:58:36.803154 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:58:36.804369 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:36.804649 [debug] [MainThread]: On master: BEGIN
[0m21:58:36.804892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:58:37.419250 [debug] [MainThread]: SQL status: BEGIN in 0.614 seconds
[0m21:58:37.420891 [debug] [MainThread]: On master: COMMIT
[0m21:58:37.422095 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:37.422981 [debug] [MainThread]: On master: COMMIT
[0m21:58:37.466440 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m21:58:37.467986 [debug] [MainThread]: On master: Close
[0m21:58:37.469765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:37.470380 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:58:37.470880 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:58:37.471339 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:58:37.471767 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:58:37.472475 [info ] [MainThread]: 
[0m21:58:37.473112 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 8.70 seconds (8.70s).
[0m21:58:37.475306 [debug] [MainThread]: Command end result
[0m21:58:37.506179 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:58:37.507423 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:58:37.511193 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:58:37.511383 [info ] [MainThread]: 
[0m21:58:37.511603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:58:37.511766 [info ] [MainThread]: 
[0m21:58:37.511947 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:58:37.513582 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.023063, "process_in_blocks": "0", "process_kernel_time": 0.162269, "process_mem_max_rss": "138706944", "process_out_blocks": "0", "process_user_time": 1.197076}
[0m21:58:37.513876 [debug] [MainThread]: Command `dbt build` succeeded at 21:58:37.513820 after 9.02 seconds
[0m21:58:37.514096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11395d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a01c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a47230>]}
[0m21:58:37.514298 [debug] [MainThread]: Flushing usage events
[0m21:58:38.033113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:35:34.513868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110527b10>]}


============================== 21:35:34.516972 | 80538c36-cd98-4d41-bb2f-eac3447335e1 ==============================
[0m21:35:34.516972 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:35:34.517307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ls -s trips_prep+', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:34.796879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80538c36-cd98-4d41-bb2f-eac3447335e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2b490>]}
[0m21:35:34.818109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80538c36-cd98-4d41-bb2f-eac3447335e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103be140>]}
[0m21:35:34.818719 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:35:34.866429 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:35:34.916928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:34.917106 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:34.934978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80538c36-cd98-4d41-bb2f-eac3447335e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bfb150>]}
[0m21:35:34.966022 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:35:34.967856 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:35:34.978206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80538c36-cd98-4d41-bb2f-eac3447335e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cdd6d0>]}
[0m21:35:34.978395 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 436 macros
[0m21:35:34.978533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80538c36-cd98-4d41-bb2f-eac3447335e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11132e5f0>]}
[0m21:35:34.978901 [info ] [MainThread]: dbt_scooters.companies_trips
[0m21:35:34.979042 [info ] [MainThread]: dbt_scooters.revenue_daily
[0m21:35:34.979147 [info ] [MainThread]: dbt_scooters.trips_age_daily
[0m21:35:34.979242 [info ] [MainThread]: dbt_scooters.trips_age_daily_stat
[0m21:35:34.979335 [info ] [MainThread]: dbt_scooters.trips_age_group
[0m21:35:34.979428 [info ] [MainThread]: dbt_scooters.trips_prep
[0m21:35:34.979526 [info ] [MainThread]: dbt_scooters.trips_stat
[0m21:35:34.979627 [info ] [MainThread]: dbt_scooters.trips_users
[0m21:35:35.008648 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.53002405, "process_in_blocks": "0", "process_kernel_time": 0.13378, "process_mem_max_rss": "119029760", "process_out_blocks": "0", "process_user_time": 0.733925}
[0m21:35:35.008957 [debug] [MainThread]: Command `dbt ls` succeeded at 21:35:35.008909 after 0.53 seconds
[0m21:35:35.009142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e264e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110404dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d62990>]}
[0m21:35:35.009300 [debug] [MainThread]: Flushing usage events
[0m21:35:35.847939 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:35:46.529243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076734d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6bb10>]}


============================== 21:35:46.531007 | 448cf7c7-f652-41fd-b9df-e602dfe3f5b0 ==============================
[0m21:35:46.531007 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:35:46.531261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build -s trips_prep+ --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m21:35:46.594462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6f490>]}
[0m21:35:46.614891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a02030>]}
[0m21:35:46.615200 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:35:46.648729 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:35:46.691722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:46.691909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:46.709728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097eb450>]}
[0m21:35:46.741404 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:35:46.742258 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:35:46.755337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a6de50>]}
[0m21:35:46.755541 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 436 macros
[0m21:35:46.756529 [info ] [MainThread]: 
[0m21:35:46.756674 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:46.756787 [info ] [MainThread]: 
[0m21:35:46.757000 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:35:46.758669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:35:46.794519 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:35:46.794728 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:35:46.794847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:47.693502 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.898 seconds
[0m21:35:47.696590 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:35:47.701417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:35:47.709933 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:35:47.710460 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:35:47.711173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:48.335284 [debug] [ThreadPool]: SQL status: BEGIN in 0.624 seconds
[0m21:35:48.336313 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:35:48.337217 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:35:48.386288 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.048 seconds
[0m21:35:48.390068 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:35:48.434639 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:35:48.449294 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:48.449831 [debug] [MainThread]: On master: BEGIN
[0m21:35:48.450206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:49.165395 [debug] [MainThread]: SQL status: BEGIN in 0.715 seconds
[0m21:35:49.166319 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:49.166992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:35:49.335929 [debug] [MainThread]: SQL status: SELECT 10 in 0.168 seconds
[0m21:35:49.339454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a47d90>]}
[0m21:35:49.340212 [debug] [MainThread]: On master: ROLLBACK
[0m21:35:49.387343 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:49.388205 [debug] [MainThread]: On master: BEGIN
[0m21:35:49.479459 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m21:35:49.480393 [debug] [MainThread]: On master: COMMIT
[0m21:35:49.481032 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:49.481619 [debug] [MainThread]: On master: COMMIT
[0m21:35:49.530933 [debug] [MainThread]: SQL status: COMMIT in 0.049 seconds
[0m21:35:49.531681 [debug] [MainThread]: On master: Close
[0m21:35:49.536697 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m21:35:49.537411 [info ] [Thread-1 (]: 1 of 8 START sql view model dbt.trips_prep ..................................... [RUN]
[0m21:35:49.537983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.trips_prep)
[0m21:35:49.538543 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m21:35:49.548278 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m21:35:49.549646 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m21:35:49.576213 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m21:35:49.577328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:35:49.577591 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m21:35:49.577796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:51.196660 [debug] [Thread-1 (]: SQL status: BEGIN in 1.619 seconds
[0m21:35:51.197574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:35:51.198084 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_ohwk"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  );
[0m21:35:51.252710 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m21:35:51.261941 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:35:51.262619 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m21:35:51.314433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.051 seconds
[0m21:35:51.328332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:35:51.329022 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m21:35:51.372421 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m21:35:51.390863 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:35:51.391332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:35:51.391585 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:35:51.436893 [debug] [Thread-1 (]: SQL status: COMMIT in 0.045 seconds
[0m21:35:51.443599 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_prep__dbt_backup"
[0m21:35:51.447674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:35:51.447961 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_ohwk"."dbt"."trips_prep__dbt_backup" cascade
[0m21:35:51.494052 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.046 seconds
[0m21:35:51.495656 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m21:35:51.497587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed3ad0>]}
[0m21:35:51.498029 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dbt.trips_prep ................................ [[32mCREATE VIEW[0m in 1.96s]
[0m21:35:51.498416 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m21:35:51.498929 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies_trips
[0m21:35:51.499207 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat
[0m21:35:51.499429 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_users
[0m21:35:51.499627 [debug] [Thread-3 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:35:51.499869 [info ] [Thread-2 (]: 2 of 8 START sql table model dbt.companies_trips ............................... [RUN]
[0m21:35:51.500158 [info ] [Thread-4 (]: 4 of 8 START sql table model dbt.trips_stat .................................... [RUN]
[0m21:35:51.500416 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:35:51.500644 [info ] [Thread-3 (]: 3 of 8 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:35:51.500929 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.companies_trips'
[0m21:35:51.501158 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_stat'
[0m21:35:51.501339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.trips_users)
[0m21:35:51.501546 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:35:51.501713 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies_trips
[0m21:35:51.501873 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat
[0m21:35:51.502024 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:35:51.502175 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:35:51.533648 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m21:35:51.534699 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m21:35:51.538821 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:35:51.540075 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:35:51.541608 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies_trips
[0m21:35:51.541782 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat
[0m21:35:51.541937 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_users
[0m21:35:51.550514 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m21:35:51.550696 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:35:51.551766 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m21:35:51.562218 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:35:51.564104 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:51.564377 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp213551562960"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:35:51.564556 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:35:51.564838 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:35:51.565152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:35:51.565290 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:35:51.565417 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m21:35:51.565541 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:35:51.565660 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m21:35:51.565776 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:35:51.565888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:51.566000 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:35:52.330990 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.766 seconds
[0m21:35:52.353250 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.353660 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:35:52.396519 [debug] [Thread-3 (]: SQL status: BEGIN in 0.042 seconds
[0m21:35:52.397397 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.397981 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp213551562960'
        
      order by ordinal_position

  
[0m21:35:52.448963 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.050 seconds
[0m21:35:52.460544 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.461112 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:35:52.516129 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.054 seconds
[0m21:35:52.535756 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.536233 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp213551562960'
        
      order by ordinal_position

  
[0m21:35:52.583166 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.047 seconds
[0m21:35:52.586260 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.586627 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:35:52.635248 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.048 seconds
[0m21:35:52.650168 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:35:52.657082 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:35:52.668409 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:35:52.669026 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.669286 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp213551562960" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp213551562960"
    )
  
[0m21:35:52.713467 [debug] [Thread-3 (]: SQL status: INSERT 0 3 in 0.044 seconds
[0m21:35:52.714770 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:35:52.715102 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.715379 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:35:52.759547 [debug] [Thread-3 (]: SQL status: COMMIT in 0.044 seconds
[0m21:35:52.760296 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:35:52.761017 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab25d0>]}
[0m21:35:52.761619 [info ] [Thread-3 (]: 3 of 8 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 1.26s]
[0m21:35:52.762118 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:35:53.040352 [debug] [Thread-1 (]: SQL status: BEGIN in 1.474 seconds
[0m21:35:53.041796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:35:53.042526 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_users__dbt_tmp"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

      where
          t.id <= 75000

  );
  
  
[0m21:35:53.068626 [debug] [Thread-4 (]: SQL status: BEGIN in 1.502 seconds
[0m21:35:53.069637 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:35:53.070532 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_ohwk"."dbt"."trips_prep"
  );
  
[0m21:35:53.117814 [debug] [Thread-2 (]: SQL status: BEGIN in 1.552 seconds
[0m21:35:53.118675 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:35:53.119264 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
  
[0m21:35:54.437863 [debug] [Thread-2 (]: SQL status: SELECT 6 in 1.318 seconds
[0m21:35:54.448946 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:35:54.449499 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m21:35:54.532112 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.082 seconds
[0m21:35:54.536836 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:35:54.537424 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:35:54.537857 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:35:54.639055 [debug] [Thread-2 (]: SQL status: COMMIT in 0.101 seconds
[0m21:35:54.641798 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m21:35:54.645103 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:35:54.645491 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m21:35:54.729729 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.084 seconds
[0m21:35:54.731460 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: Close
[0m21:35:54.732304 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3de90>]}
[0m21:35:54.732984 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dbt.companies_trips .......................... [[32mSELECT 6[0m in 3.23s]
[0m21:35:54.733581 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies_trips
[0m21:35:57.030251 [debug] [Thread-4 (]: SQL status: SELECT 1 in 3.959 seconds
[0m21:35:57.038958 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:35:57.039715 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m21:35:57.084776 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m21:35:57.087698 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:35:57.088623 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:35:57.089341 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:35:57.138556 [debug] [Thread-4 (]: SQL status: COMMIT in 0.048 seconds
[0m21:35:57.141987 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat__dbt_backup"
[0m21:35:57.142762 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:35:57.143163 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_stat__dbt_backup" cascade
[0m21:35:57.188189 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.044 seconds
[0m21:35:57.190602 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: Close
[0m21:35:57.191997 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118482030>]}
[0m21:35:57.193090 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dbt.trips_stat ............................... [[32mSELECT 1[0m in 5.69s]
[0m21:35:57.194331 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat
[0m21:35:57.770191 [debug] [Thread-1 (]: SQL status: SELECT 75000 in 4.727 seconds
[0m21:35:57.774701 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:35:57.775188 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users" rename to "trips_users__dbt_backup"
[0m21:35:57.820217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m21:35:57.823617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:35:57.824158 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users__dbt_tmp" rename to "trips_users"
[0m21:35:57.869442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m21:35:57.872105 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:35:57.872799 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:35:57.873406 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:35:57.922344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.048 seconds
[0m21:35:57.927368 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_users__dbt_backup"
[0m21:35:57.928397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:35:57.929069 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
drop table if exists "dev_ohwk"."dbt"."trips_users__dbt_backup" cascade
[0m21:35:57.977443 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.048 seconds
[0m21:35:57.980317 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: Close
[0m21:35:57.981971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10988a5d0>]}
[0m21:35:57.983035 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model dbt.trips_users ........................ [[32mSELECT 75000[0m in 6.48s]
[0m21:35:57.983859 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_users
[0m21:35:57.985403 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m21:35:57.985942 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m21:35:57.986620 [info ] [Thread-2 (]: 7 of 8 START sql table model dbt.trips_age_group ............................... [RUN]
[0m21:35:57.987389 [info ] [Thread-3 (]: 6 of 8 START sql table model dbt.trips_age_daily ............................... [RUN]
[0m21:35:57.988284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_group)
[0m21:35:57.988864 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_age_daily)
[0m21:35:57.989353 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m21:35:57.989753 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m21:35:57.994710 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m21:35:57.997489 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m21:35:57.999185 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m21:35:57.999533 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m21:35:58.002283 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m21:35:58.005139 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m21:35:58.006022 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:35:58.006374 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:35:58.006690 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m21:35:58.006966 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m21:35:58.007232 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:35:58.007481 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:35:59.084720 [debug] [Thread-3 (]: SQL status: BEGIN in 1.077 seconds
[0m21:35:59.085578 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:35:59.086039 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m21:35:59.930727 [debug] [Thread-2 (]: SQL status: BEGIN in 1.923 seconds
[0m21:35:59.931633 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:35:59.932204 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users" as tu
    cross join "dev_ohwk"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m21:36:00.336641 [debug] [Thread-3 (]: SQL status: SELECT 4946 in 1.249 seconds
[0m21:36:00.343513 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:00.344009 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m21:36:00.430815 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.086 seconds
[0m21:36:00.434740 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:36:00.435844 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:00.436423 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:36:00.536784 [debug] [Thread-3 (]: SQL status: COMMIT in 0.100 seconds
[0m21:36:00.543054 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily__dbt_backup"
[0m21:36:00.544162 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:00.544783 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily__dbt_backup" cascade
[0m21:36:00.632894 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.087 seconds
[0m21:36:00.636237 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m21:36:00.637734 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11847fcb0>]}
[0m21:36:00.638794 [info ] [Thread-3 (]: 6 of 8 OK created sql table model dbt.trips_age_daily .......................... [[32mSELECT 4946[0m in 2.65s]
[0m21:36:00.639641 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m21:36:00.640580 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m21:36:00.641373 [info ] [Thread-4 (]: 8 of 8 START sql table model dbt.trips_age_daily_stat .......................... [RUN]
[0m21:36:00.642096 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_age_daily_stat)
[0m21:36:00.642571 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m21:36:00.646604 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:00.649159 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m21:36:00.657052 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:00.657934 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:00.658286 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m21:36:00.658582 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:36:01.934829 [debug] [Thread-4 (]: SQL status: BEGIN in 1.276 seconds
[0m21:36:01.936182 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:01.937261 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_ohwk"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m21:36:02.131713 [debug] [Thread-4 (]: SQL status: SELECT 83 in 0.193 seconds
[0m21:36:02.138398 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:02.139138 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m21:36:02.233681 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m21:36:02.237219 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:36:02.238036 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:02.238685 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:36:02.334263 [debug] [Thread-4 (]: SQL status: COMMIT in 0.095 seconds
[0m21:36:02.338039 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup"
[0m21:36:02.338925 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:02.339577 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m21:36:02.432277 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.092 seconds
[0m21:36:02.434508 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m21:36:02.435736 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d1130>]}
[0m21:36:02.436755 [info ] [Thread-4 (]: 8 of 8 OK created sql table model dbt.trips_age_daily_stat ..................... [[32mSELECT 83[0m in 1.79s]
[0m21:36:02.437368 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m21:36:10.235133 [debug] [Thread-2 (]: SQL status: SELECT 7 in 10.302 seconds
[0m21:36:10.242820 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:10.243328 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m21:36:10.291598 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m21:36:10.295818 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:36:10.297010 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:10.297984 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:36:10.342674 [debug] [Thread-2 (]: SQL status: COMMIT in 0.044 seconds
[0m21:36:10.348114 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_group__dbt_backup"
[0m21:36:10.348944 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:10.349397 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_group__dbt_backup" cascade
[0m21:36:10.400952 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.051 seconds
[0m21:36:10.404785 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m21:36:10.406219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e33cb0>]}
[0m21:36:10.407298 [info ] [Thread-2 (]: 7 of 8 OK created sql table model dbt.trips_age_group .......................... [[32mSELECT 7[0m in 12.42s]
[0m21:36:10.408187 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m21:36:10.410403 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:10.410839 [debug] [MainThread]: On master: BEGIN
[0m21:36:10.411207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:11.420082 [debug] [MainThread]: SQL status: BEGIN in 1.009 seconds
[0m21:36:11.421588 [debug] [MainThread]: On master: COMMIT
[0m21:36:11.422616 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:11.423530 [debug] [MainThread]: On master: COMMIT
[0m21:36:11.472994 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m21:36:11.474215 [debug] [MainThread]: On master: Close
[0m21:36:11.476120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:11.477010 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:36:11.477830 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m21:36:11.478637 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m21:36:11.479074 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m21:36:11.479752 [info ] [MainThread]: 
[0m21:36:11.480310 [info ] [MainThread]: Finished running 2 incremental models, 5 table models, 1 view model in 0 hours 0 minutes and 24.72 seconds (24.72s).
[0m21:36:11.482909 [debug] [MainThread]: Command end result
[0m21:36:11.510768 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:36:11.512205 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:36:11.516801 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:36:11.517052 [info ] [MainThread]: 
[0m21:36:11.517293 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:11.517476 [info ] [MainThread]: 
[0m21:36:11.517660 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m21:36:11.518681 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 25.014128, "process_in_blocks": "0", "process_kernel_time": 0.176546, "process_mem_max_rss": "140394496", "process_out_blocks": "0", "process_user_time": 1.324771}
[0m21:36:11.518953 [debug] [MainThread]: Command `dbt build` succeeded at 21:36:11.518898 after 25.01 seconds
[0m21:36:11.519168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e18290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118453e30>]}
[0m21:36:11.519373 [debug] [MainThread]: Flushing usage events
[0m21:36:12.186209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:36:14.412792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112227b10>]}


============================== 21:36:14.414556 | 502f8149-2376-4d58-b933-5b34fa36b901 ==============================
[0m21:36:14.414556 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:36:14.414822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -s trips_prep+', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:36:14.476768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110927490>]}
[0m21:36:14.497303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120be030>]}
[0m21:36:14.497655 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:36:14.532475 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:36:14.578679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:36:14.578872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:36:14.597794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11285f450>]}
[0m21:36:14.631172 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:36:14.632127 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:36:14.643038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f2de50>]}
[0m21:36:14.643258 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 436 macros
[0m21:36:14.644248 [info ] [MainThread]: 
[0m21:36:14.644400 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:36:14.644522 [info ] [MainThread]: 
[0m21:36:14.644735 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:36:14.646307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:36:14.664665 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:36:14.664868 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:36:14.664990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:15.364988 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.700 seconds
[0m21:36:15.368397 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:36:15.374437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:36:15.383017 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:36:15.383580 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:36:15.383907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:16.004642 [debug] [ThreadPool]: SQL status: BEGIN in 0.620 seconds
[0m21:36:16.005195 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:36:16.005491 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:36:16.053323 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.047 seconds
[0m21:36:16.055285 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:36:16.100167 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:36:16.112788 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:16.113295 [debug] [MainThread]: On master: BEGIN
[0m21:36:16.113617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:36:17.603376 [debug] [MainThread]: SQL status: BEGIN in 1.490 seconds
[0m21:36:17.604894 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:17.606226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:36:17.837165 [debug] [MainThread]: SQL status: SELECT 6 in 0.230 seconds
[0m21:36:17.841662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f07d90>]}
[0m21:36:17.842546 [debug] [MainThread]: On master: ROLLBACK
[0m21:36:17.887290 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:17.888444 [debug] [MainThread]: On master: BEGIN
[0m21:36:17.980733 [debug] [MainThread]: SQL status: BEGIN in 0.091 seconds
[0m21:36:17.981890 [debug] [MainThread]: On master: COMMIT
[0m21:36:17.982874 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:17.983723 [debug] [MainThread]: On master: COMMIT
[0m21:36:18.031115 [debug] [MainThread]: SQL status: COMMIT in 0.047 seconds
[0m21:36:18.032370 [debug] [MainThread]: On master: Close
[0m21:36:18.040335 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m21:36:18.041407 [info ] [Thread-1 (]: 1 of 8 START sql view model dbt.trips_prep ..................................... [RUN]
[0m21:36:18.042258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.trips_prep)
[0m21:36:18.042831 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m21:36:18.052121 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m21:36:18.053309 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m21:36:18.079094 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m21:36:18.079650 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:36:18.079852 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m21:36:18.080029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:36:18.736705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.656 seconds
[0m21:36:18.738562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:36:18.739488 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_ohwk"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  );
[0m21:36:18.788933 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m21:36:18.801753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:36:18.802387 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m21:36:18.850526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m21:36:18.864953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:36:18.865560 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m21:36:18.912868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m21:36:18.935964 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:36:18.936564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:36:18.936889 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:36:18.981113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.044 seconds
[0m21:36:18.990177 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_prep__dbt_backup"
[0m21:36:18.994615 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:36:18.994992 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_ohwk"."dbt"."trips_prep__dbt_backup" cascade
[0m21:36:19.042062 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.046 seconds
[0m21:36:19.046500 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m21:36:19.048977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e3a00>]}
[0m21:36:19.049762 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dbt.trips_prep ................................ [[32mCREATE VIEW[0m in 1.01s]
[0m21:36:19.050421 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m21:36:19.051419 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies_trips
[0m21:36:19.051950 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_users
[0m21:36:19.052383 [debug] [Thread-3 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:36:19.052714 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat
[0m21:36:19.053145 [info ] [Thread-2 (]: 2 of 8 START sql table model dbt.companies_trips ............................... [RUN]
[0m21:36:19.053597 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:36:19.054081 [info ] [Thread-3 (]: 3 of 8 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:36:19.054642 [info ] [Thread-4 (]: 4 of 8 START sql table model dbt.trips_stat .................................... [RUN]
[0m21:36:19.055128 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.companies_trips'
[0m21:36:19.055453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.trips_users)
[0m21:36:19.055828 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:36:19.056181 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_stat'
[0m21:36:19.056492 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies_trips
[0m21:36:19.056783 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:36:19.057067 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:36:19.057344 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat
[0m21:36:19.096269 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m21:36:19.100641 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:36:19.102165 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:36:19.103083 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m21:36:19.103616 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies_trips
[0m21:36:19.103805 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat
[0m21:36:19.103965 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_users
[0m21:36:19.104096 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:36:19.113941 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m21:36:19.115216 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m21:36:19.127326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:19.128758 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:19.129051 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp213619125186"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:36:19.129225 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp213619128103"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:36:19.129402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:36:19.129568 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:36:19.129796 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:36:19.129959 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:36:19.130154 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m21:36:19.130292 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m21:36:19.130411 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:36:19.130527 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:36:20.432642 [debug] [Thread-4 (]: SQL status: BEGIN in 1.301 seconds
[0m21:36:20.434376 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:36:20.435675 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_ohwk"."dbt"."trips_prep"
  );
  
[0m21:36:20.730465 [debug] [Thread-2 (]: SQL status: BEGIN in 1.599 seconds
[0m21:36:20.732110 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:36:20.732848 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
  
[0m21:36:20.735390 [debug] [Thread-3 (]: SQL status: SELECT 3 in 1.606 seconds
[0m21:36:20.756321 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:20.756754 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:36:20.831608 [debug] [Thread-3 (]: SQL status: BEGIN in 0.074 seconds
[0m21:36:20.833271 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:20.834475 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp213619128103'
        
      order by ordinal_position

  
[0m21:36:21.630553 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.795 seconds
[0m21:36:21.636182 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:21.636560 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:36:21.834419 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.197 seconds
[0m21:36:21.853714 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:21.854153 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp213619128103'
        
      order by ordinal_position

  
[0m21:36:22.243956 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.389 seconds
[0m21:36:22.249951 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:22.250536 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:36:22.756853 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.505 seconds
[0m21:36:22.770472 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:36:22.776056 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:36:22.786100 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:36:22.786643 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:22.786900 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp213619128103" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp213619128103"
    )
  
[0m21:36:22.833860 [debug] [Thread-2 (]: SQL status: SELECT 6 in 2.100 seconds
[0m21:36:22.839686 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:36:22.840015 [debug] [Thread-3 (]: SQL status: INSERT 0 3 in 0.053 seconds
[0m21:36:22.840315 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m21:36:22.841418 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:36:22.841737 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:22.841985 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:36:22.931963 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m21:36:22.938501 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:36:22.939023 [debug] [Thread-3 (]: SQL status: COMMIT in 0.097 seconds
[0m21:36:22.939444 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m21:36:22.940403 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:36:22.941666 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f72a50>]}
[0m21:36:22.942496 [info ] [Thread-3 (]: 3 of 8 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 3.89s]
[0m21:36:22.943115 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:36:23.048325 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.107 seconds
[0m21:36:23.051124 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:36:23.051722 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:36:23.052175 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:36:23.145431 [debug] [Thread-2 (]: SQL status: COMMIT in 0.092 seconds
[0m21:36:23.151706 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m21:36:23.156683 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:36:23.157185 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m21:36:23.247392 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.089 seconds
[0m21:36:23.251405 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: Close
[0m21:36:23.252996 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112efde90>]}
[0m21:36:23.254188 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dbt.companies_trips .......................... [[32mSELECT 6[0m in 4.20s]
[0m21:36:23.255145 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies_trips
[0m21:36:25.007227 [debug] [Thread-1 (]: SQL status: SELECT 30901 in 5.877 seconds
[0m21:36:25.014450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:25.015203 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:36:25.132661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.116 seconds
[0m21:36:25.134136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:25.135294 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp213619125186'
        
      order by ordinal_position

  
[0m21:36:25.433940 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.297 seconds
[0m21:36:25.440751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:25.441257 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:36:25.632799 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.190 seconds
[0m21:36:25.640877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:25.641462 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp213619125186'
        
      order by ordinal_position

  
[0m21:36:25.843606 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.201 seconds
[0m21:36:25.851172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:25.851904 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:36:25.938360 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.085 seconds
[0m21:36:25.944596 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:36:25.952082 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:36:25.953160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:25.953520 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp213619125186"
    )


  
[0m21:36:26.986569 [debug] [Thread-4 (]: SQL status: SELECT 1 in 6.550 seconds
[0m21:36:26.994753 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:36:26.995393 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m21:36:27.133686 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.137 seconds
[0m21:36:27.140554 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:36:27.141248 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m21:36:27.230326 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m21:36:27.234381 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:36:27.235023 [debug] [Thread-1 (]: SQL status: INSERT 0 30901 in 1.281 seconds
[0m21:36:27.235695 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:36:27.237864 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:36:27.238526 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:36:27.239176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:27.239893 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:36:27.337975 [debug] [Thread-1 (]: SQL status: COMMIT in 0.097 seconds
[0m21:36:27.339343 [debug] [Thread-4 (]: SQL status: COMMIT in 0.099 seconds
[0m21:36:27.341526 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: Close
[0m21:36:27.346633 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat__dbt_backup"
[0m21:36:27.347675 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:36:27.348411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114485d10>]}
[0m21:36:27.348866 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_stat__dbt_backup" cascade
[0m21:36:27.349823 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 30901[0m in 8.29s]
[0m21:36:27.350686 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_users
[0m21:36:27.351473 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m21:36:27.351834 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m21:36:27.352320 [info ] [Thread-2 (]: 7 of 8 START sql table model dbt.trips_age_group ............................... [RUN]
[0m21:36:27.352877 [info ] [Thread-3 (]: 6 of 8 START sql table model dbt.trips_age_daily ............................... [RUN]
[0m21:36:27.353360 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_group)
[0m21:36:27.353758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_age_daily)
[0m21:36:27.354126 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m21:36:27.354468 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m21:36:27.358007 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m21:36:27.360683 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m21:36:27.361562 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m21:36:27.365222 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m21:36:27.365550 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m21:36:27.367794 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m21:36:27.368250 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:27.368552 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m21:36:27.368799 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:36:27.369060 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:27.369398 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m21:36:27.369625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:36:27.438401 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.088 seconds
[0m21:36:27.440652 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: Close
[0m21:36:27.441519 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133f17d0>]}
[0m21:36:27.442208 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dbt.trips_stat ............................... [[32mSELECT 1[0m in 8.39s]
[0m21:36:27.442803 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat
[0m21:36:28.336881 [debug] [Thread-2 (]: SQL status: BEGIN in 0.966 seconds
[0m21:36:28.338664 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:28.339616 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users" as tu
    cross join "dev_ohwk"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m21:36:29.133785 [debug] [Thread-3 (]: SQL status: BEGIN in 1.765 seconds
[0m21:36:29.135394 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:29.136623 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m21:36:32.075155 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 2.937 seconds
[0m21:36:32.088398 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:32.089018 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m21:36:32.133357 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m21:36:32.138607 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:32.139288 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m21:36:32.248715 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.109 seconds
[0m21:36:32.251405 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:36:32.252135 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:32.252547 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:36:32.435459 [debug] [Thread-3 (]: SQL status: COMMIT in 0.182 seconds
[0m21:36:32.440902 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily__dbt_backup"
[0m21:36:32.442187 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:32.442894 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily__dbt_backup" cascade
[0m21:36:32.540040 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.096 seconds
[0m21:36:32.543849 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m21:36:32.545300 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11445b8c0>]}
[0m21:36:32.546227 [info ] [Thread-3 (]: 6 of 8 OK created sql table model dbt.trips_age_daily .......................... [[32mSELECT 7049[0m in 5.19s]
[0m21:36:32.546923 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m21:36:32.547697 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m21:36:32.548239 [info ] [Thread-1 (]: 8 of 8 START sql table model dbt.trips_age_daily_stat .......................... [RUN]
[0m21:36:32.549050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily_stat)
[0m21:36:32.549768 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m21:36:32.553841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:32.554792 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m21:36:32.557652 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:32.558320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:32.558633 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m21:36:32.559373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:36:33.631672 [debug] [Thread-1 (]: SQL status: BEGIN in 1.072 seconds
[0m21:36:33.633526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:33.634406 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_ohwk"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m21:36:34.223025 [debug] [Thread-1 (]: SQL status: SELECT 83 in 0.587 seconds
[0m21:36:34.231777 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:34.232360 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m21:36:34.331124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.098 seconds
[0m21:36:34.338868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:34.339691 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m21:36:34.430506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m21:36:34.434610 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:36:34.435225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:34.435683 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:36:34.538863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.102 seconds
[0m21:36:34.543952 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup"
[0m21:36:34.544952 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:34.545565 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m21:36:34.633874 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.087 seconds
[0m21:36:34.638137 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m21:36:34.639622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111183770>]}
[0m21:36:34.640576 [info ] [Thread-1 (]: 8 of 8 OK created sql table model dbt.trips_age_daily_stat ..................... [[32mSELECT 83[0m in 2.09s]
[0m21:36:34.641368 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m21:36:39.956772 [debug] [Thread-2 (]: SQL status: SELECT 7 in 11.616 seconds
[0m21:36:39.963112 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:39.963756 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m21:36:40.007432 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m21:36:40.012709 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:40.013404 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m21:36:40.131437 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.117 seconds
[0m21:36:40.134063 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:36:40.134742 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:40.135305 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:36:40.180447 [debug] [Thread-2 (]: SQL status: COMMIT in 0.044 seconds
[0m21:36:40.185778 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_group__dbt_backup"
[0m21:36:40.186706 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:40.187279 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_group__dbt_backup" cascade
[0m21:36:40.233022 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.045 seconds
[0m21:36:40.238587 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m21:36:40.240196 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113440170>]}
[0m21:36:40.241210 [info ] [Thread-2 (]: 7 of 8 OK created sql table model dbt.trips_age_group .......................... [[32mSELECT 7[0m in 12.89s]
[0m21:36:40.241922 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m21:36:40.243928 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:40.244340 [debug] [MainThread]: On master: BEGIN
[0m21:36:40.244676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:41.074656 [debug] [MainThread]: SQL status: BEGIN in 0.830 seconds
[0m21:36:41.075734 [debug] [MainThread]: On master: COMMIT
[0m21:36:41.076388 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:41.076921 [debug] [MainThread]: On master: COMMIT
[0m21:36:41.121990 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m21:36:41.123494 [debug] [MainThread]: On master: Close
[0m21:36:41.125004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:41.125595 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m21:36:41.126077 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m21:36:41.126514 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m21:36:41.126930 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_stat' was properly closed.
[0m21:36:41.127642 [info ] [MainThread]: 
[0m21:36:41.128356 [info ] [MainThread]: Finished running 2 incremental models, 5 table models, 1 view model in 0 hours 0 minutes and 26.48 seconds (26.48s).
[0m21:36:41.131197 [debug] [MainThread]: Command end result
[0m21:36:41.158369 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:36:41.159966 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:36:41.164156 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:36:41.164371 [info ] [MainThread]: 
[0m21:36:41.164592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:41.164765 [info ] [MainThread]: 
[0m21:36:41.164939 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m21:36:41.165934 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 26.777496, "process_in_blocks": "0", "process_kernel_time": 0.175104, "process_mem_max_rss": "141197312", "process_out_blocks": "0", "process_user_time": 1.439427}
[0m21:36:41.166196 [debug] [MainThread]: Command `dbt build` succeeded at 21:36:41.166141 after 26.78 seconds
[0m21:36:41.166408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11085e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144520f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114452ff0>]}
[0m21:36:41.166609 [debug] [MainThread]: Flushing usage events
[0m21:36:41.902162 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:42.959754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b27b10>]}


============================== 21:28:42.961840 | 619de422-6a64-44dc-a012-670e6038ab69 ==============================
[0m21:28:42.961840 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:28:42.962116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:28:43.026023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2f490>]}
[0m21:28:43.046576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c2e00>]}
[0m21:28:43.046961 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:28:43.084960 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:28:43.121160 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:28:43.121378 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m21:28:43.121530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f8250>]}
[0m21:28:43.499339 [warn ] [MainThread]: [[33mWARNING[0m]: Found patch for macro "trips_geom_stat" which was not found
[0m21:28:43.593927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a858b0>]}
[0m21:28:43.625164 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:28:43.626455 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:28:43.639666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f019b0>]}
[0m21:28:43.639892 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 436 macros
[0m21:28:43.640890 [info ] [MainThread]: 
[0m21:28:43.641074 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:28:43.641227 [info ] [MainThread]: 
[0m21:28:43.641449 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:28:43.641811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:28:43.664436 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:28:43.664611 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:28:43.664714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:44.534060 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.869 seconds
[0m21:28:44.537508 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:28:44.546415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:28:44.552681 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:28:44.553044 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:28:44.553290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:46.078832 [debug] [ThreadPool]: SQL status: BEGIN in 1.525 seconds
[0m21:28:46.079900 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:28:46.080591 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:28:46.130421 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.049 seconds
[0m21:28:46.134711 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:28:46.185783 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:28:46.200927 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:46.201533 [debug] [MainThread]: On master: BEGIN
[0m21:28:46.201948 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:28:47.115357 [debug] [MainThread]: SQL status: BEGIN in 0.913 seconds
[0m21:28:47.117002 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:47.117875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:28:47.299695 [debug] [MainThread]: SQL status: SELECT 6 in 0.181 seconds
[0m21:28:47.303943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111bb520>]}
[0m21:28:47.305012 [debug] [MainThread]: On master: ROLLBACK
[0m21:28:47.351828 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:47.352904 [debug] [MainThread]: On master: BEGIN
[0m21:28:47.451667 [debug] [MainThread]: SQL status: BEGIN in 0.098 seconds
[0m21:28:47.452805 [debug] [MainThread]: On master: COMMIT
[0m21:28:47.453542 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:47.454115 [debug] [MainThread]: On master: COMMIT
[0m21:28:47.502978 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m21:28:47.504020 [debug] [MainThread]: On master: Close
[0m21:28:47.513638 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m21:28:47.514695 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.parking_start_stat ............................ [RUN]
[0m21:28:47.515751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.parking_start_stat)
[0m21:28:47.516619 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m21:28:47.525484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m21:28:47.527209 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m21:28:47.554988 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m21:28:47.555551 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:28:47.555738 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m21:28:47.555900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:48.478951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.923 seconds
[0m21:28:48.480191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:28:48.480986 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
where
    st_intersects(st_transform(t.start_point, 3857), hex.geom)
group by
    1
  );
  
[0m21:29:04.296175 [debug] [Thread-1 (]: SQL status: SELECT 142 in 15.815 seconds
[0m21:29:04.313607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:04.314298 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m21:29:04.360699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m21:29:04.367285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:04.367955 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m21:29:04.413105 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m21:29:04.437294 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:29:04.437798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:04.438122 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:29:04.486482 [debug] [Thread-1 (]: SQL status: COMMIT in 0.048 seconds
[0m21:29:04.494007 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_start_stat__dbt_backup"
[0m21:29:04.501430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:04.501789 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop view if exists "dev_ohwk"."dbt"."parking_start_stat__dbt_backup" cascade
[0m21:29:04.550761 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.048 seconds
[0m21:29:04.555010 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m21:29:04.558266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fcebd0>]}
[0m21:29:04.559032 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.parking_start_stat ....................... [[32mSELECT 142[0m in 17.04s]
[0m21:29:04.559602 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m21:29:04.560926 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:04.561207 [debug] [MainThread]: On master: BEGIN
[0m21:29:04.561433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:05.283477 [debug] [MainThread]: SQL status: BEGIN in 0.722 seconds
[0m21:29:05.284904 [debug] [MainThread]: On master: COMMIT
[0m21:29:05.285774 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:05.286499 [debug] [MainThread]: On master: COMMIT
[0m21:29:05.332850 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m21:29:05.333918 [debug] [MainThread]: On master: Close
[0m21:29:05.335433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:05.336013 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m21:29:05.336634 [info ] [MainThread]: 
[0m21:29:05.337246 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.70 seconds (21.70s).
[0m21:29:05.338492 [debug] [MainThread]: Command end result
[0m21:29:05.367885 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:29:05.369391 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:29:05.373838 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:29:05.374062 [info ] [MainThread]: 
[0m21:29:05.374298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:05.374461 [info ] [MainThread]: 
[0m21:29:05.374710 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:29:05.378362 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 22.448353, "process_in_blocks": "0", "process_kernel_time": 0.141872, "process_mem_max_rss": "148160512", "process_out_blocks": "0", "process_user_time": 1.404684}
[0m21:29:05.378679 [debug] [MainThread]: Command `cli build` succeeded at 21:29:05.378616 after 22.45 seconds
[0m21:29:05.378908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ff8c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11135ecb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11135eb70>]}
[0m21:29:05.379127 [debug] [MainThread]: Flushing usage events
[0m21:29:05.969081 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:46.798942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd7b10>]}


============================== 21:29:46.801011 | 6e1bb7f6-9f46-42a0-8605-a3e11014e1db ==============================
[0m21:29:46.801011 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:29:46.801284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:29:46.864419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e3490>]}
[0m21:29:46.885020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6ee00>]}
[0m21:29:46.885402 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:29:46.923951 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:29:46.960970 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:29:46.961201 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m21:29:46.961354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c44250>]}
[0m21:29:47.400363 [warn ] [MainThread]: [[33mWARNING[0m]: Found patch for macro "trips_geom_stat" which was not found
[0m21:29:47.446234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b0fc50>]}
[0m21:29:47.476856 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:29:47.478022 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:29:47.484622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a2270>]}
[0m21:29:47.484828 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 436 macros
[0m21:29:47.484978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b31300>]}
[0m21:29:47.485649 [info ] [MainThread]: 
[0m21:29:47.485784 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:29:47.485898 [info ] [MainThread]: 
[0m21:29:47.486143 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:29:47.486483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:29:47.503591 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:29:47.503761 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:29:47.503860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:48.268409 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.764 seconds
[0m21:29:48.270519 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:29:48.277281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:29:48.283649 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:29:48.284081 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:29:48.284341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:48.995323 [debug] [ThreadPool]: SQL status: BEGIN in 0.711 seconds
[0m21:29:48.996436 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:29:48.997375 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:29:49.066267 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.068 seconds
[0m21:29:49.069529 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:29:49.117338 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:29:49.129556 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:49.130129 [debug] [MainThread]: On master: BEGIN
[0m21:29:49.130618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:50.726430 [debug] [MainThread]: SQL status: BEGIN in 1.596 seconds
[0m21:29:50.727543 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:50.728185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:29:50.894205 [debug] [MainThread]: SQL status: SELECT 5 in 0.165 seconds
[0m21:29:50.896761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dcfb90>]}
[0m21:29:50.897330 [debug] [MainThread]: On master: ROLLBACK
[0m21:29:50.949629 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:50.950334 [debug] [MainThread]: On master: BEGIN
[0m21:29:51.042817 [debug] [MainThread]: SQL status: BEGIN in 0.092 seconds
[0m21:29:51.043651 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.044130 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.044599 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.090786 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m21:29:51.091863 [debug] [MainThread]: On master: Close
[0m21:29:51.101669 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m21:29:51.102832 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.parking_start_stat ............................ [RUN]
[0m21:29:51.103758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.parking_start_stat)
[0m21:29:51.104577 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m21:29:51.113831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m21:29:51.114996 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m21:29:51.142987 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m21:29:51.143554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:51.143742 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m21:29:51.143899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.777091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.633 seconds
[0m21:29:51.778167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:51.778788 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
where
    st_intersects(st_transform(t.start_point, 3857), hex.geom)
group by
    1
  );
  
[0m21:30:07.801395 [debug] [Thread-1 (]: SQL status: SELECT 142 in 16.022 seconds
[0m21:30:07.820634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:30:07.821212 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m21:30:07.868560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m21:30:07.875761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:30:07.876324 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m21:30:07.925382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m21:30:07.945790 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:30:07.946255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:30:07.946528 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:30:08.014872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.068 seconds
[0m21:30:08.025534 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_start_stat__dbt_backup"
[0m21:30:08.032222 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:30:08.032715 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_ohwk"."dbt"."parking_start_stat__dbt_backup" cascade
[0m21:30:08.082461 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.049 seconds
[0m21:30:08.087444 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m21:30:08.091889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fedd30>]}
[0m21:30:08.092968 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.parking_start_stat ....................... [[32mSELECT 142[0m in 16.99s]
[0m21:30:08.093749 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m21:30:08.095538 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:08.095882 [debug] [MainThread]: On master: BEGIN
[0m21:30:08.096157 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:08.958317 [debug] [MainThread]: SQL status: BEGIN in 0.862 seconds
[0m21:30:08.960042 [debug] [MainThread]: On master: COMMIT
[0m21:30:08.961062 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:08.961892 [debug] [MainThread]: On master: COMMIT
[0m21:30:09.008712 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m21:30:09.009803 [debug] [MainThread]: On master: Close
[0m21:30:09.011440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:09.011905 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m21:30:09.012450 [info ] [MainThread]: 
[0m21:30:09.012991 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.53 seconds (21.53s).
[0m21:30:09.014156 [debug] [MainThread]: Command end result
[0m21:30:09.043192 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:30:09.045160 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:30:09.048820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:30:09.049014 [info ] [MainThread]: 
[0m21:30:09.049244 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:30:09.049418 [info ] [MainThread]: 
[0m21:30:09.049681 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:30:09.052501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.2824, "process_in_blocks": "0", "process_kernel_time": 0.135908, "process_mem_max_rss": "146210816", "process_out_blocks": "0", "process_user_time": 1.388711}
[0m21:30:09.052756 [debug] [MainThread]: Command `cli run` succeeded at 21:30:09.052700 after 22.28 seconds
[0m21:30:09.052967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f72a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e0b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ddadd0>]}
[0m21:30:09.053170 [debug] [MainThread]: Flushing usage events
[0m21:30:09.552364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:30:53.982573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112627b10>]}


============================== 21:30:53.984618 | a5d1909d-a19f-43b4-a73f-4ada13c97eb2 ==============================
[0m21:30:53.984618 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:30:53.984889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:30:54.049765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11032f490>]}
[0m21:30:54.071091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123bee00>]}
[0m21:30:54.071569 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:30:54.112890 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:30:54.149537 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:30:54.149762 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m21:30:54.149921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134f0250>]}
[0m21:30:54.643940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11370ea80>]}
[0m21:30:54.674384 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:30:54.675601 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:30:54.685728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113572cf0>]}
[0m21:30:54.685949 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 437 macros
[0m21:30:54.686091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113267d40>]}
[0m21:30:54.686836 [info ] [MainThread]: 
[0m21:30:54.687008 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:30:54.687140 [info ] [MainThread]: 
[0m21:30:54.687389 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:54.687795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:30:54.709423 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:30:54.709602 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:30:54.709701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:55.446946 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.737 seconds
[0m21:30:55.449976 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:30:55.458402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:30:55.464216 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:30:55.464543 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:30:55.464754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:56.153320 [debug] [ThreadPool]: SQL status: BEGIN in 0.688 seconds
[0m21:30:56.153927 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:30:56.154288 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:30:56.205469 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.051 seconds
[0m21:30:56.207696 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:30:56.256144 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:30:56.267707 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:56.268371 [debug] [MainThread]: On master: BEGIN
[0m21:30:56.268745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:56.909192 [debug] [MainThread]: SQL status: BEGIN in 0.640 seconds
[0m21:30:56.910161 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:56.910791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:57.087202 [debug] [MainThread]: SQL status: SELECT 5 in 0.176 seconds
[0m21:30:57.089224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11378bd10>]}
[0m21:30:57.089716 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:57.135866 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:57.136486 [debug] [MainThread]: On master: BEGIN
[0m21:30:57.261999 [debug] [MainThread]: SQL status: BEGIN in 0.125 seconds
[0m21:30:57.263016 [debug] [MainThread]: On master: COMMIT
[0m21:30:57.263551 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:57.263951 [debug] [MainThread]: On master: COMMIT
[0m21:30:57.310758 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m21:30:57.311818 [debug] [MainThread]: On master: Close
[0m21:30:57.320010 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m21:30:57.320825 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.parking_finish_stat ........................... [RUN]
[0m21:30:57.321511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.parking_finish_stat)
[0m21:30:57.322205 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m21:30:57.329876 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m21:30:57.330926 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m21:30:57.356986 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m21:30:57.357592 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:30:57.357782 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m21:30:57.357946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:58.097146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.739 seconds
[0m21:30:58.098023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:30:58.098797 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_ohwk"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)
-- group by
--     1


select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m21:31:13.389924 [debug] [Thread-1 (]: SQL status: SELECT 464 in 15.291 seconds
[0m21:31:13.404682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:31:13.405117 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m21:31:13.452030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m21:31:13.457440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:31:13.457959 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m21:31:13.504766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m21:31:13.526218 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m21:31:13.526599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:31:13.526856 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m21:31:13.576954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m21:31:13.586128 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup"
[0m21:31:13.590857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:31:13.591189 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop view if exists "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m21:31:13.640848 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.049 seconds
[0m21:31:13.645439 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m21:31:13.648683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139fa780>]}
[0m21:31:13.649424 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.parking_finish_stat ...................... [[32mSELECT 464[0m in 16.32s]
[0m21:31:13.650026 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m21:31:13.651415 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:13.651689 [debug] [MainThread]: On master: BEGIN
[0m21:31:13.651918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:31:14.282214 [debug] [MainThread]: SQL status: BEGIN in 0.630 seconds
[0m21:31:14.283901 [debug] [MainThread]: On master: COMMIT
[0m21:31:14.284745 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:14.285306 [debug] [MainThread]: On master: COMMIT
[0m21:31:14.337567 [debug] [MainThread]: SQL status: COMMIT in 0.052 seconds
[0m21:31:14.338792 [debug] [MainThread]: On master: Close
[0m21:31:14.340431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:14.340996 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m21:31:14.341633 [info ] [MainThread]: 
[0m21:31:14.342206 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 19.65 seconds (19.65s).
[0m21:31:14.343440 [debug] [MainThread]: Command end result
[0m21:31:14.376750 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:31:14.378270 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:31:14.381896 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:31:14.382091 [info ] [MainThread]: 
[0m21:31:14.382314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:31:14.382479 [info ] [MainThread]: 
[0m21:31:14.382776 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:31:14.384825 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.431522, "process_in_blocks": "0", "process_kernel_time": 0.148568, "process_mem_max_rss": "145227776", "process_out_blocks": "0", "process_user_time": 1.409343}
[0m21:31:14.385103 [debug] [MainThread]: Command `cli run` succeeded at 21:31:14.385046 after 20.43 seconds
[0m21:31:14.385306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cadd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bb7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f3650>]}
[0m21:31:14.385499 [debug] [MainThread]: Flushing usage events
[0m21:31:15.027757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:35.019135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039074d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dfb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dfbb10>]}


============================== 10:03:35.021796 | 48cdac4e-360f-4175-a6fb-1c86f2348d96 ==============================
[0m10:03:35.021796 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:03:35.022113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:03:35.101603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104103490>]}
[0m10:03:35.122932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c92e00>]}
[0m10:03:35.123542 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:03:35.162208 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m10:03:35.217741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:03:35.217940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:03:35.237186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105463550>]}
[0m10:03:35.271794 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:03:35.273241 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:03:35.285089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7d7c0>]}
[0m10:03:35.285322 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 437 macros
[0m10:03:35.285463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e4210>]}
[0m10:03:35.286196 [info ] [MainThread]: 
[0m10:03:35.286338 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:03:35.286496 [info ] [MainThread]: 
[0m10:03:35.286767 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:35.287137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m10:03:35.309910 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m10:03:35.310101 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m10:03:35.310215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:36.375226 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.064 seconds
[0m10:03:36.378834 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m10:03:36.389076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m10:03:36.396004 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m10:03:36.396436 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m10:03:36.396686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:37.193295 [debug] [ThreadPool]: SQL status: BEGIN in 0.796 seconds
[0m10:03:37.194202 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m10:03:37.194877 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:03:37.267569 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.072 seconds
[0m10:03:37.271124 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m10:03:37.341984 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m10:03:37.348816 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:37.349092 [debug] [MainThread]: On master: BEGIN
[0m10:03:37.349288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:38.900475 [debug] [MainThread]: SQL status: BEGIN in 1.551 seconds
[0m10:03:38.901567 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:38.902348 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:39.067474 [debug] [MainThread]: SQL status: SELECT 4 in 0.164 seconds
[0m10:03:39.072777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb9e60>]}
[0m10:03:39.073746 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:39.118494 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:39.119378 [debug] [MainThread]: On master: BEGIN
[0m10:03:39.209758 [debug] [MainThread]: SQL status: BEGIN in 0.089 seconds
[0m10:03:39.210788 [debug] [MainThread]: On master: COMMIT
[0m10:03:39.211479 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:39.212049 [debug] [MainThread]: On master: COMMIT
[0m10:03:39.257390 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m10:03:39.258499 [debug] [MainThread]: On master: Close
[0m10:03:39.266261 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m10:03:39.267437 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.events_clean ............................ [RUN]
[0m10:03:39.268219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m10:03:39.268736 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m10:03:39.284220 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m10:03:39.285543 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m10:03:39.318781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:39.319087 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp100339306471"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m10:03:39.319261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:40.711194 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.391 seconds
[0m10:03:40.733613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:40.734041 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m10:03:40.779059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m10:03:40.779894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:40.780416 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp100339306471'
        
      order by ordinal_position

  
[0m10:03:40.832873 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.052 seconds
[0m10:03:40.843341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:40.844153 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:03:40.937667 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.093 seconds
[0m10:03:40.958093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:40.958568 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp100339306471'
        
      order by ordinal_position

  
[0m10:03:41.007665 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.049 seconds
[0m10:03:41.013532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:41.014034 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:03:41.061202 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.046 seconds
[0m10:03:41.073283 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:03:41.081730 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m10:03:41.082386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:41.082669 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp100339306471"
    )


  
[0m10:03:41.135322 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.052 seconds
[0m10:03:41.149104 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:03:41.149434 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:41.149679 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:03:41.222197 [debug] [Thread-1 (]: SQL status: COMMIT in 0.072 seconds
[0m10:03:41.225179 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m10:03:41.228968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10608c410>]}
[0m10:03:41.229744 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 0[0m in 1.96s]
[0m10:03:41.230366 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m10:03:41.231781 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:41.232203 [debug] [MainThread]: On master: BEGIN
[0m10:03:41.232498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:03:41.895221 [debug] [MainThread]: SQL status: BEGIN in 0.662 seconds
[0m10:03:41.896156 [debug] [MainThread]: On master: COMMIT
[0m10:03:41.897202 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:41.897809 [debug] [MainThread]: On master: COMMIT
[0m10:03:41.944963 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m10:03:41.946020 [debug] [MainThread]: On master: Close
[0m10:03:41.947285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:41.947877 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m10:03:41.948401 [info ] [MainThread]: 
[0m10:03:41.949170 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.66 seconds (6.66s).
[0m10:03:41.951140 [debug] [MainThread]: Command end result
[0m10:03:42.015296 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:03:42.016480 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:03:42.019664 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m10:03:42.019804 [info ] [MainThread]: 
[0m10:03:42.019966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:03:42.020083 [info ] [MainThread]: 
[0m10:03:42.020214 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:03:42.053099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.063138, "process_in_blocks": "0", "process_kernel_time": 0.167728, "process_mem_max_rss": "138543104", "process_out_blocks": "0", "process_user_time": 1.056158}
[0m10:03:42.053426 [debug] [MainThread]: Command `cli run` succeeded at 10:03:42.053378 after 7.06 seconds
[0m10:03:42.053622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee5180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105458ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105458f50>]}
[0m10:03:42.053800 [debug] [MainThread]: Flushing usage events
[0m10:03:42.682719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:08.037595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5bb10>]}


============================== 10:14:08.040109 | 05acd809-bce4-4282-bc42-d6316fe72383 ==============================
[0m10:14:08.040109 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:14:08.040373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -s events_clean --vars {date: 2023-06-01}', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:08.106338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05acd809-bce4-4282-bc42-d6316fe72383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615f490>]}
[0m10:14:08.127226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05acd809-bce4-4282-bc42-d6316fe72383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf2030>]}
[0m10:14:08.128296 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:14:08.165254 [debug] [MainThread]: checksum: 1eabf0d320596055ed45cbce2f2d8d9d10c502a91e79a3d337baeb459c660cd9, vars: {'date': datetime.date(2023, 6, 1)}, profile: , target: , version: 1.10.6
[0m10:14:08.201570 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:14:08.201775 [debug] [MainThread]: previous checksum: 1eabf0d320596055ed45cbce2f2d8d9d10c502a91e79a3d337baeb459c660cd9, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m10:14:08.201913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05acd809-bce4-4282-bc42-d6316fe72383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107adbe50>]}
[0m10:14:08.609194 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named events_clean. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for events_clean in this file:
   - models/properties.yml
  
[0m10:14:08.611096 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.6023357, "process_in_blocks": "0", "process_kernel_time": 0.108413, "process_mem_max_rss": "125730816", "process_out_blocks": "0", "process_user_time": 1.027037}
[0m10:14:08.611285 [debug] [MainThread]: Command `dbt build` failed at 10:14:08.611247 after 0.60 seconds
[0m10:14:08.611426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3fe70>]}
[0m10:14:08.611575 [debug] [MainThread]: Flushing usage events
[0m10:14:09.294472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:41.508584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e274d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae27b10>]}


============================== 10:14:41.510317 | 64e0eedd-9050-4549-ba44-ffe8da1c340f ==============================
[0m10:14:41.510317 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:14:41.510575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build -s events_clean --vars date: 2023-06-01', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:41.573968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64e0eedd-9050-4549-ba44-ffe8da1c340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10952b490>]}
[0m10:14:41.594960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64e0eedd-9050-4549-ba44-ffe8da1c340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abbe030>]}
[0m10:14:41.595320 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:14:41.649031 [debug] [MainThread]: checksum: 1eabf0d320596055ed45cbce2f2d8d9d10c502a91e79a3d337baeb459c660cd9, vars: {'date': datetime.date(2023, 6, 1)}, profile: , target: , version: 1.10.6
[0m10:14:41.686342 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:14:41.686551 [debug] [MainThread]: previous checksum: 1eabf0d320596055ed45cbce2f2d8d9d10c502a91e79a3d337baeb459c660cd9, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m10:14:41.686691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '64e0eedd-9050-4549-ba44-ffe8da1c340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8dbe50>]}
[0m10:14:42.094995 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named events_clean. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for events_clean in this file:
   - models/properties.yml
  
[0m10:14:42.097386 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.6181564, "process_in_blocks": "0", "process_kernel_time": 0.099393, "process_mem_max_rss": "126746624", "process_out_blocks": "0", "process_user_time": 1.030305}
[0m10:14:42.097593 [debug] [MainThread]: Command `dbt build` failed at 10:14:42.097553 after 0.62 seconds
[0m10:14:42.097748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d20ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d20a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae0be70>]}
[0m10:14:42.097885 [debug] [MainThread]: Flushing usage events
[0m10:14:42.596670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:22:06.944869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111227b10>]}


============================== 10:22:06.947874 | 2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5 ==============================
[0m10:22:06.947874 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:22:06.948192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build -s events_clean --vars date: 2023-06-01', 'send_anonymous_usage_stats': 'True'}
[0m10:22:07.016321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11022b490>]}
[0m10:22:07.038150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110be030>]}
[0m10:22:07.038815 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:22:07.075849 [debug] [MainThread]: checksum: 1eabf0d320596055ed45cbce2f2d8d9d10c502a91e79a3d337baeb459c660cd9, vars: {'date': datetime.date(2023, 6, 1)}, profile: , target: , version: 1.10.6
[0m10:22:07.113886 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:22:07.114123 [debug] [MainThread]: previous checksum: 1eabf0d320596055ed45cbce2f2d8d9d10c502a91e79a3d337baeb459c660cd9, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m10:22:07.114281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133fbe50>]}
[0m10:22:07.600827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d06e40>]}
[0m10:22:07.631239 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:22:07.632500 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:22:07.648678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ee75b0>]}
[0m10:22:07.648878 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 437 macros
[0m10:22:07.649648 [info ] [MainThread]: 
[0m10:22:07.649786 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:22:07.649895 [info ] [MainThread]: 
[0m10:22:07.650084 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:22:07.650419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m10:22:07.671552 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m10:22:07.671750 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m10:22:07.671865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:08.737231 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.065 seconds
[0m10:22:08.742474 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m10:22:08.750972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m10:22:08.757881 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m10:22:08.758350 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m10:22:08.758631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:10.492853 [debug] [ThreadPool]: SQL status: BEGIN in 1.734 seconds
[0m10:22:10.493415 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m10:22:10.493781 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:22:10.547577 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.053 seconds
[0m10:22:10.549803 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m10:22:10.598015 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m10:22:10.607790 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:10.608228 [debug] [MainThread]: On master: BEGIN
[0m10:22:10.608511 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:11.568197 [debug] [MainThread]: SQL status: BEGIN in 0.959 seconds
[0m10:22:11.569784 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:11.571149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:22:11.684969 [debug] [MainThread]: SQL status: SELECT 4 in 0.113 seconds
[0m10:22:11.689679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11432f6c0>]}
[0m10:22:11.690445 [debug] [MainThread]: On master: ROLLBACK
[0m10:22:11.744681 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:11.745572 [debug] [MainThread]: On master: BEGIN
[0m10:22:11.845026 [debug] [MainThread]: SQL status: BEGIN in 0.099 seconds
[0m10:22:11.846347 [debug] [MainThread]: On master: COMMIT
[0m10:22:11.847381 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:11.848331 [debug] [MainThread]: On master: COMMIT
[0m10:22:11.933295 [debug] [MainThread]: SQL status: COMMIT in 0.084 seconds
[0m10:22:11.934443 [debug] [MainThread]: On master: Close
[0m10:22:11.943935 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m10:22:11.944996 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.events_clean ............................ [RUN]
[0m10:22:11.945660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m10:22:11.946136 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m10:22:11.959074 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m10:22:11.960173 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m10:22:11.994591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:11.994885 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp102211982012"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    
        date("timestamp") = date '2023-06-01'
    

  );
  
  
[0m10:22:11.995070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:13.179602 [debug] [Thread-1 (]: SQL status: SELECT 3852 in 1.184 seconds
[0m10:22:13.195465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:13.195849 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m10:22:13.244878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m10:22:13.245289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:13.245646 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp102211982012'
        
      order by ordinal_position

  
[0m10:22:13.298048 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.052 seconds
[0m10:22:13.307636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:13.308340 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:22:13.358162 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.049 seconds
[0m10:22:13.373559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:13.374074 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp102211982012'
        
      order by ordinal_position

  
[0m10:22:13.448261 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.074 seconds
[0m10:22:13.454079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:13.454841 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:22:13.503775 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.048 seconds
[0m10:22:13.515867 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:22:13.530307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m10:22:13.531159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:13.531467 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        delete from "dev_ohwk"."dbt"."events_clean" as DBT_INTERNAL_DEST
        where (user_id, timestamp, type_id) in (
            select distinct user_id, timestamp, type_id
            from "events_clean__dbt_tmp102211982012" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp102211982012"
    )
  
[0m10:22:14.096998 [debug] [Thread-1 (]: SQL status: INSERT 0 3852 in 0.565 seconds
[0m10:22:14.119327 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:22:14.119810 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:14.120121 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:22:14.167531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.047 seconds
[0m10:22:14.171183 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m10:22:14.175784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fba450>]}
[0m10:22:14.176559 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 3852[0m in 2.23s]
[0m10:22:14.177181 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m10:22:14.178634 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:14.178966 [debug] [MainThread]: On master: BEGIN
[0m10:22:14.179242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:22:15.838117 [debug] [MainThread]: SQL status: BEGIN in 1.659 seconds
[0m10:22:15.839329 [debug] [MainThread]: On master: COMMIT
[0m10:22:15.840056 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:15.840587 [debug] [MainThread]: On master: COMMIT
[0m10:22:15.885409 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m10:22:15.886577 [debug] [MainThread]: On master: Close
[0m10:22:15.888593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:15.889235 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m10:22:15.889814 [info ] [MainThread]: 
[0m10:22:15.890379 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.24 seconds (8.24s).
[0m10:22:15.891535 [debug] [MainThread]: Command end result
[0m10:22:15.920062 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:22:15.921464 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:22:15.925428 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m10:22:15.925629 [info ] [MainThread]: 
[0m10:22:15.925864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:22:15.926035 [info ] [MainThread]: 
[0m10:22:15.926214 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:22:15.928095 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.014997, "process_in_blocks": "0", "process_kernel_time": 0.154062, "process_mem_max_rss": "147079168", "process_out_blocks": "0", "process_user_time": 1.448748}
[0m10:22:15.928423 [debug] [MainThread]: Command `dbt build` succeeded at 10:22:15.928361 after 9.02 seconds
[0m10:22:15.928672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114035de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140b82d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140b8050>]}
[0m10:22:15.928901 [debug] [MainThread]: Flushing usage events
[0m10:22:16.516379 [debug] [MainThread]: An error was encountered while trying to flush usage events
