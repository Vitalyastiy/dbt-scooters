[0m19:12:41.732680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2142f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c715130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c714da0>]}


============================== 19:12:41.740040 | 000a935f-c3cd-4bf2-9389-66db1aa47a71 ==============================
[0m19:12:41.740040 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:12:41.740824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinv/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt init dbt_scooters', 'send_anonymous_usage_stats': 'True'}
[0m19:12:41.770171 [debug] [MainThread]: Starter project path: /opt/anaconda3/lib/python3.12/site-packages/dbt/include/starter_project
[0m19:12:41.783206 [info ] [MainThread]: 
Your new dbt project "dbt_scooters" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m19:12:41.783910 [info ] [MainThread]: Setting up your profile.
[0m19:15:27.570821 [info ] [MainThread]: Profile dbt_scooters written to /Users/flerinv/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m19:15:27.578038 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 165.92365, "process_in_blocks": "0", "process_kernel_time": 0.518342, "process_mem_max_rss": "97734656", "process_out_blocks": "0", "process_user_time": 1.960099}
[0m19:15:27.578887 [debug] [MainThread]: Command `dbt init` succeeded at 19:15:27.578681 after 165.92 seconds
[0m19:15:27.579566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c715250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c59ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c36b380>]}
[0m19:15:27.580177 [debug] [MainThread]: Flushing usage events
[0m19:15:28.239969 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:31:41.628929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cd1c0>]}


============================== 19:31:41.636865 | 86b25d89-0e7b-4328-bb0a-fdfb24fca212 ==============================
[0m19:31:41.636865 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:31:41.638182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/Users/flerinv/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:31:41.639158 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/flerinv/Desktop/db/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m19:31:41.644102 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.11682542, "process_in_blocks": "0", "process_kernel_time": 0.44756, "process_mem_max_rss": "94085120", "process_out_blocks": "0", "process_user_time": 1.788362}
[0m19:31:41.644916 [debug] [MainThread]: Command `dbt compile` failed at 19:31:41.644729 after 0.12 seconds
[0m19:31:41.645335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cd6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cee10>]}
[0m19:31:41.645846 [debug] [MainThread]: Flushing usage events
[0m19:31:42.239022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:25.412273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a57290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109299a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109299790>]}


============================== 21:41:25.421999 | 0c9a9325-1a64-441f-8f36-1826de85fb61 ==============================
[0m21:41:25.421999 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:41:25.423071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinv/.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:41:25.423638 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/flerinv/Desktop/db/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m21:41:25.428701 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": false, "command_wall_clock_time": 0.12551336, "process_in_blocks": "0", "process_kernel_time": 0.435274, "process_mem_max_rss": "94400512", "process_out_blocks": "0", "process_user_time": 1.69647}
[0m21:41:25.429363 [debug] [MainThread]: Command `dbt ls` failed at 21:41:25.429233 after 0.13 seconds
[0m21:41:25.429983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e20f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109299a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10929b380>]}
[0m21:41:25.430488 [debug] [MainThread]: Flushing usage events
[0m21:41:26.023783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:54.923110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d334d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722bb10>]}


============================== 16:17:54.925061 | 4f6d5268-b3ee-426c-9a84-5abb0586f2ef ==============================
[0m16:17:54.925061 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:17:54.925318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed -s scooters', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:17:54.925541 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/flerinvs/dbt_scooters/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:17:54.926187 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.029389083, "process_in_blocks": "0", "process_kernel_time": 0.060353, "process_mem_max_rss": "108281856", "process_out_blocks": "0", "process_user_time": 0.504394}
[0m16:17:54.926473 [debug] [MainThread]: Command `dbt seed` failed at 16:17:54.926403 after 0.03 seconds
[0m16:17:54.926632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107113360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071269f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c18c0>]}
[0m16:17:54.926764 [debug] [MainThread]: Flushing usage events
[0m16:17:58.070092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:18:01.227479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080bb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b3b10>]}


============================== 16:18:01.229164 | e47767d0-0a6c-4e1f-8816-ac5c88a4d779 ==============================
[0m16:18:01.229164 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:18:01.229425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed -s scooters', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:18:01.229634 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/flerinvs/dbt_scooters/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:18:01.230232 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.026656333, "process_in_blocks": "0", "process_kernel_time": 0.054709, "process_mem_max_rss": "106692608", "process_out_blocks": "0", "process_user_time": 0.492152}
[0m16:18:01.230428 [debug] [MainThread]: Command `dbt seed` failed at 16:18:01.230392 after 0.03 seconds
[0m16:18:01.230553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949b360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ae9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094498c0>]}
[0m16:18:01.230673 [debug] [MainThread]: Flushing usage events
[0m16:18:07.925776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:18:20.643501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fbb10>]}


============================== 16:18:20.645296 | 6c0d1a36-7df1-4310-acb5-8d6492e07b43 ==============================
[0m16:18:20.645296 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:18:20.645558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:18:20.651841 [info ] [MainThread]: dbt version: 1.10.6
[0m16:18:20.652013 [info ] [MainThread]: python version: 3.13.5
[0m16:18:20.652141 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m16:18:20.652254 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit-Mach-O
[0m16:18:20.673786 [info ] [MainThread]: Using profiles dir at /Users/flerinvs/.dbt
[0m16:18:20.674008 [info ] [MainThread]: Using profiles.yml file at /Users/flerinvs/.dbt/profiles.yml
[0m16:18:20.674123 [info ] [MainThread]: Using dbt_project.yml file at /Users/flerinvs/dbt_scooters/dbt_project.yml
[0m16:18:20.674318 [info ] [MainThread]: adapter type: postgres
[0m16:18:20.674418 [info ] [MainThread]: adapter version: 1.9.0
[0m16:18:20.674531 [info ] [MainThread]: Configuration:
[0m16:18:20.674646 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:18:20.674748 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m16:18:20.674845 [info ] [MainThread]: Required dependencies:
[0m16:18:20.674984 [debug] [MainThread]: Executing "git --help"
[0m16:18:20.684785 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:18:20.685213 [debug] [MainThread]: STDERR: "b''"
[0m16:18:20.685357 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:18:20.685491 [info ] [MainThread]: Connection:
[0m16:18:20.685708 [info ] [MainThread]:   host: dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com
[0m16:18:20.685808 [info ] [MainThread]:   port: 5432
[0m16:18:20.685896 [info ] [MainThread]:   user: admin
[0m16:18:20.685989 [info ] [MainThread]:   database: dev_ohwk
[0m16:18:20.686079 [info ] [MainThread]:   schema: dbt
[0m16:18:20.686170 [info ] [MainThread]:   connect_timeout: 10
[0m16:18:20.686264 [info ] [MainThread]:   role: None
[0m16:18:20.686352 [info ] [MainThread]:   search_path: None
[0m16:18:20.686445 [info ] [MainThread]:   keepalives_idle: 0
[0m16:18:20.686533 [info ] [MainThread]:   sslmode: None
[0m16:18:20.686625 [info ] [MainThread]:   sslcert: None
[0m16:18:20.686719 [info ] [MainThread]:   sslkey: None
[0m16:18:20.686802 [info ] [MainThread]:   sslrootcert: None
[0m16:18:20.686889 [info ] [MainThread]:   application_name: dbt
[0m16:18:20.686975 [info ] [MainThread]:   retries: 1
[0m16:18:20.687248 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:18:20.719917 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:18:20.738287 [debug] [MainThread]: Using postgres connection "debug"
[0m16:18:20.738489 [debug] [MainThread]: On debug: select 1 as id
[0m16:18:20.738602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:21.581993 [debug] [MainThread]: SQL status: SELECT 1 in 0.843 seconds
[0m16:18:21.585616 [debug] [MainThread]: On debug: Close
[0m16:18:21.587189 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:18:21.587738 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:18:21.588127 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/flerinvs/dbt_scooters/dbt_project.yml> not found

[0m16:18:21.590604 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.9711258, "process_in_blocks": "0", "process_kernel_time": 0.093434, "process_mem_max_rss": "125698048", "process_out_blocks": "0", "process_user_time": 0.562186}
[0m16:18:21.591630 [debug] [MainThread]: Command `dbt debug` failed at 16:18:21.591395 after 0.97 seconds
[0m16:18:21.592125 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:18:21.592566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f25810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d96a0>]}
[0m16:18:21.593081 [debug] [MainThread]: Flushing usage events
[0m16:18:23.672161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:14.130098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f53b10>]}


============================== 16:19:14.131752 | b1e38b6a-1b6e-42d6-b589-65e39bb13da7 ==============================
[0m16:19:14.131752 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:19:14.132014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:20:16.352838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067374d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a1fb10>]}


============================== 16:20:16.354570 | 8fb14e0b-7a33-4b22-92d0-9ea36a3eaaa3 ==============================
[0m16:20:16.354570 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:20:16.354839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:20:16.360654 [info ] [MainThread]: dbt version: 1.10.6
[0m16:20:16.360810 [info ] [MainThread]: python version: 3.13.5
[0m16:20:16.360924 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m16:20:16.361033 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit-Mach-O
[0m16:20:16.382062 [info ] [MainThread]: Using profiles dir at /Users/flerinvs/.dbt
[0m16:20:16.382315 [info ] [MainThread]: Using profiles.yml file at /Users/flerinvs/.dbt/profiles.yml
[0m16:20:16.382478 [info ] [MainThread]: Using dbt_project.yml file at /Users/flerinvs/dbt_scooters/dbt_project.yml
[0m16:20:16.382702 [info ] [MainThread]: adapter type: postgres
[0m16:20:16.382860 [info ] [MainThread]: adapter version: 1.9.0
[0m16:20:16.382983 [info ] [MainThread]: Configuration:
[0m16:20:16.383081 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:20:16.383186 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m16:20:16.383282 [info ] [MainThread]: Required dependencies:
[0m16:20:16.383434 [debug] [MainThread]: Executing "git --help"
[0m16:20:16.392261 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:20:16.392643 [debug] [MainThread]: STDERR: "b''"
[0m16:20:16.392772 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:20:16.392900 [info ] [MainThread]: Connection:
[0m16:20:16.393042 [info ] [MainThread]:   host: dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com
[0m16:20:16.393145 [info ] [MainThread]:   port: 5432
[0m16:20:16.393328 [info ] [MainThread]:   user: admin
[0m16:20:16.393498 [info ] [MainThread]:   database: dev_ohwk
[0m16:20:16.393603 [info ] [MainThread]:   schema: dbt
[0m16:20:16.393697 [info ] [MainThread]:   connect_timeout: 10
[0m16:20:16.393800 [info ] [MainThread]:   role: None
[0m16:20:16.393900 [info ] [MainThread]:   search_path: None
[0m16:20:16.394002 [info ] [MainThread]:   keepalives_idle: 0
[0m16:20:16.394094 [info ] [MainThread]:   sslmode: None
[0m16:20:16.394193 [info ] [MainThread]:   sslcert: None
[0m16:20:16.394293 [info ] [MainThread]:   sslkey: None
[0m16:20:16.394380 [info ] [MainThread]:   sslrootcert: None
[0m16:20:16.394475 [info ] [MainThread]:   application_name: dbt
[0m16:20:16.394597 [info ] [MainThread]:   retries: 1
[0m16:20:16.394964 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:20:16.426456 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:20:16.440342 [debug] [MainThread]: Using postgres connection "debug"
[0m16:20:16.440506 [debug] [MainThread]: On debug: select 1 as id
[0m16:20:16.440635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:17.260986 [debug] [MainThread]: SQL status: SELECT 1 in 0.820 seconds
[0m16:20:17.263043 [debug] [MainThread]: On debug: Close
[0m16:20:17.264138 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:20:17.264687 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:20:17.265208 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/flerinvs/dbt_scooters/dbt_project.yml> not found

[0m16:20:17.268105 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.94013417, "process_in_blocks": "0", "process_kernel_time": 0.097744, "process_mem_max_rss": "125861888", "process_out_blocks": "0", "process_user_time": 0.567374}
[0m16:20:17.268869 [debug] [MainThread]: Command `dbt debug` failed at 16:20:17.268731 after 0.94 seconds
[0m16:20:17.269388 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:20:17.269869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11174d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110be6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110afd6a0>]}
[0m16:20:17.270486 [debug] [MainThread]: Flushing usage events
[0m16:20:22.556778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:08.114927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b1fb10>]}


============================== 16:22:08.116876 | f1dea4b0-56e4-4683-bcb1-d4e84ac6f018 ==============================
[0m16:22:08.116876 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:22:08.117126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:22:08.120177 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m16:22:08.120956 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.032071292, "process_in_blocks": "0", "process_kernel_time": 0.055934, "process_mem_max_rss": "107429888", "process_out_blocks": "0", "process_user_time": 0.502277}
[0m16:22:08.121166 [debug] [MainThread]: Command `cli deps` failed at 16:22:08.121121 after 0.03 seconds
[0m16:22:08.121298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0b360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a22c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109bd7b0>]}
[0m16:22:08.121434 [debug] [MainThread]: Flushing usage events
[0m16:22:10.078519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:46.734517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ff620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c1fb10>]}


============================== 16:23:46.736267 | 8de417f3-c5b3-4b22-aedd-c05d68fb61ec ==============================
[0m16:23:46.736267 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:23:46.736538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:23:46.777986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8de417f3-c5b3-4b22-aedd-c05d68fb61ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11132b490>]}
[0m16:23:46.782493 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:23:46.783037 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:23:46.783835 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.07387383, "process_in_blocks": "0", "process_kernel_time": 0.059156, "process_mem_max_rss": "113295360", "process_out_blocks": "0", "process_user_time": 0.529441}
[0m16:23:46.784046 [debug] [MainThread]: Command `cli deps` succeeded at 16:23:46.784004 after 0.07 seconds
[0m16:23:46.784175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129bd8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129be360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129a3450>]}
[0m16:23:46.784295 [debug] [MainThread]: Flushing usage events
[0m16:23:48.054507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:57.343591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075074d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fbb10>]}


============================== 16:23:57.345310 | 461684ff-d55e-4a2f-b255-37fed8fa6136 ==============================
[0m16:23:57.345310 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:23:57.345568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:23:57.351292 [info ] [MainThread]: dbt version: 1.10.6
[0m16:23:57.351454 [info ] [MainThread]: python version: 3.13.5
[0m16:23:57.351629 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m16:23:57.351778 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit-Mach-O
[0m16:23:57.373694 [info ] [MainThread]: Using profiles dir at /Users/flerinvs/.dbt
[0m16:23:57.373916 [info ] [MainThread]: Using profiles.yml file at /Users/flerinvs/.dbt/profiles.yml
[0m16:23:57.374036 [info ] [MainThread]: Using dbt_project.yml file at /Users/flerinvs/dbt_scooters/dbt_project.yml
[0m16:23:57.374249 [info ] [MainThread]: adapter type: postgres
[0m16:23:57.374355 [info ] [MainThread]: adapter version: 1.9.0
[0m16:23:57.410029 [info ] [MainThread]: Configuration:
[0m16:23:57.410254 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:23:57.410380 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:23:57.410482 [info ] [MainThread]: Required dependencies:
[0m16:23:57.410639 [debug] [MainThread]: Executing "git --help"
[0m16:23:57.420782 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:23:57.421259 [debug] [MainThread]: STDERR: "b''"
[0m16:23:57.421459 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:23:57.421620 [info ] [MainThread]: Connection:
[0m16:23:57.421769 [info ] [MainThread]:   host: dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com
[0m16:23:57.421874 [info ] [MainThread]:   port: 5432
[0m16:23:57.421986 [info ] [MainThread]:   user: admin
[0m16:23:57.422078 [info ] [MainThread]:   database: dev_ohwk
[0m16:23:57.422170 [info ] [MainThread]:   schema: dbt
[0m16:23:57.422263 [info ] [MainThread]:   connect_timeout: 10
[0m16:23:57.422361 [info ] [MainThread]:   role: None
[0m16:23:57.422455 [info ] [MainThread]:   search_path: None
[0m16:23:57.422546 [info ] [MainThread]:   keepalives_idle: 0
[0m16:23:57.422634 [info ] [MainThread]:   sslmode: None
[0m16:23:57.422729 [info ] [MainThread]:   sslcert: None
[0m16:23:57.422815 [info ] [MainThread]:   sslkey: None
[0m16:23:57.422904 [info ] [MainThread]:   sslrootcert: None
[0m16:23:57.423003 [info ] [MainThread]:   application_name: dbt
[0m16:23:57.423094 [info ] [MainThread]:   retries: 1
[0m16:23:57.423371 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:23:57.454251 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:23:57.468622 [debug] [MainThread]: Using postgres connection "debug"
[0m16:23:57.468765 [debug] [MainThread]: On debug: select 1 as id
[0m16:23:57.468870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:58.460466 [debug] [MainThread]: SQL status: SELECT 1 in 0.991 seconds
[0m16:23:58.464797 [debug] [MainThread]: On debug: Close
[0m16:23:58.466241 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:23:58.467008 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:23:58.470111 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1504844, "process_in_blocks": "0", "process_kernel_time": 0.099429, "process_mem_max_rss": "127369216", "process_out_blocks": "0", "process_user_time": 0.599057}
[0m16:23:58.470927 [debug] [MainThread]: Command `dbt debug` succeeded at 16:23:58.470774 after 1.15 seconds
[0m16:23:58.471427 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:23:58.471956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b5ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109065eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad48d0>]}
[0m16:23:58.472555 [debug] [MainThread]: Flushing usage events
[0m16:23:59.008463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:26.927544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccbb10>]}


============================== 16:24:26.929267 | 8cea40dc-8b97-49f4-9459-59df0364f412 ==============================
[0m16:24:26.929267 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:24:26.929535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed -s scooters', 'send_anonymous_usage_stats': 'True'}
[0m16:24:26.992630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcb490>]}
[0m16:24:27.013901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b62030>]}
[0m16:24:27.014226 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:24:27.048550 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:24:27.090377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:27.090534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:27.106755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794af50>]}
[0m16:24:27.138492 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:24:27.139797 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:24:27.145924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a19130>]}
[0m16:24:27.146099 [info ] [MainThread]: Found 11 models, 1 seed, 12 sources, 434 macros
[0m16:24:27.146235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f5b70>]}
[0m16:24:27.146878 [info ] [MainThread]: 
[0m16:24:27.147011 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:24:27.147110 [info ] [MainThread]: 
[0m16:24:27.147298 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:24:27.147666 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:24:27.165078 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:24:27.165279 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:24:27.165402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:27.809683 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.644 seconds
[0m16:24:27.812453 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:24:27.819730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:24:27.825456 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:24:27.825735 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:24:27.825947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:28.468252 [debug] [ThreadPool]: SQL status: BEGIN in 0.642 seconds
[0m16:24:28.469090 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:24:28.469576 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:24:28.526110 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.056 seconds
[0m16:24:28.531008 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:24:28.577057 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:24:28.587907 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:28.588386 [debug] [MainThread]: On master: BEGIN
[0m16:24:28.588729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:29.299392 [debug] [MainThread]: SQL status: BEGIN in 0.710 seconds
[0m16:24:29.300722 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:29.301931 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:24:29.357290 [debug] [MainThread]: SQL status: SELECT 3 in 0.054 seconds
[0m16:24:29.361342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d80c80>]}
[0m16:24:29.362246 [debug] [MainThread]: On master: ROLLBACK
[0m16:24:29.408869 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:29.409797 [debug] [MainThread]: On master: BEGIN
[0m16:24:29.521965 [debug] [MainThread]: SQL status: BEGIN in 0.111 seconds
[0m16:24:29.523215 [debug] [MainThread]: On master: COMMIT
[0m16:24:29.523949 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:29.524531 [debug] [MainThread]: On master: COMMIT
[0m16:24:29.570418 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m16:24:29.571321 [debug] [MainThread]: On master: Close
[0m16:24:29.579574 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.scooters
[0m16:24:29.580339 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.scooters ............................................ [RUN]
[0m16:24:29.580927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.scooters)
[0m16:24:29.581864 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.scooters
[0m16:24:29.582319 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.scooters
[0m16:24:29.608306 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:24:29.608582 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: BEGIN
[0m16:24:29.608771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:31.138375 [debug] [Thread-1 (]: SQL status: BEGIN in 1.529 seconds
[0m16:24:31.139889 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:24:31.140580 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_ohwk"."dbt"."scooters"
[0m16:24:31.202049 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.061 seconds
[0m16:24:31.230152 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:24:31.230604 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_ohwk"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m16:24:31.282698 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.052 seconds
[0m16:24:31.291217 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m16:24:31.305515 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m16:24:31.305792 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:24:31.306011 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m16:24:31.356459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.050 seconds
[0m16:24:31.358280 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: Close
[0m16:24:31.360700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cea40dc-8b97-49f4-9459-59df0364f412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b734d0>]}
[0m16:24:31.361216 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt.scooters ........................................ [[32mINSERT 10[0m in 1.78s]
[0m16:24:31.361690 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.scooters
[0m16:24:31.362717 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:31.362942 [debug] [MainThread]: On master: BEGIN
[0m16:24:31.363127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:32.193879 [debug] [MainThread]: SQL status: BEGIN in 0.830 seconds
[0m16:24:32.195006 [debug] [MainThread]: On master: COMMIT
[0m16:24:32.195657 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:32.196202 [debug] [MainThread]: On master: COMMIT
[0m16:24:32.247133 [debug] [MainThread]: SQL status: COMMIT in 0.050 seconds
[0m16:24:32.248177 [debug] [MainThread]: On master: Close
[0m16:24:32.249614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:32.250160 [debug] [MainThread]: Connection 'seed.dbt_scooters.scooters' was properly closed.
[0m16:24:32.250719 [info ] [MainThread]: 
[0m16:24:32.251436 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m16:24:32.252741 [debug] [MainThread]: Command end result
[0m16:24:32.278719 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:24:32.280091 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:24:32.284115 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:24:32.284299 [info ] [MainThread]: 
[0m16:24:32.284512 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:32.284662 [info ] [MainThread]: 
[0m16:24:32.284833 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:24:32.285793 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 5.3843775, "process_in_blocks": "0", "process_kernel_time": 0.116253, "process_mem_max_rss": "136134656", "process_out_blocks": "0", "process_user_time": 0.892786}
[0m16:24:32.286054 [debug] [MainThread]: Command `dbt seed` succeeded at 16:24:32.285998 after 5.38 seconds
[0m16:24:32.286270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d841b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f12d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f12e90>]}
[0m16:24:32.286472 [debug] [MainThread]: Flushing usage events
[0m16:24:40.106089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:38.260359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040af620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c27b10>]}


============================== 16:25:38.262701 | a0a3407e-7cc3-46e8-9a33-d684370ae8b0 ==============================
[0m16:25:38.262701 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:25:38.262964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:25:38.327697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0a3407e-7cc3-46e8-9a33-d684370ae8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2b490>]}
[0m16:25:38.348406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0a3407e-7cc3-46e8-9a33-d684370ae8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bebe0>]}
[0m16:25:38.348826 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:25:38.383780 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m16:25:38.421177 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:25:38.421400 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m16:25:38.421546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a0a3407e-7cc3-46e8-9a33-d684370ae8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689be50>]}
[0m16:25:38.892441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0a3407e-7cc3-46e8-9a33-d684370ae8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aea030>]}
[0m16:25:38.921395 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:25:38.922250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:25:38.927772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0a3407e-7cc3-46e8-9a33-d684370ae8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107069b70>]}
[0m16:25:38.927989 [info ] [MainThread]: Found 12 models, 1 seed, 12 sources, 434 macros
[0m16:25:38.928199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0a3407e-7cc3-46e8-9a33-d684370ae8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c5cc0>]}
[0m16:25:38.928888 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:25:38.929135 [debug] [MainThread]: Command end result
[0m16:25:38.938936 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:25:38.939774 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:25:38.941083 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:25:38.941741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7083914, "process_in_blocks": "0", "process_kernel_time": 0.095342, "process_mem_max_rss": "128974848", "process_out_blocks": "0", "process_user_time": 1.152532}
[0m16:25:38.941898 [debug] [MainThread]: Command `cli run` succeeded at 16:25:38.941866 after 0.71 seconds
[0m16:25:38.942036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b0cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714c1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714c730>]}
[0m16:25:38.942152 [debug] [MainThread]: Flushing usage events
[0m16:25:42.353135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:29.528183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079574d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e53b10>]}


============================== 16:26:29.529915 | 7d951edc-6b48-455b-8129-df94d2f2ed20 ==============================
[0m16:26:29.529915 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:26:29.530181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -s scooters+', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:26:29.591592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108153490>]}
[0m16:26:29.611899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cea030>]}
[0m16:26:29.612216 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:26:29.645718 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:26:29.687853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:29.688013 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:29.704306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad3250>]}
[0m16:26:29.736401 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:26:29.737232 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:26:29.749244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d2bf20>]}
[0m16:26:29.749436 [info ] [MainThread]: Found 13 models, 1 seed, 12 sources, 434 macros
[0m16:26:29.750245 [info ] [MainThread]: 
[0m16:26:29.750382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:26:29.750480 [info ] [MainThread]: 
[0m16:26:29.750664 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:26:29.752085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:26:29.770961 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:26:29.771150 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:26:29.771255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:30.550189 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.779 seconds
[0m16:26:30.553634 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:26:30.558499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:26:30.566726 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:26:30.567194 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:26:30.567484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:31.408732 [debug] [ThreadPool]: SQL status: BEGIN in 0.841 seconds
[0m16:26:31.410176 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:26:31.411185 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:26:31.459828 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.048 seconds
[0m16:26:31.462699 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:26:31.507828 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:26:31.520408 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:31.521014 [debug] [MainThread]: On master: BEGIN
[0m16:26:31.521303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:32.562393 [debug] [MainThread]: SQL status: BEGIN in 1.041 seconds
[0m16:26:32.563920 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:32.565147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:26:32.620619 [debug] [MainThread]: SQL status: SELECT 3 in 0.054 seconds
[0m16:26:32.626225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5b3f0>]}
[0m16:26:32.626934 [debug] [MainThread]: On master: ROLLBACK
[0m16:26:32.672719 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:32.673482 [debug] [MainThread]: On master: BEGIN
[0m16:26:32.763529 [debug] [MainThread]: SQL status: BEGIN in 0.089 seconds
[0m16:26:32.764175 [debug] [MainThread]: On master: COMMIT
[0m16:26:32.764589 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:32.765085 [debug] [MainThread]: On master: COMMIT
[0m16:26:32.811437 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m16:26:32.811816 [debug] [MainThread]: On master: Close
[0m16:26:32.814991 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.scooters
[0m16:26:32.815484 [info ] [Thread-1 (]: 1 of 2 START seed file dbt.scooters ............................................ [RUN]
[0m16:26:32.815865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.scooters)
[0m16:26:32.816142 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.scooters
[0m16:26:32.816389 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.scooters
[0m16:26:32.838110 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:32.838387 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: BEGIN
[0m16:26:32.838554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:33.492773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.654 seconds
[0m16:26:33.494612 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:33.495710 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_ohwk"."dbt"."scooters"
[0m16:26:33.574484 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.078 seconds
[0m16:26:33.601024 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:33.601454 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_ohwk"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m16:26:33.651715 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.050 seconds
[0m16:26:33.660567 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m16:26:33.674088 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m16:26:33.674396 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:33.674628 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m16:26:33.733041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.058 seconds
[0m16:26:33.735812 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: Close
[0m16:26:33.737918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0fa000>]}
[0m16:26:33.738487 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file dbt.scooters ........................................ [[32mINSERT 10[0m in 0.92s]
[0m16:26:33.738983 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.scooters
[0m16:26:33.739857 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies
[0m16:26:33.740371 [info ] [Thread-2 (]: 2 of 2 START sql view model dbt.companies ...................................... [RUN]
[0m16:26:33.740845 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.companies'
[0m16:26:33.741137 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies
[0m16:26:33.747659 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m16:26:33.749200 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies
[0m16:26:33.768925 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m16:26:33.769429 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:33.769608 [debug] [Thread-2 (]: On model.dbt_scooters.companies: BEGIN
[0m16:26:33.769759 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:26:34.530540 [debug] [Thread-2 (]: SQL status: BEGIN in 0.760 seconds
[0m16:26:34.532358 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:34.533219 [debug] [Thread-2 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  create view "dev_ohwk"."dbt"."companies__dbt_tmp"
    
    
  as (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_ohwk"."dbt"."scooters"
group by
    1
  );
[0m16:26:34.582913 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m16:26:34.595365 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:34.596017 [debug] [Thread-2 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies" rename to "companies__dbt_backup"
[0m16:26:34.642771 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:26:34.646342 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:34.646532 [debug] [Thread-2 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies__dbt_tmp" rename to "companies"
[0m16:26:34.692608 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:26:34.695164 [debug] [Thread-2 (]: On model.dbt_scooters.companies: COMMIT
[0m16:26:34.695390 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:34.695580 [debug] [Thread-2 (]: On model.dbt_scooters.companies: COMMIT
[0m16:26:34.743336 [debug] [Thread-2 (]: SQL status: COMMIT in 0.048 seconds
[0m16:26:34.748833 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."companies__dbt_backup"
[0m16:26:34.752791 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:34.753047 [debug] [Thread-2 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_ohwk"."dbt"."companies__dbt_backup" cascade
[0m16:26:34.802870 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.049 seconds
[0m16:26:34.805104 [debug] [Thread-2 (]: On model.dbt_scooters.companies: Close
[0m16:26:34.806435 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d951edc-6b48-455b-8129-df94d2f2ed20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d89b50>]}
[0m16:26:34.807305 [info ] [Thread-2 (]: 2 of 2 OK created sql view model dbt.companies ................................. [[32mCREATE VIEW[0m in 1.07s]
[0m16:26:34.807929 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies
[0m16:26:34.809379 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:34.809798 [debug] [MainThread]: On master: BEGIN
[0m16:26:34.810094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:35.439357 [debug] [MainThread]: SQL status: BEGIN in 0.629 seconds
[0m16:26:35.440946 [debug] [MainThread]: On master: COMMIT
[0m16:26:35.441607 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:35.442090 [debug] [MainThread]: On master: COMMIT
[0m16:26:35.489498 [debug] [MainThread]: SQL status: COMMIT in 0.047 seconds
[0m16:26:35.490662 [debug] [MainThread]: On master: Close
[0m16:26:35.492536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:35.493194 [debug] [MainThread]: Connection 'seed.dbt_scooters.scooters' was properly closed.
[0m16:26:35.493605 [debug] [MainThread]: Connection 'model.dbt_scooters.companies' was properly closed.
[0m16:26:35.494138 [info ] [MainThread]: 
[0m16:26:35.494726 [info ] [MainThread]: Finished running 1 seed, 1 view model in 0 hours 0 minutes and 5.74 seconds (5.74s).
[0m16:26:35.496087 [debug] [MainThread]: Command end result
[0m16:26:35.562949 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:26:35.564006 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:26:35.566817 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:26:35.566955 [info ] [MainThread]: 
[0m16:26:35.567116 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:26:35.567234 [info ] [MainThread]: 
[0m16:26:35.567361 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m16:26:35.568134 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.0642834, "process_in_blocks": "0", "process_kernel_time": 0.128987, "process_mem_max_rss": "137510912", "process_out_blocks": "0", "process_user_time": 1.002742}
[0m16:26:35.568325 [debug] [MainThread]: Command `dbt build` succeeded at 16:26:35.568285 after 6.06 seconds
[0m16:26:35.568477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cff120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0837f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a083610>]}
[0m16:26:35.568619 [debug] [MainThread]: Flushing usage events
[0m16:26:36.830055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:46.586227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107527b10>]}


============================== 16:26:46.588054 | 26736b32-ad61-4cc5-8845-0fb37e21b6a8 ==============================
[0m16:26:46.588054 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:26:46.588312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build -s +companies_trips', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:26:46.653298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106427490>]}
[0m16:26:46.674857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073be030>]}
[0m16:26:46.675214 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:26:46.708745 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:26:46.750614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:46.750781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:46.767597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11120b450>]}
[0m16:26:46.801321 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:26:46.802245 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:26:46.812830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111653f20>]}
[0m16:26:46.813041 [info ] [MainThread]: Found 13 models, 1 seed, 12 sources, 434 macros
[0m16:26:46.813913 [info ] [MainThread]: 
[0m16:26:46.814058 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:26:46.814174 [info ] [MainThread]: 
[0m16:26:46.814387 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:26:46.815856 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:26:46.833473 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:26:46.833677 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:26:46.833790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:47.507388 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.673 seconds
[0m16:26:47.510610 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:26:47.515736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:26:47.524849 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:26:47.525404 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:26:47.525711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:48.163868 [debug] [ThreadPool]: SQL status: BEGIN in 0.638 seconds
[0m16:26:48.164179 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:26:48.164367 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:26:48.224700 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.060 seconds
[0m16:26:48.225502 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:26:48.270945 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:26:48.274211 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:48.274352 [debug] [MainThread]: On master: BEGIN
[0m16:26:48.274451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:50.016553 [debug] [MainThread]: SQL status: BEGIN in 1.742 seconds
[0m16:26:50.017690 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:50.018631 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:26:50.115485 [debug] [MainThread]: SQL status: SELECT 4 in 0.096 seconds
[0m16:26:50.120615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111683850>]}
[0m16:26:50.121454 [debug] [MainThread]: On master: ROLLBACK
[0m16:26:50.165790 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:50.166374 [debug] [MainThread]: On master: BEGIN
[0m16:26:50.257544 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m16:26:50.258776 [debug] [MainThread]: On master: COMMIT
[0m16:26:50.259705 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:50.260257 [debug] [MainThread]: On master: COMMIT
[0m16:26:50.307016 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m16:26:50.307970 [debug] [MainThread]: On master: Close
[0m16:26:50.315034 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.scooters
[0m16:26:50.315678 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m16:26:50.316336 [info ] [Thread-2 (]: 2 of 4 START seed file dbt.scooters ............................................ [RUN]
[0m16:26:50.316940 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt.trips_prep ..................................... [RUN]
[0m16:26:50.317700 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.dbt_scooters.scooters'
[0m16:26:50.318202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.trips_prep)
[0m16:26:50.318611 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.scooters
[0m16:26:50.318981 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m16:26:50.319337 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.scooters
[0m16:26:50.326874 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m16:26:50.348120 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:50.348420 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: BEGIN
[0m16:26:50.348600 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:26:50.348808 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m16:26:50.365266 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m16:26:50.365798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:26:50.365970 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m16:26:50.366119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:51.100666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.734 seconds
[0m16:26:51.102010 [debug] [Thread-2 (]: SQL status: BEGIN in 0.753 seconds
[0m16:26:51.102923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:26:51.103729 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:51.104470 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_ohwk"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  );
[0m16:26:51.105201 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_ohwk"."dbt"."scooters"
[0m16:26:51.161809 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.056 seconds
[0m16:26:51.170195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:26:51.170676 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.065 seconds
[0m16:26:51.171025 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m16:26:51.186226 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:51.186544 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_ohwk"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m16:26:51.229294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:26:51.234429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:26:51.234695 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m16:26:51.237905 [debug] [Thread-2 (]: SQL status: INSERT 0 10 in 0.051 seconds
[0m16:26:51.241611 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m16:26:51.250572 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: COMMIT
[0m16:26:51.250797 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m16:26:51.250967 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: COMMIT
[0m16:26:51.281076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:26:51.283388 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m16:26:51.283618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:26:51.283815 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m16:26:51.298199 [debug] [Thread-2 (]: SQL status: COMMIT in 0.047 seconds
[0m16:26:51.299559 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: Close
[0m16:26:51.300949 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111afcc80>]}
[0m16:26:51.301375 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file dbt.scooters ........................................ [[32mINSERT 10[0m in 0.98s]
[0m16:26:51.301797 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.scooters
[0m16:26:51.302249 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies
[0m16:26:51.302663 [info ] [Thread-3 (]: 3 of 4 START sql view model dbt.companies ...................................... [RUN]
[0m16:26:51.303040 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.companies'
[0m16:26:51.303266 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies
[0m16:26:51.304996 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m16:26:51.305450 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies
[0m16:26:51.339401 [debug] [Thread-1 (]: SQL status: COMMIT in 0.055 seconds
[0m16:26:51.340705 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m16:26:51.343522 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_prep__dbt_backup"
[0m16:26:51.345766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:26:51.345920 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_ohwk"."dbt"."trips_prep__dbt_backup" cascade
[0m16:26:51.346201 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:51.346344 [debug] [Thread-3 (]: On model.dbt_scooters.companies: BEGIN
[0m16:26:51.346472 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:26:51.393584 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.047 seconds
[0m16:26:51.394563 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m16:26:51.394989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116134d0>]}
[0m16:26:51.395348 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt.trips_prep ................................ [[32mCREATE VIEW[0m in 1.08s]
[0m16:26:51.395650 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m16:26:52.017700 [debug] [Thread-3 (]: SQL status: BEGIN in 0.671 seconds
[0m16:26:52.018353 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:52.018759 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  create view "dev_ohwk"."dbt"."companies__dbt_tmp"
    
    
  as (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_ohwk"."dbt"."scooters"
group by
    1
  );
[0m16:26:52.067518 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m16:26:52.073572 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:52.074072 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies" rename to "companies__dbt_backup"
[0m16:26:52.120322 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:26:52.125011 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:52.125423 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies__dbt_tmp" rename to "companies"
[0m16:26:52.173284 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m16:26:52.176253 [debug] [Thread-3 (]: On model.dbt_scooters.companies: COMMIT
[0m16:26:52.176883 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:52.177267 [debug] [Thread-3 (]: On model.dbt_scooters.companies: COMMIT
[0m16:26:52.223791 [debug] [Thread-3 (]: SQL status: COMMIT in 0.046 seconds
[0m16:26:52.228565 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."companies__dbt_backup"
[0m16:26:52.229512 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:26:52.229916 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop view if exists "dev_ohwk"."dbt"."companies__dbt_backup" cascade
[0m16:26:52.278153 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.048 seconds
[0m16:26:52.280842 [debug] [Thread-3 (]: On model.dbt_scooters.companies: Close
[0m16:26:52.282376 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11162eba0>]}
[0m16:26:52.283434 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dbt.companies ................................. [[32mCREATE VIEW[0m in 0.98s]
[0m16:26:52.284154 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies
[0m16:26:52.285062 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies_trips
[0m16:26:52.285677 [info ] [Thread-4 (]: 4 of 4 START sql view model dbt.companies_trips ................................ [RUN]
[0m16:26:52.286272 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.companies_trips'
[0m16:26:52.286645 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies_trips
[0m16:26:52.289787 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m16:26:52.290657 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies_trips
[0m16:26:52.293487 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m16:26:52.294037 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:26:52.294272 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m16:26:52.294498 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:26:52.941882 [debug] [Thread-4 (]: SQL status: BEGIN in 0.647 seconds
[0m16:26:52.943003 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:26:52.943779 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  create view "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
    
    
  as (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
[0m16:26:52.999003 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m16:26:53.002946 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:26:53.003338 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m16:26:53.050014 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:26:53.051351 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m16:26:53.051634 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:26:53.051843 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m16:26:53.098186 [debug] [Thread-4 (]: SQL status: COMMIT in 0.046 seconds
[0m16:26:53.100293 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m16:26:53.100877 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:26:53.101175 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop view if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m16:26:53.147271 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.046 seconds
[0m16:26:53.149633 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: Close
[0m16:26:53.150635 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26736b32-ad61-4cc5-8845-0fb37e21b6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f1810>]}
[0m16:26:53.151334 [info ] [Thread-4 (]: 4 of 4 OK created sql view model dbt.companies_trips ........................... [[32mCREATE VIEW[0m in 0.86s]
[0m16:26:53.152027 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies_trips
[0m16:26:53.153544 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:53.153860 [debug] [MainThread]: On master: BEGIN
[0m16:26:53.154103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:54.598493 [debug] [MainThread]: SQL status: BEGIN in 1.444 seconds
[0m16:26:54.600227 [debug] [MainThread]: On master: COMMIT
[0m16:26:54.602892 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:54.603832 [debug] [MainThread]: On master: COMMIT
[0m16:26:54.652477 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m16:26:54.653458 [debug] [MainThread]: On master: Close
[0m16:26:54.654402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:54.654823 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_prep' was properly closed.
[0m16:26:54.655098 [debug] [MainThread]: Connection 'seed.dbt_scooters.scooters' was properly closed.
[0m16:26:54.655354 [debug] [MainThread]: Connection 'model.dbt_scooters.companies' was properly closed.
[0m16:26:54.655575 [debug] [MainThread]: Connection 'model.dbt_scooters.companies_trips' was properly closed.
[0m16:26:54.655938 [info ] [MainThread]: 
[0m16:26:54.656266 [info ] [MainThread]: Finished running 1 seed, 3 view models in 0 hours 0 minutes and 7.84 seconds (7.84s).
[0m16:26:54.657336 [debug] [MainThread]: Command end result
[0m16:26:54.678165 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:26:54.679615 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:26:54.683459 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:26:54.683638 [info ] [MainThread]: 
[0m16:26:54.683832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:26:54.683977 [info ] [MainThread]: 
[0m16:26:54.684134 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:26:54.685029 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.124219, "process_in_blocks": "0", "process_kernel_time": 0.128543, "process_mem_max_rss": "138838016", "process_out_blocks": "0", "process_user_time": 1.018167}
[0m16:26:54.685260 [debug] [MainThread]: Command `dbt build` succeeded at 16:26:54.685210 after 8.12 seconds
[0m16:26:54.685468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107547230>]}
[0m16:26:54.685652 [debug] [MainThread]: Flushing usage events
[0m16:27:01.581394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:23.083953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112027b10>]}


============================== 16:29:23.085672 | a2bb543a-7e7f-474c-8078-273b462802f8 ==============================
[0m16:29:23.085672 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:29:23.085930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed -s event_types', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:23.147007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110727490>]}
[0m16:29:23.167231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ebe030>]}
[0m16:29:23.167554 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:29:23.200173 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:29:23.242762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:29:23.243028 [debug] [MainThread]: Partial parsing: added file: dbt_scooters://seeds/event_types.csv
[0m16:29:23.326120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c53250>]}
[0m16:29:23.357143 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:29:23.358043 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:29:23.363905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d25130>]}
[0m16:29:23.364120 [info ] [MainThread]: Found 13 models, 2 seeds, 12 sources, 434 macros
[0m16:29:23.364276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11306bcb0>]}
[0m16:29:23.364899 [info ] [MainThread]: 
[0m16:29:23.365041 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:29:23.365142 [info ] [MainThread]: 
[0m16:29:23.365330 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:29:23.365647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:29:23.383567 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:29:23.383781 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:29:23.383895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:25.004385 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.620 seconds
[0m16:29:25.007547 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:29:25.015539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:29:25.022672 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:29:25.023146 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:29:25.023399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:25.746695 [debug] [ThreadPool]: SQL status: BEGIN in 0.723 seconds
[0m16:29:25.747825 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:29:25.748488 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:29:25.804996 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.056 seconds
[0m16:29:25.809197 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:29:25.863636 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:29:25.874554 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:25.874993 [debug] [MainThread]: On master: BEGIN
[0m16:29:25.875275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:26.544488 [debug] [MainThread]: SQL status: BEGIN in 0.669 seconds
[0m16:29:26.544825 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:26.545041 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:29:26.617609 [debug] [MainThread]: SQL status: SELECT 7 in 0.072 seconds
[0m16:29:26.619354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11317f790>]}
[0m16:29:26.619674 [debug] [MainThread]: On master: ROLLBACK
[0m16:29:26.665874 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:26.666165 [debug] [MainThread]: On master: BEGIN
[0m16:29:26.767583 [debug] [MainThread]: SQL status: BEGIN in 0.101 seconds
[0m16:29:26.768672 [debug] [MainThread]: On master: COMMIT
[0m16:29:26.769370 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:26.769960 [debug] [MainThread]: On master: COMMIT
[0m16:29:26.817503 [debug] [MainThread]: SQL status: COMMIT in 0.047 seconds
[0m16:29:26.818696 [debug] [MainThread]: On master: Close
[0m16:29:26.827411 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.event_types
[0m16:29:26.828775 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.event_types ......................................... [RUN]
[0m16:29:26.829731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.event_types)
[0m16:29:26.830226 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.event_types
[0m16:29:26.830613 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.event_types
[0m16:29:26.854485 [debug] [Thread-1 (]: Compilation Error in seed event_types (seeds/event_types.csv)
  value was undefined because a callable raised a StopIteration exception
[0m16:29:26.855679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2bb543a-7e7f-474c-8078-273b462802f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cfba10>]}
[0m16:29:26.856032 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file dbt.event_types ................................. [[31mERROR[0m in 0.03s]
[0m16:29:26.856372 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.event_types
[0m16:29:26.856726 [debug] [Thread-7 (]: Marking all children of 'seed.dbt_scooters.event_types' to be skipped because of status 'error'.  Reason: Compilation Error in seed event_types (seeds/event_types.csv)
  value was undefined because a callable raised a StopIteration exception.
[0m16:29:26.857995 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:26.858172 [debug] [MainThread]: On master: BEGIN
[0m16:29:26.858316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:27.570487 [debug] [MainThread]: SQL status: BEGIN in 0.712 seconds
[0m16:29:27.571612 [debug] [MainThread]: On master: COMMIT
[0m16:29:27.572372 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:27.572892 [debug] [MainThread]: On master: COMMIT
[0m16:29:27.617555 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m16:29:27.618486 [debug] [MainThread]: On master: Close
[0m16:29:27.619878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:27.620402 [debug] [MainThread]: Connection 'seed.dbt_scooters.event_types' was properly closed.
[0m16:29:27.620958 [info ] [MainThread]: 
[0m16:29:27.621545 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m16:29:27.622707 [debug] [MainThread]: Command end result
[0m16:29:27.688695 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:29:27.689690 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:29:27.692451 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:29:27.692591 [info ] [MainThread]: 
[0m16:29:27.692752 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:29:27.692869 [info ] [MainThread]: 
[0m16:29:27.693020 [error] [MainThread]: [31mFailure in seed event_types (seeds/event_types.csv)[0m
[0m16:29:27.693158 [error] [MainThread]:   Compilation Error in seed event_types (seeds/event_types.csv)
  value was undefined because a callable raised a StopIteration exception
[0m16:29:27.693263 [info ] [MainThread]: 
[0m16:29:27.693379 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:29:27.694183 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.634324, "process_in_blocks": "0", "process_kernel_time": 0.11959, "process_mem_max_rss": "137428992", "process_out_blocks": "0", "process_user_time": 0.918972}
[0m16:29:27.694370 [debug] [MainThread]: Command `dbt seed` failed at 16:29:27.694330 after 4.63 seconds
[0m16:29:27.694529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131460a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113005c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130059f0>]}
[0m16:29:27.694671 [debug] [MainThread]: Flushing usage events
[0m16:29:28.943046 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:57.275827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067274d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122127b10>]}


============================== 16:29:57.277546 | 432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b ==============================
[0m16:29:57.277546 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:29:57.277813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed -s event_types', 'send_anonymous_usage_stats': 'True'}
[0m16:29:57.339138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e27490>]}
[0m16:29:57.360047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204be030>]}
[0m16:29:57.360401 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:29:57.394516 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:29:57.436299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:57.436454 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:57.452523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122bdb150>]}
[0m16:29:57.484397 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:29:57.485217 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:29:57.491277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122cad130>]}
[0m16:29:57.491490 [info ] [MainThread]: Found 13 models, 2 seeds, 12 sources, 434 macros
[0m16:29:57.491640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12248baf0>]}
[0m16:29:57.492329 [info ] [MainThread]: 
[0m16:29:57.492466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:29:57.492569 [info ] [MainThread]: 
[0m16:29:57.492762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:29:57.493119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:29:57.510442 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:29:57.510648 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:29:57.510758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:58.145049 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.634 seconds
[0m16:29:58.149288 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:29:58.158569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:29:58.166780 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:29:58.167370 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:29:58.167671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:59.023470 [debug] [ThreadPool]: SQL status: BEGIN in 0.855 seconds
[0m16:29:59.025027 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:29:59.026019 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:29:59.076171 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.049 seconds
[0m16:29:59.081321 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:29:59.125878 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:29:59.137354 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:59.138011 [debug] [MainThread]: On master: BEGIN
[0m16:29:59.138376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:00.005460 [debug] [MainThread]: SQL status: BEGIN in 0.867 seconds
[0m16:30:00.006510 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:00.007192 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:30:00.070206 [debug] [MainThread]: SQL status: SELECT 7 in 0.062 seconds
[0m16:30:00.078173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123019300>]}
[0m16:30:00.079313 [debug] [MainThread]: On master: ROLLBACK
[0m16:30:00.123287 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:00.124057 [debug] [MainThread]: On master: BEGIN
[0m16:30:00.212904 [debug] [MainThread]: SQL status: BEGIN in 0.088 seconds
[0m16:30:00.213966 [debug] [MainThread]: On master: COMMIT
[0m16:30:00.214863 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:00.215647 [debug] [MainThread]: On master: COMMIT
[0m16:30:00.266786 [debug] [MainThread]: SQL status: COMMIT in 0.050 seconds
[0m16:30:00.267941 [debug] [MainThread]: On master: Close
[0m16:30:00.276022 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.event_types
[0m16:30:00.276731 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.event_types ......................................... [RUN]
[0m16:30:00.277286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.event_types)
[0m16:30:00.277665 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.event_types
[0m16:30:00.277997 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.event_types
[0m16:30:00.301119 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m16:30:00.301399 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: BEGIN
[0m16:30:00.301594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:01.967797 [debug] [Thread-1 (]: SQL status: BEGIN in 1.666 seconds
[0m16:30:01.968727 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m16:30:01.969326 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_ohwk"."dbt"."event_types"
[0m16:30:02.019824 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.050 seconds
[0m16:30:02.043394 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m16:30:02.043907 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_ohwk"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m16:30:02.093096 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.049 seconds
[0m16:30:02.100981 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m16:30:02.113854 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: COMMIT
[0m16:30:02.114196 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m16:30:02.114475 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: COMMIT
[0m16:30:02.160228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.045 seconds
[0m16:30:02.162225 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: Close
[0m16:30:02.163960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '432c1baa-4ac1-4b04-ac88-d4d9a97d6a5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122df34d0>]}
[0m16:30:02.164453 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt.event_types ..................................... [[32mINSERT 4[0m in 1.89s]
[0m16:30:02.164954 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.event_types
[0m16:30:02.166134 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:02.166389 [debug] [MainThread]: On master: BEGIN
[0m16:30:02.166610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:02.995541 [debug] [MainThread]: SQL status: BEGIN in 0.829 seconds
[0m16:30:02.996795 [debug] [MainThread]: On master: COMMIT
[0m16:30:02.997510 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:02.998041 [debug] [MainThread]: On master: COMMIT
[0m16:30:03.042597 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m16:30:03.042944 [debug] [MainThread]: On master: Close
[0m16:30:03.043350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:03.043507 [debug] [MainThread]: Connection 'seed.dbt_scooters.event_types' was properly closed.
[0m16:30:03.043668 [info ] [MainThread]: 
[0m16:30:03.043845 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m16:30:03.044245 [debug] [MainThread]: Command end result
[0m16:30:03.063346 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:30:03.064756 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:30:03.069000 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:30:03.069249 [info ] [MainThread]: 
[0m16:30:03.069507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:03.069686 [info ] [MainThread]: 
[0m16:30:03.069885 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:30:03.071243 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 5.8195925, "process_in_blocks": "0", "process_kernel_time": 0.115103, "process_mem_max_rss": "136183808", "process_out_blocks": "0", "process_user_time": 0.878995}
[0m16:30:03.071598 [debug] [MainThread]: Command `dbt seed` succeeded at 16:30:03.071532 after 5.82 seconds
[0m16:30:03.071834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12301d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12309b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12309a8f0>]}
[0m16:30:03.072050 [debug] [MainThread]: Flushing usage events
[0m16:30:08.373075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:59.476261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031bf620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d7b10>]}


============================== 16:30:59.478270 | b2574b94-25df-46a2-8ae6-a4cc3a56a071 ==============================
[0m16:30:59.478270 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:30:59.478550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:30:59.544184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039df490>]}
[0m16:30:59.566176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10456ebe0>]}
[0m16:30:59.566587 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:30:59.601711 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m16:30:59.637941 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:30:59.638162 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m16:30:59.638309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105534250>]}
[0m16:31:00.124071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e8d70>]}
[0m16:31:00.155526 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:31:00.156405 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:31:00.169082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058dd9b0>]}
[0m16:31:00.169310 [info ] [MainThread]: Found 14 models, 2 seeds, 14 sources, 434 macros
[0m16:31:00.170277 [info ] [MainThread]: 
[0m16:31:00.170448 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:31:00.170562 [info ] [MainThread]: 
[0m16:31:00.170795 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:00.171177 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:31:00.188944 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:31:00.189136 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:31:00.189243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:01.545188 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.356 seconds
[0m16:31:01.547492 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:31:01.556313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:31:01.564652 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:31:01.565188 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:31:01.565475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:02.193622 [debug] [ThreadPool]: SQL status: BEGIN in 0.628 seconds
[0m16:31:02.194915 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:31:02.195378 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:31:02.247970 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.052 seconds
[0m16:31:02.250261 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:31:02.296295 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:31:02.306771 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:02.307354 [debug] [MainThread]: On master: BEGIN
[0m16:31:02.307603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:03.810933 [debug] [MainThread]: SQL status: BEGIN in 1.503 seconds
[0m16:31:03.811859 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:03.812896 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:31:03.870503 [debug] [MainThread]: SQL status: SELECT 7 in 0.057 seconds
[0m16:31:03.874452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b9a340>]}
[0m16:31:03.875141 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:03.920161 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:03.921361 [debug] [MainThread]: On master: BEGIN
[0m16:31:04.011006 [debug] [MainThread]: SQL status: BEGIN in 0.089 seconds
[0m16:31:04.012018 [debug] [MainThread]: On master: COMMIT
[0m16:31:04.012404 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:04.012835 [debug] [MainThread]: On master: COMMIT
[0m16:31:04.061179 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m16:31:04.062089 [debug] [MainThread]: On master: Close
[0m16:31:04.066772 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_full
[0m16:31:04.067580 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt.events_full .................................... [RUN]
[0m16:31:04.068397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_full)
[0m16:31:04.068862 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_full
[0m16:31:04.078902 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m16:31:04.080210 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_full
[0m16:31:04.106384 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m16:31:04.106938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:31:04.107126 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: BEGIN
[0m16:31:04.107289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:05.709004 [debug] [Thread-1 (]: SQL status: BEGIN in 1.601 seconds
[0m16:31:05.709937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:31:05.710495 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_ohwk"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_ohwk"."dbt"."events_clean"
    left join "dev_ohwk"."dbt"."event_types"
        using (type_id)
  );
[0m16:31:05.758264 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.047 seconds
[0m16:31:05.771377 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:31:05.772268 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m16:31:05.827360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.054 seconds
[0m16:31:05.833149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:31:05.833574 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m16:31:05.879081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m16:31:05.896682 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m16:31:05.897094 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:31:05.897347 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m16:31:05.946934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m16:31:05.953357 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."events_full__dbt_backup"
[0m16:31:05.957572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:31:05.957845 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_ohwk"."dbt"."events_full__dbt_backup" cascade
[0m16:31:06.004104 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.046 seconds
[0m16:31:06.008183 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: Close
[0m16:31:06.010467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2574b94-25df-46a2-8ae6-a4cc3a56a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105946810>]}
[0m16:31:06.011127 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt.events_full ............................... [[32mCREATE VIEW[0m in 1.94s]
[0m16:31:06.011642 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_full
[0m16:31:06.013150 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:06.013433 [debug] [MainThread]: On master: BEGIN
[0m16:31:06.013680 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:07.505027 [debug] [MainThread]: SQL status: BEGIN in 1.491 seconds
[0m16:31:07.506342 [debug] [MainThread]: On master: COMMIT
[0m16:31:07.507010 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:07.507536 [debug] [MainThread]: On master: COMMIT
[0m16:31:07.553235 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m16:31:07.554689 [debug] [MainThread]: On master: Close
[0m16:31:07.556563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:07.557246 [debug] [MainThread]: Connection 'model.dbt_scooters.events_full' was properly closed.
[0m16:31:07.557835 [info ] [MainThread]: 
[0m16:31:07.558426 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.39 seconds (7.39s).
[0m16:31:07.559611 [debug] [MainThread]: Command end result
[0m16:31:07.588016 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:31:07.589507 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:31:07.593415 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:31:07.593604 [info ] [MainThread]: 
[0m16:31:07.593823 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:07.593980 [info ] [MainThread]: 
[0m16:31:07.594341 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:31:07.595578 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.145414, "process_in_blocks": "0", "process_kernel_time": 0.128928, "process_mem_max_rss": "146128896", "process_out_blocks": "0", "process_user_time": 1.385202}
[0m16:31:07.595863 [debug] [MainThread]: Command `cli build` succeeded at 16:31:07.595803 after 8.15 seconds
[0m16:31:07.596076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105975ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7d8b0>]}
[0m16:31:07.596281 [debug] [MainThread]: Flushing usage events
[0m16:31:12.986920 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:54.795753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104257620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106127b10>]}


============================== 16:31:54.797688 | 2986c9a5-357f-4fa2-870d-ef889351ea0d ==============================
[0m16:31:54.797688 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:31:54.797985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:54.862031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2986c9a5-357f-4fa2-870d-ef889351ea0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2f490>]}
[0m16:31:54.883442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2986c9a5-357f-4fa2-870d-ef889351ea0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbebe0>]}
[0m16:31:54.883894 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:31:54.919719 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m16:31:54.957514 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:31:54.957767 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m16:31:54.957923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2986c9a5-357f-4fa2-870d-ef889351ea0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce4250>]}
[0m16:31:55.429029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2986c9a5-357f-4fa2-870d-ef889351ea0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9d130>]}
[0m16:31:55.458342 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:31:55.459237 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:31:55.469892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2986c9a5-357f-4fa2-870d-ef889351ea0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a6270>]}
[0m16:31:55.470110 [info ] [MainThread]: Found 15 models, 2 seeds, 15 sources, 434 macros
[0m16:31:55.470839 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:31:55.471100 [debug] [MainThread]: Command end result
[0m16:31:55.480797 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:31:55.481602 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:31:55.482914 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:31:55.483724 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.71339893, "process_in_blocks": "0", "process_kernel_time": 0.098323, "process_mem_max_rss": "130826240", "process_out_blocks": "0", "process_user_time": 1.162757}
[0m16:31:55.483946 [debug] [MainThread]: Command `cli build` succeeded at 16:31:55.483907 after 0.71 seconds
[0m16:31:55.484095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107127d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f10dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f30650>]}
[0m16:31:55.484233 [debug] [MainThread]: Flushing usage events
[0m16:31:58.941813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:43.327211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109327b10>]}


============================== 21:19:43.329588 | 317adf4f-b077-4403-a16d-12ddff316202 ==============================
[0m21:19:43.329588 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:19:43.329850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed -s scooters', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:19:43.406631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108627490>]}
[0m21:19:43.428020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091be030>]}
[0m21:19:43.428540 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:19:43.464180 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:19:43.514664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:19:43.514841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:19:43.532353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa7150>]}
[0m21:19:43.566580 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:19:43.567834 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:19:43.578797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0854f0>]}
[0m21:19:43.579050 [info ] [MainThread]: Found 15 models, 3 seeds, 15 sources, 434 macros
[0m21:19:43.579203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109853d90>]}
[0m21:19:43.579911 [info ] [MainThread]: 
[0m21:19:43.580051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:19:43.580152 [info ] [MainThread]: 
[0m21:19:43.580386 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:19:43.580754 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:19:43.603498 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:19:43.603684 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:19:43.603801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:45.861412 [debug] [ThreadPool]: SQL status: SELECT 16 in 2.257 seconds
[0m21:19:45.864244 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:19:45.872526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:19:45.882036 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:19:45.882607 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:19:45.882904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:46.983991 [debug] [ThreadPool]: SQL status: BEGIN in 1.101 seconds
[0m21:19:46.984829 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:19:46.985371 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:19:47.055627 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.069 seconds
[0m21:19:47.058149 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:19:47.123069 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:19:47.134932 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:47.135441 [debug] [MainThread]: On master: BEGIN
[0m21:19:47.135784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:48.824947 [debug] [MainThread]: SQL status: BEGIN in 1.689 seconds
[0m21:19:48.826089 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:48.827239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:19:48.891653 [debug] [MainThread]: SQL status: SELECT 7 in 0.063 seconds
[0m21:19:48.895680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f17e0>]}
[0m21:19:48.896667 [debug] [MainThread]: On master: ROLLBACK
[0m21:19:48.960789 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:48.961349 [debug] [MainThread]: On master: BEGIN
[0m21:19:49.484203 [debug] [MainThread]: SQL status: BEGIN in 0.522 seconds
[0m21:19:49.485287 [debug] [MainThread]: On master: COMMIT
[0m21:19:49.485698 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:49.486075 [debug] [MainThread]: On master: COMMIT
[0m21:19:49.547446 [debug] [MainThread]: SQL status: COMMIT in 0.061 seconds
[0m21:19:49.548176 [debug] [MainThread]: On master: Close
[0m21:19:49.555116 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.scooters
[0m21:19:49.556045 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.scooters ............................................ [RUN]
[0m21:19:49.556652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.scooters)
[0m21:19:49.557076 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.scooters
[0m21:19:49.557479 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.scooters
[0m21:19:49.587284 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m21:19:49.587648 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: BEGIN
[0m21:19:49.587876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:50.364149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.776 seconds
[0m21:19:50.364998 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m21:19:50.366090 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_ohwk"."dbt"."scooters"
[0m21:19:50.435324 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.068 seconds
[0m21:19:50.462373 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m21:19:50.462792 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_ohwk"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m21:19:50.526702 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.063 seconds
[0m21:19:50.535335 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m21:19:50.550161 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m21:19:50.550520 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m21:19:50.550771 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m21:19:50.614737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.063 seconds
[0m21:19:50.617861 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: Close
[0m21:19:50.621450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '317adf4f-b077-4403-a16d-12ddff316202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1cf7d0>]}
[0m21:19:50.622143 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt.scooters ........................................ [[32mINSERT 10[0m in 1.06s]
[0m21:19:50.622723 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.scooters
[0m21:19:50.624148 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:50.624548 [debug] [MainThread]: On master: BEGIN
[0m21:19:50.624851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:19:51.431677 [debug] [MainThread]: SQL status: BEGIN in 0.807 seconds
[0m21:19:51.432638 [debug] [MainThread]: On master: COMMIT
[0m21:19:51.433481 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:51.434400 [debug] [MainThread]: On master: COMMIT
[0m21:19:51.483003 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m21:19:51.484323 [debug] [MainThread]: On master: Close
[0m21:19:51.485803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:51.486328 [debug] [MainThread]: Connection 'seed.dbt_scooters.scooters' was properly closed.
[0m21:19:51.486813 [info ] [MainThread]: 
[0m21:19:51.487300 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 7.91 seconds (7.91s).
[0m21:19:51.488423 [debug] [MainThread]: Command end result
[0m21:19:51.517087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:19:51.518588 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:19:51.523057 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:19:51.523238 [info ] [MainThread]: 
[0m21:19:51.523453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:51.523608 [info ] [MainThread]: 
[0m21:19:51.523785 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:19:51.525162 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.225017, "process_in_blocks": "0", "process_kernel_time": 0.151458, "process_mem_max_rss": "136085504", "process_out_blocks": "0", "process_user_time": 0.936847}
[0m21:19:51.525425 [debug] [MainThread]: Command `dbt seed` succeeded at 21:19:51.525374 after 8.23 seconds
[0m21:19:51.525640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3dc3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c176b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ef390>]}
[0m21:19:51.525837 [debug] [MainThread]: Flushing usage events
[0m21:19:52.303854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:20.824520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ff620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d27b10>]}


============================== 21:27:20.826512 | 1330b93b-81ed-4f10-bba7-15213b4e6e7e ==============================
[0m21:27:20.826512 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:27:20.826787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m21:27:20.891108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1330b93b-81ed-4f10-bba7-15213b4e6e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2f490>]}
[0m21:27:20.912137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1330b93b-81ed-4f10-bba7-15213b4e6e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bbebe0>]}
[0m21:27:20.912539 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:27:20.950260 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:27:20.987854 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:27:20.988098 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m21:27:20.988253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1330b93b-81ed-4f10-bba7-15213b4e6e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110be0250>]}
[0m21:27:21.465935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1330b93b-81ed-4f10-bba7-15213b4e6e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108f6030>]}
[0m21:27:21.500807 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:27:21.502018 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:27:21.514876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1330b93b-81ed-4f10-bba7-15213b4e6e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11105a350>]}
[0m21:27:21.515114 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:27:21.515878 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:27:21.516138 [debug] [MainThread]: Command end result
[0m21:27:21.526195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:27:21.527064 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:27:21.528468 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:27:21.529552 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7334606, "process_in_blocks": "0", "process_kernel_time": 0.101276, "process_mem_max_rss": "129826816", "process_out_blocks": "0", "process_user_time": 1.176559}
[0m21:27:21.529747 [debug] [MainThread]: Command `cli build` succeeded at 21:27:21.529703 after 0.73 seconds
[0m21:27:21.529976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110d7d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dc8650>]}
[0m21:27:21.530191 [debug] [MainThread]: Flushing usage events
[0m21:27:22.235562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:30.325800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107433620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894bb10>]}


============================== 21:27:30.327675 | 6b8fb0ff-302d-4426-b204-e4104d40472c ==============================
[0m21:27:30.327675 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:27:30.327974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:27:30.390630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b8fb0ff-302d-4426-b204-e4104d40472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c53490>]}
[0m21:27:30.411531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b8fb0ff-302d-4426-b204-e4104d40472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e2be0>]}
[0m21:27:30.411910 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:27:30.450283 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:27:30.488745 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:27:30.488984 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m21:27:30.489133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b8fb0ff-302d-4426-b204-e4104d40472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097b0250>]}
[0m21:27:30.984331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b8fb0ff-302d-4426-b204-e4104d40472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ba030>]}
[0m21:27:31.016812 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:27:31.017728 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:27:31.028943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b8fb0ff-302d-4426-b204-e4104d40472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b62270>]}
[0m21:27:31.029171 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:27:31.029936 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:27:31.030223 [debug] [MainThread]: Command end result
[0m21:27:31.040194 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:27:31.041012 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:27:31.042340 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:27:31.043005 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7434084, "process_in_blocks": "0", "process_kernel_time": 0.091336, "process_mem_max_rss": "129105920", "process_out_blocks": "0", "process_user_time": 1.189786}
[0m21:27:31.043187 [debug] [MainThread]: Command `cli build` succeeded at 21:27:31.043151 after 0.74 seconds
[0m21:27:31.043327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ba3d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108830dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aac650>]}
[0m21:27:31.043452 [debug] [MainThread]: Flushing usage events
[0m21:27:32.205697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:39.058300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ff620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112127b10>]}


============================== 21:27:39.060141 | c901338c-94f5-4c7c-87a9-58df7be52e58 ==============================
[0m21:27:39.060141 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:27:39.060391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m21:27:39.123273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c901338c-94f5-4c7c-87a9-58df7be52e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11102f490>]}
[0m21:27:39.144157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c901338c-94f5-4c7c-87a9-58df7be52e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fbebe0>]}
[0m21:27:39.144551 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:27:39.179713 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:27:39.223798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:27:39.223985 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:27:39.241042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c901338c-94f5-4c7c-87a9-58df7be52e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11306f750>]}
[0m21:27:39.275098 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:27:39.276014 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:27:39.281964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c901338c-94f5-4c7c-87a9-58df7be52e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121a97c0>]}
[0m21:27:39.282161 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:27:39.282294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c901338c-94f5-4c7c-87a9-58df7be52e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112607d90>]}
[0m21:27:39.282924 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:27:39.283732 [debug] [MainThread]: Command end result
[0m21:27:39.293332 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:27:39.294110 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:27:39.295509 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:27:39.296286 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.26338124, "process_in_blocks": "0", "process_kernel_time": 0.085465, "process_mem_max_rss": "119685120", "process_out_blocks": "0", "process_user_time": 0.705375}
[0m21:27:39.296487 [debug] [MainThread]: Command `cli run` succeeded at 21:27:39.296445 after 0.26 seconds
[0m21:27:39.296640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121c18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112010dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11383dfd0>]}
[0m21:27:39.296774 [debug] [MainThread]: Flushing usage events
[0m21:27:40.328836 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:42.496925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10319f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104827b10>]}


============================== 21:28:42.498649 | 4bb506e1-3ae3-4bfc-9fa3-141d8bfd47f9 ==============================
[0m21:28:42.498649 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:28:42.498916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed -s age_grops', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:28:42.562524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bb506e1-3ae3-4bfc-9fa3-141d8bfd47f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103997490>]}
[0m21:28:42.583134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bb506e1-3ae3-4bfc-9fa3-141d8bfd47f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046be030>]}
[0m21:28:42.583467 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:28:42.617795 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:28:42.661032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:28:42.661204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:28:42.677935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bb506e1-3ae3-4bfc-9fa3-141d8bfd47f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105453150>]}
[0m21:28:42.711115 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:28:42.712009 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:28:42.717871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bb506e1-3ae3-4bfc-9fa3-141d8bfd47f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d54f0>]}
[0m21:28:42.718052 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:28:42.718190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bb506e1-3ae3-4bfc-9fa3-141d8bfd47f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cfbaf0>]}
[0m21:28:42.718472 [warn ] [MainThread]: The selection criterion 'age_grops' does not match any enabled nodes
[0m21:28:42.718978 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:28:42.719740 [debug] [MainThread]: Command end result
[0m21:28:42.729600 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:28:42.730747 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:28:42.732178 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:28:42.732298 [info ] [MainThread]: 
[0m21:28:42.732450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:28:42.732565 [info ] [MainThread]: 
[0m21:28:42.732680 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m21:28:42.733530 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.26134217, "process_in_blocks": "0", "process_kernel_time": 0.087367, "process_mem_max_rss": "119111680", "process_out_blocks": "0", "process_user_time": 0.705531}
[0m21:28:42.733714 [debug] [MainThread]: Command `dbt seed` succeeded at 21:28:42.733676 after 0.26 seconds
[0m21:28:42.733864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104704d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106025c10>]}
[0m21:28:42.733986 [debug] [MainThread]: Flushing usage events
[0m21:28:43.418613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:30:12.125593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5bb10>]}


============================== 21:30:12.127302 | 0f3f6b68-cb19-45da-aac9-ea4527bd11c3 ==============================
[0m21:30:12.127302 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:30:12.127558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed -s age_groups', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:30:12.192824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405b490>]}
[0m21:30:12.214333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf2030>]}
[0m21:30:12.214679 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:30:12.249279 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:30:12.294832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:30:12.295005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:30:12.312366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059db150>]}
[0m21:30:12.347051 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:30:12.347977 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:30:12.354292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab54f0>]}
[0m21:30:12.354484 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:30:12.354626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105283af0>]}
[0m21:30:12.355287 [info ] [MainThread]: 
[0m21:30:12.355426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:30:12.355536 [info ] [MainThread]: 
[0m21:30:12.355736 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:12.356098 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:30:12.375173 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:30:12.375366 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:30:12.375480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:13.125182 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.749 seconds
[0m21:30:13.128884 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:30:13.136920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:30:13.142861 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:30:13.143199 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:30:13.143440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:13.778765 [debug] [ThreadPool]: SQL status: BEGIN in 0.635 seconds
[0m21:30:13.779401 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:30:13.779743 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:30:13.830061 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.050 seconds
[0m21:30:13.833829 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:30:13.880506 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:30:13.894323 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:13.894879 [debug] [MainThread]: On master: BEGIN
[0m21:30:13.895253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:14.571458 [debug] [MainThread]: SQL status: BEGIN in 0.676 seconds
[0m21:30:14.572203 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:14.572668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:14.623018 [debug] [MainThread]: SQL status: SELECT 7 in 0.050 seconds
[0m21:30:14.626947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e298b0>]}
[0m21:30:14.627846 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:14.672307 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:14.673536 [debug] [MainThread]: On master: BEGIN
[0m21:30:14.761376 [debug] [MainThread]: SQL status: BEGIN in 0.087 seconds
[0m21:30:14.762143 [debug] [MainThread]: On master: COMMIT
[0m21:30:14.762486 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:14.762763 [debug] [MainThread]: On master: COMMIT
[0m21:30:14.809324 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m21:30:14.810623 [debug] [MainThread]: On master: Close
[0m21:30:14.818641 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.age_groups
[0m21:30:14.819611 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.age_groups .......................................... [RUN]
[0m21:30:14.820250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.age_groups)
[0m21:30:14.820694 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.age_groups
[0m21:30:14.821075 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.age_groups
[0m21:30:14.847929 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:30:14.848245 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m21:30:14.848449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:15.783586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.934 seconds
[0m21:30:15.785317 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:30:15.786297 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    create table "dev_ohwk"."dbt"."age_groups" ("group" text,"age_start" integer,"age_end" integer)
  
[0m21:30:15.888774 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.101 seconds
[0m21:30:15.914126 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:30:15.914672 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_ohwk"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m21:30:15.969710 [debug] [Thread-1 (]: SQL status: INSERT 0 8 in 0.054 seconds
[0m21:30:15.978740 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m21:30:15.995470 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:30:15.995753 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:30:15.995963 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:30:16.084128 [debug] [Thread-1 (]: SQL status: COMMIT in 0.088 seconds
[0m21:30:16.087964 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: Close
[0m21:30:16.092320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3f6b68-cb19-45da-aac9-ea4527bd11c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c07f50>]}
[0m21:30:16.093176 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt.age_groups ...................................... [[32mINSERT 8[0m in 1.27s]
[0m21:30:16.093878 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.age_groups
[0m21:30:16.095728 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:16.096253 [debug] [MainThread]: On master: BEGIN
[0m21:30:16.096583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:16.808488 [debug] [MainThread]: SQL status: BEGIN in 0.712 seconds
[0m21:30:16.809337 [debug] [MainThread]: On master: COMMIT
[0m21:30:16.809884 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:16.810321 [debug] [MainThread]: On master: COMMIT
[0m21:30:16.864746 [debug] [MainThread]: SQL status: COMMIT in 0.054 seconds
[0m21:30:16.865504 [debug] [MainThread]: On master: Close
[0m21:30:16.866928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:16.867378 [debug] [MainThread]: Connection 'seed.dbt_scooters.age_groups' was properly closed.
[0m21:30:16.867801 [info ] [MainThread]: 
[0m21:30:16.868324 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m21:30:16.869614 [debug] [MainThread]: Command end result
[0m21:30:16.900225 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:30:16.901611 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:30:16.905411 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:30:16.905612 [info ] [MainThread]: 
[0m21:30:16.905834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:30:16.905993 [info ] [MainThread]: 
[0m21:30:16.906163 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:30:16.907303 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.80745, "process_in_blocks": "0", "process_kernel_time": 0.127498, "process_mem_max_rss": "136003584", "process_out_blocks": "0", "process_user_time": 0.92673}
[0m21:30:16.907546 [debug] [MainThread]: Command `dbt seed` succeeded at 21:30:16.907497 after 4.81 seconds
[0m21:30:16.907755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc79d0>]}
[0m21:30:16.907944 [debug] [MainThread]: Flushing usage events
[0m21:30:17.678422 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:31:03.014417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb3b10>]}


============================== 21:31:03.016303 | 067fc28f-c946-4227-8914-c4bb9fe2a8f5 ==============================
[0m21:31:03.016303 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:31:03.016595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:31:03.109535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '067fc28f-c946-4227-8914-c4bb9fe2a8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082bb490>]}
[0m21:31:03.130765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '067fc28f-c946-4227-8914-c4bb9fe2a8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e4abe0>]}
[0m21:31:03.131175 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:31:03.166379 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:31:03.203742 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:31:03.203977 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m21:31:03.204129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '067fc28f-c946-4227-8914-c4bb9fe2a8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e18250>]}
[0m21:31:03.690099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '067fc28f-c946-4227-8914-c4bb9fe2a8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d3e030>]}
[0m21:31:03.720756 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:31:03.721752 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:31:03.734734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '067fc28f-c946-4227-8914-c4bb9fe2a8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a192270>]}
[0m21:31:03.734966 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:31:03.735744 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:31:03.735980 [debug] [MainThread]: Command end result
[0m21:31:03.746242 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:31:03.747186 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:31:03.748659 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:31:03.749354 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7609447, "process_in_blocks": "0", "process_kernel_time": 0.093233, "process_mem_max_rss": "133201920", "process_out_blocks": "0", "process_user_time": 1.180793}
[0m21:31:03.749510 [debug] [MainThread]: Command `cli build` succeeded at 21:31:03.749477 after 0.76 seconds
[0m21:31:03.749638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a20fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e98dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a134650>]}
[0m21:31:03.749760 [debug] [MainThread]: Flushing usage events
[0m21:31:04.436042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:31:11.078544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bfb10>]}


============================== 21:31:11.080422 | f7e973e5-4725-40e8-a478-72042f728dd4 ==============================
[0m21:31:11.080422 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:31:11.080677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:31:11.144042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7e973e5-4725-40e8-a478-72042f728dd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c7490>]}
[0m21:31:11.165351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7e973e5-4725-40e8-a478-72042f728dd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106556be0>]}
[0m21:31:11.165737 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:31:11.201318 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:31:11.246997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:31:11.247178 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:31:11.264968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7e973e5-4725-40e8-a478-72042f728dd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d37750>]}
[0m21:31:11.300297 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:31:11.301273 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:31:11.307676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7e973e5-4725-40e8-a478-72042f728dd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067417c0>]}
[0m21:31:11.307908 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:31:11.308050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e973e5-4725-40e8-a478-72042f728dd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf3d90>]}
[0m21:31:11.308712 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:31:11.309520 [debug] [MainThread]: Command end result
[0m21:31:11.319764 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:31:11.320607 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:31:11.321961 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:31:11.322618 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.269466, "process_in_blocks": "0", "process_kernel_time": 0.086279, "process_mem_max_rss": "119881728", "process_out_blocks": "0", "process_user_time": 0.711774}
[0m21:31:11.322810 [debug] [MainThread]: Command `cli run` succeeded at 21:31:11.322772 after 0.27 seconds
[0m21:31:11.322959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067598b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107575fd0>]}
[0m21:31:11.323084 [debug] [MainThread]: Flushing usage events
[0m21:31:12.757777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:46.000951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac7b10>]}


============================== 21:32:46.002657 | b3c6c2d2-d5db-43e6-8958-9f6d0c5432bc ==============================
[0m21:32:46.002657 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:32:46.002918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:32:46.010288 [info ] [MainThread]: dbt version: 1.10.6
[0m21:32:46.010490 [info ] [MainThread]: python version: 3.13.5
[0m21:32:46.010608 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m21:32:46.010711 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit-Mach-O
[0m21:32:46.031680 [info ] [MainThread]: Using profiles dir at /Users/flerinvs/.dbt
[0m21:32:46.031928 [info ] [MainThread]: Using profiles.yml file at /Users/flerinvs/.dbt/profiles.yml
[0m21:32:46.032041 [info ] [MainThread]: Using dbt_project.yml file at /Users/flerinvs/dbt_scooters/dbt_project.yml
[0m21:32:46.032244 [info ] [MainThread]: adapter type: postgres
[0m21:32:46.032349 [info ] [MainThread]: adapter version: 1.9.0
[0m21:32:46.068922 [info ] [MainThread]: Configuration:
[0m21:32:46.069175 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:32:46.069302 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:32:46.069411 [info ] [MainThread]: Required dependencies:
[0m21:32:46.069566 [debug] [MainThread]: Executing "git --help"
[0m21:32:46.079308 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:32:46.079806 [debug] [MainThread]: STDERR: "b''"
[0m21:32:46.079938 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:32:46.080059 [info ] [MainThread]: Connection:
[0m21:32:46.080200 [info ] [MainThread]:   host: dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com
[0m21:32:46.080306 [info ] [MainThread]:   port: 5432
[0m21:32:46.080399 [info ] [MainThread]:   user: admin
[0m21:32:46.080497 [info ] [MainThread]:   database: dev_ohwk
[0m21:32:46.080589 [info ] [MainThread]:   schema: dbt
[0m21:32:46.080685 [info ] [MainThread]:   connect_timeout: 10
[0m21:32:46.080781 [info ] [MainThread]:   role: None
[0m21:32:46.080868 [info ] [MainThread]:   search_path: None
[0m21:32:46.080960 [info ] [MainThread]:   keepalives_idle: 0
[0m21:32:46.081053 [info ] [MainThread]:   sslmode: None
[0m21:32:46.081145 [info ] [MainThread]:   sslcert: None
[0m21:32:46.081236 [info ] [MainThread]:   sslkey: None
[0m21:32:46.081331 [info ] [MainThread]:   sslrootcert: None
[0m21:32:46.081429 [info ] [MainThread]:   application_name: dbt
[0m21:32:46.081527 [info ] [MainThread]:   retries: 1
[0m21:32:46.081783 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:32:46.113665 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:32:46.127357 [debug] [MainThread]: Using postgres connection "debug"
[0m21:32:46.127534 [debug] [MainThread]: On debug: select 1 as id
[0m21:32:46.127640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:48.047912 [debug] [MainThread]: SQL status: SELECT 1 in 1.920 seconds
[0m21:32:48.050140 [debug] [MainThread]: On debug: Close
[0m21:32:48.051245 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:32:48.051901 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:32:48.055045 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.0785975, "process_in_blocks": "0", "process_kernel_time": 0.098027, "process_mem_max_rss": "128761856", "process_out_blocks": "0", "process_user_time": 0.608003}
[0m21:32:48.056102 [debug] [MainThread]: Command `dbt debug` succeeded at 21:32:48.055898 after 2.08 seconds
[0m21:32:48.056660 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:32:48.057105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107181ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107131eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba08d0>]}
[0m21:32:48.057835 [debug] [MainThread]: Flushing usage events
[0m21:32:48.856653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:49.572258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbfb10>]}


============================== 21:32:49.574055 | f0779d3a-6132-47ea-a19e-fc92d54164ea ==============================
[0m21:32:49.574055 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:32:49.574308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -s age_groups+', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:32:49.637446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042bf490>]}
[0m21:32:49.657993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e56030>]}
[0m21:32:49.658340 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:32:49.691279 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:32:49.727330 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:32:49.727555 [debug] [MainThread]: previous checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, current checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7
[0m21:32:49.727690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3fe50>]}
[0m21:32:50.210444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d488c0>]}
[0m21:32:50.241103 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:32:50.241912 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:32:50.252788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061da270>]}
[0m21:32:50.252992 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:32:50.253799 [info ] [MainThread]: 
[0m21:32:50.253938 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:32:50.254045 [info ] [MainThread]: 
[0m21:32:50.254231 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:32:50.254562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:32:50.271320 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:32:50.271528 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:32:50.271639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:50.897280 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.625 seconds
[0m21:32:50.901117 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:32:50.909230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:32:50.915956 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:32:50.916419 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:32:50.916669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:51.802617 [debug] [ThreadPool]: SQL status: BEGIN in 0.886 seconds
[0m21:32:51.804123 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:32:51.804620 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:32:51.878947 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.074 seconds
[0m21:32:51.881700 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:32:51.945928 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:32:51.959668 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:51.960246 [debug] [MainThread]: On master: BEGIN
[0m21:32:51.960542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:52.800453 [debug] [MainThread]: SQL status: BEGIN in 0.840 seconds
[0m21:32:52.801788 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:52.803235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:32:52.870276 [debug] [MainThread]: SQL status: SELECT 7 in 0.066 seconds
[0m21:32:52.875664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064325b0>]}
[0m21:32:52.876782 [debug] [MainThread]: On master: ROLLBACK
[0m21:32:52.944144 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:52.945360 [debug] [MainThread]: On master: BEGIN
[0m21:32:53.081086 [debug] [MainThread]: SQL status: BEGIN in 0.135 seconds
[0m21:32:53.082583 [debug] [MainThread]: On master: COMMIT
[0m21:32:53.083417 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:53.083822 [debug] [MainThread]: On master: COMMIT
[0m21:32:53.126652 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m21:32:53.127440 [debug] [MainThread]: On master: Close
[0m21:32:53.135656 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.age_groups
[0m21:32:53.136650 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.age_groups .......................................... [RUN]
[0m21:32:53.137429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.age_groups)
[0m21:32:53.137926 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.age_groups
[0m21:32:53.138365 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.age_groups
[0m21:32:53.166406 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:32:53.166710 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m21:32:53.166916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:53.878823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.711 seconds
[0m21:32:53.879965 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:32:53.880479 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_ohwk"."dbt"."age_groups"
[0m21:32:53.931705 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.050 seconds
[0m21:32:53.957324 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:32:53.957745 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_ohwk"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m21:32:54.006429 [debug] [Thread-1 (]: SQL status: INSERT 0 8 in 0.048 seconds
[0m21:32:54.015216 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m21:32:54.028381 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:32:54.028695 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:32:54.028939 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:32:54.076656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.047 seconds
[0m21:32:54.079864 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: Close
[0m21:32:54.082709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0779d3a-6132-47ea-a19e-fc92d54164ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fa990>]}
[0m21:32:54.083330 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt.age_groups ...................................... [[32mINSERT 8[0m in 0.94s]
[0m21:32:54.083901 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.age_groups
[0m21:32:54.085133 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:54.085395 [debug] [MainThread]: On master: BEGIN
[0m21:32:54.085612 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:56.518259 [debug] [MainThread]: SQL status: BEGIN in 2.432 seconds
[0m21:32:56.519818 [debug] [MainThread]: On master: COMMIT
[0m21:32:56.520684 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:56.521070 [debug] [MainThread]: On master: COMMIT
[0m21:32:56.583809 [debug] [MainThread]: SQL status: COMMIT in 0.062 seconds
[0m21:32:56.584664 [debug] [MainThread]: On master: Close
[0m21:32:56.585894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:56.586304 [debug] [MainThread]: Connection 'seed.dbt_scooters.age_groups' was properly closed.
[0m21:32:56.587026 [info ] [MainThread]: 
[0m21:32:56.587850 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.33 seconds (6.33s).
[0m21:32:56.588980 [debug] [MainThread]: Command end result
[0m21:32:56.619121 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:32:56.620667 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:32:56.624704 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:32:56.624907 [info ] [MainThread]: 
[0m21:32:56.625142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:32:56.625300 [info ] [MainThread]: 
[0m21:32:56.625491 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:32:56.626595 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.0799794, "process_in_blocks": "0", "process_kernel_time": 0.121994, "process_mem_max_rss": "145719296", "process_out_blocks": "0", "process_user_time": 1.383364}
[0m21:32:56.626858 [debug] [MainThread]: Command `dbt build` succeeded at 21:32:56.626804 after 7.08 seconds
[0m21:32:56.627072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106220aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660edf0>]}
[0m21:32:56.627272 [debug] [MainThread]: Flushing usage events
[0m21:32:57.221238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:33:01.117030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a8f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f879d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f87b10>]}


============================== 21:33:01.118740 | b68c5be0-6e16-451e-a289-d4ba7b5e28c3 ==============================
[0m21:33:01.118740 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:33:01.119012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -s age_groups+', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:33:01.197874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b68c5be0-6e16-451e-a289-d4ba7b5e28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104287490>]}
[0m21:33:01.219674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b68c5be0-6e16-451e-a289-d4ba7b5e28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e1e030>]}
[0m21:33:01.220009 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:33:01.254628 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:33:01.300040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:33:01.300225 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:33:01.317599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b68c5be0-6e16-451e-a289-d4ba7b5e28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c07450>]}
[0m21:33:01.352047 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:33:01.352929 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:33:01.363792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b68c5be0-6e16-451e-a289-d4ba7b5e28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7de50>]}
[0m21:33:01.364007 [info ] [MainThread]: Found 16 models, 3 seeds, 16 sources, 434 macros
[0m21:33:01.364821 [info ] [MainThread]: 
[0m21:33:01.364970 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:01.365078 [info ] [MainThread]: 
[0m21:33:01.365280 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:33:01.365634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:33:01.382956 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:33:01.383147 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:33:01.383255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:02.006004 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.622 seconds
[0m21:33:02.010149 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:33:02.019198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:33:02.026004 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:33:02.026403 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:33:02.026648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:02.640842 [debug] [ThreadPool]: SQL status: BEGIN in 0.614 seconds
[0m21:33:02.641848 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:33:02.642476 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:33:02.690490 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.047 seconds
[0m21:33:02.693903 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:33:02.737736 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:33:02.750795 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:02.751320 [debug] [MainThread]: On master: BEGIN
[0m21:33:02.751711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:04.255721 [debug] [MainThread]: SQL status: BEGIN in 1.504 seconds
[0m21:33:04.256593 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:04.257269 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:33:04.353818 [debug] [MainThread]: SQL status: SELECT 7 in 0.096 seconds
[0m21:33:04.358220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b68c5be0-6e16-451e-a289-d4ba7b5e28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e97e70>]}
[0m21:33:04.359022 [debug] [MainThread]: On master: ROLLBACK
[0m21:33:04.424079 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:04.424399 [debug] [MainThread]: On master: BEGIN
[0m21:33:04.562762 [debug] [MainThread]: SQL status: BEGIN in 0.138 seconds
[0m21:33:04.563456 [debug] [MainThread]: On master: COMMIT
[0m21:33:04.564127 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:04.564774 [debug] [MainThread]: On master: COMMIT
[0m21:33:04.629836 [debug] [MainThread]: SQL status: COMMIT in 0.064 seconds
[0m21:33:04.630832 [debug] [MainThread]: On master: Close
[0m21:33:04.638239 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.age_groups
[0m21:33:04.639200 [info ] [Thread-1 (]: 1 of 1 START seed file dbt.age_groups .......................................... [RUN]
[0m21:33:04.639886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now seed.dbt_scooters.age_groups)
[0m21:33:04.640318 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.age_groups
[0m21:33:04.640734 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.age_groups
[0m21:33:04.669936 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:33:04.670283 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m21:33:04.670473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:05.432976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.762 seconds
[0m21:33:05.434230 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:33:05.435367 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_ohwk"."dbt"."age_groups"
[0m21:33:05.511276 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.075 seconds
[0m21:33:05.533908 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:33:05.534403 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_ohwk"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m21:33:05.601162 [debug] [Thread-1 (]: SQL status: INSERT 0 8 in 0.066 seconds
[0m21:33:05.609617 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m21:33:05.622751 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:33:05.623081 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:33:05.623330 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:33:05.691801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.068 seconds
[0m21:33:05.695212 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: Close
[0m21:33:05.698687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b68c5be0-6e16-451e-a289-d4ba7b5e28c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ea680>]}
[0m21:33:05.699339 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt.age_groups ...................................... [[32mINSERT 8[0m in 1.06s]
[0m21:33:05.699936 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.age_groups
[0m21:33:05.701390 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:05.701694 [debug] [MainThread]: On master: BEGIN
[0m21:33:05.701946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:33:07.299579 [debug] [MainThread]: SQL status: BEGIN in 1.597 seconds
[0m21:33:07.300487 [debug] [MainThread]: On master: COMMIT
[0m21:33:07.300980 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:07.301380 [debug] [MainThread]: On master: COMMIT
[0m21:33:07.368236 [debug] [MainThread]: SQL status: COMMIT in 0.066 seconds
[0m21:33:07.369593 [debug] [MainThread]: On master: Close
[0m21:33:07.370935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:07.371229 [debug] [MainThread]: Connection 'seed.dbt_scooters.age_groups' was properly closed.
[0m21:33:07.371689 [info ] [MainThread]: 
[0m21:33:07.372146 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.01 seconds (6.01s).
[0m21:33:07.373159 [debug] [MainThread]: Command end result
[0m21:33:07.434422 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:33:07.435506 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:33:07.438434 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:33:07.438572 [info ] [MainThread]: 
[0m21:33:07.438747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:33:07.438863 [info ] [MainThread]: 
[0m21:33:07.438994 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:33:07.439836 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.347812, "process_in_blocks": "0", "process_kernel_time": 0.121323, "process_mem_max_rss": "136626176", "process_out_blocks": "0", "process_user_time": 0.956909}
[0m21:33:07.440036 [debug] [MainThread]: Command `dbt build` succeeded at 21:33:07.439993 after 6.35 seconds
[0m21:33:07.440197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e64d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3b540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3ac50>]}
[0m21:33:07.440359 [debug] [MainThread]: Flushing usage events
[0m21:33:08.292674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:47.311376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1fb10>]}


============================== 15:42:47.313465 | c861ae9f-6ff5-4eaa-833f-226947a8a424 ==============================
[0m15:42:47.313465 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:42:47.313724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:42:47.358655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c861ae9f-6ff5-4eaa-833f-226947a8a424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2b490>]}
[0m15:42:47.364600 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:42:47.365182 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:42:47.395400 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11549904, "process_in_blocks": "0", "process_kernel_time": 0.067118, "process_mem_max_rss": "111460352", "process_out_blocks": "0", "process_user_time": 0.54846}
[0m15:42:47.395648 [debug] [MainThread]: Command `cli deps` succeeded at 15:42:47.395600 after 0.12 seconds
[0m15:42:47.395808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abd8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abe360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa3450>]}
[0m15:42:47.395954 [debug] [MainThread]: Flushing usage events
[0m15:42:48.054322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:58.383990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ccf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113027b10>]}


============================== 16:08:58.385987 | d6522f68-8fb0-489c-a22d-a6abb85e5f46 ==============================
[0m16:08:58.385987 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:08:58.386265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:08:58.454480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111727490>]}
[0m16:08:58.476326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ebe030>]}
[0m16:08:58.476673 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:08:58.514602 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:08:58.559791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:58.559979 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:58.577164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dfb450>]}
[0m16:08:58.611459 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:08:58.612520 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:08:58.618856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130a59a0>]}
[0m16:08:58.619073 [info ] [MainThread]: Found 17 models, 3 seeds, 16 sources, 435 macros
[0m16:08:58.619217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134af5b0>]}
[0m16:08:58.620199 [info ] [MainThread]: 
[0m16:08:58.620349 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:08:58.620464 [info ] [MainThread]: 
[0m16:08:58.620665 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:08:58.622406 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:08:58.640298 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:08:58.640499 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:08:58.640610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:00.389166 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.748 seconds
[0m16:09:00.391868 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:09:00.394542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:09:00.400296 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:09:00.400638 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:09:00.400884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:01.331726 [debug] [ThreadPool]: SQL status: BEGIN in 0.931 seconds
[0m16:09:01.332242 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:09:01.332615 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:09:01.388330 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.055 seconds
[0m16:09:01.390424 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:09:01.437106 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:09:01.448925 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:01.449405 [debug] [MainThread]: On master: BEGIN
[0m16:09:01.449796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:02.151729 [debug] [MainThread]: SQL status: BEGIN in 0.702 seconds
[0m16:09:02.153125 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:02.154308 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:02.217990 [debug] [MainThread]: SQL status: SELECT 7 in 0.063 seconds
[0m16:09:02.220812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114251a50>]}
[0m16:09:02.221362 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:02.272905 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:02.273420 [debug] [MainThread]: On master: BEGIN
[0m16:09:02.371739 [debug] [MainThread]: SQL status: BEGIN in 0.098 seconds
[0m16:09:02.372224 [debug] [MainThread]: On master: COMMIT
[0m16:09:02.372562 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:02.372865 [debug] [MainThread]: On master: COMMIT
[0m16:09:02.421525 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m16:09:02.421902 [debug] [MainThread]: On master: Close
[0m16:09:02.430062 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m16:09:02.430880 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m16:09:02.431533 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m16:09:02.432158 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_clean
[0m16:09:02.433032 [info ] [Thread-3 (]: 3 of 17 START sql incremental model dbt.trips_concurrency ...................... [RUN]
[0m16:09:02.433641 [info ] [Thread-1 (]: 1 of 17 START sql view model dbt.companies ..................................... [RUN]
[0m16:09:02.434203 [info ] [Thread-4 (]: 4 of 17 START sql view model dbt.trips_geom .................................... [RUN]
[0m16:09:02.434751 [info ] [Thread-2 (]: 2 of 17 START sql incremental model dbt.events_clean ........................... [RUN]
[0m16:09:02.435516 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m16:09:02.436000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.companies)
[0m16:09:02.436525 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m16:09:02.436938 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean'
[0m16:09:02.437283 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m16:09:02.437607 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m16:09:02.437904 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m16:09:02.438208 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_clean
[0m16:09:02.454485 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m16:09:02.461864 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m16:09:02.464613 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m16:09:02.467073 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m16:09:02.468508 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m16:09:02.468768 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m16:09:02.469067 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m16:09:02.469577 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_clean
[0m16:09:02.504192 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m16:09:02.506966 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:02.508197 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m16:09:02.509622 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:02.509868 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp160902492534"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency
from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m16:09:02.510134 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp160902509075"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id
from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m16:09:02.510345 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:09:02.510511 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:09:02.510777 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:09:02.510993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:09:02.511168 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m16:09:02.511304 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m16:09:02.511430 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:09:02.511548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:03.716311 [debug] [Thread-4 (]: SQL status: BEGIN in 1.205 seconds
[0m16:09:03.717160 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:09:03.717666 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_ohwk"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_ohwk"."scooters_raw"."trips"
  );
[0m16:09:03.811653 [debug] [Thread-1 (]: SQL status: BEGIN in 1.300 seconds
[0m16:09:03.812687 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:09:03.813122 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  create view "dev_ohwk"."dbt"."companies__dbt_tmp"
    
    
  as (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_ohwk"."dbt"."scooters"
group by
    1
  );
[0m16:09:04.005835 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.192 seconds
[0m16:09:04.006680 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.289 seconds
[0m16:09:04.017787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:09:04.027946 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:09:04.028510 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies" rename to "companies__dbt_backup"
[0m16:09:04.028870 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m16:09:04.100308 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.071 seconds
[0m16:09:04.101118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.072 seconds
[0m16:09:04.105706 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:09:04.108777 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:09:04.109270 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m16:09:04.109728 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies__dbt_tmp" rename to "companies"
[0m16:09:04.203902 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m16:09:04.204625 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m16:09:04.255276 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m16:09:04.256031 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m16:09:04.256249 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:09:04.256405 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:09:04.256552 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m16:09:04.256695 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m16:09:04.404769 [debug] [Thread-4 (]: SQL status: COMMIT in 0.148 seconds
[0m16:09:04.405561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.149 seconds
[0m16:09:04.414390 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_geom__dbt_backup"
[0m16:09:04.416851 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."companies__dbt_backup"
[0m16:09:04.421530 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:09:04.423516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:09:04.423819 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop table if exists "dev_ohwk"."dbt"."trips_geom__dbt_backup" cascade
[0m16:09:04.424092 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop view if exists "dev_ohwk"."dbt"."companies__dbt_backup" cascade
[0m16:09:04.608072 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.183 seconds
[0m16:09:04.614075 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m16:09:04.618719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a8ca10>]}
[0m16:09:04.619639 [info ] [Thread-1 (]: 1 of 17 OK created sql view model dbt.companies ................................ [[32mCREATE VIEW[0m in 2.18s]
[0m16:09:04.620360 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m16:09:04.620830 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m16:09:04.621429 [info ] [Thread-1 (]: 5 of 17 START sql view model dbt.trips_prep .................................... [RUN]
[0m16:09:04.621979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.trips_prep)
[0m16:09:04.622368 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m16:09:04.625951 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m16:09:04.627256 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m16:09:04.631418 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m16:09:04.632432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:09:04.632742 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m16:09:04.633024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:04.690739 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.266 seconds
[0m16:09:04.692513 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: Close
[0m16:09:04.693339 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fff8b0>]}
[0m16:09:04.694022 [info ] [Thread-4 (]: 4 of 17 OK created sql view model dbt.trips_geom ............................... [[32mCREATE VIEW[0m in 2.26s]
[0m16:09:04.694611 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m16:09:04.695014 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m16:09:04.695606 [info ] [Thread-4 (]: 6 of 17 START sql view model dbt.trips_stat_daily .............................. [RUN]
[0m16:09:04.696177 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.trips_stat_daily)
[0m16:09:04.696560 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m16:09:04.698118 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m16:09:04.698739 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m16:09:04.701282 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m16:09:04.701827 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:09:04.702114 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m16:09:04.702379 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:05.285170 [debug] [Thread-2 (]: SQL status: SELECT 0 in 2.774 seconds
[0m16:09:05.307161 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:05.307745 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: BEGIN
[0m16:09:05.386647 [debug] [Thread-2 (]: SQL status: BEGIN in 0.078 seconds
[0m16:09:05.387536 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:05.388330 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp160902509075'
        
      order by ordinal_position

  
[0m16:09:05.685332 [debug] [Thread-1 (]: SQL status: BEGIN in 1.052 seconds
[0m16:09:05.687064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:09:05.687859 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_ohwk"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  );
[0m16:09:05.691094 [debug] [Thread-4 (]: SQL status: BEGIN in 0.989 seconds
[0m16:09:05.691595 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:09:05.692011 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  create view "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp"
    
    
  as (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
[0m16:09:05.889186 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.500 seconds
[0m16:09:05.894982 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:05.895440 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.203 seconds
[0m16:09:05.895836 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:09:05.898785 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:09:05.899290 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m16:09:05.984215 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.295 seconds
[0m16:09:05.991424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:09:05.992060 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m16:09:05.992743 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m16:09:05.995912 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:09:05.996448 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m16:09:06.086789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m16:09:06.088407 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m16:09:06.093541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:09:06.095177 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m16:09:06.095620 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m16:09:06.096023 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:09:06.096484 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m16:09:06.183420 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.284 seconds
[0m16:09:06.184265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m16:09:06.191059 [debug] [Thread-4 (]: SQL status: COMMIT in 0.094 seconds
[0m16:09:06.194848 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:06.196393 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m16:09:06.199033 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup"
[0m16:09:06.199467 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:09:06.199867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:09:06.200424 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:09:06.200884 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m16:09:06.201282 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m16:09:06.290512 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.089 seconds
[0m16:09:06.292189 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.090 seconds
[0m16:09:06.293462 [debug] [Thread-1 (]: SQL status: COMMIT in 0.092 seconds
[0m16:09:06.308472 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m16:09:06.310829 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m16:09:06.312989 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_prep__dbt_backup"
[0m16:09:06.313680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:09:06.314174 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b07570>]}
[0m16:09:06.314524 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_ohwk"."dbt"."trips_prep__dbt_backup" cascade
[0m16:09:06.315145 [info ] [Thread-4 (]: 6 of 17 OK created sql view model dbt.trips_stat_daily ......................... [[32mCREATE VIEW[0m in 1.62s]
[0m16:09:06.315870 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m16:09:06.316271 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:06.316619 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m16:09:06.317014 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id")
    (
        select "user_id", "timestamp", "type_id"
        from "events_clean__dbt_tmp160902509075"
    )


  
[0m16:09:06.317412 [info ] [Thread-4 (]: 7 of 17 START sql view model dbt.parking_finish_stat ........................... [RUN]
[0m16:09:06.317824 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.parking_finish_stat)
[0m16:09:06.318147 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m16:09:06.320210 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m16:09:06.321509 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m16:09:06.324274 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m16:09:06.325132 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:09:06.325376 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m16:09:06.325576 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:06.387762 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.070 seconds
[0m16:09:06.389246 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m16:09:06.389687 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.074 seconds
[0m16:09:06.390132 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:09:06.391598 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m16:09:06.391989 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m16:09:06.392728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142c1d50>]}
[0m16:09:06.393312 [info ] [Thread-1 (]: 5 of 17 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 1.77s]
[0m16:09:06.393808 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m16:09:06.394155 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m16:09:06.394630 [info ] [Thread-1 (]: 8 of 17 START sql view model dbt.parking_start_stat ............................ [RUN]
[0m16:09:06.395120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_start_stat)
[0m16:09:06.395461 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m16:09:06.397847 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m16:09:06.398529 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m16:09:06.401137 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m16:09:06.401601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:09:06.401840 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m16:09:06.402064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:06.484956 [debug] [Thread-2 (]: SQL status: COMMIT in 0.092 seconds
[0m16:09:06.486323 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: Close
[0m16:09:06.487330 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114343b60>]}
[0m16:09:06.488135 [info ] [Thread-2 (]: 2 of 17 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 4.05s]
[0m16:09:06.488695 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_clean
[0m16:09:06.489086 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies_trips
[0m16:09:06.489594 [info ] [Thread-2 (]: 9 of 17 START sql view model dbt.companies_trips ............................... [RUN]
[0m16:09:06.490134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.companies_trips)
[0m16:09:06.490497 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies_trips
[0m16:09:06.494553 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m16:09:06.495731 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies_trips
[0m16:09:06.499061 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m16:09:06.499755 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:09:06.500048 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m16:09:06.500320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:06.693688 [debug] [Thread-3 (]: SQL status: SELECT 0 in 4.183 seconds
[0m16:09:06.700020 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:06.700890 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m16:09:06.745221 [debug] [Thread-3 (]: SQL status: BEGIN in 0.043 seconds
[0m16:09:06.746568 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:06.747193 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp160902492534'
        
      order by ordinal_position

  
[0m16:09:06.810195 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.062 seconds
[0m16:09:06.811900 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:06.812120 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:09:06.885422 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.073 seconds
[0m16:09:06.888787 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:06.889120 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:09:06.935166 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.045 seconds
[0m16:09:06.938350 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m16:09:06.939806 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:06.940440 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency")
    (
        select "timestamp", "concurrency"
        from "trips_concurrency__dbt_tmp160902492534"
    )


  
[0m16:09:06.984617 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.044 seconds
[0m16:09:06.987573 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m16:09:06.988325 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:09:06.988838 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m16:09:07.270672 [debug] [Thread-3 (]: SQL status: COMMIT in 0.281 seconds
[0m16:09:07.272320 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m16:09:07.273739 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143d5cd0>]}
[0m16:09:07.274675 [info ] [Thread-3 (]: 3 of 17 OK created sql incremental model dbt.trips_concurrency ................. [[32mINSERT 0 0[0m in 4.84s]
[0m16:09:07.275356 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m16:09:07.275819 [debug] [Thread-3 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:09:07.276404 [info ] [Thread-3 (]: 10 of 17 START sql view model dbt.revenue_daily ................................ [RUN]
[0m16:09:07.277111 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.revenue_daily)
[0m16:09:07.277532 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:09:07.281312 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:09:07.282724 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:09:07.287110 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:09:07.288520 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:09:07.289105 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:09:07.289481 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:07.383255 [debug] [Thread-4 (]: SQL status: BEGIN in 1.058 seconds
[0m16:09:07.383787 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:09:07.384159 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  create view "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp"
    
    
  as (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
where
    st_intersects(st_transform(t.finish_point, 3857), hex.geom)
group by
    1
  );
[0m16:09:07.454840 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.070 seconds
[0m16:09:07.460419 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:09:07.461437 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m16:09:07.479821 [debug] [Thread-2 (]: SQL status: BEGIN in 0.979 seconds
[0m16:09:07.480500 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:09:07.480987 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  create view "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
    
    
  as (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
[0m16:09:07.531379 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.069 seconds
[0m16:09:07.534673 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:09:07.535064 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m16:09:07.548932 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.067 seconds
[0m16:09:07.557598 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:09:07.558127 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m16:09:07.603544 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m16:09:07.605767 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m16:09:07.606377 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:09:07.606807 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m16:09:07.627175 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.069 seconds
[0m16:09:07.628709 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m16:09:07.629127 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:09:07.629502 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m16:09:07.719503 [debug] [Thread-2 (]: SQL status: COMMIT in 0.089 seconds
[0m16:09:07.720423 [debug] [Thread-4 (]: SQL status: COMMIT in 0.113 seconds
[0m16:09:07.723735 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m16:09:07.726975 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup"
[0m16:09:07.727770 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:09:07.728404 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:09:07.728880 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop view if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m16:09:07.729336 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m16:09:07.791055 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.061 seconds
[0m16:09:07.791831 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.062 seconds
[0m16:09:07.793991 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: Close
[0m16:09:07.795839 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m16:09:07.797186 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143d75f0>]}
[0m16:09:07.797701 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cab10>]}
[0m16:09:07.798471 [info ] [Thread-2 (]: 9 of 17 OK created sql view model dbt.companies_trips .......................... [[32mCREATE VIEW[0m in 1.31s]
[0m16:09:07.799164 [info ] [Thread-4 (]: 7 of 17 OK created sql view model dbt.parking_finish_stat ...................... [[32mCREATE VIEW[0m in 1.48s]
[0m16:09:07.799834 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies_trips
[0m16:09:07.800370 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m16:09:07.800835 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m16:09:07.801319 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m16:09:07.801827 [info ] [Thread-2 (]: 11 of 17 START sql view model dbt.trips_stat ................................... [RUN]
[0m16:09:07.802309 [info ] [Thread-4 (]: 12 of 17 START sql incremental model dbt.trips_users ........................... [RUN]
[0m16:09:07.802871 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_stat)
[0m16:09:07.803339 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.trips_users)
[0m16:09:07.803785 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m16:09:07.804217 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m16:09:07.808070 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m16:09:07.812318 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m16:09:07.813319 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m16:09:07.813657 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m16:09:07.817601 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m16:09:07.820446 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:07.820866 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp160907819309"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age
from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m16:09:07.821150 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:07.821636 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:09:07.821893 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m16:09:07.822123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:07.968676 [debug] [Thread-1 (]: SQL status: BEGIN in 1.566 seconds
[0m16:09:07.969648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:09:07.970236 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  create view "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp"
    
    
  as (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
where
    st_intersects(st_transform(t.start_point, 3857), hex.geom)
group by
    1
  );
[0m16:09:08.037119 [debug] [Thread-3 (]: SQL status: BEGIN in 0.747 seconds
[0m16:09:08.037983 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.067 seconds
[0m16:09:08.038497 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:09:08.043967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:09:08.044506 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

  create view "dev_ohwk"."dbt"."revenue_daily__dbt_tmp"
    
    
  as (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"
group by
    2
order by
    2
  );
[0m16:09:08.045189 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m16:09:08.103537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.058 seconds
[0m16:09:08.104337 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.059 seconds
[0m16:09:08.108428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:09:08.111498 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:09:08.111992 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m16:09:08.112448 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
alter table "dev_ohwk"."dbt"."revenue_daily__dbt_tmp" rename to "revenue_daily"
[0m16:09:08.158912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:09:08.161514 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m16:09:08.162184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:09:08.162633 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.050 seconds
[0m16:09:08.163026 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m16:09:08.164562 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:09:08.165194 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:09:08.165559 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:09:08.210700 [debug] [Thread-1 (]: SQL status: COMMIT in 0.046 seconds
[0m16:09:08.214003 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_start_stat__dbt_backup"
[0m16:09:08.214610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:09:08.214986 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_ohwk"."dbt"."parking_start_stat__dbt_backup" cascade
[0m16:09:08.217966 [debug] [Thread-3 (]: SQL status: COMMIT in 0.052 seconds
[0m16:09:08.220244 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."revenue_daily__dbt_backup"
[0m16:09:08.220822 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:09:08.221198 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
drop view if exists "dev_ohwk"."dbt"."revenue_daily__dbt_backup" cascade
[0m16:09:08.272894 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.051 seconds
[0m16:09:08.274509 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:09:08.274904 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.060 seconds
[0m16:09:08.276199 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m16:09:08.276770 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cad50>]}
[0m16:09:08.278008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cadb0>]}
[0m16:09:08.277546 [info ] [Thread-3 (]: 10 of 17 OK created sql view model dbt.revenue_daily ........................... [[32mCREATE VIEW[0m in 1.00s]
[0m16:09:08.278712 [info ] [Thread-1 (]: 8 of 17 OK created sql view model dbt.parking_start_stat ....................... [[32mCREATE VIEW[0m in 1.88s]
[0m16:09:08.279331 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:09:08.279854 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m16:09:08.280271 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_full
[0m16:09:08.280915 [info ] [Thread-3 (]: 13 of 17 START sql view model dbt.events_full .................................. [RUN]
[0m16:09:08.281383 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.events_full)
[0m16:09:08.281754 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_full
[0m16:09:08.284826 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m16:09:08.286995 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_full
[0m16:09:08.291389 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m16:09:08.292777 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:09:08.293205 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: BEGIN
[0m16:09:08.293536 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:08.814537 [debug] [Thread-2 (]: SQL status: BEGIN in 0.992 seconds
[0m16:09:08.815110 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:09:08.815511 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  create view "dev_ohwk"."dbt"."trips_stat__dbt_tmp"
    
    
  as (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_ohwk"."dbt"."trips_prep"
  );
[0m16:09:08.891706 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.076 seconds
[0m16:09:08.894971 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:09:08.895365 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m16:09:08.988637 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m16:09:08.991981 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:09:08.992354 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m16:09:09.086074 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m16:09:09.088054 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m16:09:09.088564 [debug] [Thread-4 (]: SQL status: SELECT 0 in 1.267 seconds
[0m16:09:09.088982 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:09:09.092170 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:09.092626 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m16:09:09.092992 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m16:09:09.139666 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m16:09:09.140547 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:09.141073 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp160907819309'
        
      order by ordinal_position

  
[0m16:09:09.141524 [debug] [Thread-2 (]: SQL status: COMMIT in 0.048 seconds
[0m16:09:09.144875 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat__dbt_backup"
[0m16:09:09.145660 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:09:09.146153 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_stat__dbt_backup" cascade
[0m16:09:09.203916 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.057 seconds
[0m16:09:09.205665 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m16:09:09.206475 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f130b0>]}
[0m16:09:09.207094 [info ] [Thread-2 (]: 11 of 17 OK created sql view model dbt.trips_stat .............................. [[32mCREATE VIEW[0m in 1.40s]
[0m16:09:09.207626 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m16:09:09.208848 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.067 seconds
[0m16:09:09.212518 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:09.212892 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:09:09.251621 [debug] [Thread-3 (]: SQL status: BEGIN in 0.958 seconds
[0m16:09:09.252418 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:09:09.252948 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_ohwk"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_ohwk"."dbt"."events_clean"
    left join "dev_ohwk"."dbt"."event_types"
        using (type_id)
  );
[0m16:09:09.290061 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.077 seconds
[0m16:09:09.294457 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:09.294914 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:09:09.311012 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.057 seconds
[0m16:09:09.315516 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:09:09.315949 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m16:09:09.362885 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m16:09:09.366476 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:09:09.366838 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m16:09:09.413639 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.118 seconds
[0m16:09:09.416254 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m16:09:09.417438 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:09.417843 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age"
        from "trips_users__dbt_tmp160907819309"
    )


  
[0m16:09:09.463111 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.096 seconds
[0m16:09:09.464696 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m16:09:09.465089 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:09:09.465415 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m16:09:09.483390 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.065 seconds
[0m16:09:09.484865 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m16:09:09.485233 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:09:09.485548 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m16:09:09.517886 [debug] [Thread-3 (]: SQL status: COMMIT in 0.052 seconds
[0m16:09:09.522869 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."events_full__dbt_backup"
[0m16:09:09.523895 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:09:09.524439 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_ohwk"."dbt"."events_full__dbt_backup" cascade
[0m16:09:09.591687 [debug] [Thread-4 (]: SQL status: COMMIT in 0.105 seconds
[0m16:09:09.593730 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m16:09:09.595335 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a67b90>]}
[0m16:09:09.596166 [info ] [Thread-4 (]: 12 of 17 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 1.79s]
[0m16:09:09.597025 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m16:09:09.598042 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_daily
[0m16:09:09.598664 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.074 seconds
[0m16:09:09.599223 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m16:09:09.599899 [info ] [Thread-1 (]: 14 of 17 START sql view model dbt.trips_age_daily .............................. [RUN]
[0m16:09:09.602054 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: Close
[0m16:09:09.602603 [info ] [Thread-2 (]: 15 of 17 START sql view model dbt.trips_age_group .............................. [RUN]
[0m16:09:09.603101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.trips_age_daily)
[0m16:09:09.603666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_age_group)
[0m16:09:09.604206 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cab70>]}
[0m16:09:09.604603 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m16:09:09.605060 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m16:09:09.610054 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m16:09:09.605652 [info ] [Thread-3 (]: 13 of 17 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 1.32s]
[0m16:09:09.614071 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m16:09:09.614794 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_full
[0m16:09:09.615520 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m16:09:09.618320 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m16:09:09.618695 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m16:09:09.619039 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m16:09:09.621838 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m16:09:09.622322 [info ] [Thread-4 (]: 16 of 17 START sql view model dbt.events_stat .................................. [RUN]
[0m16:09:09.623051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:09:09.623393 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.events_stat)
[0m16:09:09.623677 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m16:09:09.623986 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m16:09:09.624250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:09.624530 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:09:09.626227 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m16:09:09.626594 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m16:09:09.626897 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:09.627253 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m16:09:09.629517 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m16:09:09.629947 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:09:09.630148 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m16:09:09.630343 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:11.318875 [debug] [Thread-4 (]: SQL status: BEGIN in 1.688 seconds
[0m16:09:11.319661 [debug] [Thread-1 (]: SQL status: BEGIN in 1.695 seconds
[0m16:09:11.320191 [debug] [Thread-2 (]: SQL status: BEGIN in 1.693 seconds
[0m16:09:11.320668 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:09:11.321247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:09:11.321704 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:09:11.322125 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  create view "dev_ohwk"."dbt"."events_stat__dbt_tmp"
    
    
  as (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_ohwk"."dbt"."events_full"
  );
[0m16:09:11.322558 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  create view "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp"
    
    
  as (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users"
group by
    1,
    2
  );
[0m16:09:11.322955 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  create view "dev_ohwk"."dbt"."trips_age_group__dbt_tmp"
    
    
  as (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users" as tu
    cross join "dev_ohwk"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
[0m16:09:11.389258 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.065 seconds
[0m16:09:11.390533 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.067 seconds
[0m16:09:11.391300 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.068 seconds
[0m16:09:11.396278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:09:11.403900 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:09:11.406238 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:09:11.406594 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m16:09:11.406907 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m16:09:11.407205 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_ohwk"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m16:09:11.486507 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.079 seconds
[0m16:09:11.487146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.080 seconds
[0m16:09:11.487612 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.080 seconds
[0m16:09:11.489105 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m16:09:11.492245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:09:11.493707 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m16:09:11.494131 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:09:11.494513 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m16:09:11.494890 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:09:11.495233 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m16:09:11.495643 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m16:09:11.561188 [debug] [Thread-4 (]: SQL status: COMMIT in 0.065 seconds
[0m16:09:11.561696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.066 seconds
[0m16:09:11.562162 [debug] [Thread-2 (]: SQL status: COMMIT in 0.066 seconds
[0m16:09:11.564894 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."events_stat__dbt_backup"
[0m16:09:11.566237 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m16:09:11.568163 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_group__dbt_backup"
[0m16:09:11.568705 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:09:11.569062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:09:11.569564 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:09:11.569936 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop view if exists "dev_ohwk"."dbt"."events_stat__dbt_backup" cascade
[0m16:09:11.570336 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m16:09:11.570739 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_group__dbt_backup" cascade
[0m16:09:11.634946 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.064 seconds
[0m16:09:11.635443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.064 seconds
[0m16:09:11.637022 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m16:09:11.637401 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.066 seconds
[0m16:09:11.639729 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily__dbt_backup"
[0m16:09:11.641136 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m16:09:11.641905 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a64710>]}
[0m16:09:11.642660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:09:11.643955 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily__dbt_backup" cascade
[0m16:09:11.643586 [info ] [Thread-4 (]: 16 of 17 OK created sql view model dbt.events_stat ............................. [[32mCREATE VIEW[0m in 2.02s]
[0m16:09:11.644571 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a64710>]}
[0m16:09:11.645196 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m16:09:11.645730 [info ] [Thread-2 (]: 15 of 17 OK created sql view model dbt.trips_age_group ......................... [[32mCREATE VIEW[0m in 2.04s]
[0m16:09:11.646391 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m16:09:11.704394 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.059 seconds
[0m16:09:11.706088 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: Close
[0m16:09:11.706847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cab70>]}
[0m16:09:11.707493 [info ] [Thread-1 (]: 14 of 17 OK created sql view model dbt.trips_age_daily ......................... [[32mCREATE VIEW[0m in 2.10s]
[0m16:09:11.708095 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m16:09:11.708964 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m16:09:11.709516 [info ] [Thread-3 (]: 17 of 17 START sql view model dbt.trips_age_daily_stat ......................... [RUN]
[0m16:09:11.709930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_age_daily_stat)
[0m16:09:11.710244 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m16:09:11.713351 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:11.714130 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m16:09:11.716677 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:11.717199 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:11.717454 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m16:09:11.717688 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:12.491225 [debug] [Thread-3 (]: SQL status: BEGIN in 0.773 seconds
[0m16:09:12.491559 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:12.491778 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  create view "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp"
    
    
  as (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_ohwk"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
[0m16:09:12.543033 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m16:09:12.549659 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:12.550434 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m16:09:12.610695 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.059 seconds
[0m16:09:12.617887 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:12.618710 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m16:09:12.667282 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m16:09:12.671453 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m16:09:12.672336 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:12.673006 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m16:09:12.724237 [debug] [Thread-3 (]: SQL status: COMMIT in 0.050 seconds
[0m16:09:12.729967 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup"
[0m16:09:12.731207 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:09:12.731917 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m16:09:12.807217 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.074 seconds
[0m16:09:12.811525 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m16:09:12.813591 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6522f68-8fb0-489c-a22d-a6abb85e5f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142cb890>]}
[0m16:09:12.814846 [info ] [Thread-3 (]: 17 of 17 OK created sql view model dbt.trips_age_daily_stat .................... [[32mCREATE VIEW[0m in 1.10s]
[0m16:09:12.815912 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m16:09:12.818770 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:12.819239 [debug] [MainThread]: On master: BEGIN
[0m16:09:12.819627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:13.528260 [debug] [MainThread]: SQL status: BEGIN in 0.708 seconds
[0m16:09:13.529140 [debug] [MainThread]: On master: COMMIT
[0m16:09:13.529740 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:13.530265 [debug] [MainThread]: On master: COMMIT
[0m16:09:13.578399 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m16:09:13.579366 [debug] [MainThread]: On master: Close
[0m16:09:13.580701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:13.581243 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m16:09:13.581699 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m16:09:13.582111 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m16:09:13.582469 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m16:09:13.583213 [info ] [MainThread]: 
[0m16:09:13.583673 [info ] [MainThread]: Finished running 3 incremental models, 14 view models in 0 hours 0 minutes and 14.96 seconds (14.96s).
[0m16:09:13.587717 [debug] [MainThread]: Command end result
[0m16:09:13.615654 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:09:13.617099 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:09:13.621713 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:09:13.621912 [info ] [MainThread]: 
[0m16:09:13.622137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:13.622308 [info ] [MainThread]: 
[0m16:09:13.622487 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=17
[0m16:09:13.624268 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.26882, "process_in_blocks": "0", "process_kernel_time": 0.204503, "process_mem_max_rss": "140820480", "process_out_blocks": "0", "process_user_time": 1.577208}
[0m16:09:13.624620 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:13.624550 after 15.27 seconds
[0m16:09:13.624861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b9f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b9f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b9fd70>]}
[0m16:09:13.625149 [debug] [MainThread]: Flushing usage events
[0m16:09:14.479508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:08.312405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130c34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115027b10>]}


============================== 16:17:08.314703 | 76a6ace6-c55f-47f1-8e2e-d8a2c2e81657 ==============================
[0m16:17:08.314703 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:17:08.314977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:17:08.380155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11372f490>]}
[0m16:17:08.401191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146bebe0>]}
[0m16:17:08.401621 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:17:08.440414 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m16:17:08.478102 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:17:08.478345 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m16:17:08.478497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ce4250>]}
[0m16:17:08.971361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ad2030>]}
[0m16:17:09.002492 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:17:09.003903 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:17:09.010392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11545ea50>]}
[0m16:17:09.010609 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:17:09.010750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a89bf0>]}
[0m16:17:09.011423 [info ] [MainThread]: 
[0m16:17:09.011558 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:17:09.011699 [info ] [MainThread]: 
[0m16:17:09.011972 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:17:09.012388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:17:09.029263 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:17:09.029538 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:17:09.029714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:10.116807 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.087 seconds
[0m16:17:10.118020 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:17:10.122537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:17:10.126483 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:17:10.126760 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:17:10.126942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:10.801313 [debug] [ThreadPool]: SQL status: BEGIN in 0.674 seconds
[0m16:17:10.802254 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:17:10.802656 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:17:10.848597 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.045 seconds
[0m16:17:10.851453 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:17:10.897395 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:17:10.910542 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:10.911194 [debug] [MainThread]: On master: BEGIN
[0m16:17:10.911466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:17:11.608817 [debug] [MainThread]: SQL status: BEGIN in 0.697 seconds
[0m16:17:11.609289 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:11.609680 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:17:11.663695 [debug] [MainThread]: SQL status: SELECT 18 in 0.054 seconds
[0m16:17:11.667963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a23c50>]}
[0m16:17:11.668493 [debug] [MainThread]: On master: ROLLBACK
[0m16:17:11.709882 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:11.710471 [debug] [MainThread]: On master: BEGIN
[0m16:17:11.795108 [debug] [MainThread]: SQL status: BEGIN in 0.084 seconds
[0m16:17:11.796936 [debug] [MainThread]: On master: COMMIT
[0m16:17:11.797620 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:11.797985 [debug] [MainThread]: On master: COMMIT
[0m16:17:11.842194 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m16:17:11.842696 [debug] [MainThread]: On master: Close
[0m16:17:11.849564 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:17:11.850271 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:17:11.850966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:17:11.851330 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:17:11.860941 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:17:11.862019 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:17:11.901056 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:17:11.901620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:17:11.901791 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:17:11.901939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:13.489540 [debug] [Thread-1 (]: SQL status: BEGIN in 1.587 seconds
[0m16:17:13.490226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:17:13.490631 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_ohwk"."dbt"."revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

group by
    2
order by
    2
  );
  
  
[0m16:17:15.161056 [debug] [Thread-1 (]: SQL status: SELECT 91 in 1.670 seconds
[0m16:17:15.170291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:17:15.170639 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
alter table "dev_ohwk"."dbt"."revenue_daily" rename to "revenue_daily__dbt_backup"
[0m16:17:15.214401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m16:17:15.216545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:17:15.216801 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
alter table "dev_ohwk"."dbt"."revenue_daily__dbt_tmp" rename to "revenue_daily"
[0m16:17:15.261038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m16:17:15.275151 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:17:15.275477 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:17:15.275701 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:17:15.317888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m16:17:15.323054 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."revenue_daily__dbt_backup"
[0m16:17:15.326166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:17:15.326447 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
drop view if exists "dev_ohwk"."dbt"."revenue_daily__dbt_backup" cascade
[0m16:17:15.371273 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.045 seconds
[0m16:17:15.373561 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:17:15.376050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a6ace6-c55f-47f1-8e2e-d8a2c2e81657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116192e60>]}
[0m16:17:15.376580 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mSELECT 91[0m in 3.52s]
[0m16:17:15.377026 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:17:15.378081 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:15.378361 [debug] [MainThread]: On master: BEGIN
[0m16:17:15.378569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:17:16.016266 [debug] [MainThread]: SQL status: BEGIN in 0.638 seconds
[0m16:17:16.017179 [debug] [MainThread]: On master: COMMIT
[0m16:17:16.017743 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:16.018279 [debug] [MainThread]: On master: COMMIT
[0m16:17:16.058964 [debug] [MainThread]: SQL status: COMMIT in 0.040 seconds
[0m16:17:16.059401 [debug] [MainThread]: On master: Close
[0m16:17:16.059882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:16.060066 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:17:16.060261 [info ] [MainThread]: 
[0m16:17:16.060467 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.05 seconds (7.05s).
[0m16:17:16.060932 [debug] [MainThread]: Command end result
[0m16:17:16.080590 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:17:16.082197 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:17:16.085243 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:17:16.085406 [info ] [MainThread]: 
[0m16:17:16.085683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:16.085883 [info ] [MainThread]: 
[0m16:17:16.086154 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:17:16.088063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.803939, "process_in_blocks": "0", "process_kernel_time": 0.128026, "process_mem_max_rss": "145670144", "process_out_blocks": "0", "process_user_time": 1.375166}
[0m16:17:16.088296 [debug] [MainThread]: Command `cli run` succeeded at 16:17:16.088251 after 7.80 seconds
[0m16:17:16.088472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115de51d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fb3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a13cd0>]}
[0m16:17:16.088651 [debug] [MainThread]: Flushing usage events
[0m16:17:16.791058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:46.209441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108227b10>]}


============================== 16:20:46.211879 | 054a913c-a53e-4191-9ded-e14a426d1ae9 ==============================
[0m16:20:46.211879 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:20:46.212152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models revenue_daily', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:20:46.212363 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m16:20:46.212509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10810ed70>]}
[0m16:20:46.278053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbe030>]}
[0m16:20:46.298820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa3b50>]}
[0m16:20:46.299572 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:20:46.337245 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:20:46.374351 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:20:46.374578 [debug] [MainThread]: previous checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, current checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7
[0m16:20:46.374725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db9310>]}
[0m16:20:46.869988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820a7b0>]}
[0m16:20:46.902223 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:20:46.903388 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:20:46.913303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a59d090>]}
[0m16:20:46.913514 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:20:46.913663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d90f50>]}
[0m16:20:46.914347 [info ] [MainThread]: 
[0m16:20:46.914479 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:20:46.914587 [info ] [MainThread]: 
[0m16:20:46.914779 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:46.915129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:20:46.936161 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:20:46.936371 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:20:46.936480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:48.711978 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.775 seconds
[0m16:20:48.716150 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:20:48.725694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:20:48.733814 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:20:48.734357 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:20:48.734620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:49.528082 [debug] [ThreadPool]: SQL status: BEGIN in 0.793 seconds
[0m16:20:49.529051 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:20:49.529613 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:20:49.680114 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.150 seconds
[0m16:20:49.684769 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:20:49.733726 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:20:49.747488 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:49.747939 [debug] [MainThread]: On master: BEGIN
[0m16:20:49.748214 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:50.444759 [debug] [MainThread]: SQL status: BEGIN in 0.696 seconds
[0m16:20:50.445715 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:50.446320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:50.507205 [debug] [MainThread]: SQL status: SELECT 17 in 0.060 seconds
[0m16:20:50.516759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a78eaf0>]}
[0m16:20:50.517745 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:50.571459 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:50.572904 [debug] [MainThread]: On master: BEGIN
[0m16:20:50.673716 [debug] [MainThread]: SQL status: BEGIN in 0.100 seconds
[0m16:20:50.675158 [debug] [MainThread]: On master: COMMIT
[0m16:20:50.676241 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:50.677182 [debug] [MainThread]: On master: COMMIT
[0m16:20:50.731126 [debug] [MainThread]: SQL status: COMMIT in 0.053 seconds
[0m16:20:50.732024 [debug] [MainThread]: On master: Close
[0m16:20:50.739580 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:20:50.740532 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:20:50.741589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:20:50.742147 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:20:50.753977 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:20:50.755151 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:20:50.790126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:50.790436 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp162050777453"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:20:50.790613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:52.479788 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.689 seconds
[0m16:20:52.499116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:52.499657 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:20:52.551789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m16:20:52.552817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:52.553348 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp162050777453'
        
      order by ordinal_position

  
[0m16:20:52.611550 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.057 seconds
[0m16:20:52.622307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:52.622926 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:20:52.678346 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.055 seconds
[0m16:20:52.691438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:52.692137 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:20:52.748075 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.055 seconds
[0m16:20:52.768516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:20:52.769696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:52.770148 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp162050777453"
    )


  
[0m16:20:52.821589 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.051 seconds
[0m16:20:52.842881 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:20:52.843318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:20:52.843612 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:20:52.917311 [debug] [Thread-1 (]: SQL status: COMMIT in 0.073 seconds
[0m16:20:52.922042 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:20:52.927148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '054a913c-a53e-4191-9ded-e14a426d1ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffc910>]}
[0m16:20:52.928226 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 2.18s]
[0m16:20:52.929033 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:20:52.931417 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:52.931815 [debug] [MainThread]: On master: BEGIN
[0m16:20:52.932139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:54.018407 [debug] [MainThread]: SQL status: BEGIN in 1.086 seconds
[0m16:20:54.019463 [debug] [MainThread]: On master: COMMIT
[0m16:20:54.019946 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:54.020337 [debug] [MainThread]: On master: COMMIT
[0m16:20:54.093275 [debug] [MainThread]: SQL status: COMMIT in 0.072 seconds
[0m16:20:54.094464 [debug] [MainThread]: On master: Close
[0m16:20:54.096459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:54.097032 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:20:54.097604 [info ] [MainThread]: 
[0m16:20:54.098161 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.18 seconds (7.18s).
[0m16:20:54.099129 [debug] [MainThread]: Command end result
[0m16:20:54.132083 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:20:54.133454 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:20:54.137137 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:20:54.137339 [info ] [MainThread]: 
[0m16:20:54.137575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:54.137750 [info ] [MainThread]: 
[0m16:20:54.137927 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:20:54.138240 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:20:54.139963 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9579806, "process_in_blocks": "0", "process_kernel_time": 0.160621, "process_mem_max_rss": "147292160", "process_out_blocks": "0", "process_user_time": 1.458232}
[0m16:20:54.140280 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:54.140217 after 7.96 seconds
[0m16:20:54.140508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6ea4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108247230>]}
[0m16:20:54.140728 [debug] [MainThread]: Flushing usage events
[0m16:20:54.793833 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:29.361250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c134d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910bb10>]}


============================== 16:24:29.363279 | 7afc0209-06f2-40a5-89d4-e232bd76bbf0 ==============================
[0m16:24:29.363279 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:24:29.363556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:24:29.425892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840f490>]}
[0m16:24:29.446715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa2030>]}
[0m16:24:29.447087 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:24:29.482636 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:24:29.526678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:29.526852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:29.543687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8b450>]}
[0m16:24:29.577187 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:24:29.578347 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:24:29.584565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091899a0>]}
[0m16:24:29.584751 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:24:29.584890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10963b3f0>]}
[0m16:24:29.585934 [info ] [MainThread]: 
[0m16:24:29.586074 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:24:29.586179 [info ] [MainThread]: 
[0m16:24:29.586368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:24:29.588149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:24:29.607641 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:24:29.607856 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:24:29.607977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:31.145243 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.537 seconds
[0m16:24:31.149509 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:24:31.154732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:24:31.162756 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:24:31.163206 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:24:31.163448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:32.947830 [debug] [ThreadPool]: SQL status: BEGIN in 1.784 seconds
[0m16:24:32.949165 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:24:32.950257 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:24:33.010935 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.060 seconds
[0m16:24:33.014089 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:24:33.055947 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:24:33.070160 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:33.070612 [debug] [MainThread]: On master: BEGIN
[0m16:24:33.070938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:33.772126 [debug] [MainThread]: SQL status: BEGIN in 0.701 seconds
[0m16:24:33.773134 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:33.774010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:24:33.832230 [debug] [MainThread]: SQL status: SELECT 17 in 0.057 seconds
[0m16:24:33.838194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1e1bf0>]}
[0m16:24:33.839050 [debug] [MainThread]: On master: ROLLBACK
[0m16:24:33.888821 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:33.889478 [debug] [MainThread]: On master: BEGIN
[0m16:24:33.984160 [debug] [MainThread]: SQL status: BEGIN in 0.094 seconds
[0m16:24:33.985189 [debug] [MainThread]: On master: COMMIT
[0m16:24:33.986226 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:33.987134 [debug] [MainThread]: On master: COMMIT
[0m16:24:34.046906 [debug] [MainThread]: SQL status: COMMIT in 0.059 seconds
[0m16:24:34.047889 [debug] [MainThread]: On master: Close
[0m16:24:34.056237 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m16:24:34.056965 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m16:24:34.057505 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m16:24:34.058002 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_clean
[0m16:24:34.058743 [info ] [Thread-1 (]: 1 of 17 START sql view model dbt.companies ..................................... [RUN]
[0m16:24:34.059459 [info ] [Thread-3 (]: 3 of 17 START sql incremental model dbt.trips_concurrency ...................... [RUN]
[0m16:24:34.060103 [info ] [Thread-4 (]: 4 of 17 START sql view model dbt.trips_geom .................................... [RUN]
[0m16:24:34.060566 [info ] [Thread-2 (]: 2 of 17 START sql incremental model dbt.events_clean ........................... [RUN]
[0m16:24:34.061115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.companies)
[0m16:24:34.061664 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m16:24:34.062152 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m16:24:34.062584 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean'
[0m16:24:34.062934 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m16:24:34.063264 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m16:24:34.063581 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m16:24:34.064053 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_clean
[0m16:24:34.072495 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m16:24:34.080716 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m16:24:34.082347 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m16:24:34.084271 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m16:24:34.084937 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m16:24:34.085234 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m16:24:34.098024 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m16:24:34.110771 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_clean
[0m16:24:34.120153 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m16:24:34.121408 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m16:24:34.125146 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:34.126678 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:34.126948 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp162434109283"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency
from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m16:24:34.127132 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp162434126108"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id
from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m16:24:34.127295 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:24:34.127486 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:24:34.127703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:24:34.127871 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:24:34.128080 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m16:24:34.128239 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m16:24:34.128381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:34.128515 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:24:35.272853 [debug] [Thread-1 (]: SQL status: BEGIN in 1.144 seconds
[0m16:24:35.274341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:24:35.275017 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  create view "dev_ohwk"."dbt"."companies__dbt_tmp"
    
    
  as (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_ohwk"."dbt"."scooters"
group by
    1
  );
[0m16:24:35.481034 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.205 seconds
[0m16:24:35.495026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:24:35.496024 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies" rename to "companies__dbt_backup"
[0m16:24:35.571580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.075 seconds
[0m16:24:35.583695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:24:35.584240 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies__dbt_tmp" rename to "companies"
[0m16:24:35.671703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.087 seconds
[0m16:24:35.692359 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m16:24:35.692878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:24:35.693161 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m16:24:35.776582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.083 seconds
[0m16:24:35.780774 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."companies__dbt_backup"
[0m16:24:35.783561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m16:24:35.783801 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop view if exists "dev_ohwk"."dbt"."companies__dbt_backup" cascade
[0m16:24:35.975353 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.191 seconds
[0m16:24:35.981122 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m16:24:35.986152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41c290>]}
[0m16:24:35.987197 [info ] [Thread-1 (]: 1 of 17 OK created sql view model dbt.companies ................................ [[32mCREATE VIEW[0m in 1.92s]
[0m16:24:35.988060 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m16:24:35.988624 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m16:24:35.989291 [info ] [Thread-1 (]: 5 of 17 START sql view model dbt.trips_prep .................................... [RUN]
[0m16:24:35.989946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.trips_prep)
[0m16:24:35.990384 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m16:24:36.039685 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m16:24:36.040243 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m16:24:36.041696 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m16:24:36.042051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:24:36.042210 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m16:24:36.042354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:36.373895 [debug] [Thread-4 (]: SQL status: BEGIN in 2.245 seconds
[0m16:24:36.375103 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:24:36.375910 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_ohwk"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_ohwk"."scooters_raw"."trips"
  );
[0m16:24:36.475287 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.098 seconds
[0m16:24:36.476542 [debug] [Thread-2 (]: SQL status: SELECT 0 in 2.349 seconds
[0m16:24:36.482872 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:24:36.499545 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:36.500118 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m16:24:36.500537 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: BEGIN
[0m16:24:36.574939 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.074 seconds
[0m16:24:36.575586 [debug] [Thread-2 (]: SQL status: BEGIN in 0.075 seconds
[0m16:24:36.581170 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:24:36.581848 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:36.582443 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m16:24:36.583079 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp162434126108'
        
      order by ordinal_position

  
[0m16:24:36.672107 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m16:24:36.675853 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m16:24:36.676560 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:24:36.677083 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m16:24:36.793746 [debug] [Thread-4 (]: SQL status: COMMIT in 0.116 seconds
[0m16:24:36.797858 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_geom__dbt_backup"
[0m16:24:36.798819 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m16:24:36.799351 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_ohwk"."dbt"."trips_geom__dbt_backup" cascade
[0m16:24:36.876180 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.076 seconds
[0m16:24:36.877005 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.293 seconds
[0m16:24:36.880401 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: Close
[0m16:24:36.889445 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:36.890081 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:36.890976 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c2ba0>]}
[0m16:24:36.891970 [info ] [Thread-4 (]: 4 of 17 OK created sql view model dbt.trips_geom ............................... [[32mCREATE VIEW[0m in 2.83s]
[0m16:24:36.892682 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m16:24:36.893163 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m16:24:36.893739 [info ] [Thread-4 (]: 6 of 17 START sql view model dbt.trips_stat_daily .............................. [RUN]
[0m16:24:36.894403 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.trips_stat_daily)
[0m16:24:36.894922 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m16:24:36.897724 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m16:24:36.898673 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m16:24:36.901501 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m16:24:36.902236 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:24:36.902554 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m16:24:36.902837 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:24:36.978370 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.087 seconds
[0m16:24:36.989967 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:36.990444 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:37.021953 [debug] [Thread-1 (]: SQL status: BEGIN in 0.979 seconds
[0m16:24:37.022886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:24:37.023508 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_ohwk"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  );
[0m16:24:37.072682 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m16:24:37.080081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:24:37.080846 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.090 seconds
[0m16:24:37.081487 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m16:24:37.096355 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m16:24:37.097275 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:37.097615 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id")
    (
        select "user_id", "timestamp", "type_id"
        from "events_clean__dbt_tmp162434126108"
    )


  
[0m16:24:37.418900 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.321 seconds
[0m16:24:37.422959 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m16:24:37.423609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.329 seconds
[0m16:24:37.424111 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m16:24:37.429505 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:24:37.430235 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m16:24:37.430826 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m16:24:37.575597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.144 seconds
[0m16:24:37.576688 [debug] [Thread-2 (]: SQL status: COMMIT in 0.145 seconds
[0m16:24:37.579922 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m16:24:37.581354 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: Close
[0m16:24:37.581925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:24:37.582596 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m16:24:37.583630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a468e10>]}
[0m16:24:37.584823 [info ] [Thread-2 (]: 2 of 17 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 3.52s]
[0m16:24:37.585628 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_clean
[0m16:24:37.586171 [debug] [Thread-2 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m16:24:37.586863 [info ] [Thread-2 (]: 7 of 17 START sql view model dbt.parking_finish_stat ........................... [RUN]
[0m16:24:37.587626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.parking_finish_stat)
[0m16:24:37.588100 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m16:24:37.592010 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m16:24:37.592846 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m16:24:37.596791 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m16:24:37.597785 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:24:37.598381 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m16:24:37.598735 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:24:37.782337 [debug] [Thread-1 (]: SQL status: COMMIT in 0.198 seconds
[0m16:24:37.787529 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_prep__dbt_backup"
[0m16:24:37.788621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m16:24:37.789113 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_ohwk"."dbt"."trips_prep__dbt_backup" cascade
[0m16:24:38.170536 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.380 seconds
[0m16:24:38.175130 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m16:24:38.176650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a245850>]}
[0m16:24:38.177719 [info ] [Thread-1 (]: 5 of 17 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 2.19s]
[0m16:24:38.178713 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m16:24:38.179393 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m16:24:38.180319 [info ] [Thread-1 (]: 8 of 17 START sql view model dbt.parking_start_stat ............................ [RUN]
[0m16:24:38.181172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_start_stat)
[0m16:24:38.181659 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m16:24:38.185765 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m16:24:38.187033 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m16:24:38.191187 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m16:24:38.192021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:24:38.192386 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m16:24:38.192698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:39.637873 [debug] [Thread-3 (]: SQL status: SELECT 0 in 5.510 seconds
[0m16:24:39.643624 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:39.644194 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m16:24:39.971304 [debug] [Thread-3 (]: SQL status: BEGIN in 0.326 seconds
[0m16:24:39.972478 [debug] [Thread-4 (]: SQL status: BEGIN in 3.070 seconds
[0m16:24:39.973234 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:39.974030 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:24:39.974911 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp162434109283'
        
      order by ordinal_position

  
[0m16:24:39.975639 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  create view "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp"
    
    
  as (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
[0m16:24:40.042001 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.065 seconds
[0m16:24:40.043400 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.067 seconds
[0m16:24:40.049658 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:24:40.053977 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:40.054500 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m16:24:40.055150 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:40.109793 [debug] [Thread-2 (]: SQL status: BEGIN in 2.511 seconds
[0m16:24:40.110766 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.055 seconds
[0m16:24:40.111830 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.056 seconds
[0m16:24:40.112712 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:24:40.118455 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:40.122915 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:24:40.123550 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  create view "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp"
    
    
  as (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
where
    st_intersects(st_transform(t.finish_point, 3857), hex.geom)
group by
    1
  );
[0m16:24:40.124172 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:40.124682 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m16:24:40.195923 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.070 seconds
[0m16:24:40.198669 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m16:24:40.199342 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:24:40.199899 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.075 seconds
[0m16:24:40.200362 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m16:24:40.200859 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.076 seconds
[0m16:24:40.203504 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m16:24:40.207997 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:24:40.208683 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m16:24:40.209721 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:40.210128 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency")
    (
        select "timestamp", "concurrency"
        from "trips_concurrency__dbt_tmp162434109283"
    )


  
[0m16:24:40.268087 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.059 seconds
[0m16:24:40.269208 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.058 seconds
[0m16:24:40.270151 [debug] [Thread-4 (]: SQL status: COMMIT in 0.066 seconds
[0m16:24:40.272592 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m16:24:40.274756 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m16:24:40.278493 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup"
[0m16:24:40.279079 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:24:40.280449 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m16:24:40.281143 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m16:24:40.281579 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m16:24:40.281957 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m16:24:40.282301 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop view if exists "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m16:24:40.346213 [debug] [Thread-2 (]: SQL status: COMMIT in 0.063 seconds
[0m16:24:40.347407 [debug] [Thread-3 (]: SQL status: COMMIT in 0.065 seconds
[0m16:24:40.348031 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.065 seconds
[0m16:24:40.352056 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup"
[0m16:24:40.353505 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m16:24:40.355515 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m16:24:40.356351 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m16:24:40.357087 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop view if exists "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m16:24:40.357844 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4609f0>]}
[0m16:24:40.358363 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a460a60>]}
[0m16:24:40.359304 [info ] [Thread-3 (]: 3 of 17 OK created sql incremental model dbt.trips_concurrency ................. [[32mINSERT 0 0[0m in 6.30s]
[0m16:24:40.360672 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m16:24:40.359992 [info ] [Thread-4 (]: 6 of 17 OK created sql view model dbt.trips_stat_daily ......................... [[32mCREATE VIEW[0m in 3.46s]
[0m16:24:40.361262 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_full
[0m16:24:40.361923 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m16:24:40.362464 [info ] [Thread-3 (]: 9 of 17 START sql view model dbt.events_full ................................... [RUN]
[0m16:24:40.362991 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies_trips
[0m16:24:40.363508 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.events_full)
[0m16:24:40.364005 [info ] [Thread-4 (]: 10 of 17 START sql view model dbt.companies_trips .............................. [RUN]
[0m16:24:40.364419 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_full
[0m16:24:40.364808 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.companies_trips)
[0m16:24:40.367872 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m16:24:40.368304 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies_trips
[0m16:24:40.371690 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m16:24:40.372313 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_full
[0m16:24:40.372688 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies_trips
[0m16:24:40.375311 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m16:24:40.380546 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m16:24:40.381117 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:24:40.381375 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:24:40.381593 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: BEGIN
[0m16:24:40.381826 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m16:24:40.382057 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:24:40.382268 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:24:40.420224 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.061 seconds
[0m16:24:40.421454 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m16:24:40.422025 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f97bf0>]}
[0m16:24:40.422574 [info ] [Thread-2 (]: 7 of 17 OK created sql view model dbt.parking_finish_stat ...................... [[32mCREATE VIEW[0m in 2.83s]
[0m16:24:40.423036 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m16:24:40.423331 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:24:40.423681 [info ] [Thread-2 (]: 11 of 17 START sql incremental model dbt.revenue_daily ......................... [RUN]
[0m16:24:40.424000 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.revenue_daily)
[0m16:24:40.424258 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:24:40.426562 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:24:40.427028 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:24:40.429435 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:40.429733 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp162440428318"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:24:40.429987 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:24:41.132066 [debug] [Thread-3 (]: SQL status: BEGIN in 0.750 seconds
[0m16:24:41.133178 [debug] [Thread-4 (]: SQL status: BEGIN in 0.751 seconds
[0m16:24:41.134129 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:24:41.134918 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:24:41.135637 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_ohwk"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_ohwk"."dbt"."events_clean"
    left join "dev_ohwk"."dbt"."event_types"
        using (type_id)
  );
[0m16:24:41.136340 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  create view "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
    
    
  as (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
[0m16:24:41.280019 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.143 seconds
[0m16:24:41.287539 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.150 seconds
[0m16:24:41.287898 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:24:41.291053 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:24:41.291587 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m16:24:41.291978 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m16:24:41.344188 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.052 seconds
[0m16:24:41.349938 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:24:41.350676 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m16:24:41.362618 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.070 seconds
[0m16:24:41.366092 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m16:24:41.366817 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:24:41.367432 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m16:24:41.416967 [debug] [Thread-1 (]: SQL status: BEGIN in 3.224 seconds
[0m16:24:41.417967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:24:41.418493 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.067 seconds
[0m16:24:41.419067 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  create view "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp"
    
    
  as (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
where
    st_intersects(st_transform(t.start_point, 3857), hex.geom)
group by
    1
  );
[0m16:24:41.421830 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m16:24:41.422341 [debug] [Thread-4 (]: SQL status: COMMIT in 0.054 seconds
[0m16:24:41.423059 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:24:41.426501 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m16:24:41.427086 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m16:24:41.427941 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m16:24:41.428503 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop view if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m16:24:41.592601 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.163 seconds
[0m16:24:41.593927 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.171 seconds
[0m16:24:41.594533 [debug] [Thread-3 (]: SQL status: COMMIT in 0.166 seconds
[0m16:24:41.597093 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: Close
[0m16:24:41.601940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:24:41.605612 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."events_full__dbt_backup"
[0m16:24:41.606232 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m16:24:41.606988 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25b470>]}
[0m16:24:41.607623 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m16:24:41.608670 [info ] [Thread-4 (]: 10 of 17 OK created sql view model dbt.companies_trips ......................... [[32mCREATE VIEW[0m in 1.24s]
[0m16:24:41.609137 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_ohwk"."dbt"."events_full__dbt_backup" cascade
[0m16:24:41.609789 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies_trips
[0m16:24:41.610552 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat
[0m16:24:41.611237 [info ] [Thread-4 (]: 12 of 17 START sql view model dbt.trips_stat ................................... [RUN]
[0m16:24:41.611756 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_stat)
[0m16:24:41.612120 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat
[0m16:24:41.614938 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m16:24:41.615733 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat
[0m16:24:41.618492 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m16:24:41.619136 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:24:41.619435 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m16:24:41.619780 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:24:41.715330 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.107 seconds
[0m16:24:41.719690 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m16:24:41.720430 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.110 seconds
[0m16:24:41.721103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:24:41.723209 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: Close
[0m16:24:41.723706 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m16:24:41.724953 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3641d0>]}
[0m16:24:41.725874 [info ] [Thread-3 (]: 9 of 17 OK created sql view model dbt.events_full .............................. [[32mCREATE VIEW[0m in 1.36s]
[0m16:24:41.726587 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_full
[0m16:24:41.727074 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_users
[0m16:24:41.727676 [info ] [Thread-3 (]: 13 of 17 START sql incremental model dbt.trips_users ........................... [RUN]
[0m16:24:41.728370 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_users)
[0m16:24:41.728768 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_users
[0m16:24:41.733167 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m16:24:41.734051 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_users
[0m16:24:41.737411 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:41.737799 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp162441736046"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age
from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m16:24:41.738144 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:24:41.798606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.074 seconds
[0m16:24:41.803811 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_start_stat__dbt_backup"
[0m16:24:41.804673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m16:24:41.805214 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop view if exists "dev_ohwk"."dbt"."parking_start_stat__dbt_backup" cascade
[0m16:24:41.865007 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.059 seconds
[0m16:24:41.868956 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m16:24:41.870854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3652b0>]}
[0m16:24:41.872185 [info ] [Thread-1 (]: 8 of 17 OK created sql view model dbt.parking_start_stat ....................... [[32mCREATE VIEW[0m in 3.69s]
[0m16:24:41.873144 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m16:24:41.873876 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_stat
[0m16:24:41.874754 [info ] [Thread-1 (]: 14 of 17 START sql view model dbt.events_stat .................................. [RUN]
[0m16:24:41.875461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.events_stat)
[0m16:24:41.875980 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_stat
[0m16:24:41.880509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m16:24:41.881901 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_stat
[0m16:24:41.886486 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m16:24:41.887487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:24:41.887856 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: BEGIN
[0m16:24:41.888151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:42.590961 [debug] [Thread-2 (]: SQL status: SELECT 3 in 2.160 seconds
[0m16:24:42.597310 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:42.598439 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:24:42.657093 [debug] [Thread-2 (]: SQL status: BEGIN in 0.057 seconds
[0m16:24:42.657837 [debug] [Thread-4 (]: SQL status: BEGIN in 1.038 seconds
[0m16:24:42.658329 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:42.659069 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:24:42.659699 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp162440428318'
        
      order by ordinal_position

  
[0m16:24:42.660214 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  create view "dev_ohwk"."dbt"."trips_stat__dbt_tmp"
    
    
  as (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_ohwk"."dbt"."trips_prep"
  );
[0m16:24:42.745229 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.084 seconds
[0m16:24:42.746647 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.086 seconds
[0m16:24:42.752255 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:42.757475 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:24:42.758055 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:42.758546 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m16:24:42.824668 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m16:24:42.825814 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.067 seconds
[0m16:24:42.828230 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m16:24:42.833171 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:42.833896 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:24:42.834428 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:42.834876 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m16:24:42.992545 [debug] [Thread-4 (]: SQL status: COMMIT in 0.157 seconds
[0m16:24:42.993666 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.158 seconds
[0m16:24:42.996933 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat__dbt_backup"
[0m16:24:42.999728 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:24:43.000814 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m16:24:43.001571 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop view if exists "dev_ohwk"."dbt"."trips_stat__dbt_backup" cascade
[0m16:24:43.002768 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:43.003238 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp162440428318"
    )


  
[0m16:24:43.092188 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.088 seconds
[0m16:24:43.093447 [debug] [Thread-3 (]: SQL status: SELECT 0 in 1.355 seconds
[0m16:24:43.096735 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.095 seconds
[0m16:24:43.100066 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:24:43.104187 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:43.105809 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: Close
[0m16:24:43.106314 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:24:43.106796 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: BEGIN
[0m16:24:43.107321 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:24:43.108148 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a2330>]}
[0m16:24:43.109109 [info ] [Thread-4 (]: 12 of 17 OK created sql view model dbt.trips_stat .............................. [[32mCREATE VIEW[0m in 1.50s]
[0m16:24:43.109802 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat
[0m16:24:43.170285 [debug] [Thread-2 (]: SQL status: COMMIT in 0.061 seconds
[0m16:24:43.171151 [debug] [Thread-3 (]: SQL status: BEGIN in 0.063 seconds
[0m16:24:43.172562 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:24:43.173033 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:43.173520 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp162441736046'
        
      order by ordinal_position

  
[0m16:24:43.174173 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ab230>]}
[0m16:24:43.174989 [info ] [Thread-2 (]: 11 of 17 OK created sql incremental model dbt.revenue_daily .................... [[32mINSERT 0 3[0m in 2.75s]
[0m16:24:43.175648 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:24:43.389021 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.214 seconds
[0m16:24:43.395940 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:43.396713 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:43.462334 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.064 seconds
[0m16:24:43.470039 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:43.470868 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:24:43.534216 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.062 seconds
[0m16:24:43.538337 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m16:24:43.540250 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:43.541012 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age"
        from "trips_users__dbt_tmp162441736046"
    )


  
[0m16:24:43.601739 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.060 seconds
[0m16:24:43.605369 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m16:24:43.605946 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m16:24:43.606441 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m16:24:43.670134 [debug] [Thread-3 (]: SQL status: COMMIT in 0.063 seconds
[0m16:24:43.672494 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: Close
[0m16:24:43.674141 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a31d0>]}
[0m16:24:43.675430 [info ] [Thread-3 (]: 13 of 17 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 1.95s]
[0m16:24:43.676335 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_users
[0m16:24:43.677231 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m16:24:43.677867 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_daily
[0m16:24:43.678619 [info ] [Thread-2 (]: 16 of 17 START sql view model dbt.trips_age_group .............................. [RUN]
[0m16:24:43.679523 [info ] [Thread-4 (]: 15 of 17 START sql view model dbt.trips_age_daily .............................. [RUN]
[0m16:24:43.680367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_age_group)
[0m16:24:43.680969 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_age_daily)
[0m16:24:43.681503 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m16:24:43.682005 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m16:24:43.686609 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m16:24:43.689919 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m16:24:43.691498 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m16:24:43.691999 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m16:24:43.695707 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m16:24:43.698084 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m16:24:43.698702 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:24:43.699024 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:24:43.699292 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m16:24:43.699546 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m16:24:43.699796 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:24:43.700052 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:24:43.820847 [debug] [Thread-1 (]: SQL status: BEGIN in 1.932 seconds
[0m16:24:43.822255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:24:43.822896 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  create view "dev_ohwk"."dbt"."events_stat__dbt_tmp"
    
    
  as (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_ohwk"."dbt"."events_full"
  );
[0m16:24:43.895342 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.071 seconds
[0m16:24:43.902915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:24:43.903467 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_ohwk"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m16:24:43.966816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.062 seconds
[0m16:24:43.970655 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: COMMIT
[0m16:24:43.971441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:24:43.971999 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: COMMIT
[0m16:24:44.033820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.061 seconds
[0m16:24:44.039211 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."events_stat__dbt_backup"
[0m16:24:44.040251 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m16:24:44.040810 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop view if exists "dev_ohwk"."dbt"."events_stat__dbt_backup" cascade
[0m16:24:44.101923 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.060 seconds
[0m16:24:44.105180 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: Close
[0m16:24:44.106695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a0950>]}
[0m16:24:44.108196 [info ] [Thread-1 (]: 14 of 17 OK created sql view model dbt.events_stat ............................. [[32mCREATE VIEW[0m in 2.23s]
[0m16:24:44.109219 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_stat
[0m16:24:44.406667 [debug] [Thread-4 (]: SQL status: BEGIN in 0.706 seconds
[0m16:24:44.407926 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:24:44.409182 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  create view "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp"
    
    
  as (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users"
group by
    1,
    2
  );
[0m16:24:44.414743 [debug] [Thread-2 (]: SQL status: BEGIN in 0.715 seconds
[0m16:24:44.415342 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:24:44.415948 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  create view "dev_ohwk"."dbt"."trips_age_group__dbt_tmp"
    
    
  as (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users" as tu
    cross join "dev_ohwk"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
[0m16:24:44.467559 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.057 seconds
[0m16:24:44.472905 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:24:44.473429 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.057 seconds
[0m16:24:44.473925 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m16:24:44.485072 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:24:44.485667 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m16:24:44.530479 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m16:24:44.535327 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:24:44.535845 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.050 seconds
[0m16:24:44.536265 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m16:24:44.539336 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:24:44.539864 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m16:24:44.583647 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m16:24:44.587569 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m16:24:44.588228 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m16:24:44.588882 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:24:44.591064 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m16:24:44.591768 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m16:24:44.592347 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:24:44.592883 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m16:24:44.637955 [debug] [Thread-4 (]: SQL status: COMMIT in 0.045 seconds
[0m16:24:44.643022 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily__dbt_backup"
[0m16:24:44.643420 [debug] [Thread-2 (]: SQL status: COMMIT in 0.050 seconds
[0m16:24:44.644342 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m16:24:44.647444 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_group__dbt_backup"
[0m16:24:44.647932 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_daily__dbt_backup" cascade
[0m16:24:44.648757 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m16:24:44.649263 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_group__dbt_backup" cascade
[0m16:24:44.696682 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.047 seconds
[0m16:24:44.700397 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: Close
[0m16:24:44.701046 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.051 seconds
[0m16:24:44.703229 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m16:24:44.704178 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ffd7f0>]}
[0m16:24:44.705880 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25b950>]}
[0m16:24:44.705176 [info ] [Thread-4 (]: 15 of 17 OK created sql view model dbt.trips_age_daily ......................... [[32mCREATE VIEW[0m in 1.02s]
[0m16:24:44.706841 [info ] [Thread-2 (]: 16 of 17 OK created sql view model dbt.trips_age_group ......................... [[32mCREATE VIEW[0m in 1.03s]
[0m16:24:44.707607 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m16:24:44.708227 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m16:24:44.708946 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m16:24:44.709489 [info ] [Thread-3 (]: 17 of 17 START sql view model dbt.trips_age_daily_stat ......................... [RUN]
[0m16:24:44.709951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily_stat)
[0m16:24:44.710304 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m16:24:44.714693 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:44.715625 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m16:24:44.718945 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:44.719591 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:44.719897 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m16:24:44.720170 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:24:45.859959 [debug] [Thread-3 (]: SQL status: BEGIN in 1.140 seconds
[0m16:24:45.860267 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:45.860486 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  create view "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp"
    
    
  as (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_ohwk"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
[0m16:24:45.984277 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.123 seconds
[0m16:24:45.988405 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:45.988897 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m16:24:46.212208 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.223 seconds
[0m16:24:46.213511 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m16:24:46.213803 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:46.214024 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m16:24:46.411146 [debug] [Thread-3 (]: SQL status: COMMIT in 0.196 seconds
[0m16:24:46.417316 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup"
[0m16:24:46.418424 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m16:24:46.419103 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m16:24:46.524605 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.104 seconds
[0m16:24:46.527019 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m16:24:46.528243 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7afc0209-06f2-40a5-89d4-e232bd76bbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc8650>]}
[0m16:24:46.529099 [info ] [Thread-3 (]: 17 of 17 OK created sql view model dbt.trips_age_daily_stat .................... [[32mCREATE VIEW[0m in 1.82s]
[0m16:24:46.529970 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m16:24:46.532582 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:46.533210 [debug] [MainThread]: On master: BEGIN
[0m16:24:46.533641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:48.251377 [debug] [MainThread]: SQL status: BEGIN in 1.718 seconds
[0m16:24:48.252405 [debug] [MainThread]: On master: COMMIT
[0m16:24:48.253085 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:48.253635 [debug] [MainThread]: On master: COMMIT
[0m16:24:48.323728 [debug] [MainThread]: SQL status: COMMIT in 0.070 seconds
[0m16:24:48.324561 [debug] [MainThread]: On master: Close
[0m16:24:48.326076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:48.326514 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m16:24:48.326924 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m16:24:48.327249 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m16:24:48.327566 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m16:24:48.328117 [info ] [MainThread]: 
[0m16:24:48.328602 [info ] [MainThread]: Finished running 4 incremental models, 13 view models in 0 hours 0 minutes and 18.74 seconds (18.74s).
[0m16:24:48.332214 [debug] [MainThread]: Command end result
[0m16:24:48.360358 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:24:48.361755 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:24:48.366216 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:24:48.366415 [info ] [MainThread]: 
[0m16:24:48.366636 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:48.366810 [info ] [MainThread]: 
[0m16:24:48.366984 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=17
[0m16:24:48.368363 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.033909, "process_in_blocks": "0", "process_kernel_time": 0.232934, "process_mem_max_rss": "138330112", "process_out_blocks": "0", "process_user_time": 1.745579}
[0m16:24:48.368705 [debug] [MainThread]: Command `dbt run` succeeded at 16:24:48.368639 after 19.03 seconds
[0m16:24:48.368943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad4bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a44fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a44fdd0>]}
[0m16:24:48.369167 [debug] [MainThread]: Flushing usage events
[0m16:24:49.290814 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:18.015357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879bb10>]}


============================== 16:25:18.017328 | 7454961c-a9f4-4d01-a4a2-ac5e0dde2859 ==============================
[0m16:25:18.017328 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:25:18.017594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:25:18.082094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa3490>]}
[0m16:25:18.104085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108636be0>]}
[0m16:25:18.104537 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:25:18.140602 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m16:25:18.177457 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:25:18.177694 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m16:25:18.177848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109604250>]}
[0m16:25:18.665768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109616120>]}
[0m16:25:18.697811 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:25:18.698759 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:25:18.704895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e63850>]}
[0m16:25:18.705110 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:25:18.705274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095dd7e0>]}
[0m16:25:18.706165 [info ] [MainThread]: 
[0m16:25:18.706331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:25:18.706493 [info ] [MainThread]: 
[0m16:25:18.706736 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:25:18.707105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:25:18.737619 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:25:18.737826 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:25:18.737931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:20.284982 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.547 seconds
[0m16:25:20.286861 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:25:20.292913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:25:20.297874 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:25:20.298183 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:25:20.298395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:20.974541 [debug] [ThreadPool]: SQL status: BEGIN in 0.675 seconds
[0m16:25:20.976071 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:25:20.976739 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:25:21.053977 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.076 seconds
[0m16:25:21.057463 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:25:21.103161 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:25:21.112511 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:21.112920 [debug] [MainThread]: On master: BEGIN
[0m16:25:21.113158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:22.191509 [debug] [MainThread]: SQL status: BEGIN in 1.078 seconds
[0m16:25:22.192581 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:22.193209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:25:22.397292 [debug] [MainThread]: SQL status: SELECT 17 in 0.203 seconds
[0m16:25:22.405477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109487c50>]}
[0m16:25:22.406420 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:22.470076 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:22.471078 [debug] [MainThread]: On master: BEGIN
[0m16:25:22.657111 [debug] [MainThread]: SQL status: BEGIN in 0.185 seconds
[0m16:25:22.658312 [debug] [MainThread]: On master: COMMIT
[0m16:25:22.659049 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:22.659639 [debug] [MainThread]: On master: COMMIT
[0m16:25:22.723710 [debug] [MainThread]: SQL status: COMMIT in 0.063 seconds
[0m16:25:22.724955 [debug] [MainThread]: On master: Close
[0m16:25:22.731255 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:25:22.732344 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:25:22.733357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:25:22.734008 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:25:22.745603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:25:22.746612 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:25:22.781399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:22.781713 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp162522768622"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:25:22.781897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:24.476740 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.695 seconds
[0m16:25:24.494656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:24.495275 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:25:24.540579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m16:25:24.541369 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:24.541749 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp162522768622'
        
      order by ordinal_position

  
[0m16:25:24.602988 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.061 seconds
[0m16:25:24.608937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:24.609450 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:25:24.658330 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.048 seconds
[0m16:25:24.671214 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:24.672020 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:25:24.721463 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.049 seconds
[0m16:25:24.734151 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:25:24.734954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:24.735314 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp162522768622"
    )


  
[0m16:25:24.782015 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.046 seconds
[0m16:25:24.797024 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:25:24.797412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:25:24.797675 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:25:24.847162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m16:25:24.848496 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:25:24.849651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7454961c-a9f4-4d01-a4a2-ac5e0dde2859', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099aedb0>]}
[0m16:25:24.850103 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 2.12s]
[0m16:25:24.850793 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:25:24.851683 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:24.851872 [debug] [MainThread]: On master: BEGIN
[0m16:25:24.852014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:26.440705 [debug] [MainThread]: SQL status: BEGIN in 1.589 seconds
[0m16:25:26.441456 [debug] [MainThread]: On master: COMMIT
[0m16:25:26.441950 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:26.442308 [debug] [MainThread]: On master: COMMIT
[0m16:25:26.506175 [debug] [MainThread]: SQL status: COMMIT in 0.063 seconds
[0m16:25:26.506674 [debug] [MainThread]: On master: Close
[0m16:25:26.507312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:26.507591 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:25:26.507899 [info ] [MainThread]: 
[0m16:25:26.508222 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.80 seconds (7.80s).
[0m16:25:26.509279 [debug] [MainThread]: Command end result
[0m16:25:26.539327 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:25:26.540818 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:25:26.544820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:25:26.545010 [info ] [MainThread]: 
[0m16:25:26.545229 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:26.545390 [info ] [MainThread]: 
[0m16:25:26.545592 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:25:26.546690 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.558575, "process_in_blocks": "0", "process_kernel_time": 0.130135, "process_mem_max_rss": "146489344", "process_out_blocks": "0", "process_user_time": 1.407664}
[0m16:25:26.547054 [debug] [MainThread]: Command `cli run` succeeded at 16:25:26.546974 after 8.56 seconds
[0m16:25:26.547305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d54410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109447410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064070d0>]}
[0m16:25:26.547542 [debug] [MainThread]: Flushing usage events
[0m16:25:27.157200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:28:48.361112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056bf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb7b10>]}


============================== 16:28:48.363561 | e1660d4a-5445-46c6-92c3-dda2f39cbbba ==============================
[0m16:28:48.363561 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:28:48.363822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s revenue_daily', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:28:48.429759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebb490>]}
[0m16:28:48.450993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4e030>]}
[0m16:28:48.451685 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:28:48.488333 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:28:48.540029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:28:48.540216 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:28:48.557244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782f450>]}
[0m16:28:48.591317 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:28:48.592497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:28:48.602343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c359a0>]}
[0m16:28:48.602556 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:28:48.602703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e33f0>]}
[0m16:28:48.603398 [info ] [MainThread]: 
[0m16:28:48.603537 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:28:48.603645 [info ] [MainThread]: 
[0m16:28:48.603845 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:28:48.604203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:28:48.625907 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:28:48.626138 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:28:48.626267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:49.853826 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.227 seconds
[0m16:28:49.855961 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:28:49.861962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:28:49.866982 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:28:49.867278 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:28:49.867495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:50.589532 [debug] [ThreadPool]: SQL status: BEGIN in 0.722 seconds
[0m16:28:50.591236 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:28:50.592365 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:28:50.649657 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.056 seconds
[0m16:28:50.653981 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:28:50.706278 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:28:50.720994 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:50.721464 [debug] [MainThread]: On master: BEGIN
[0m16:28:50.721790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:51.370920 [debug] [MainThread]: SQL status: BEGIN in 0.649 seconds
[0m16:28:51.372327 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:51.373677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:28:51.476137 [debug] [MainThread]: SQL status: SELECT 17 in 0.101 seconds
[0m16:28:51.484490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c61bf0>]}
[0m16:28:51.485445 [debug] [MainThread]: On master: ROLLBACK
[0m16:28:51.534932 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:51.536717 [debug] [MainThread]: On master: BEGIN
[0m16:28:51.645640 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m16:28:51.647018 [debug] [MainThread]: On master: COMMIT
[0m16:28:51.647766 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:51.648368 [debug] [MainThread]: On master: COMMIT
[0m16:28:51.692044 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m16:28:51.693249 [debug] [MainThread]: On master: Close
[0m16:28:51.699868 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:28:51.700542 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:28:51.701162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:28:51.701765 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:28:51.717924 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:28:51.718794 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:28:51.753772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:51.754090 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp162851741158"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:28:51.754272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:54.279128 [debug] [Thread-1 (]: SQL status: SELECT 3 in 2.525 seconds
[0m16:28:54.302959 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:54.303558 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:28:54.374033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m16:28:54.375087 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:54.375726 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp162851741158'
        
      order by ordinal_position

  
[0m16:28:54.453124 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.077 seconds
[0m16:28:54.463274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:54.464079 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:28:54.514570 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.050 seconds
[0m16:28:54.526476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:54.527021 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:28:54.613769 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.086 seconds
[0m16:28:54.631305 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:28:54.632679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:54.633093 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp162851741158"
    )


  
[0m16:28:54.685522 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.052 seconds
[0m16:28:54.703694 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:28:54.704269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:28:54.704651 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:28:54.777044 [debug] [Thread-1 (]: SQL status: COMMIT in 0.072 seconds
[0m16:28:54.778431 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:28:54.780478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1660d4a-5445-46c6-92c3-dda2f39cbbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e981d0>]}
[0m16:28:54.780934 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 3.08s]
[0m16:28:54.781332 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:28:54.782303 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:54.782577 [debug] [MainThread]: On master: BEGIN
[0m16:28:54.782778 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:28:56.397275 [debug] [MainThread]: SQL status: BEGIN in 1.614 seconds
[0m16:28:56.398384 [debug] [MainThread]: On master: COMMIT
[0m16:28:56.399040 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:56.399470 [debug] [MainThread]: On master: COMMIT
[0m16:28:56.478715 [debug] [MainThread]: SQL status: COMMIT in 0.079 seconds
[0m16:28:56.479418 [debug] [MainThread]: On master: Close
[0m16:28:56.480249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:56.480568 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:28:56.481197 [info ] [MainThread]: 
[0m16:28:56.481882 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m16:28:56.482991 [debug] [MainThread]: Command end result
[0m16:28:56.551598 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:28:56.552687 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:28:56.555437 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:28:56.555583 [info ] [MainThread]: 
[0m16:28:56.555763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:56.555884 [info ] [MainThread]: 
[0m16:28:56.556027 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:28:56.558000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.224507, "process_in_blocks": "0", "process_kernel_time": 0.145747, "process_mem_max_rss": "137297920", "process_out_blocks": "0", "process_user_time": 1.02418}
[0m16:28:56.558203 [debug] [MainThread]: Command `dbt run` succeeded at 16:28:56.558162 after 8.22 seconds
[0m16:28:56.558364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107239d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107239e50>]}
[0m16:28:56.558515 [debug] [MainThread]: Flushing usage events
[0m16:28:57.803774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:48.323641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111727b10>]}


============================== 16:30:48.326172 | be3252d8-c7b4-4b5e-b322-da40a85b61d9 ==============================
[0m16:30:48.326172 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:30:48.326443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s revenue_ddaiily', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:30:48.394086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be3252d8-c7b4-4b5e-b322-da40a85b61d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11052b490>]}
[0m16:30:48.415874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be3252d8-c7b4-4b5e-b322-da40a85b61d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114be030>]}
[0m16:30:48.416482 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:30:48.453092 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:30:48.497470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:30:48.497657 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:30:48.516866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be3252d8-c7b4-4b5e-b322-da40a85b61d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121db450>]}
[0m16:30:48.550101 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:30:48.551299 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:30:48.561445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be3252d8-c7b4-4b5e-b322-da40a85b61d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117a59a0>]}
[0m16:30:48.561634 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:30:48.561777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be3252d8-c7b4-4b5e-b322-da40a85b61d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b38910>]}
[0m16:30:48.562066 [warn ] [MainThread]: The selection criterion 'revenue_ddaiily' does not match any enabled nodes
[0m16:30:48.562570 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:30:48.563349 [debug] [MainThread]: Command end result
[0m16:30:48.573663 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:30:48.574560 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:30:48.575955 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:30:48.576852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.28060505, "process_in_blocks": "0", "process_kernel_time": 0.105406, "process_mem_max_rss": "119668736", "process_out_blocks": "0", "process_user_time": 0.711622}
[0m16:30:48.577040 [debug] [MainThread]: Command `dbt run` succeeded at 16:30:48.577003 after 0.28 seconds
[0m16:30:48.577190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117c1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111504dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112452450>]}
[0m16:30:48.577321 [debug] [MainThread]: Flushing usage events
[0m16:30:50.521967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:14.673296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053234d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681bb10>]}


============================== 16:31:14.675005 | d549dd18-d1ea-4635-99cd-b3acf5b8ce9e ==============================
[0m16:31:14.675005 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:31:14.675266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s revenue_daily', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:14.738203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1b490>]}
[0m16:31:14.759214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b2030>]}
[0m16:31:14.759590 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:31:14.793461 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:31:14.840345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:14.840522 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:14.859828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107497450>]}
[0m16:31:14.893605 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:31:14.894484 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:31:14.900747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068999a0>]}
[0m16:31:14.900953 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:31:14.901105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df8910>]}
[0m16:31:14.901824 [info ] [MainThread]: 
[0m16:31:14.901971 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:31:14.902078 [info ] [MainThread]: 
[0m16:31:14.902273 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:14.902652 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:31:14.924954 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:31:14.925153 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:31:14.925264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:15.863849 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.938 seconds
[0m16:31:15.865282 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:31:15.870218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:31:15.874683 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:31:15.874919 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:31:15.875094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:18.304417 [debug] [ThreadPool]: SQL status: BEGIN in 2.429 seconds
[0m16:31:18.305175 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:31:18.305625 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:31:18.372753 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.066 seconds
[0m16:31:18.375947 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:31:18.440937 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:31:18.455206 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:18.455752 [debug] [MainThread]: On master: BEGIN
[0m16:31:18.456157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:19.314444 [debug] [MainThread]: SQL status: BEGIN in 0.858 seconds
[0m16:31:19.315971 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:19.317117 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:31:19.382704 [debug] [MainThread]: SQL status: SELECT 17 in 0.065 seconds
[0m16:31:19.391752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fec30>]}
[0m16:31:19.392651 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:19.456361 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:19.457756 [debug] [MainThread]: On master: BEGIN
[0m16:31:19.685409 [debug] [MainThread]: SQL status: BEGIN in 0.226 seconds
[0m16:31:19.686901 [debug] [MainThread]: On master: COMMIT
[0m16:31:19.687879 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:19.688393 [debug] [MainThread]: On master: COMMIT
[0m16:31:19.754800 [debug] [MainThread]: SQL status: COMMIT in 0.066 seconds
[0m16:31:19.755619 [debug] [MainThread]: On master: Close
[0m16:31:19.763596 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:31:19.764563 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:31:19.765324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:31:19.765863 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:31:19.782322 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:31:19.783219 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:31:19.817022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:19.817301 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp163119804473"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:31:19.817480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:20.901294 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.084 seconds
[0m16:31:20.916175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:20.916624 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:31:20.980258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m16:31:20.981317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:20.982130 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp163119804473'
        
      order by ordinal_position

  
[0m16:31:21.086709 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.104 seconds
[0m16:31:21.090416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:21.090745 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:31:21.140786 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.050 seconds
[0m16:31:21.147044 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:21.147339 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:31:21.206936 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.059 seconds
[0m16:31:21.222907 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:31:21.223742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:21.224065 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp163119804473" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp163119804473"
    )
  
[0m16:31:21.275032 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.050 seconds
[0m16:31:21.287894 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:31:21.288295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:31:21.288542 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:31:21.394078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.104 seconds
[0m16:31:21.399350 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:31:21.403548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd549dd18-d1ea-4635-99cd-b3acf5b8ce9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b80350>]}
[0m16:31:21.404371 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 1.64s]
[0m16:31:21.405024 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:31:21.406452 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:21.406847 [debug] [MainThread]: On master: BEGIN
[0m16:31:21.407140 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:22.514657 [debug] [MainThread]: SQL status: BEGIN in 1.107 seconds
[0m16:31:22.515624 [debug] [MainThread]: On master: COMMIT
[0m16:31:22.516148 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:22.516580 [debug] [MainThread]: On master: COMMIT
[0m16:31:22.581491 [debug] [MainThread]: SQL status: COMMIT in 0.064 seconds
[0m16:31:22.582612 [debug] [MainThread]: On master: Close
[0m16:31:22.583839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:22.584385 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:31:22.585111 [info ] [MainThread]: 
[0m16:31:22.585640 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.68 seconds (7.68s).
[0m16:31:22.586520 [debug] [MainThread]: Command end result
[0m16:31:22.662834 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:31:22.663884 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:31:22.666498 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:31:22.666636 [info ] [MainThread]: 
[0m16:31:22.666805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:22.666920 [info ] [MainThread]: 
[0m16:31:22.667045 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:31:22.667801 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.020097, "process_in_blocks": "0", "process_kernel_time": 0.12987, "process_mem_max_rss": "136560640", "process_out_blocks": "0", "process_user_time": 1.01102}
[0m16:31:22.667992 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:22.667955 after 8.02 seconds
[0m16:31:22.668154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9de50>]}
[0m16:31:22.668295 [debug] [MainThread]: Flushing usage events
[0m16:31:23.316698 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:37.295660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705bb10>]}


============================== 16:38:37.298085 | fb724f97-1ac7-49b2-b859-e99f6116665f ==============================
[0m16:38:37.298085 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:38:37.298344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s revenue_daily', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:38:37.363837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635f490>]}
[0m16:38:37.384626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef2030>]}
[0m16:38:37.385320 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:38:37.422623 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:38:37.474996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:37.475174 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:37.494277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdb450>]}
[0m16:38:37.527541 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:38:37.528603 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:38:37.538309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d99a0>]}
[0m16:38:37.538519 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:38:37.538667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107638910>]}
[0m16:38:37.539391 [info ] [MainThread]: 
[0m16:38:37.539534 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:37.539643 [info ] [MainThread]: 
[0m16:38:37.539845 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:38:37.540202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:38:37.561832 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:38:37.562057 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:38:37.562188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:38.539344 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.977 seconds
[0m16:38:38.543324 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:38:38.551388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:38:38.557468 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:38:38.557828 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:38:38.558061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:39.395603 [debug] [ThreadPool]: SQL status: BEGIN in 0.837 seconds
[0m16:38:39.396458 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:38:39.396924 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:38:39.489565 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.092 seconds
[0m16:38:39.490996 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:38:39.532847 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:38:39.538492 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:39.538720 [debug] [MainThread]: On master: BEGIN
[0m16:38:39.538877 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:40.208912 [debug] [MainThread]: SQL status: BEGIN in 0.670 seconds
[0m16:38:40.210570 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:40.211623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:38:40.275439 [debug] [MainThread]: SQL status: SELECT 17 in 0.063 seconds
[0m16:38:40.284201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10813ac30>]}
[0m16:38:40.285026 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:40.335840 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:40.337096 [debug] [MainThread]: On master: BEGIN
[0m16:38:40.435530 [debug] [MainThread]: SQL status: BEGIN in 0.097 seconds
[0m16:38:40.436828 [debug] [MainThread]: On master: COMMIT
[0m16:38:40.437276 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:40.437707 [debug] [MainThread]: On master: COMMIT
[0m16:38:40.483346 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m16:38:40.484154 [debug] [MainThread]: On master: Close
[0m16:38:40.491139 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:38:40.492144 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:38:40.492967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:38:40.493493 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:38:40.509855 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:38:40.510753 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:38:40.538499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:40.538787 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp163840527068"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:38:40.538975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:42.177712 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.638 seconds
[0m16:38:42.198503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:42.198953 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:38:42.242918 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m16:38:42.243688 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:42.244194 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp163840527068'
        
      order by ordinal_position

  
[0m16:38:42.309281 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.064 seconds
[0m16:38:42.318961 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:42.319512 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:38:42.373656 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.053 seconds
[0m16:38:42.385281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:42.385765 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:38:42.436202 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.050 seconds
[0m16:38:42.456998 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:38:42.457967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:42.458339 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp163840527068" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp163840527068"
    )
  
[0m16:38:42.502539 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.044 seconds
[0m16:38:42.519698 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:38:42.520009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:38:42.520251 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:38:42.564380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.044 seconds
[0m16:38:42.567668 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:38:42.570828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb724f97-1ac7-49b2-b859-e99f6116665f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c0350>]}
[0m16:38:42.571574 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 2.08s]
[0m16:38:42.572212 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:38:42.573521 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:42.573817 [debug] [MainThread]: On master: BEGIN
[0m16:38:42.574064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:43.259718 [debug] [MainThread]: SQL status: BEGIN in 0.685 seconds
[0m16:38:43.260661 [debug] [MainThread]: On master: COMMIT
[0m16:38:43.261145 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:43.261908 [debug] [MainThread]: On master: COMMIT
[0m16:38:43.306144 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m16:38:43.307303 [debug] [MainThread]: On master: Close
[0m16:38:43.309081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:43.309602 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:38:43.310164 [info ] [MainThread]: 
[0m16:38:43.310780 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m16:38:43.311987 [debug] [MainThread]: Command end result
[0m16:38:43.374521 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:38:43.375609 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:38:43.378435 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:38:43.378580 [info ] [MainThread]: 
[0m16:38:43.378757 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:43.378886 [info ] [MainThread]: 
[0m16:38:43.379022 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:38:43.380403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1114373, "process_in_blocks": "0", "process_kernel_time": 0.140209, "process_mem_max_rss": "136265728", "process_out_blocks": "0", "process_user_time": 0.99446}
[0m16:38:43.380634 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:43.380590 after 6.11 seconds
[0m16:38:43.380810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10818d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ddd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076dde50>]}
[0m16:38:43.380972 [debug] [MainThread]: Flushing usage events
[0m16:38:44.074821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:41.440338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d27b10>]}


============================== 16:39:41.442816 | cb657d32-ffa5-491b-91d3-b754d1141ae2 ==============================
[0m16:39:41.442816 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:39:41.443087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s revenue_daily', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:39:41.509988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c2b490>]}
[0m16:39:41.531686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113abe030>]}
[0m16:39:41.532403 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:39:41.568745 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:39:41.613097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:41.613284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:41.632276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11470b450>]}
[0m16:39:41.665393 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:39:41.666502 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:39:41.676568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113da59a0>]}
[0m16:39:41.676776 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:39:41.676924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fa4910>]}
[0m16:39:41.677641 [info ] [MainThread]: 
[0m16:39:41.677778 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:39:41.677888 [info ] [MainThread]: 
[0m16:39:41.678079 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:41.678432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:39:41.699147 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:39:41.699339 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:39:41.699451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:42.344526 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.645 seconds
[0m16:39:42.347909 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:39:42.356315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:39:42.363156 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:39:42.363600 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:39:42.363850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:43.873411 [debug] [ThreadPool]: SQL status: BEGIN in 1.509 seconds
[0m16:39:43.874901 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:39:43.875913 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:39:43.922846 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.046 seconds
[0m16:39:43.925904 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:39:43.972731 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:39:43.986723 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:43.987214 [debug] [MainThread]: On master: BEGIN
[0m16:39:43.987540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:44.955545 [debug] [MainThread]: SQL status: BEGIN in 0.968 seconds
[0m16:39:44.956536 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:44.957068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:45.035897 [debug] [MainThread]: SQL status: SELECT 17 in 0.078 seconds
[0m16:39:45.044904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b6ac30>]}
[0m16:39:45.046108 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:45.092493 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:45.093896 [debug] [MainThread]: On master: BEGIN
[0m16:39:45.216657 [debug] [MainThread]: SQL status: BEGIN in 0.122 seconds
[0m16:39:45.217583 [debug] [MainThread]: On master: COMMIT
[0m16:39:45.218062 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:45.218435 [debug] [MainThread]: On master: COMMIT
[0m16:39:45.261886 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m16:39:45.263464 [debug] [MainThread]: On master: Close
[0m16:39:45.270819 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:39:45.271913 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:39:45.272740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:39:45.273319 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:39:45.289171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:39:45.290167 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:39:45.324486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:45.324754 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp163945311466"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date"
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2
order by
    2
  );
  
  
[0m16:39:45.324929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:46.168327 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.843 seconds
[0m16:39:46.190920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.191477 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:39:46.235706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m16:39:46.236691 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.237358 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp163945311466'
        
      order by ordinal_position

  
[0m16:39:46.292169 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.054 seconds
[0m16:39:46.304099 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.304896 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:39:46.388802 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.083 seconds
[0m16:39:46.409628 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.410126 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp163945311466'
        
      order by ordinal_position

  
[0m16:39:46.456998 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.046 seconds
[0m16:39:46.463439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.463901 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:39:46.509827 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.045 seconds
[0m16:39:46.524868 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:39:46.537064 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:39:46.537858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.538158 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp163945311466" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date")
    (
        select "revenue_rub", "date"
        from "revenue_daily__dbt_tmp163945311466"
    )
  
[0m16:39:46.583871 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.045 seconds
[0m16:39:46.596979 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:39:46.597311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:39:46.597555 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:39:46.656696 [debug] [Thread-1 (]: SQL status: COMMIT in 0.059 seconds
[0m16:39:46.661008 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:39:46.664613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb657d32-ffa5-491b-91d3-b754d1141ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e00350>]}
[0m16:39:46.665350 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 1.39s]
[0m16:39:46.665909 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:39:46.667238 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:46.667515 [debug] [MainThread]: On master: BEGIN
[0m16:39:46.667742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:47.464394 [debug] [MainThread]: SQL status: BEGIN in 0.796 seconds
[0m16:39:47.465609 [debug] [MainThread]: On master: COMMIT
[0m16:39:47.466404 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:47.467009 [debug] [MainThread]: On master: COMMIT
[0m16:39:47.511963 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m16:39:47.513041 [debug] [MainThread]: On master: Close
[0m16:39:47.514587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:47.515219 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:39:47.515867 [info ] [MainThread]: 
[0m16:39:47.516728 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m16:39:47.518821 [debug] [MainThread]: Command end result
[0m16:39:47.585673 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:39:47.586707 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:39:47.589397 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:39:47.589532 [info ] [MainThread]: 
[0m16:39:47.589702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:39:47.589819 [info ] [MainThread]: 
[0m16:39:47.589947 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:39:47.591421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.176956, "process_in_blocks": "0", "process_kernel_time": 0.144844, "process_mem_max_rss": "136888320", "process_out_blocks": "0", "process_user_time": 1.037071}
[0m16:39:47.591674 [debug] [MainThread]: Command `dbt run` succeeded at 16:39:47.591630 after 6.18 seconds
[0m16:39:47.591845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bbc680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114049d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114049e50>]}
[0m16:39:47.592001 [debug] [MainThread]: Flushing usage events
[0m16:39:48.155240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:01.399028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c774d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b027b10>]}


============================== 16:40:01.400791 | f4f811ba-c667-404e-96ad-cafb9c87c780 ==============================
[0m16:40:01.400791 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:40:01.401064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s revenue_daily', 'send_anonymous_usage_stats': 'True'}
[0m16:40:01.462503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109727490>]}
[0m16:40:01.483186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aebe030>]}
[0m16:40:01.483535 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:40:01.516774 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:40:01.561512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:01.561707 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:01.580287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbff450>]}
[0m16:40:01.612509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:40:01.613347 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:40:01.619259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a59a0>]}
[0m16:40:01.619456 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:40:01.619599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b55c910>]}
[0m16:40:01.620315 [info ] [MainThread]: 
[0m16:40:01.620469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:01.620579 [info ] [MainThread]: 
[0m16:40:01.620774 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:01.621134 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:40:01.640845 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:40:01.641040 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:40:01.641152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:02.400599 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.759 seconds
[0m16:40:02.403889 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:40:02.413084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:40:02.420857 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:40:02.421349 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:40:02.421674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:03.757805 [debug] [ThreadPool]: SQL status: BEGIN in 1.336 seconds
[0m16:40:03.758904 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:40:03.759461 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:40:03.806764 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.047 seconds
[0m16:40:03.811081 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:40:03.854389 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:40:03.869508 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:03.869976 [debug] [MainThread]: On master: BEGIN
[0m16:40:03.870298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:04.586890 [debug] [MainThread]: SQL status: BEGIN in 0.717 seconds
[0m16:40:04.587231 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:04.587529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:04.652259 [debug] [MainThread]: SQL status: SELECT 17 in 0.064 seconds
[0m16:40:04.658842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c05ec30>]}
[0m16:40:04.659432 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:04.704987 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:04.705822 [debug] [MainThread]: On master: BEGIN
[0m16:40:04.798337 [debug] [MainThread]: SQL status: BEGIN in 0.092 seconds
[0m16:40:04.799860 [debug] [MainThread]: On master: COMMIT
[0m16:40:04.800822 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:04.801243 [debug] [MainThread]: On master: COMMIT
[0m16:40:04.851088 [debug] [MainThread]: SQL status: COMMIT in 0.049 seconds
[0m16:40:04.852029 [debug] [MainThread]: On master: Close
[0m16:40:04.855236 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:40:04.855902 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:40:04.856419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:40:04.856800 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:40:04.869050 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:40:04.869768 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:40:04.900484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:04.900749 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp164004888632"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    now() at time zone 'utc' as updated_at
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m16:40:04.900915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:06.563092 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.662 seconds
[0m16:40:06.580459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.580986 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:40:06.624660 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m16:40:06.625608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.626394 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp164004888632'
        
      order by ordinal_position

  
[0m16:40:06.677800 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.050 seconds
[0m16:40:06.688614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.689320 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:40:06.762983 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.073 seconds
[0m16:40:06.784725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.785259 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp164004888632'
        
      order by ordinal_position

  
[0m16:40:06.839678 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.054 seconds
[0m16:40:06.846442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.846999 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m16:40:06.895934 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.048 seconds
[0m16:40:06.908229 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: [PostgresColumn(column='updated_at', dtype='timestamp without time zone', char_size=None, numeric_precision=None, numeric_scale=None)]
        Target columns not in source: []
        New column types: []
  
[0m16:40:06.918320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.918657 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    alter table "dev_ohwk"."dbt"."revenue_daily"

            
               add column "updated_at" timestamp without time zone
            

            
  
[0m16:40:06.961714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m16:40:06.962871 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: [PostgresColumn(column='updated_at', dtype='timestamp without time zone', char_size=None, numeric_precision=None, numeric_scale=None)]
        Columns removed: 
        Data types changed: 
  
[0m16:40:06.974123 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:40:06.974855 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:06.975138 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp164004888632" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp164004888632"
    )
  
[0m16:40:07.018294 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.043 seconds
[0m16:40:07.029623 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:40:07.029889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:40:07.030104 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:40:07.073420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m16:40:07.075211 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:40:07.077037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4f811ba-c667-404e-96ad-cafb9c87c780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2fc410>]}
[0m16:40:07.077651 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 2.22s]
[0m16:40:07.078178 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:40:07.079457 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:07.079724 [debug] [MainThread]: On master: BEGIN
[0m16:40:07.079966 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:07.768518 [debug] [MainThread]: SQL status: BEGIN in 0.688 seconds
[0m16:40:07.770065 [debug] [MainThread]: On master: COMMIT
[0m16:40:07.771219 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:07.771932 [debug] [MainThread]: On master: COMMIT
[0m16:40:07.814949 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m16:40:07.816102 [debug] [MainThread]: On master: Close
[0m16:40:07.817517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:07.818106 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:40:07.818749 [info ] [MainThread]: 
[0m16:40:07.819421 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.20 seconds (6.20s).
[0m16:40:07.820833 [debug] [MainThread]: Command end result
[0m16:40:07.885489 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:40:07.886569 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:40:07.889245 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:40:07.889387 [info ] [MainThread]: 
[0m16:40:07.889556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:07.889673 [info ] [MainThread]: 
[0m16:40:07.889802 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:40:07.890642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5163918, "process_in_blocks": "0", "process_kernel_time": 0.129864, "process_mem_max_rss": "137396224", "process_out_blocks": "0", "process_user_time": 1.024023}
[0m16:40:07.890829 [debug] [MainThread]: Command `dbt run` succeeded at 16:40:07.890791 after 6.52 seconds
[0m16:40:07.890996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b601d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b601e50>]}
[0m16:40:07.891146 [debug] [MainThread]: Flushing usage events
[0m16:40:08.671477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:50.523932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109827b10>]}


============================== 16:44:50.526477 | bc797b92-22f1-4d31-806c-a83c94043a9d ==============================
[0m16:44:50.526477 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:44:50.526738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s revenue_daily --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m16:44:50.592510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10882b490>]}
[0m16:44:50.614440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095be030>]}
[0m16:44:50.615094 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:44:50.652500 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:44:50.702950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:50.703119 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:50.722194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8f450>]}
[0m16:44:50.755705 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:44:50.756846 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:44:50.766597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a59a0>]}
[0m16:44:50.766795 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m16:44:50.766937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b74910>]}
[0m16:44:50.767633 [info ] [MainThread]: 
[0m16:44:50.767776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:44:50.767885 [info ] [MainThread]: 
[0m16:44:50.768080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:50.768483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m16:44:50.790476 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m16:44:50.790670 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m16:44:50.790795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:51.556535 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.766 seconds
[0m16:44:51.557617 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m16:44:51.561120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m16:44:51.564357 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:44:51.564565 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m16:44:51.564712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:52.236767 [debug] [ThreadPool]: SQL status: BEGIN in 0.672 seconds
[0m16:44:52.238419 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m16:44:52.239493 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:44:52.291441 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.051 seconds
[0m16:44:52.297130 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m16:44:52.342092 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m16:44:52.355100 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:52.355529 [debug] [MainThread]: On master: BEGIN
[0m16:44:52.355822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:53.241026 [debug] [MainThread]: SQL status: BEGIN in 0.885 seconds
[0m16:44:53.241451 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:53.241779 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:44:53.304269 [debug] [MainThread]: SQL status: SELECT 17 in 0.062 seconds
[0m16:44:53.307203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b05ec30>]}
[0m16:44:53.307727 [debug] [MainThread]: On master: ROLLBACK
[0m16:44:53.355066 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:53.356154 [debug] [MainThread]: On master: BEGIN
[0m16:44:53.438375 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m16:44:53.438932 [debug] [MainThread]: On master: COMMIT
[0m16:44:53.439277 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:53.439566 [debug] [MainThread]: On master: COMMIT
[0m16:44:53.492143 [debug] [MainThread]: SQL status: COMMIT in 0.052 seconds
[0m16:44:53.493209 [debug] [MainThread]: On master: Close
[0m16:44:53.501069 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m16:44:53.502092 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m16:44:53.503032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m16:44:53.503494 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m16:44:53.517561 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m16:44:53.518580 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m16:44:53.551174 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m16:44:53.551832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:44:53.552011 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m16:44:53.552165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:54.237885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.685 seconds
[0m16:44:54.239130 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:44:54.239768 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_ohwk"."dbt"."revenue_daily__dbt_tmp"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    now() at time zone 'utc' as updated_at
from
    "dev_ohwk"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
  );
  
  
[0m16:44:55.133699 [debug] [Thread-1 (]: SQL status: SELECT 91 in 0.893 seconds
[0m16:44:55.148808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:44:55.149324 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
alter table "dev_ohwk"."dbt"."revenue_daily" rename to "revenue_daily__dbt_backup"
[0m16:44:55.193185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m16:44:55.203235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:44:55.203592 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
alter table "dev_ohwk"."dbt"."revenue_daily__dbt_tmp" rename to "revenue_daily"
[0m16:44:55.245481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.041 seconds
[0m16:44:55.268021 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:44:55.268509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:44:55.268835 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m16:44:55.313480 [debug] [Thread-1 (]: SQL status: COMMIT in 0.044 seconds
[0m16:44:55.322192 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."revenue_daily__dbt_backup"
[0m16:44:55.327384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m16:44:55.327777 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */
drop table if exists "dev_ohwk"."dbt"."revenue_daily__dbt_backup" cascade
[0m16:44:55.376596 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.048 seconds
[0m16:44:55.381570 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m16:44:55.385373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc797b92-22f1-4d31-806c-a83c94043a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac7b710>]}
[0m16:44:55.386297 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mSELECT 91[0m in 1.88s]
[0m16:44:55.387042 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m16:44:55.388568 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:55.388904 [debug] [MainThread]: On master: BEGIN
[0m16:44:55.389181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:56.092071 [debug] [MainThread]: SQL status: BEGIN in 0.703 seconds
[0m16:44:56.093300 [debug] [MainThread]: On master: COMMIT
[0m16:44:56.094387 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:56.095009 [debug] [MainThread]: On master: COMMIT
[0m16:44:56.558409 [debug] [MainThread]: SQL status: COMMIT in 0.463 seconds
[0m16:44:56.559921 [debug] [MainThread]: On master: Close
[0m16:44:56.561328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:56.561689 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m16:44:56.562453 [info ] [MainThread]: 
[0m16:44:56.563454 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.79 seconds (5.79s).
[0m16:44:56.564392 [debug] [MainThread]: Command end result
[0m16:44:56.626495 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m16:44:56.627551 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m16:44:56.630288 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m16:44:56.630438 [info ] [MainThread]: 
[0m16:44:56.630623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:56.630747 [info ] [MainThread]: 
[0m16:44:56.630890 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:44:56.632237 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.134803, "process_in_blocks": "0", "process_kernel_time": 0.143117, "process_mem_max_rss": "137183232", "process_out_blocks": "0", "process_user_time": 0.966875}
[0m16:44:56.632440 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:56.632402 after 6.14 seconds
[0m16:44:56.632611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0acaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c19e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c19db0>]}
[0m16:44:56.632775 [debug] [MainThread]: Flushing usage events
[0m16:44:57.257578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:43:24.308904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c834d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091779d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109177b10>]}


============================== 20:43:24.311455 | c923e30e-bcc5-4e73-b597-4fcec8398100 ==============================
[0m20:43:24.311455 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:43:24.311721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:43:24.385020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10847f490>]}
[0m20:43:24.406329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10900ebe0>]}
[0m20:43:24.406907 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:43:24.445407 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m20:43:24.483296 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:43:24.483539 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m20:43:24.483688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe0250>]}
[0m20:43:24.974434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fde210>]}
[0m20:43:25.006461 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m20:43:25.007671 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m20:43:25.025626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a35da90>]}
[0m20:43:25.025850 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m20:43:25.026671 [info ] [MainThread]: 
[0m20:43:25.026811 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:43:25.026924 [info ] [MainThread]: 
[0m20:43:25.027115 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:43:25.027495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m20:43:25.049835 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m20:43:25.050028 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m20:43:25.050144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:43:25.809803 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.760 seconds
[0m20:43:25.811932 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m20:43:25.820111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m20:43:25.828421 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m20:43:25.828915 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m20:43:25.829222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:26.594809 [debug] [ThreadPool]: SQL status: BEGIN in 0.765 seconds
[0m20:43:26.595515 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m20:43:26.596101 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m20:43:27.101298 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.505 seconds
[0m20:43:27.104275 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m20:43:27.160835 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m20:43:27.175046 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:27.175661 [debug] [MainThread]: On master: BEGIN
[0m20:43:27.176063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:43:27.896333 [debug] [MainThread]: SQL status: BEGIN in 0.720 seconds
[0m20:43:27.897353 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:27.898015 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:43:27.954867 [debug] [MainThread]: SQL status: SELECT 17 in 0.056 seconds
[0m20:43:27.960691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5eab60>]}
[0m20:43:27.961370 [debug] [MainThread]: On master: ROLLBACK
[0m20:43:28.008612 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:28.009570 [debug] [MainThread]: On master: BEGIN
[0m20:43:28.100718 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m20:43:28.101714 [debug] [MainThread]: On master: COMMIT
[0m20:43:28.102281 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:28.102832 [debug] [MainThread]: On master: COMMIT
[0m20:43:28.151652 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m20:43:28.152600 [debug] [MainThread]: On master: Close
[0m20:43:28.161375 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m20:43:28.162202 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m20:43:28.163831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m20:43:28.164510 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m20:43:28.176877 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m20:43:28.178233 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m20:43:28.213062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:28.213370 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp204328199917"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    now() at time zone 'utc' as updated_at
from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m20:43:28.213594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:30.122516 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.909 seconds
[0m20:43:30.143342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.143893 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m20:43:30.198673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m20:43:30.199493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.199859 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp204328199917'
        
      order by ordinal_position

  
[0m20:43:30.259388 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.059 seconds
[0m20:43:30.267023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.267504 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m20:43:30.315865 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.048 seconds
[0m20:43:30.333556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.334198 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp204328199917'
        
      order by ordinal_position

  
[0m20:43:30.404955 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.070 seconds
[0m20:43:30.410266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.410749 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m20:43:30.491883 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.080 seconds
[0m20:43:30.505601 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:43:30.521532 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m20:43:30.522432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.522750 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp204328199917" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp204328199917"
    )
  
[0m20:43:30.588073 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.065 seconds
[0m20:43:30.604269 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m20:43:30.605134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m20:43:30.605451 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m20:43:30.671499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.066 seconds
[0m20:43:30.674233 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m20:43:30.677583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c923e30e-bcc5-4e73-b597-4fcec8398100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3be750>]}
[0m20:43:30.678474 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 2.51s]
[0m20:43:30.679147 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m20:43:30.681285 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:30.681734 [debug] [MainThread]: On master: BEGIN
[0m20:43:30.682000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:43:31.473383 [debug] [MainThread]: SQL status: BEGIN in 0.791 seconds
[0m20:43:31.474338 [debug] [MainThread]: On master: COMMIT
[0m20:43:31.474879 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:31.475356 [debug] [MainThread]: On master: COMMIT
[0m20:43:31.518718 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m20:43:31.519618 [debug] [MainThread]: On master: Close
[0m20:43:31.520933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:31.521528 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m20:43:31.522265 [info ] [MainThread]: 
[0m20:43:31.522723 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.50 seconds (6.50s).
[0m20:43:31.523668 [debug] [MainThread]: Command end result
[0m20:43:31.557195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m20:43:31.558603 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m20:43:31.562189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m20:43:31.562377 [info ] [MainThread]: 
[0m20:43:31.562600 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:43:31.563051 [info ] [MainThread]: 
[0m20:43:31.563336 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:43:31.565137 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.2848167, "process_in_blocks": "0", "process_kernel_time": 0.161966, "process_mem_max_rss": "149061632", "process_out_blocks": "0", "process_user_time": 1.463572}
[0m20:43:31.565434 [debug] [MainThread]: Command `cli build` succeeded at 20:43:31.565371 after 7.29 seconds
[0m20:43:31.565662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3f1de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a71edf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a71ed50>]}
[0m20:43:31.565879 [debug] [MainThread]: Flushing usage events
[0m20:43:32.224554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:06:53.497983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10564b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b439d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b43b10>]}


============================== 21:06:53.500454 | 849a4981-e59a-426f-a6ed-6076793b7c66 ==============================
[0m21:06:53.500454 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:06:53.500717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls -s config.materialized:incremental', 'send_anonymous_usage_stats': 'True'}
[0m21:06:53.567846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '849a4981-e59a-426f-a6ed-6076793b7c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e43490>]}
[0m21:06:53.589377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '849a4981-e59a-426f-a6ed-6076793b7c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069da140>]}
[0m21:06:53.589792 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:06:53.625926 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:06:53.677978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:06:53.678159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:06:53.694785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '849a4981-e59a-426f-a6ed-6076793b7c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c3150>]}
[0m21:06:53.727191 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:06:53.730096 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:06:53.738783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '849a4981-e59a-426f-a6ed-6076793b7c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a56d0>]}
[0m21:06:53.738972 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:06:53.739114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '849a4981-e59a-426f-a6ed-6076793b7c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706f310>]}
[0m21:06:53.739426 [info ] [MainThread]: dbt_scooters.events_clean
[0m21:06:53.739553 [info ] [MainThread]: dbt_scooters.revenue_daily
[0m21:06:53.739652 [info ] [MainThread]: dbt_scooters.trips_concurrency
[0m21:06:53.739753 [info ] [MainThread]: dbt_scooters.trips_users
[0m21:06:53.741069 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.26988965, "process_in_blocks": "0", "process_kernel_time": 0.105278, "process_mem_max_rss": "119422976", "process_out_blocks": "0", "process_user_time": 0.701449}
[0m21:06:53.741243 [debug] [MainThread]: Command `dbt ls` succeeded at 21:06:53.741208 after 0.27 seconds
[0m21:06:53.741385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a20dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107946990>]}
[0m21:06:53.741503 [debug] [MainThread]: Flushing usage events
[0m21:06:54.400435 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:12:00.602773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036ef4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be7b10>]}


============================== 21:12:00.605253 | 4dac914a-398c-4275-81c2-dc4fb443d1c8 ==============================
[0m21:12:00.605253 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:12:00.605550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -s config.materialized:incremental', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:12:00.670099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee7490>]}
[0m21:12:00.690247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7e030>]}
[0m21:12:00.690931 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:12:00.727435 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:12:00.772055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:12:00.772238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:12:00.789563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105867450>]}
[0m21:12:00.824122 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:12:00.825235 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:12:00.841259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae5e50>]}
[0m21:12:00.841466 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:12:00.842329 [info ] [MainThread]: 
[0m21:12:00.842474 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:12:00.842585 [info ] [MainThread]: 
[0m21:12:00.842782 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:12:00.844314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:12:00.866661 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:12:00.866852 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:12:00.866964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:02.217883 [debug] [ThreadPool]: SQL status: SELECT 16 in 1.350 seconds
[0m21:12:02.221901 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:12:02.227121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:12:02.234856 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:12:02.235250 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:12:02.235488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:03.878925 [debug] [ThreadPool]: SQL status: BEGIN in 1.643 seconds
[0m21:12:03.880465 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:12:03.881562 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:12:03.944743 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.062 seconds
[0m21:12:03.948768 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:12:04.037656 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:12:04.050954 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:04.051443 [debug] [MainThread]: On master: BEGIN
[0m21:12:04.051788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:12:05.756967 [debug] [MainThread]: SQL status: BEGIN in 1.705 seconds
[0m21:12:05.758479 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:05.759165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:12:05.904848 [debug] [MainThread]: SQL status: SELECT 17 in 0.145 seconds
[0m21:12:05.911495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105afbd90>]}
[0m21:12:05.912475 [debug] [MainThread]: On master: ROLLBACK
[0m21:12:05.988757 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:05.990137 [debug] [MainThread]: On master: BEGIN
[0m21:12:06.104731 [debug] [MainThread]: SQL status: BEGIN in 0.114 seconds
[0m21:12:06.105668 [debug] [MainThread]: On master: COMMIT
[0m21:12:06.106636 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:06.107384 [debug] [MainThread]: On master: COMMIT
[0m21:12:06.169575 [debug] [MainThread]: SQL status: COMMIT in 0.062 seconds
[0m21:12:06.170726 [debug] [MainThread]: On master: Close
[0m21:12:06.179112 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:12:06.179780 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:12:06.180269 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:12:06.180651 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:12:06.181209 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:12:06.181832 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:12:06.182338 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:12:06.182801 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:12:06.183369 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:12:06.183752 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:12:06.184065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:12:06.184424 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:12:06.184719 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:12:06.184994 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:12:06.185255 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:12:06.185520 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:12:06.202475 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:12:06.202863 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:12:06.205237 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:12:06.207854 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:12:06.208488 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:12:06.208738 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:12:06.208951 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:12:06.209130 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:12:06.268757 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:06.270402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:06.271357 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:06.272702 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:06.272871 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp211206225970"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:12:06.273021 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp211206234723"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id
from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m21:12:06.273184 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp211206239752"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency
from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:12:06.273344 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp211206272158"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:12:06.273475 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:12:06.273593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:06.273707 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:12:06.273819 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:12:07.087163 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.813 seconds
[0m21:12:07.108531 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:07.108973 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:12:07.183792 [debug] [Thread-4 (]: SQL status: BEGIN in 0.074 seconds
[0m21:12:07.184583 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:07.185041 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp211206272158'
        
      order by ordinal_position

  
[0m21:12:07.294491 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.109 seconds
[0m21:12:07.302580 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:07.303071 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:07.506227 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.203 seconds
[0m21:12:07.517141 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:07.517816 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:07.706694 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.188 seconds
[0m21:12:07.720725 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:12:07.721939 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:07.722399 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age"
        from "trips_users__dbt_tmp211206272158"
    )


  
[0m21:12:07.804906 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.082 seconds
[0m21:12:07.828172 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:12:07.828713 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:12:07.829038 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:12:07.908967 [debug] [Thread-4 (]: SQL status: COMMIT in 0.080 seconds
[0m21:12:07.911266 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:12:07.914312 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b83d640>]}
[0m21:12:07.915049 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 0[0m in 1.73s]
[0m21:12:07.915639 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:12:08.393974 [debug] [Thread-2 (]: SQL status: SELECT 3 in 2.120 seconds
[0m21:12:08.398806 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:08.399363 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:12:08.502069 [debug] [Thread-1 (]: SQL status: SELECT 0 in 2.228 seconds
[0m21:12:08.502744 [debug] [Thread-2 (]: SQL status: BEGIN in 0.103 seconds
[0m21:12:08.506714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:08.507196 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:08.507600 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:12:08.507993 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp211206225970'
        
      order by ordinal_position

  
[0m21:12:08.575407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m21:12:08.575900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:08.576320 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp211206234723'
        
      order by ordinal_position

  
[0m21:12:08.705234 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.197 seconds
[0m21:12:08.708503 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:08.708940 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:08.809212 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.100 seconds
[0m21:12:08.824778 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:08.825277 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp211206225970'
        
      order by ordinal_position

  
[0m21:12:08.911454 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.085 seconds
[0m21:12:08.913089 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.336 seconds
[0m21:12:08.920464 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:08.923962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:08.924621 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:08.925135 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:09.004227 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.078 seconds
[0m21:12:09.019726 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:12:09.029819 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:12:09.030815 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:09.031198 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp211206225970" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp211206225970"
    )
  
[0m21:12:09.105808 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.074 seconds
[0m21:12:09.109122 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:12:09.109613 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:12:09.109963 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:12:09.302110 [debug] [Thread-2 (]: SQL status: COMMIT in 0.192 seconds
[0m21:12:09.302574 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.377 seconds
[0m21:12:09.303391 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:12:09.307103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:09.307602 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:09.308178 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b26a50>]}
[0m21:12:09.308960 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 3.12s]
[0m21:12:09.309624 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:12:09.609190 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.300 seconds
[0m21:12:09.613471 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:12:09.614969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:09.615342 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id")
    (
        select "user_id", "timestamp", "type_id"
        from "events_clean__dbt_tmp211206234723"
    )


  
[0m21:12:09.695253 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.079 seconds
[0m21:12:09.697220 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:12:09.697691 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:12:09.698046 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:12:09.815421 [debug] [Thread-1 (]: SQL status: COMMIT in 0.116 seconds
[0m21:12:09.817282 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:12:09.818646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abf800>]}
[0m21:12:09.819631 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 0[0m in 3.63s]
[0m21:12:09.820619 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:12:10.987318 [debug] [Thread-3 (]: SQL status: SELECT 0 in 4.713 seconds
[0m21:12:10.995524 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:10.996413 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:12:11.050085 [debug] [Thread-3 (]: SQL status: BEGIN in 0.053 seconds
[0m21:12:11.050718 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:11.051128 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp211206239752'
        
      order by ordinal_position

  
[0m21:12:11.157934 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.106 seconds
[0m21:12:11.162178 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:11.162675 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:11.232479 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.069 seconds
[0m21:12:11.234960 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:11.235306 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:12:11.310135 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.074 seconds
[0m21:12:11.311967 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:12:11.312747 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:11.313069 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency")
    (
        select "timestamp", "concurrency"
        from "trips_concurrency__dbt_tmp211206239752"
    )


  
[0m21:12:11.363969 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.051 seconds
[0m21:12:11.365782 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:12:11.366248 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:12:11.366606 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:12:11.419270 [debug] [Thread-3 (]: SQL status: COMMIT in 0.052 seconds
[0m21:12:11.421279 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:12:11.423602 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dac914a-398c-4275-81c2-dc4fb443d1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b880910>]}
[0m21:12:11.425013 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mINSERT 0 0[0m in 5.24s]
[0m21:12:11.426088 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:12:11.429034 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:11.429514 [debug] [MainThread]: On master: BEGIN
[0m21:12:11.429914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:12:12.128106 [debug] [MainThread]: SQL status: BEGIN in 0.698 seconds
[0m21:12:12.129449 [debug] [MainThread]: On master: COMMIT
[0m21:12:12.130101 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:12.130594 [debug] [MainThread]: On master: COMMIT
[0m21:12:12.180509 [debug] [MainThread]: SQL status: COMMIT in 0.049 seconds
[0m21:12:12.182314 [debug] [MainThread]: On master: Close
[0m21:12:12.183617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:12:12.184194 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:12:12.184424 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:12:12.184655 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:12:12.184863 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:12:12.185287 [info ] [MainThread]: 
[0m21:12:12.185655 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 11.34 seconds (11.34s).
[0m21:12:12.186837 [debug] [MainThread]: Command end result
[0m21:12:12.215420 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:12:12.216904 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:12:12.221132 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:12:12.221357 [info ] [MainThread]: 
[0m21:12:12.221588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:12:12.221754 [info ] [MainThread]: 
[0m21:12:12.221926 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:12:12.223472 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.648479, "process_in_blocks": "0", "process_kernel_time": 0.159917, "process_mem_max_rss": "139804672", "process_out_blocks": "0", "process_user_time": 1.166874}
[0m21:12:12.223738 [debug] [MainThread]: Command `dbt build` succeeded at 21:12:12.223684 after 11.65 seconds
[0m21:12:12.223952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105905a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105930850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c07230>]}
[0m21:12:12.224155 [debug] [MainThread]: Flushing usage events
[0m21:12:12.968789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:26:48.186836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057734d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6bb10>]}


============================== 21:26:48.189275 | 2850b532-b0d1-4bdc-90ff-a9d9de378982 ==============================
[0m21:26:48.189275 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:26:48.189550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -s config.materialized:incremental', 'send_anonymous_usage_stats': 'True'}
[0m21:26:48.257744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6b490>]}
[0m21:26:48.279495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b02030>]}
[0m21:26:48.280181 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:26:48.317388 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:26:48.361864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:26:48.362058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:26:48.378594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078eb450>]}
[0m21:26:48.412087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:26:48.413002 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:26:48.429516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b69e50>]}
[0m21:26:48.429742 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:26:48.430616 [info ] [MainThread]: 
[0m21:26:48.430757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:26:48.430869 [info ] [MainThread]: 
[0m21:26:48.431076 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:26:48.432613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:26:48.454899 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:26:48.455090 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:26:48.455200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:49.607635 [debug] [ThreadPool]: SQL status: SELECT 18 in 1.152 seconds
[0m21:26:49.610513 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:26:49.614649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:26:49.623464 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:26:49.624338 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:26:49.624834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:50.895904 [debug] [ThreadPool]: SQL status: BEGIN in 1.271 seconds
[0m21:26:50.897401 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:26:50.898056 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:26:50.973692 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.075 seconds
[0m21:26:50.978390 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:26:51.074880 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:26:51.090065 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:51.091683 [debug] [MainThread]: On master: BEGIN
[0m21:26:51.092371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:52.226695 [debug] [MainThread]: SQL status: BEGIN in 1.134 seconds
[0m21:26:52.228175 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:52.229246 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:26:52.316206 [debug] [MainThread]: SQL status: SELECT 17 in 0.086 seconds
[0m21:26:52.324171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7fd90>]}
[0m21:26:52.325099 [debug] [MainThread]: On master: ROLLBACK
[0m21:26:52.388845 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:52.389553 [debug] [MainThread]: On master: BEGIN
[0m21:26:52.484249 [debug] [MainThread]: SQL status: BEGIN in 0.094 seconds
[0m21:26:52.484618 [debug] [MainThread]: On master: COMMIT
[0m21:26:52.484804 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:52.484956 [debug] [MainThread]: On master: COMMIT
[0m21:26:52.525710 [debug] [MainThread]: SQL status: COMMIT in 0.041 seconds
[0m21:26:52.526107 [debug] [MainThread]: On master: Close
[0m21:26:52.529628 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:26:52.529936 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:26:52.530140 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:26:52.530326 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:26:52.530701 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:26:52.530983 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:26:52.531440 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:26:52.531758 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:26:52.532056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:26:52.532330 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:26:52.532575 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:26:52.532801 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:26:52.533003 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:26:52.533225 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:26:52.533440 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:26:52.533618 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:26:52.541823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:26:52.543968 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:26:52.545748 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:26:52.548205 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:26:52.548903 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:26:52.549113 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:26:52.549288 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:26:52.555762 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:26:52.580336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:52.580690 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:52.582106 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:52.629352 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:52.629597 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp212652564342"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m21:26:52.629753 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp212652568558"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:26:52.629928 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp212652581572"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() at time zone 'utc' as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:26:52.630103 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp212652628750"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:26:52.630238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:52.630358 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:26:52.630470 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:26:52.630593 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:26:55.420382 [debug] [Thread-2 (]: SQL status: SELECT 3 in 2.789 seconds
[0m21:26:55.437967 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:55.438532 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:26:55.519757 [debug] [Thread-2 (]: SQL status: BEGIN in 0.081 seconds
[0m21:26:55.520214 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:55.520597 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp212652628750'
        
      order by ordinal_position

  
[0m21:26:55.820981 [debug] [Thread-4 (]: SQL status: SELECT 0 in 3.190 seconds
[0m21:26:55.822044 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.301 seconds
[0m21:26:55.827062 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:55.835011 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:55.835610 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:26:55.836120 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:55.922456 [debug] [Thread-4 (]: SQL status: BEGIN in 0.085 seconds
[0m21:26:55.923999 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:55.926876 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp212652568558'
        
      order by ordinal_position

  
[0m21:26:56.022951 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.186 seconds
[0m21:26:56.046379 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:56.047007 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp212652628750'
        
      order by ordinal_position

  
[0m21:26:56.221324 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.174 seconds
[0m21:26:56.222384 [debug] [Thread-3 (]: SQL status: SELECT 0 in 3.592 seconds
[0m21:26:56.228769 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:56.232738 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:56.233341 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:56.233747 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:26:56.300592 [debug] [Thread-3 (]: SQL status: BEGIN in 0.066 seconds
[0m21:26:56.301182 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:56.301577 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp212652581572'
        
      order by ordinal_position

  
[0m21:26:56.319569 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.392 seconds
[0m21:26:56.320074 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.086 seconds
[0m21:26:56.323790 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:56.335252 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:26:56.335806 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:56.349273 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:26:56.350062 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:56.350339 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp212652628750" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp212652628750"
    )
  
[0m21:26:56.437022 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.086 seconds
[0m21:26:56.438273 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.090 seconds
[0m21:26:56.456947 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:26:56.460111 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:56.460416 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:26:56.460689 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:56.460948 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:26:56.528211 [debug] [Thread-2 (]: SQL status: COMMIT in 0.067 seconds
[0m21:26:56.532011 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:26:56.536398 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d875980>]}
[0m21:26:56.537211 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 4.00s]
[0m21:26:56.537878 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:26:56.623423 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.321 seconds
[0m21:26:56.624899 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.163 seconds
[0m21:26:56.630197 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:56.638818 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:26:56.639340 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:56.640160 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:56.640509 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age"
        from "trips_users__dbt_tmp212652568558"
    )


  
[0m21:26:56.704689 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.064 seconds
[0m21:26:56.707340 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:26:56.707917 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:26:56.708299 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:26:56.733512 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.094 seconds
[0m21:26:56.739480 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:56.739993 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:56.816381 [debug] [Thread-1 (]: SQL status: SELECT 0 in 4.186 seconds
[0m21:26:56.822426 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:56.823176 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.083 seconds
[0m21:26:56.823673 [debug] [Thread-4 (]: SQL status: COMMIT in 0.115 seconds
[0m21:26:56.824188 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:26:56.827413 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:26:56.828762 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:26:56.830593 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bab050>]}
[0m21:26:56.831056 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:56.831864 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 0[0m in 4.30s]
[0m21:26:56.832998 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency")
    (
        select "timestamp", "concurrency"
        from "trips_concurrency__dbt_tmp212652581572"
    )


  
[0m21:26:56.834225 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:26:56.894653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m21:26:56.894982 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.060 seconds
[0m21:26:56.895244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:56.896153 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:26:56.896404 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp212652564342'
        
      order by ordinal_position

  
[0m21:26:56.896682 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:26:56.896988 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:26:56.974496 [debug] [Thread-3 (]: SQL status: COMMIT in 0.077 seconds
[0m21:26:56.974954 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.078 seconds
[0m21:26:56.975584 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:26:56.978075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:56.978398 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:56.978699 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b43800>]}
[0m21:26:56.979090 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mINSERT 0 0[0m in 4.45s]
[0m21:26:56.979416 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:26:57.044453 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.066 seconds
[0m21:26:57.046023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:57.046216 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:26:57.116271 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.070 seconds
[0m21:26:57.117524 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:26:57.118120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:57.118335 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id")
    (
        select "user_id", "timestamp", "type_id"
        from "events_clean__dbt_tmp212652564342"
    )


  
[0m21:26:57.169572 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.051 seconds
[0m21:26:57.170731 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:26:57.171042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:26:57.171275 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:26:57.239019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.067 seconds
[0m21:26:57.239656 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:26:57.240149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2850b532-b0d1-4bdc-90ff-a9d9de378982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d878190>]}
[0m21:26:57.240521 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 0[0m in 4.71s]
[0m21:26:57.240823 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:26:57.241682 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:57.241902 [debug] [MainThread]: On master: BEGIN
[0m21:26:57.242074 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:58.482878 [debug] [MainThread]: SQL status: BEGIN in 1.240 seconds
[0m21:26:58.484101 [debug] [MainThread]: On master: COMMIT
[0m21:26:58.484518 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:58.484877 [debug] [MainThread]: On master: COMMIT
[0m21:26:58.540121 [debug] [MainThread]: SQL status: COMMIT in 0.055 seconds
[0m21:26:58.541269 [debug] [MainThread]: On master: Close
[0m21:26:58.542790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:58.543392 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:26:58.543857 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:26:58.544344 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:26:58.544780 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:26:58.545486 [info ] [MainThread]: 
[0m21:26:58.546102 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 10.11 seconds (10.11s).
[0m21:26:58.547833 [debug] [MainThread]: Command end result
[0m21:26:58.574375 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:26:58.575858 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:26:58.579827 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:26:58.580034 [info ] [MainThread]: 
[0m21:26:58.580257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:26:58.580433 [info ] [MainThread]: 
[0m21:26:58.580618 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:26:58.582411 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.421572, "process_in_blocks": "0", "process_kernel_time": 0.15418, "process_mem_max_rss": "139591680", "process_out_blocks": "0", "process_user_time": 1.127919}
[0m21:26:58.582684 [debug] [MainThread]: Command `dbt build` succeeded at 21:26:58.582631 after 10.42 seconds
[0m21:26:58.582902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10798da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046132d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c8b230>]}
[0m21:26:58.583107 [debug] [MainThread]: Flushing usage events
[0m21:26:59.268611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:33:23.078546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052534d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674bb10>]}


============================== 21:33:23.080958 | 72dab404-9fdd-4f99-bac2-f530b99dc52a ==============================
[0m21:33:23.080958 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:33:23.081219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:33:23.146610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a4f490>]}
[0m21:33:23.166911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e2030>]}
[0m21:33:23.167541 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:33:23.204492 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:33:23.255901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:33:23.256075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:33:23.272355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cb450>]}
[0m21:33:23.304683 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:33:23.307608 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:33:23.317272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c99a0>]}
[0m21:33:23.317491 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:33:23.317640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7b3f0>]}
[0m21:33:23.318615 [info ] [MainThread]: 
[0m21:33:23.318755 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:23.318862 [info ] [MainThread]: 
[0m21:33:23.319061 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:33:23.320835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:33:23.342651 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:33:23.342856 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:33:23.342970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:25.063386 [debug] [ThreadPool]: SQL status: SELECT 20 in 1.720 seconds
[0m21:33:25.064603 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:33:25.066609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:33:25.071171 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:33:25.071499 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:33:25.071708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:26.193418 [debug] [ThreadPool]: SQL status: BEGIN in 1.122 seconds
[0m21:33:26.193928 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:33:26.194239 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:33:26.238777 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.044 seconds
[0m21:33:26.241856 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:33:26.286848 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:33:26.297636 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:26.298203 [debug] [MainThread]: On master: BEGIN
[0m21:33:26.298514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:26.924936 [debug] [MainThread]: SQL status: BEGIN in 0.626 seconds
[0m21:33:26.925436 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:26.925860 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:33:26.980425 [debug] [MainThread]: SQL status: SELECT 17 in 0.053 seconds
[0m21:33:26.985344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781dcc0>]}
[0m21:33:26.986254 [debug] [MainThread]: On master: ROLLBACK
[0m21:33:27.031326 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:27.032413 [debug] [MainThread]: On master: BEGIN
[0m21:33:27.140565 [debug] [MainThread]: SQL status: BEGIN in 0.107 seconds
[0m21:33:27.141633 [debug] [MainThread]: On master: COMMIT
[0m21:33:27.142077 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:27.142363 [debug] [MainThread]: On master: COMMIT
[0m21:33:27.187642 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:33:27.188611 [debug] [MainThread]: On master: Close
[0m21:33:27.196242 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:33:27.197021 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m21:33:27.197595 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m21:33:27.198038 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_clean
[0m21:33:27.199062 [info ] [Thread-3 (]: 3 of 17 START sql incremental model dbt.trips_concurrency ...................... [RUN]
[0m21:33:27.199815 [info ] [Thread-4 (]: 4 of 17 START sql view model dbt.trips_geom .................................... [RUN]
[0m21:33:27.200405 [info ] [Thread-1 (]: 1 of 17 START sql view model dbt.companies ..................................... [RUN]
[0m21:33:27.200999 [info ] [Thread-2 (]: 2 of 17 START sql incremental model dbt.events_clean ........................... [RUN]
[0m21:33:27.201842 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:33:27.202445 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m21:33:27.202859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.companies)
[0m21:33:27.203314 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.events_clean'
[0m21:33:27.203687 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:33:27.204038 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m21:33:27.204370 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m21:33:27.204697 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:33:27.220627 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m21:33:27.221649 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:33:27.223399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m21:33:27.225477 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:33:27.226369 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m21:33:27.226630 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_clean
[0m21:33:27.226908 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m21:33:27.227139 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:33:27.252851 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m21:33:27.263559 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:33:27.264867 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m21:33:27.266341 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:33:27.266991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:33:27.267188 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:33:27.267368 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:33:27.267521 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:33:27.267658 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m21:33:27.267796 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m21:33:27.267925 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:33:27.268048 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:33:27.268173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:27.268311 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:33:27.268452 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:33:27.268595 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:33:28.043459 [debug] [Thread-4 (]: SQL status: BEGIN in 0.775 seconds
[0m21:33:28.044894 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:33:28.045817 [debug] [Thread-3 (]: SQL status: BEGIN in 0.777 seconds
[0m21:33:28.046467 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  create view "dev_ohwk"."dbt"."trips_geom__dbt_tmp"
    
    
  as (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_ohwk"."scooters_raw"."trips"
  );
[0m21:33:28.047171 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:33:28.048054 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() at time zone 'utc' as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:33:28.108399 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.060 seconds
[0m21:33:28.121411 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:33:28.122090 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m21:33:28.204606 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.082 seconds
[0m21:33:28.219719 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:33:28.220464 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m21:33:28.301529 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.080 seconds
[0m21:33:28.321049 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m21:33:28.321599 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:33:28.321967 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m21:33:28.405858 [debug] [Thread-4 (]: SQL status: COMMIT in 0.083 seconds
[0m21:33:28.418342 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_geom__dbt_backup"
[0m21:33:28.425091 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:33:28.425706 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_ohwk"."dbt"."trips_geom__dbt_backup" cascade
[0m21:33:28.511905 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.085 seconds
[0m21:33:28.517169 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: Close
[0m21:33:28.523268 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108050350>]}
[0m21:33:28.524473 [info ] [Thread-4 (]: 4 of 17 OK created sql view model dbt.trips_geom ............................... [[32mCREATE VIEW[0m in 1.32s]
[0m21:33:28.525442 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m21:33:28.525953 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m21:33:28.526679 [info ] [Thread-4 (]: 5 of 17 START sql view model dbt.trips_prep .................................... [RUN]
[0m21:33:28.527388 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.trips_prep)
[0m21:33:28.527790 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m21:33:28.576210 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m21:33:28.576781 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m21:33:28.578173 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m21:33:28.578503 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:33:28.578651 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m21:33:28.578786 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:33:29.651988 [debug] [Thread-3 (]: SQL status: SELECT 10 in 1.603 seconds
[0m21:33:29.665426 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:33:29.666134 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m21:33:29.694002 [debug] [Thread-1 (]: SQL status: BEGIN in 2.425 seconds
[0m21:33:29.695105 [debug] [Thread-2 (]: SQL status: BEGIN in 2.426 seconds
[0m21:33:29.695866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:33:29.696550 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:33:29.697120 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  create view "dev_ohwk"."dbt"."companies__dbt_tmp"
    
    
  as (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_ohwk"."dbt"."scooters"
group by
    1
  );
[0m21:33:29.697736 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
  
    

  create  table "dev_ohwk"."dbt"."events_clean__dbt_tmp"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" < timestamp '2023-08-01'

  );
  
  
[0m21:33:29.702201 [debug] [Thread-4 (]: SQL status: BEGIN in 1.123 seconds
[0m21:33:29.702788 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:33:29.703267 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_ohwk"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  );
[0m21:33:29.712392 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m21:33:29.717568 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:33:29.718200 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m21:33:29.803570 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.085 seconds
[0m21:33:29.805566 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.102 seconds
[0m21:33:29.806413 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.108 seconds
[0m21:33:29.809435 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:33:29.815851 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:33:29.820058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:33:29.820702 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:33:29.821107 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m21:33:29.821504 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies" rename to "companies__dbt_backup"
[0m21:33:29.821856 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:33:29.903112 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.081 seconds
[0m21:33:29.903814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.081 seconds
[0m21:33:29.907860 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:33:29.908439 [debug] [Thread-3 (]: SQL status: COMMIT in 0.086 seconds
[0m21:33:29.913250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:33:29.913668 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m21:33:29.915344 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_concurrency__dbt_backup"
[0m21:33:29.915722 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies__dbt_tmp" rename to "companies"
[0m21:33:29.918308 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:33:29.918743 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_ohwk"."dbt"."trips_concurrency__dbt_backup" cascade
[0m21:33:29.960362 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m21:33:29.963269 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:33:29.963880 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:33:29.964337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m21:33:29.964806 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:33:29.966768 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m21:33:29.967305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:33:29.967599 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m21:33:30.005863 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.087 seconds
[0m21:33:30.008151 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:33:30.009197 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f7070>]}
[0m21:33:30.009841 [info ] [Thread-3 (]: 3 of 17 OK created sql incremental model dbt.trips_concurrency ................. [[32mSELECT 10[0m in 2.81s]
[0m21:33:30.010672 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:33:30.011246 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m21:33:30.012059 [info ] [Thread-3 (]: 6 of 17 START sql view model dbt.trips_stat_daily .............................. [RUN]
[0m21:33:30.012715 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.trips_stat_daily)
[0m21:33:30.013166 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m21:33:30.013721 [debug] [Thread-1 (]: SQL status: COMMIT in 0.046 seconds
[0m21:33:30.016668 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m21:33:30.020157 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."companies__dbt_backup"
[0m21:33:30.020658 [debug] [Thread-4 (]: SQL status: COMMIT in 0.053 seconds
[0m21:33:30.021357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:33:30.023751 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_prep__dbt_backup"
[0m21:33:30.024296 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop view if exists "dev_ohwk"."dbt"."companies__dbt_backup" cascade
[0m21:33:30.024974 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:33:30.025392 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m21:33:30.025854 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_ohwk"."dbt"."trips_prep__dbt_backup" cascade
[0m21:33:30.029482 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m21:33:30.030285 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:33:30.030598 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m21:33:30.030881 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:33:30.103881 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.078 seconds
[0m21:33:30.106960 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m21:33:30.108476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108075e50>]}
[0m21:33:30.109508 [info ] [Thread-1 (]: 1 of 17 OK created sql view model dbt.companies ................................ [[32mCREATE VIEW[0m in 2.91s]
[0m21:33:30.110497 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m21:33:30.111106 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m21:33:30.111677 [info ] [Thread-1 (]: 7 of 17 START sql view model dbt.parking_finish_stat ........................... [RUN]
[0m21:33:30.112310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.parking_finish_stat)
[0m21:33:30.112719 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m21:33:30.116239 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m21:33:30.117125 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m21:33:30.120796 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m21:33:30.122009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:33:30.122496 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m21:33:30.122817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:30.205165 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.175 seconds
[0m21:33:30.206247 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m21:33:30.206767 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c9b50>]}
[0m21:33:30.207146 [info ] [Thread-4 (]: 5 of 17 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 1.68s]
[0m21:33:30.207455 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m21:33:30.207667 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_start_stat
[0m21:33:30.207981 [info ] [Thread-4 (]: 8 of 17 START sql view model dbt.parking_start_stat ............................ [RUN]
[0m21:33:30.208322 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.parking_start_stat)
[0m21:33:30.208534 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m21:33:30.210187 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m21:33:30.210719 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m21:33:30.212315 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m21:33:30.212688 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:33:30.212897 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m21:33:30.213065 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:33:31.011352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.888 seconds
[0m21:33:31.012480 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:33:31.013257 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  create view "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp"
    
    
  as (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
where
    st_intersects(st_transform(t.finish_point, 3857), hex.geom)
group by
    1
  );
[0m21:33:31.103641 [debug] [Thread-3 (]: SQL status: BEGIN in 1.072 seconds
[0m21:33:31.104800 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:33:31.105742 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  create view "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp"
    
    
  as (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
[0m21:33:31.109146 [debug] [Thread-4 (]: SQL status: BEGIN in 0.896 seconds
[0m21:33:31.110424 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:33:31.111269 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.097 seconds
[0m21:33:31.112078 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  create view "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp"
    
    
  as (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
where
    st_intersects(st_transform(t.start_point, 3857), hex.geom)
group by
    1
  );
[0m21:33:31.120157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:33:31.120858 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m21:33:31.205833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.084 seconds
[0m21:33:31.208242 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m21:33:31.208752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:33:31.209079 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m21:33:31.210384 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.090 seconds
[0m21:33:31.210850 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.104 seconds
[0m21:33:31.214930 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:33:31.218362 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:33:31.218857 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m21:33:31.219297 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m21:33:31.555894 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.336 seconds
[0m21:33:31.556954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.347 seconds
[0m21:33:31.557515 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.338 seconds
[0m21:33:31.562391 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:33:31.565807 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup"
[0m21:33:31.567978 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:33:31.568526 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m21:33:31.569195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:33:31.569680 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:33:31.570218 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop view if exists "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m21:33:31.570714 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:33:31.618322 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m21:33:31.619051 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.048 seconds
[0m21:33:31.621170 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m21:33:31.621763 [debug] [Thread-4 (]: SQL status: COMMIT in 0.050 seconds
[0m21:33:31.627344 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m21:33:31.627824 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:33:31.630912 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_start_stat__dbt_backup"
[0m21:33:31.631362 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m21:33:31.631921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107633700>]}
[0m21:33:31.632473 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:33:31.633519 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop view if exists "dev_ohwk"."dbt"."parking_start_stat__dbt_backup" cascade
[0m21:33:31.633217 [info ] [Thread-1 (]: 7 of 17 OK created sql view model dbt.parking_finish_stat ...................... [[32mCREATE VIEW[0m in 1.52s]
[0m21:33:31.634141 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m21:33:31.634535 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies_trips
[0m21:33:31.635075 [info ] [Thread-1 (]: 9 of 17 START sql view model dbt.companies_trips ............................... [RUN]
[0m21:33:31.635775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now model.dbt_scooters.companies_trips)
[0m21:33:31.636193 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies_trips
[0m21:33:31.639639 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m21:33:31.640351 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies_trips
[0m21:33:31.644758 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m21:33:31.645947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:33:31.646294 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m21:33:31.646538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:31.731845 [debug] [Thread-3 (]: SQL status: COMMIT in 0.099 seconds
[0m21:33:31.732750 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.099 seconds
[0m21:33:31.735491 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup"
[0m21:33:31.737357 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: Close
[0m21:33:31.738027 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:33:31.738486 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop view if exists "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m21:33:31.739163 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799f650>]}
[0m21:33:31.740152 [info ] [Thread-4 (]: 8 of 17 OK created sql view model dbt.parking_start_stat ....................... [[32mCREATE VIEW[0m in 1.53s]
[0m21:33:31.740800 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m21:33:31.741181 [debug] [Thread-4 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:33:31.741712 [info ] [Thread-4 (]: 10 of 17 START sql incremental model dbt.revenue_daily ......................... [RUN]
[0m21:33:31.742248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.revenue_daily)
[0m21:33:31.742749 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:33:31.746319 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:33:31.747003 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:33:31.752582 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:31.752913 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp213331749256"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:33:31.753256 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:33:31.829519 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.089 seconds
[0m21:33:31.832112 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m21:33:31.833325 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799f3b0>]}
[0m21:33:31.834121 [info ] [Thread-3 (]: 6 of 17 OK created sql view model dbt.trips_stat_daily ......................... [[32mCREATE VIEW[0m in 1.82s]
[0m21:33:31.834641 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m21:33:31.834986 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat
[0m21:33:31.835623 [info ] [Thread-3 (]: 11 of 17 START sql view model dbt.trips_stat ................................... [RUN]
[0m21:33:31.836265 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.trips_stat)
[0m21:33:31.836679 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat
[0m21:33:31.839437 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m21:33:31.840076 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat
[0m21:33:31.847513 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m21:33:31.848389 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:33:31.848666 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m21:33:31.848905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:33:32.720159 [debug] [Thread-1 (]: SQL status: BEGIN in 1.073 seconds
[0m21:33:32.721141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:33:32.721908 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  create view "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
    
    
  as (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
[0m21:33:32.824334 [debug] [Thread-3 (]: SQL status: BEGIN in 0.975 seconds
[0m21:33:32.825455 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:33:32.826159 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  create view "dev_ohwk"."dbt"."trips_stat__dbt_tmp"
    
    
  as (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_ohwk"."dbt"."trips_prep"
  );
[0m21:33:32.933454 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.106 seconds
[0m21:33:32.935154 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.212 seconds
[0m21:33:32.940873 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:33:32.945233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:33:32.945841 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m21:33:32.946329 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m21:33:33.011633 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m21:33:33.015095 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:33:33.015943 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:33:33.016719 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:33:33.031485 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.084 seconds
[0m21:33:33.036984 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:33:33.037904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:33:33.038586 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:33:33.226270 [debug] [Thread-3 (]: SQL status: COMMIT in 0.209 seconds
[0m21:33:33.227453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.188 seconds
[0m21:33:33.231588 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat__dbt_backup"
[0m21:33:33.234700 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m21:33:33.235834 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:33:33.236695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:33:33.237324 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop view if exists "dev_ohwk"."dbt"."trips_stat__dbt_backup" cascade
[0m21:33:33.237928 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop view if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m21:33:33.326907 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.088 seconds
[0m21:33:33.327851 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.089 seconds
[0m21:33:33.330850 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: Close
[0m21:33:33.333178 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: Close
[0m21:33:33.334934 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d17cb0>]}
[0m21:33:33.335646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d718b0>]}
[0m21:33:33.336568 [info ] [Thread-3 (]: 11 of 17 OK created sql view model dbt.trips_stat .............................. [[32mCREATE VIEW[0m in 1.50s]
[0m21:33:33.337447 [info ] [Thread-1 (]: 9 of 17 OK created sql view model dbt.companies_trips .......................... [[32mCREATE VIEW[0m in 1.70s]
[0m21:33:33.338351 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat
[0m21:33:33.339088 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies_trips
[0m21:33:33.339642 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_users
[0m21:33:33.340434 [info ] [Thread-3 (]: 12 of 17 START sql incremental model dbt.trips_users ........................... [RUN]
[0m21:33:33.341033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m21:33:33.343289 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:33:33.352067 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:33:33.353402 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_users
[0m21:33:33.356810 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:33:33.357505 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:33:33.357770 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:33:33.358011 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:33:33.428474 [debug] [Thread-4 (]: SQL status: SELECT 3 in 1.675 seconds
[0m21:33:33.445876 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:33.446324 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:33:33.771598 [debug] [Thread-4 (]: SQL status: BEGIN in 0.325 seconds
[0m21:33:33.773046 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:33.774221 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp213331749256'
        
      order by ordinal_position

  
[0m21:33:34.094143 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.319 seconds
[0m21:33:34.103850 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:34.104682 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:33:34.231856 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.126 seconds
[0m21:33:34.253223 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:34.253834 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp213331749256'
        
      order by ordinal_position

  
[0m21:33:34.424067 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.169 seconds
[0m21:33:34.432584 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:34.434854 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:33:34.528629 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.093 seconds
[0m21:33:34.546182 [debug] [Thread-4 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:33:34.559374 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:33:34.560187 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:34.560489 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp213331749256" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp213331749256"
    )
  
[0m21:33:35.239476 [debug] [Thread-4 (]: SQL status: INSERT 0 3 in 0.679 seconds
[0m21:33:35.240532 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:33:35.240786 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:33:35.240981 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:33:35.722827 [debug] [Thread-4 (]: SQL status: COMMIT in 0.481 seconds
[0m21:33:35.724037 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:33:35.725031 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799cef0>]}
[0m21:33:35.725832 [info ] [Thread-4 (]: 10 of 17 OK created sql incremental model dbt.revenue_daily .................... [[32mINSERT 0 3[0m in 3.98s]
[0m21:33:35.726618 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:33:35.922384 [debug] [Thread-2 (]: SQL status: SELECT 221370 in 6.223 seconds
[0m21:33:35.929240 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:33:35.929877 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean" rename to "events_clean__dbt_backup"
[0m21:33:36.004360 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.074 seconds
[0m21:33:36.010378 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:33:36.010979 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean__dbt_tmp" rename to "events_clean"
[0m21:33:36.124310 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.112 seconds
[0m21:33:36.125270 [debug] [Thread-3 (]: SQL status: BEGIN in 2.767 seconds
[0m21:33:36.127894 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:33:36.128606 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:33:36.129293 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:33:36.129769 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_users__dbt_tmp"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() at time zone 'utc' as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

      where
          t.id <= 75000

  );
  
  
[0m21:33:36.130209 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:33:36.427293 [debug] [Thread-2 (]: SQL status: COMMIT in 0.296 seconds
[0m21:33:36.431391 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."events_clean__dbt_backup"
[0m21:33:36.432396 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:33:36.432930 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
drop table if exists "dev_ohwk"."dbt"."events_clean__dbt_backup" cascade
[0m21:33:36.549170 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.115 seconds
[0m21:33:36.553187 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: Close
[0m21:33:36.554868 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799f050>]}
[0m21:33:36.556092 [info ] [Thread-2 (]: 2 of 17 OK created sql incremental model dbt.events_clean ...................... [[32mSELECT 221370[0m in 9.35s]
[0m21:33:36.557098 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_clean
[0m21:33:36.558163 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_full
[0m21:33:36.559267 [info ] [Thread-1 (]: 13 of 17 START sql view model dbt.events_full .................................. [RUN]
[0m21:33:36.560213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.events_full)
[0m21:33:36.560728 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_full
[0m21:33:36.566452 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m21:33:36.568666 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_full
[0m21:33:36.572055 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m21:33:36.573004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:33:36.573431 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: BEGIN
[0m21:33:36.573744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:38.613899 [debug] [Thread-1 (]: SQL status: BEGIN in 2.040 seconds
[0m21:33:38.615383 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:33:38.615992 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_ohwk"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_ohwk"."dbt"."events_clean"
    left join "dev_ohwk"."dbt"."event_types"
        using (type_id)
  );
[0m21:33:40.144276 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 1.527 seconds
[0m21:33:40.145885 [debug] [Thread-3 (]: SQL status: SELECT 75000 in 4.015 seconds
[0m21:33:40.151311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:33:40.155385 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:33:40.155894 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m21:33:40.156574 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users" rename to "trips_users__dbt_backup"
[0m21:33:40.809211 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.652 seconds
[0m21:33:40.810838 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.654 seconds
[0m21:33:40.815860 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:33:40.817931 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m21:33:40.818674 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users__dbt_tmp" rename to "trips_users"
[0m21:33:40.819151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:33:40.819658 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m21:33:40.891329 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.072 seconds
[0m21:33:40.891981 [debug] [Thread-1 (]: SQL status: COMMIT in 0.072 seconds
[0m21:33:40.894258 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:33:40.899265 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."events_full__dbt_backup"
[0m21:33:40.899975 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:33:40.900744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:33:40.901318 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:33:40.901757 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_ohwk"."dbt"."events_full__dbt_backup" cascade
[0m21:33:40.966294 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.064 seconds
[0m21:33:40.967105 [debug] [Thread-3 (]: SQL status: COMMIT in 0.065 seconds
[0m21:33:40.969817 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: Close
[0m21:33:40.973631 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_users__dbt_backup"
[0m21:33:40.974814 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:33:40.975537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107896630>]}
[0m21:33:40.976041 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
drop table if exists "dev_ohwk"."dbt"."trips_users__dbt_backup" cascade
[0m21:33:40.976948 [info ] [Thread-1 (]: 13 of 17 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 4.42s]
[0m21:33:40.977914 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_full
[0m21:33:40.978704 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m21:33:40.979256 [info ] [Thread-4 (]: 14 of 17 START sql view model dbt.events_stat .................................. [RUN]
[0m21:33:40.979804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.events_stat)
[0m21:33:40.980249 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m21:33:40.983707 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m21:33:40.984970 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m21:33:40.988952 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m21:33:40.989845 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:33:40.990447 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m21:33:40.990875 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:33:41.042424 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.065 seconds
[0m21:33:41.044553 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: Close
[0m21:33:41.045871 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799f8f0>]}
[0m21:33:41.046765 [info ] [Thread-3 (]: 12 of 17 OK created sql incremental model dbt.trips_users ...................... [[32mSELECT 75000[0m in 7.70s]
[0m21:33:41.047422 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_users
[0m21:33:41.048037 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_daily
[0m21:33:41.048494 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_group
[0m21:33:41.048949 [info ] [Thread-2 (]: 15 of 17 START sql view model dbt.trips_age_daily .............................. [RUN]
[0m21:33:41.049471 [info ] [Thread-1 (]: 16 of 17 START sql view model dbt.trips_age_group .............................. [RUN]
[0m21:33:41.049911 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.trips_age_daily)
[0m21:33:41.050270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_age_group)
[0m21:33:41.050584 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m21:33:41.050882 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m21:33:41.053397 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m21:33:41.055737 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m21:33:41.056403 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_group
[0m21:33:41.056697 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m21:33:41.059514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m21:33:41.061686 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m21:33:41.062299 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:33:41.062592 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:33:41.062809 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m21:33:41.063037 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m21:33:41.063265 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:33:41.063488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:41.937887 [debug] [Thread-4 (]: SQL status: BEGIN in 0.947 seconds
[0m21:33:41.939212 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:33:41.940085 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  create view "dev_ohwk"."dbt"."events_stat__dbt_tmp"
    
    
  as (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_ohwk"."dbt"."events_full"
  );
[0m21:33:42.004876 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.063 seconds
[0m21:33:42.012700 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:33:42.013548 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_ohwk"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m21:33:42.110235 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.096 seconds
[0m21:33:42.111481 [debug] [Thread-2 (]: SQL status: BEGIN in 1.048 seconds
[0m21:33:42.114264 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m21:33:42.114864 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:33:42.115221 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:33:42.115529 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  create view "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp"
    
    
  as (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users"
group by
    1,
    2
  );
[0m21:33:42.115932 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m21:33:42.295218 [debug] [Thread-4 (]: SQL status: COMMIT in 0.178 seconds
[0m21:33:42.296427 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.180 seconds
[0m21:33:42.301053 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."events_stat__dbt_backup"
[0m21:33:42.312969 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:33:42.313648 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:33:42.314095 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m21:33:42.314486 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop view if exists "dev_ohwk"."dbt"."events_stat__dbt_backup" cascade
[0m21:33:42.375029 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.060 seconds
[0m21:33:42.376082 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.061 seconds
[0m21:33:42.378746 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:33:42.381155 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m21:33:42.381758 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:33:42.382355 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:33:42.383216 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108037b30>]}
[0m21:33:42.384167 [info ] [Thread-4 (]: 14 of 17 OK created sql view model dbt.events_stat ............................. [[32mCREATE VIEW[0m in 1.40s]
[0m21:33:42.385023 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m21:33:42.447778 [debug] [Thread-2 (]: SQL status: COMMIT in 0.065 seconds
[0m21:33:42.451180 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily__dbt_backup"
[0m21:33:42.451959 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:33:42.452362 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_daily__dbt_backup" cascade
[0m21:33:42.546560 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.093 seconds
[0m21:33:42.549936 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: Close
[0m21:33:42.551611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108037290>]}
[0m21:33:42.552740 [info ] [Thread-2 (]: 15 of 17 OK created sql view model dbt.trips_age_daily ......................... [[32mCREATE VIEW[0m in 1.50s]
[0m21:33:42.553582 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m21:33:42.554448 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m21:33:42.555086 [info ] [Thread-3 (]: 17 of 17 START sql view model dbt.trips_age_daily_stat ......................... [RUN]
[0m21:33:42.555759 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily_stat)
[0m21:33:42.556214 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m21:33:42.561033 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:42.562204 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m21:33:42.566544 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:42.567348 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:42.567674 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m21:33:42.567973 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:33:44.602909 [debug] [Thread-1 (]: SQL status: BEGIN in 3.539 seconds
[0m21:33:44.604345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:33:44.604878 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  create view "dev_ohwk"."dbt"."trips_age_group__dbt_tmp"
    
    
  as (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users" as tu
    cross join "dev_ohwk"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
[0m21:33:44.761610 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.156 seconds
[0m21:33:44.766969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:33:44.767637 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m21:33:44.851748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.083 seconds
[0m21:33:44.854401 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:33:44.854996 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:33:44.855538 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:33:44.919949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.063 seconds
[0m21:33:44.925217 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_group__dbt_backup"
[0m21:33:44.926397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:33:44.927199 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_group__dbt_backup" cascade
[0m21:33:44.992987 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.065 seconds
[0m21:33:44.995283 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: Close
[0m21:33:44.996193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108037e90>]}
[0m21:33:44.997088 [info ] [Thread-1 (]: 16 of 17 OK created sql view model dbt.trips_age_group ......................... [[32mCREATE VIEW[0m in 3.95s]
[0m21:33:44.997923 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_group
[0m21:33:45.946513 [debug] [Thread-3 (]: SQL status: BEGIN in 3.378 seconds
[0m21:33:45.947703 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:45.948436 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  create view "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp"
    
    
  as (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_ohwk"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
[0m21:33:46.015811 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.066 seconds
[0m21:33:46.025029 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:46.025864 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m21:33:46.102188 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.075 seconds
[0m21:33:46.105719 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:33:46.106530 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:46.107151 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:33:46.170879 [debug] [Thread-3 (]: SQL status: COMMIT in 0.063 seconds
[0m21:33:46.176741 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup"
[0m21:33:46.177643 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:33:46.178123 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop view if exists "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m21:33:46.238134 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.059 seconds
[0m21:33:46.242273 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m21:33:46.244052 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dab404-9fdd-4f99-bac2-f530b99dc52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080354f0>]}
[0m21:33:46.245271 [info ] [Thread-3 (]: 17 of 17 OK created sql view model dbt.trips_age_daily_stat .................... [[32mCREATE VIEW[0m in 3.69s]
[0m21:33:46.246308 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m21:33:46.248961 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:46.249425 [debug] [MainThread]: On master: BEGIN
[0m21:33:46.249813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:33:47.001376 [debug] [MainThread]: SQL status: BEGIN in 0.751 seconds
[0m21:33:47.002464 [debug] [MainThread]: On master: COMMIT
[0m21:33:47.003108 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:47.003632 [debug] [MainThread]: On master: COMMIT
[0m21:33:47.048978 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:33:47.049964 [debug] [MainThread]: On master: Close
[0m21:33:47.052070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:47.052600 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m21:33:47.052976 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m21:33:47.053313 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m21:33:47.053713 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m21:33:47.054407 [info ] [MainThread]: 
[0m21:33:47.054896 [info ] [MainThread]: Finished running 4 incremental models, 13 view models in 0 hours 0 minutes and 23.74 seconds (23.74s).
[0m21:33:47.058541 [debug] [MainThread]: Command end result
[0m21:33:47.086908 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:33:47.088428 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:33:47.092830 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:33:47.093036 [info ] [MainThread]: 
[0m21:33:47.093257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:33:47.093432 [info ] [MainThread]: 
[0m21:33:47.093609 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=17
[0m21:33:47.095390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.04306, "process_in_blocks": "0", "process_kernel_time": 0.234516, "process_mem_max_rss": "140722176", "process_out_blocks": "0", "process_user_time": 1.72513}
[0m21:33:47.095726 [debug] [MainThread]: Command `dbt run` succeeded at 21:33:47.095660 after 24.04 seconds
[0m21:33:47.095971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817b770>]}
[0m21:33:47.096197 [debug] [MainThread]: Flushing usage events
[0m21:33:47.928626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:13.719039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f574d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744fb10>]}


============================== 21:51:13.721488 | 81739301-6de8-4cd8-8871-7573ccea6d92 ==============================
[0m21:51:13.721488 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:51:13.721751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt show -s trips_prep', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:51:13.788484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81739301-6de8-4cd8-8871-7573ccea6d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106753490>]}
[0m21:51:13.810184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81739301-6de8-4cd8-8871-7573ccea6d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e6030>]}
[0m21:51:13.819863 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:51:13.859009 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:51:13.913338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:51:13.913534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:51:13.930414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81739301-6de8-4cd8-8871-7573ccea6d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817af50>]}
[0m21:51:13.962296 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:51:13.963526 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:51:13.965088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81739301-6de8-4cd8-8871-7573ccea6d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801a3f0>]}
[0m21:51:13.965293 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:51:13.965443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81739301-6de8-4cd8-8871-7573ccea6d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2c2f0>]}
[0m21:51:13.966150 [info ] [MainThread]: 
[0m21:51:13.966298 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:51:13.966403 [info ] [MainThread]: 
[0m21:51:13.966601 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:51:13.968548 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_dbt'
[0m21:51:13.991723 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:51:13.991951 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:51:13.992083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:15.032424 [debug] [ThreadPool]: SQL status: BEGIN in 1.040 seconds
[0m21:51:15.033977 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:51:15.035110 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:51:15.102644 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.066 seconds
[0m21:51:15.116031 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:51:15.161531 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:51:15.165723 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:15.165893 [debug] [MainThread]: On master: BEGIN
[0m21:51:15.166014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:16.330595 [debug] [MainThread]: SQL status: BEGIN in 1.164 seconds
[0m21:51:16.332186 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:16.333283 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:51:16.507455 [debug] [MainThread]: SQL status: SELECT 17 in 0.173 seconds
[0m21:51:16.517778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81739301-6de8-4cd8-8871-7573ccea6d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839d4a0>]}
[0m21:51:16.518448 [debug] [MainThread]: On master: ROLLBACK
[0m21:51:16.561772 [debug] [MainThread]: On master: Close
[0m21:51:16.569176 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m21:51:16.570049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.trips_prep)
[0m21:51:16.570615 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m21:51:16.580138 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m21:51:16.581216 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m21:51:16.587008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:51:16.587328 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  
  select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  
  limit 5

[0m21:51:16.587601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:17.314531 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.726 seconds
[0m21:51:17.323673 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m21:51:17.325336 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m21:51:17.327357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:17.327921 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_prep' was properly closed.
[0m21:51:17.328716 [debug] [MainThread]: Command end result
[0m21:51:17.352391 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:51:17.353537 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:51:17.357560 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:51:17.358117 [info ] [MainThread]: Previewing node 'trips_prep':
| id | user_id | scooter_hw_id   |           started_at |          finished_at | start_lat | ... |
| -- | ------- | --------------- | -------------------- | -------------------- | --------- | --- |
|  1 |    1393 | GT-GXLV2-99D4   | 2023-06-01 03:06:... | 2023-06-01 03:24:... |   55.761… | ... |
|  2 |    1987 | XM-1S-56D8X     | 2023-06-01 03:27:... | 2023-06-01 03:53:... |   55.743… | ... |
|  3 |     981 | SN-ES2-82XF4    | 2023-06-01 03:32:... | 2023-06-01 04:05:... |   55.762… | ... |
|  4 |    1629 | SN-MAXG30-56D2G | 2023-06-01 03:36:... | 2023-06-01 04:00:... |   55.743… | ... |
|  5 |     602 | SN-MAXG30-56D2G | 2023-06-01 03:42:... | 2023-06-01 04:10:... |   55.732… | ... |

[0m21:51:17.359831 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 3.666701, "process_in_blocks": "0", "process_kernel_time": 0.138045, "process_mem_max_rss": "133611520", "process_out_blocks": "0", "process_user_time": 0.825505}
[0m21:51:17.360102 [debug] [MainThread]: Command `dbt show` succeeded at 21:51:17.360050 after 3.67 seconds
[0m21:51:17.360312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108535e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108535ff0>]}
[0m21:51:17.360505 [debug] [MainThread]: Flushing usage events
[0m21:51:18.013619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:52:33.552147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11080f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112627b10>]}


============================== 21:52:33.554545 | a4743445-06b5-4e72-a575-ec2d82ec6851 ==============================
[0m21:52:33.554545 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:52:33.554807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt show -s trips_prep --output json', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:52:33.620036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4743445-06b5-4e72-a575-ec2d82ec6851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c2b490>]}
[0m21:52:33.641533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4743445-06b5-4e72-a575-ec2d82ec6851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123be030>]}
[0m21:52:33.650116 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:52:33.688205 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:52:33.741378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:52:33.741554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:52:33.758714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4743445-06b5-4e72-a575-ec2d82ec6851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134a6f50>]}
[0m21:52:33.791560 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:52:33.793596 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:52:33.795022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4743445-06b5-4e72-a575-ec2d82ec6851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133463f0>]}
[0m21:52:33.795194 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:52:33.795330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4743445-06b5-4e72-a575-ec2d82ec6851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b5c2f0>]}
[0m21:52:33.796023 [info ] [MainThread]: 
[0m21:52:33.796182 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:52:33.796286 [info ] [MainThread]: 
[0m21:52:33.796478 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:52:33.798268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_dbt'
[0m21:52:33.821158 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:52:33.821358 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:52:33.821472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:34.595686 [debug] [ThreadPool]: SQL status: BEGIN in 0.774 seconds
[0m21:52:34.597006 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:52:34.597683 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:52:34.644152 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.046 seconds
[0m21:52:34.648484 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:52:34.691516 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:52:34.705874 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:34.706388 [debug] [MainThread]: On master: BEGIN
[0m21:52:34.706716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:52:35.418923 [debug] [MainThread]: SQL status: BEGIN in 0.712 seconds
[0m21:52:35.420391 [debug] [MainThread]: Using postgres connection "master"
[0m21:52:35.421662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:52:36.092607 [debug] [MainThread]: SQL status: SELECT 17 in 0.670 seconds
[0m21:52:36.100138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4743445-06b5-4e72-a575-ec2d82ec6851', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136c54a0>]}
[0m21:52:36.100846 [debug] [MainThread]: On master: ROLLBACK
[0m21:52:36.145934 [debug] [MainThread]: On master: Close
[0m21:52:36.153885 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m21:52:36.154816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.trips_prep)
[0m21:52:36.155469 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m21:52:36.166125 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m21:52:36.167179 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m21:52:36.173726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:52:36.174082 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  
  select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  
  limit 5

[0m21:52:36.174363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:36.860952 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.686 seconds
[0m21:52:36.869941 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m21:52:36.872126 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m21:52:36.874495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:36.875011 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_prep' was properly closed.
[0m21:52:36.876141 [debug] [MainThread]: Command end result
[0m21:52:36.905067 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:52:36.906451 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:52:36.910573 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:52:36.911078 [info ] [MainThread]: {
  "node": "trips_prep",
  "show": [
    {
      "id": 1,
      "user_id": 1393,
      "scooter_hw_id": "GT-GXLV2-99D4",
      "started_at": "2023-06-01T03:06:02+00:00",
      "finished_at": "2023-06-01T03:24:49+00:00",
      "start_lat": 55.76074980015,
      "start_lon": 37.613998000366,
      "finish_lat": 55.771709800018,
      "finish_lon": 37.618098300294,
      "distance_m": 1644.9869999999992,
      "price_rub": 0.0,
      "duration_s": 1127.0,
      "is_free": true,
      "date": "2023-06-01"
    },
    {
      "id": 2,
      "user_id": 1987,
      "scooter_hw_id": "XM-1S-56D8X",
      "started_at": "2023-06-01T03:27:24+00:00",
      "finished_at": "2023-06-01T03:53:51+00:00",
      "start_lat": 55.742680999971,
      "start_lon": 37.651061899694,
      "finish_lat": 55.737762199979,
      "finish_lon": 37.601283200021,
      "distance_m": 4430.513000000002,
      "price_rub": 0.0,
      "duration_s": 1587.0,
      "is_free": true,
      "date": "2023-06-01"
    },
    {
      "id": 3,
      "user_id": 981,
      "scooter_hw_id": "SN-ES2-82XF4",
      "started_at": "2023-06-01T03:32:32+00:00",
      "finished_at": "2023-06-01T04:05:32+00:00",
      "start_lat": 55.761562000052,
      "start_lon": 37.642958999712,
      "finish_lat": 55.749707300062,
      "finish_lon": 37.589230200223,
      "distance_m": 4473.652999999999,
      "price_rub": 0.0,
      "duration_s": 1980.0,
      "is_free": true,
      "date": "2023-06-01"
    },
    {
      "id": 4,
      "user_id": 1629,
      "scooter_hw_id": "SN-MAXG30-56D2G",
      "started_at": "2023-06-01T03:36:45+00:00",
      "finished_at": "2023-06-01T04:00:30+00:00",
      "start_lat": 55.74342999992,
      "start_lon": 37.590625999817,
      "finish_lat": 55.735751999836,
      "finish_lon": 37.614239000391,
      "distance_m": 2506.7030000000004,
      "price_rub": 237.5,
      "duration_s": 1425.0,
      "is_free": false,
      "date": "2023-06-01"
    },
    {
      "id": 5,
      "user_id": 602,
      "scooter_hw_id": "SN-MAXG30-56D2G",
      "started_at": "2023-06-01T03:42:08+00:00",
      "finished_at": "2023-06-01T04:10:24+00:00",
      "start_lat": 55.7316526,
      "start_lon": 37.623907,
      "finish_lat": 55.769427999931,
      "finish_lon": 37.623846999784,
      "distance_m": 4883.543000000001,
      "price_rub": 0.0,
      "duration_s": 1696.0,
      "is_free": true,
      "date": "2023-06-01"
    }
  ]
}
[0m21:52:36.912866 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 3.3870766, "process_in_blocks": "0", "process_kernel_time": 0.134818, "process_mem_max_rss": "134119424", "process_out_blocks": "0", "process_user_time": 0.840605}
[0m21:52:36.913136 [debug] [MainThread]: Command `dbt show` succeeded at 21:52:36.913084 after 3.39 seconds
[0m21:52:36.913349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112504dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114061ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114061f40>]}
[0m21:52:36.913549 [debug] [MainThread]: Flushing usage events
[0m21:52:37.549924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:53:18.097054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c9f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c9fb10>]}


============================== 21:53:18.098843 | cb3e2d83-31ef-4c77-afff-8106497b70be ==============================
[0m21:53:18.098843 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:53:18.099115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': "dbt show --inline select current_setting('TIMEZONE')", 'send_anonymous_usage_stats': 'True'}
[0m21:53:18.162951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb3e2d83-31ef-4c77-afff-8106497b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9f490>]}
[0m21:53:18.184695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb3e2d83-31ef-4c77-afff-8106497b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b36030>]}
[0m21:53:18.189577 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:53:18.223082 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:53:18.267579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:53:18.267751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:53:18.284095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb3e2d83-31ef-4c77-afff-8106497b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099caf50>]}
[0m21:53:18.315687 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:53:18.316531 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:53:18.366377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb3e2d83-31ef-4c77-afff-8106497b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3fa70>]}
[0m21:53:18.366582 [info ] [MainThread]: Found 17 models, 3 seeds, 1 sql operation, 17 sources, 435 macros
[0m21:53:18.366728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb3e2d83-31ef-4c77-afff-8106497b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cc1c50>]}
[0m21:53:18.367536 [info ] [MainThread]: 
[0m21:53:18.367687 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:53:18.367797 [info ] [MainThread]: 
[0m21:53:18.367986 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:53:18.369833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_dbt'
[0m21:53:18.388145 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:53:18.388335 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:53:18.388448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:19.953330 [debug] [ThreadPool]: SQL status: BEGIN in 1.564 seconds
[0m21:53:19.954968 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:53:19.956021 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:53:20.004193 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.047 seconds
[0m21:53:20.009947 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:53:20.059858 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:53:20.074373 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:20.074908 [debug] [MainThread]: On master: BEGIN
[0m21:53:20.075177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:53:20.701954 [debug] [MainThread]: SQL status: BEGIN in 0.627 seconds
[0m21:53:20.702764 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:20.703244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:53:21.060749 [debug] [MainThread]: SQL status: SELECT 17 in 0.357 seconds
[0m21:53:21.067264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb3e2d83-31ef-4c77-afff-8106497b70be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd8120>]}
[0m21:53:21.067888 [debug] [MainThread]: On master: ROLLBACK
[0m21:53:21.111813 [debug] [MainThread]: On master: Close
[0m21:53:21.115900 [debug] [Thread-1 (]: Began running node sql_operation.dbt_scooters.inline_query
[0m21:53:21.116574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now sql_operation.dbt_scooters.inline_query)
[0m21:53:21.117104 [debug] [Thread-1 (]: Began compiling node sql_operation.dbt_scooters.inline_query
[0m21:53:21.156891 [debug] [Thread-1 (]: Writing injected SQL for node "sql_operation.dbt_scooters.inline_query"
[0m21:53:21.157540 [debug] [Thread-1 (]: Began executing node sql_operation.dbt_scooters.inline_query
[0m21:53:21.160361 [debug] [Thread-1 (]: Using postgres connection "sql_operation.dbt_scooters.inline_query"
[0m21:53:21.160550 [debug] [Thread-1 (]: On sql_operation.dbt_scooters.inline_query: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "sql_operation.dbt_scooters.inline_query"} */

  
  select current_setting('TIMEZONE')
  
  limit 5

[0m21:53:21.160684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:21.776228 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.615 seconds
[0m21:53:21.782399 [debug] [Thread-1 (]: On sql_operation.dbt_scooters.inline_query: Close
[0m21:53:21.784157 [debug] [Thread-1 (]: Finished running node sql_operation.dbt_scooters.inline_query
[0m21:53:21.785814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:53:21.786179 [debug] [MainThread]: Connection 'sql_operation.dbt_scooters.inline_query' was properly closed.
[0m21:53:21.786904 [debug] [MainThread]: Command end result
[0m21:53:21.807562 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:53:21.808678 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:53:21.812703 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:53:21.812953 [info ] [MainThread]: Previewing inline node:
| current_setting |
| --------------- |
| UTC             |

[0m21:53:21.813864 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 3.7424076, "process_in_blocks": "0", "process_kernel_time": 0.109746, "process_mem_max_rss": "136232960", "process_out_blocks": "0", "process_user_time": 0.89293}
[0m21:53:21.814105 [debug] [MainThread]: Command `dbt show` succeeded at 21:53:21.814058 after 3.74 seconds
[0m21:53:21.814300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca2af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca2c50>]}
[0m21:53:21.814484 [debug] [MainThread]: Flushing usage events
[0m21:53:22.357764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:54:55.635469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f434d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10543b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10543bb10>]}


============================== 21:54:55.637209 | 183b4641-0f0d-43d5-9005-1a4ba045c63a ==============================
[0m21:54:55.637209 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:54:55.637484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -s config.materialized:incremental --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:54:55.698904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10473f490>]}
[0m21:54:55.719249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d2030>]}
[0m21:54:55.719581 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:54:55.752708 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:54:55.795940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:54:55.796145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:54:55.814149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bb450>]}
[0m21:54:55.846024 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:54:55.846913 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:54:55.859520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106339e50>]}
[0m21:54:55.859737 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:54:55.860602 [info ] [MainThread]: 
[0m21:54:55.860743 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:54:55.860856 [info ] [MainThread]: 
[0m21:54:55.861057 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:54:55.862560 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:54:55.880197 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:54:55.880380 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:54:55.880491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:56.746155 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.865 seconds
[0m21:54:56.751275 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:54:56.756004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:54:56.763798 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:54:56.764345 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:54:56.764610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:54:57.380069 [debug] [ThreadPool]: SQL status: BEGIN in 0.615 seconds
[0m21:54:57.381584 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:54:57.382697 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:54:57.430159 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.046 seconds
[0m21:54:57.435442 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:54:57.478061 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:54:57.493077 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:57.493655 [debug] [MainThread]: On master: BEGIN
[0m21:54:57.493931 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:58.481110 [debug] [MainThread]: SQL status: BEGIN in 0.987 seconds
[0m21:54:58.482724 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:58.484026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:54:58.708390 [debug] [MainThread]: SQL status: SELECT 17 in 0.223 seconds
[0m21:54:58.720603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106352970>]}
[0m21:54:58.721407 [debug] [MainThread]: On master: ROLLBACK
[0m21:54:58.766864 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:58.767977 [debug] [MainThread]: On master: BEGIN
[0m21:54:58.857564 [debug] [MainThread]: SQL status: BEGIN in 0.089 seconds
[0m21:54:58.858700 [debug] [MainThread]: On master: COMMIT
[0m21:54:58.859710 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:58.860576 [debug] [MainThread]: On master: COMMIT
[0m21:54:58.904812 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m21:54:58.905908 [debug] [MainThread]: On master: Close
[0m21:54:58.914266 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:54:58.914795 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:54:58.915231 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:54:58.915635 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:54:58.916320 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:54:58.916891 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:54:58.917494 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:54:58.918061 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:54:58.918641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:54:58.919181 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:54:58.919856 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:54:58.920687 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:54:58.921141 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:54:58.921529 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:54:58.921886 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:54:58.922216 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:54:58.939181 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:54:58.940230 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:54:58.942340 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:54:58.944660 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:54:58.946234 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:54:58.946413 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:54:58.946566 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:54:58.946733 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:54:59.011402 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:54:59.011688 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:54:59.013220 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:54:59.014379 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:54:59.014538 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215458995907"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:54:59.014850 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:54:59.015182 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:54:59.015378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:54:59.015522 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:54:59.015650 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:54:59.015771 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:54:59.015886 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:54:59.016004 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:54:59.016118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:59.016228 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:54:59.787086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.770 seconds
[0m21:54:59.788951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:54:59.790268 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
  
    

  create  table "dev_ohwk"."dbt"."events_clean__dbt_tmp"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" < timestamp '2023-08-01'

  );
  
  
[0m21:55:00.802695 [debug] [Thread-4 (]: SQL status: BEGIN in 1.786 seconds
[0m21:55:00.804357 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:00.805576 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_users__dbt_tmp"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

      where
          t.id <= 75000

  );
  
  
[0m21:55:01.003552 [debug] [Thread-3 (]: SQL status: BEGIN in 1.987 seconds
[0m21:55:01.004221 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:01.004719 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:55:02.304592 [debug] [Thread-2 (]: SQL status: SELECT 3 in 3.289 seconds
[0m21:55:02.324910 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:02.325469 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:55:02.737017 [debug] [Thread-2 (]: SQL status: BEGIN in 0.411 seconds
[0m21:55:02.737968 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:02.738633 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215458995907'
        
      order by ordinal_position

  
[0m21:55:03.300965 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.561 seconds
[0m21:55:03.309781 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:03.310512 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:03.603953 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.292 seconds
[0m21:55:03.624408 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:03.625044 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215458995907'
        
      order by ordinal_position

  
[0m21:55:04.010289 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.384 seconds
[0m21:55:04.017546 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:04.018434 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:04.246396 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.227 seconds
[0m21:55:04.260647 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:55:04.268488 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:55:04.280230 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:55:04.281023 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:04.281317 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215458995907" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215458995907"
    )
  
[0m21:55:04.442607 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.160 seconds
[0m21:55:04.443778 [debug] [Thread-3 (]: SQL status: SELECT 10 in 3.438 seconds
[0m21:55:04.470472 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:55:04.474300 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:04.474638 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:04.474942 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m21:55:04.475207 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:55:04.571087 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m21:55:04.577448 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:04.578084 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m21:55:04.649605 [debug] [Thread-2 (]: SQL status: COMMIT in 0.174 seconds
[0m21:55:04.654060 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:55:04.657460 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f4e8f0>]}
[0m21:55:04.658662 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 5.74s]
[0m21:55:04.659379 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:55:04.703287 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.124 seconds
[0m21:55:04.708679 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:55:04.709207 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:04.709580 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:55:04.904804 [debug] [Thread-3 (]: SQL status: COMMIT in 0.195 seconds
[0m21:55:04.915596 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_concurrency__dbt_backup"
[0m21:55:04.921821 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:04.922300 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_ohwk"."dbt"."trips_concurrency__dbt_backup" cascade
[0m21:55:05.103903 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.181 seconds
[0m21:55:05.108189 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:55:05.109669 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106386990>]}
[0m21:55:05.110729 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mSELECT 10[0m in 6.19s]
[0m21:55:05.111588 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:55:08.244462 [debug] [Thread-4 (]: SQL status: SELECT 75000 in 7.437 seconds
[0m21:55:08.251391 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:08.251934 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users" rename to "trips_users__dbt_backup"
[0m21:55:08.300316 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m21:55:08.306379 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:08.307011 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users__dbt_tmp" rename to "trips_users"
[0m21:55:08.354312 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m21:55:08.358523 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:55:08.359641 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:08.360630 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:55:08.505095 [debug] [Thread-4 (]: SQL status: COMMIT in 0.143 seconds
[0m21:55:08.512076 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_users__dbt_backup"
[0m21:55:08.512928 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:08.513331 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
drop table if exists "dev_ohwk"."dbt"."trips_users__dbt_backup" cascade
[0m21:55:08.705526 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.191 seconds
[0m21:55:08.710722 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:55:08.712558 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630b8b0>]}
[0m21:55:08.713477 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mSELECT 75000[0m in 9.79s]
[0m21:55:08.714079 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:55:09.094386 [debug] [Thread-1 (]: SQL status: SELECT 221370 in 9.303 seconds
[0m21:55:09.104219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:09.104752 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean" rename to "events_clean__dbt_backup"
[0m21:55:09.147186 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.042 seconds
[0m21:55:09.152775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:09.153339 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean__dbt_tmp" rename to "events_clean"
[0m21:55:09.195813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.042 seconds
[0m21:55:09.199164 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:55:09.199848 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:09.200404 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:55:09.244172 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m21:55:09.246901 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."events_clean__dbt_backup"
[0m21:55:09.247504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:09.247880 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
drop table if exists "dev_ohwk"."dbt"."events_clean__dbt_backup" cascade
[0m21:55:09.297030 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.049 seconds
[0m21:55:09.300285 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:55:09.302269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183b4641-0f0d-43d5-9005-1a4ba045c63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105407bb0>]}
[0m21:55:09.303583 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mSELECT 221370[0m in 10.38s]
[0m21:55:09.304394 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:55:09.307137 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:09.307624 [debug] [MainThread]: On master: BEGIN
[0m21:55:09.307971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:10.776968 [debug] [MainThread]: SQL status: BEGIN in 1.469 seconds
[0m21:55:10.777339 [debug] [MainThread]: On master: COMMIT
[0m21:55:10.777575 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:10.777787 [debug] [MainThread]: On master: COMMIT
[0m21:55:10.829416 [debug] [MainThread]: SQL status: COMMIT in 0.051 seconds
[0m21:55:10.830159 [debug] [MainThread]: On master: Close
[0m21:55:10.831273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:10.831652 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:55:10.831981 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:55:10.832276 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:55:10.832552 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:55:10.833069 [info ] [MainThread]: 
[0m21:55:10.833476 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 14.97 seconds (14.97s).
[0m21:55:10.834756 [debug] [MainThread]: Command end result
[0m21:55:10.858398 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:55:10.859849 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:55:10.863660 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:55:10.863861 [info ] [MainThread]: 
[0m21:55:10.864084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:55:10.864254 [info ] [MainThread]: 
[0m21:55:10.864431 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:55:10.866013 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 15.257017, "process_in_blocks": "0", "process_kernel_time": 0.141741, "process_mem_max_rss": "141590528", "process_out_blocks": "0", "process_user_time": 1.212258}
[0m21:55:10.866321 [debug] [MainThread]: Command `dbt build` succeeded at 21:55:10.866258 after 15.26 seconds
[0m21:55:10.866546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106139250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545b2a0>]}
[0m21:55:10.866766 [debug] [MainThread]: Flushing usage events
[0m21:55:11.496285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:55:12.196205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078934d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8bb10>]}


============================== 21:55:12.198027 | 9fb9d5b6-d137-40e8-a03a-f0b441558545 ==============================
[0m21:55:12.198027 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:55:12.198286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build -s config.materialized:incremental', 'send_anonymous_usage_stats': 'True'}
[0m21:55:12.260451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808b490>]}
[0m21:55:12.282086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c22030>]}
[0m21:55:12.282458 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:55:12.315600 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:55:12.358774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:55:12.358954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:55:12.376777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0b450>]}
[0m21:55:12.408444 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:55:12.409248 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:55:12.422045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8de50>]}
[0m21:55:12.422278 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:55:12.423138 [info ] [MainThread]: 
[0m21:55:12.423286 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:55:12.423397 [info ] [MainThread]: 
[0m21:55:12.423594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:55:12.425082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:55:12.442627 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:55:12.442808 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:55:12.442924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:13.372794 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.929 seconds
[0m21:55:13.377410 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:55:13.382911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:55:13.391049 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:55:13.391617 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:55:13.391911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:14.100094 [debug] [ThreadPool]: SQL status: BEGIN in 0.708 seconds
[0m21:55:14.101718 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:55:14.102829 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:55:14.205117 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.101 seconds
[0m21:55:14.210958 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:55:14.300255 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:55:14.312416 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:14.312786 [debug] [MainThread]: On master: BEGIN
[0m21:55:14.313064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:14.954688 [debug] [MainThread]: SQL status: BEGIN in 0.641 seconds
[0m21:55:14.956537 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:14.957830 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:55:15.202275 [debug] [MainThread]: SQL status: SELECT 10 in 0.243 seconds
[0m21:55:15.206416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c62970>]}
[0m21:55:15.207228 [debug] [MainThread]: On master: ROLLBACK
[0m21:55:15.249162 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:15.250158 [debug] [MainThread]: On master: BEGIN
[0m21:55:15.634925 [debug] [MainThread]: SQL status: BEGIN in 0.384 seconds
[0m21:55:15.636455 [debug] [MainThread]: On master: COMMIT
[0m21:55:15.637495 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:15.638416 [debug] [MainThread]: On master: COMMIT
[0m21:55:15.708251 [debug] [MainThread]: SQL status: COMMIT in 0.069 seconds
[0m21:55:15.708795 [debug] [MainThread]: On master: Close
[0m21:55:15.711876 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:55:15.712191 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:55:15.712446 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:55:15.712647 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:55:15.712947 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:55:15.713299 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:55:15.713606 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:55:15.713948 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:55:15.714337 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:55:15.714621 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:55:15.714834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:55:15.715082 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:55:15.715288 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:55:15.715465 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:55:15.715629 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:55:15.715795 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:55:15.724958 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:55:15.727073 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:55:15.728669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:55:15.730276 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:55:15.730798 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:55:15.730997 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:55:15.731145 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:55:15.731279 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:55:15.785540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:15.785747 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:15.787131 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:15.788283 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:15.788435 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp215515750228"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m21:55:15.788582 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp215515748334"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:55:15.788724 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215515786500"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:55:15.788884 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp215515787802"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:55:15.789032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:15.789146 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:55:15.789267 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:55:15.789391 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:55:19.102006 [debug] [Thread-2 (]: SQL status: SELECT 3 in 3.312 seconds
[0m21:55:19.124039 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:19.124567 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:55:19.204305 [debug] [Thread-2 (]: SQL status: BEGIN in 0.079 seconds
[0m21:55:19.205565 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:19.206495 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215515786500'
        
      order by ordinal_position

  
[0m21:55:19.846286 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.638 seconds
[0m21:55:19.854943 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:19.855435 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:20.106033 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.250 seconds
[0m21:55:20.129355 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:20.129576 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215515786500'
        
      order by ordinal_position

  
[0m21:55:20.302706 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.172 seconds
[0m21:55:20.312767 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:20.313508 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:20.603621 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.289 seconds
[0m21:55:20.618750 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:55:20.624651 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:55:20.634578 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:55:20.635206 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:20.635468 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215515786500" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215515786500"
    )
  
[0m21:55:20.710660 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.075 seconds
[0m21:55:20.718243 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:55:20.718474 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:20.718631 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:55:20.807322 [debug] [Thread-2 (]: SQL status: COMMIT in 0.088 seconds
[0m21:55:20.809319 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:55:20.811312 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a73a5b0>]}
[0m21:55:20.811975 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 5.10s]
[0m21:55:20.812494 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:55:21.101397 [debug] [Thread-1 (]: SQL status: SELECT 101377 in 5.312 seconds
[0m21:55:21.109881 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:21.110348 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:55:21.156939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m21:55:21.157723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:21.158286 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215515750228'
        
      order by ordinal_position

  
[0m21:55:21.746818 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.587 seconds
[0m21:55:21.753695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:21.754302 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:21.805921 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.051 seconds
[0m21:55:21.812455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:21.813276 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215515750228'
        
      order by ordinal_position

  
[0m21:55:22.003633 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.189 seconds
[0m21:55:22.011305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:22.012131 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:22.508565 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.495 seconds
[0m21:55:22.512719 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:55:22.522032 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:55:22.523468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:22.523906 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp215515750228"
    )


  
[0m21:55:23.942319 [debug] [Thread-4 (]: SQL status: SELECT 30901 in 8.153 seconds
[0m21:55:23.949540 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:23.950088 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:55:24.003785 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m21:55:24.005222 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:24.006448 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215515748334'
        
      order by ordinal_position

  
[0m21:55:24.204743 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.197 seconds
[0m21:55:24.213108 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:24.213688 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:24.303790 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.089 seconds
[0m21:55:24.311302 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:24.312011 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215515748334'
        
      order by ordinal_position

  
[0m21:55:24.401496 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.089 seconds
[0m21:55:24.407792 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:24.408462 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:24.502047 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.093 seconds
[0m21:55:24.511410 [debug] [Thread-4 (]: 
    In "dev_ohwk"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:55:24.512435 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:55:24.513082 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:24.513388 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp215515748334"
    )


  
[0m21:55:26.707114 [debug] [Thread-1 (]: SQL status: INSERT 0 101377 in 4.182 seconds
[0m21:55:26.708818 [debug] [Thread-4 (]: SQL status: INSERT 0 30901 in 2.195 seconds
[0m21:55:26.712896 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:55:26.714653 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:55:26.715406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:26.715811 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:26.716167 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:55:26.716504 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:55:26.810609 [debug] [Thread-4 (]: SQL status: COMMIT in 0.093 seconds
[0m21:55:26.811906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.095 seconds
[0m21:55:26.813795 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:55:26.815116 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:55:26.816928 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd2090>]}
[0m21:55:26.817714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c56780>]}
[0m21:55:26.818921 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 30901[0m in 11.10s]
[0m21:55:26.820148 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 101377[0m in 11.10s]
[0m21:55:26.820969 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:55:26.821683 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:55:32.236598 [debug] [Thread-3 (]: SQL status: SELECT 199849 in 16.447 seconds
[0m21:55:32.241894 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:32.242632 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:55:32.287169 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m21:55:32.288082 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:32.288664 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215515787802'
        
      order by ordinal_position

  
[0m21:55:32.340046 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.050 seconds
[0m21:55:32.345722 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:32.346328 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:32.421144 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.074 seconds
[0m21:55:32.429222 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:32.429971 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215515787802'
        
      order by ordinal_position

  
[0m21:55:32.483393 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.052 seconds
[0m21:55:32.489982 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:32.490784 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:32.537370 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.046 seconds
[0m21:55:32.542931 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:55:32.545585 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:55:32.547514 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:32.547919 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp215515787802"
    )


  
[0m21:55:34.591815 [debug] [Thread-3 (]: SQL status: INSERT 0 199849 in 2.043 seconds
[0m21:55:34.594696 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:55:34.595368 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:34.595920 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:55:34.644726 [debug] [Thread-3 (]: SQL status: COMMIT in 0.048 seconds
[0m21:55:34.646625 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:55:34.648301 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb9d5b6-d137-40e8-a03a-f0b441558545', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a787f70>]}
[0m21:55:34.649611 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mINSERT 0 199849[0m in 18.93s]
[0m21:55:34.650858 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:55:34.653721 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:34.654263 [debug] [MainThread]: On master: BEGIN
[0m21:55:34.654647 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:36.264096 [debug] [MainThread]: SQL status: BEGIN in 1.609 seconds
[0m21:55:36.265648 [debug] [MainThread]: On master: COMMIT
[0m21:55:36.266728 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:36.267640 [debug] [MainThread]: On master: COMMIT
[0m21:55:36.313993 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:55:36.315280 [debug] [MainThread]: On master: Close
[0m21:55:36.316781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:36.317312 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:55:36.317775 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:55:36.318189 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:55:36.318579 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:55:36.319235 [info ] [MainThread]: 
[0m21:55:36.319790 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 23.90 seconds (23.90s).
[0m21:55:36.321626 [debug] [MainThread]: Command end result
[0m21:55:36.352854 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:55:36.354285 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:55:36.358133 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:55:36.358337 [info ] [MainThread]: 
[0m21:55:36.358554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:55:36.358724 [info ] [MainThread]: 
[0m21:55:36.358898 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:55:36.359865 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 24.189741, "process_in_blocks": "0", "process_kernel_time": 0.142761, "process_mem_max_rss": "138723328", "process_out_blocks": "0", "process_user_time": 1.20623}
[0m21:55:36.360119 [debug] [MainThread]: Command `dbt build` succeeded at 21:55:36.360067 after 24.19 seconds
[0m21:55:36.360314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107484250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dab230>]}
[0m21:55:36.360506 [debug] [MainThread]: Flushing usage events
[0m21:55:36.884624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:55:46.143244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106827b10>]}


============================== 21:55:46.145075 | 1419d6bf-f2f5-4682-a950-f92edb201861 ==============================
[0m21:55:46.145075 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:55:46.145339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -s config.materialized:incremental --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m21:55:46.210391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2b490>]}
[0m21:55:46.232214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebe030>]}
[0m21:55:46.232594 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:55:46.265941 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:55:46.309548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:55:46.309741 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:55:46.327895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d7450>]}
[0m21:55:46.359912 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:55:46.360788 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:55:46.371536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107551e50>]}
[0m21:55:46.371739 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:55:46.372563 [info ] [MainThread]: 
[0m21:55:46.372712 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:55:46.372835 [info ] [MainThread]: 
[0m21:55:46.373036 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:55:46.374539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:55:46.393499 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:55:46.393681 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:55:46.393791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:47.063221 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.669 seconds
[0m21:55:47.066501 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:55:47.072464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:55:47.081165 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:55:47.081769 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:55:47.082104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:47.749534 [debug] [ThreadPool]: SQL status: BEGIN in 0.667 seconds
[0m21:55:47.751157 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:55:47.752290 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:55:47.838796 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.085 seconds
[0m21:55:47.844143 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:55:47.915651 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:55:47.928754 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:47.929185 [debug] [MainThread]: On master: BEGIN
[0m21:55:47.929496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:48.667327 [debug] [MainThread]: SQL status: BEGIN in 0.737 seconds
[0m21:55:48.668951 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:48.670276 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:55:48.905327 [debug] [MainThread]: SQL status: SELECT 10 in 0.233 seconds
[0m21:55:48.913875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107536970>]}
[0m21:55:48.914398 [debug] [MainThread]: On master: ROLLBACK
[0m21:55:48.957742 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:48.958447 [debug] [MainThread]: On master: BEGIN
[0m21:55:49.051765 [debug] [MainThread]: SQL status: BEGIN in 0.093 seconds
[0m21:55:49.052728 [debug] [MainThread]: On master: COMMIT
[0m21:55:49.053201 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:49.053533 [debug] [MainThread]: On master: COMMIT
[0m21:55:49.106229 [debug] [MainThread]: SQL status: COMMIT in 0.052 seconds
[0m21:55:49.107603 [debug] [MainThread]: On master: Close
[0m21:55:49.116577 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:55:49.117287 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:55:49.117772 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:55:49.118213 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:55:49.118965 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:55:49.119601 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:55:49.120188 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:55:49.120781 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:55:49.121401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:55:49.121953 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:55:49.122422 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:55:49.122875 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:55:49.123459 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:55:49.124076 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:55:49.124491 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:55:49.124844 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:55:49.139390 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:55:49.142442 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:55:49.145001 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:55:49.146934 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:55:49.147561 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:55:49.147856 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:55:49.153728 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:55:49.167296 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:55:49.211570 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:55:49.212594 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:55:49.214014 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:55:49.215896 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:49.216228 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215549214706"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:55:49.216390 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:55:49.216647 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:49.216805 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:55:49.216947 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:55:49.217100 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:49.217337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:49.217502 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:55:49.217638 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:55:49.217754 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:55:49.217868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:49.995147 [debug] [Thread-3 (]: SQL status: BEGIN in 0.778 seconds
[0m21:55:49.997032 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:49.998467 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:55:51.303903 [debug] [Thread-4 (]: SQL status: BEGIN in 2.086 seconds
[0m21:55:51.305567 [debug] [Thread-1 (]: SQL status: BEGIN in 2.087 seconds
[0m21:55:51.306780 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:51.307993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:55:51.309272 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_users__dbt_tmp"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

      where
          t.id <= 75000

  );
  
  
[0m21:55:51.310412 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
  
    

  create  table "dev_ohwk"."dbt"."events_clean__dbt_tmp"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" < timestamp '2023-08-01'

  );
  
  
[0m21:55:51.411423 [debug] [Thread-3 (]: SQL status: SELECT 10 in 1.412 seconds
[0m21:55:51.427402 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:51.427886 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m21:55:51.504852 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.076 seconds
[0m21:55:51.511093 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:51.511875 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m21:55:51.604266 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m21:55:51.629608 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:55:51.629991 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:51.630241 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:55:51.904877 [debug] [Thread-3 (]: SQL status: COMMIT in 0.274 seconds
[0m21:55:51.916827 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_concurrency__dbt_backup"
[0m21:55:51.921773 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:55:51.922151 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_ohwk"."dbt"."trips_concurrency__dbt_backup" cascade
[0m21:55:52.308996 [debug] [Thread-2 (]: SQL status: SELECT 3 in 3.092 seconds
[0m21:55:52.310789 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.388 seconds
[0m21:55:52.329732 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:52.331976 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:55:52.332317 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:55:52.333870 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f55e60>]}
[0m21:55:52.334410 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mSELECT 10[0m in 3.21s]
[0m21:55:52.334851 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:55:52.411627 [debug] [Thread-2 (]: SQL status: BEGIN in 0.079 seconds
[0m21:55:52.412177 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:52.412532 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215549214706'
        
      order by ordinal_position

  
[0m21:55:52.819596 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.406 seconds
[0m21:55:52.830269 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:52.830784 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:53.014356 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.183 seconds
[0m21:55:53.034401 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:53.034857 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215549214706'
        
      order by ordinal_position

  
[0m21:55:53.103904 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.068 seconds
[0m21:55:53.110545 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:53.111178 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:55:53.309857 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.198 seconds
[0m21:55:53.325245 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:55:53.330428 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:55:53.340104 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:55:53.340736 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:53.340970 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215549214706" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215549214706"
    )
  
[0m21:55:53.405335 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.064 seconds
[0m21:55:53.406794 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:55:53.407162 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:55:53.407484 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:55:53.843582 [debug] [Thread-2 (]: SQL status: COMMIT in 0.435 seconds
[0m21:55:53.846908 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:55:53.849107 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a6d50>]}
[0m21:55:53.850191 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 4.73s]
[0m21:55:53.850891 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:55:57.251449 [debug] [Thread-4 (]: SQL status: SELECT 75000 in 5.940 seconds
[0m21:55:57.259575 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:57.260164 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users" rename to "trips_users__dbt_backup"
[0m21:55:57.312538 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.052 seconds
[0m21:55:57.319909 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:57.320642 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users__dbt_tmp" rename to "trips_users"
[0m21:55:57.409165 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m21:55:57.413409 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:55:57.414087 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:57.414646 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:55:57.833314 [debug] [Thread-4 (]: SQL status: COMMIT in 0.418 seconds
[0m21:55:57.838060 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_users__dbt_backup"
[0m21:55:57.838915 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:55:57.839423 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
drop table if exists "dev_ohwk"."dbt"."trips_users__dbt_backup" cascade
[0m21:55:58.013641 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.173 seconds
[0m21:55:58.018436 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:55:58.020386 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107533280>]}
[0m21:55:58.021570 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mSELECT 75000[0m in 8.90s]
[0m21:55:58.022327 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:56:00.135711 [debug] [Thread-1 (]: SQL status: SELECT 221370 in 8.824 seconds
[0m21:56:00.142366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:00.142859 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean" rename to "events_clean__dbt_backup"
[0m21:56:01.155797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.012 seconds
[0m21:56:01.162239 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:01.162762 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean__dbt_tmp" rename to "events_clean"
[0m21:56:01.208456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m21:56:01.213038 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:56:01.214244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:01.215259 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:56:01.266382 [debug] [Thread-1 (]: SQL status: COMMIT in 0.050 seconds
[0m21:56:01.271087 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."events_clean__dbt_backup"
[0m21:56:01.272064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:01.272637 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
drop table if exists "dev_ohwk"."dbt"."events_clean__dbt_backup" cascade
[0m21:56:01.331869 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.058 seconds
[0m21:56:01.336192 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:56:01.338554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1419d6bf-f2f5-4682-a950-f92edb201861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6cc30>]}
[0m21:56:01.340153 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mSELECT 221370[0m in 12.22s]
[0m21:56:01.340863 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:56:01.342958 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:01.343389 [debug] [MainThread]: On master: BEGIN
[0m21:56:01.343741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:56:02.206971 [debug] [MainThread]: SQL status: BEGIN in 0.863 seconds
[0m21:56:02.208554 [debug] [MainThread]: On master: COMMIT
[0m21:56:02.209605 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:02.210248 [debug] [MainThread]: On master: COMMIT
[0m21:56:02.255423 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m21:56:02.256727 [debug] [MainThread]: On master: Close
[0m21:56:02.258900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:02.259566 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:56:02.260077 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:56:02.260511 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:56:02.260974 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:56:02.261652 [info ] [MainThread]: 
[0m21:56:02.262240 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 15.89 seconds (15.89s).
[0m21:56:02.264037 [debug] [MainThread]: Command end result
[0m21:56:02.292530 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:56:02.294031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:56:02.298112 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:56:02.298314 [info ] [MainThread]: 
[0m21:56:02.298533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:56:02.298697 [info ] [MainThread]: 
[0m21:56:02.298870 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:56:02.299863 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 16.181684, "process_in_blocks": "0", "process_kernel_time": 0.144575, "process_mem_max_rss": "139083776", "process_out_blocks": "0", "process_user_time": 1.205599}
[0m21:56:02.300123 [debug] [MainThread]: Command `dbt build` succeeded at 21:56:02.300069 after 16.18 seconds
[0m21:56:02.300345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca1dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c694d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068472a0>]}
[0m21:56:02.300554 [debug] [MainThread]: Flushing usage events
[0m21:56:02.897971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:56:03.578585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055af4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c27b10>]}


============================== 21:56:03.580489 | 93b758c6-e215-406e-b15d-11de98f086bb ==============================
[0m21:56:03.580489 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:56:03.580756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -s config.materialized:incremental', 'send_anonymous_usage_stats': 'True'}
[0m21:56:03.643356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da7490>]}
[0m21:56:03.663776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106abe030>]}
[0m21:56:03.664141 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:56:03.697118 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:56:03.740342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:56:03.740525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:56:03.758504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a53450>]}
[0m21:56:03.790424 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:56:03.791248 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:56:03.801812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd1e50>]}
[0m21:56:03.802016 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:56:03.802839 [info ] [MainThread]: 
[0m21:56:03.802986 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:56:03.803104 [info ] [MainThread]: 
[0m21:56:03.803317 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:56:03.804843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:56:03.822205 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:56:03.822408 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:56:03.822528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:05.353968 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.531 seconds
[0m21:56:05.358785 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:56:05.364344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:56:05.372446 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:56:05.373027 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:56:05.373354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:56:06.064566 [debug] [ThreadPool]: SQL status: BEGIN in 0.691 seconds
[0m21:56:06.066401 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:56:06.067516 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:56:06.120557 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.052 seconds
[0m21:56:06.125428 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:56:06.172563 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:56:06.186423 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:06.186908 [debug] [MainThread]: On master: BEGIN
[0m21:56:06.187135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:06.888692 [debug] [MainThread]: SQL status: BEGIN in 0.701 seconds
[0m21:56:06.890397 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:06.891720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:56:07.103958 [debug] [MainThread]: SQL status: SELECT 10 in 0.211 seconds
[0m21:56:07.110357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca2970>]}
[0m21:56:07.111167 [debug] [MainThread]: On master: ROLLBACK
[0m21:56:07.156399 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:07.157516 [debug] [MainThread]: On master: BEGIN
[0m21:56:07.248221 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m21:56:07.249548 [debug] [MainThread]: On master: COMMIT
[0m21:56:07.250532 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:07.251445 [debug] [MainThread]: On master: COMMIT
[0m21:56:07.300960 [debug] [MainThread]: SQL status: COMMIT in 0.049 seconds
[0m21:56:07.302225 [debug] [MainThread]: On master: Close
[0m21:56:07.309891 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:56:07.310415 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:56:07.310768 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:56:07.311082 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:56:07.311687 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:56:07.312210 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:56:07.313007 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:56:07.313641 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:56:07.314174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:56:07.314704 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:56:07.315163 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:56:07.315588 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:56:07.315958 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:56:07.316301 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:56:07.316594 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:56:07.316864 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:56:07.328965 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:56:07.332092 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:56:07.334422 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:56:07.336559 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:56:07.337255 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:56:07.337487 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:56:07.337679 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:56:07.337849 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:56:07.403497 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:07.404985 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:07.405210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:07.406372 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:07.406527 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp215607388085"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:56:07.406678 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215607404292"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:56:07.406817 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp215607396615"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m21:56:07.406973 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp215607405896"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:56:07.407121 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:56:07.407238 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:56:07.407348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:56:07.407459 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:56:09.904177 [debug] [Thread-4 (]: SQL status: SELECT 30901 in 2.496 seconds
[0m21:56:09.926038 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:09.926472 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:56:09.969893 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m21:56:09.970643 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:09.971219 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215607388085'
        
      order by ordinal_position

  
[0m21:56:10.608891 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.637 seconds
[0m21:56:10.621776 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:10.622492 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:10.809617 [debug] [Thread-2 (]: SQL status: SELECT 3 in 3.402 seconds
[0m21:56:10.811134 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.188 seconds
[0m21:56:10.817801 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:10.834104 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:10.834482 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:56:10.834782 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215607388085'
        
      order by ordinal_position

  
[0m21:56:10.907121 [debug] [Thread-2 (]: SQL status: BEGIN in 0.072 seconds
[0m21:56:10.907476 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:10.907731 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215607404292'
        
      order by ordinal_position

  
[0m21:56:10.911029 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.076 seconds
[0m21:56:10.913752 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:10.914077 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:11.107789 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.193 seconds
[0m21:56:11.121718 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.214 seconds
[0m21:56:11.127031 [debug] [Thread-4 (]: 
    In "dev_ohwk"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:56:11.129634 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:11.138585 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:56:11.138917 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:11.139621 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:11.139892 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp215607388085"
    )


  
[0m21:56:11.309504 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.170 seconds
[0m21:56:11.317447 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:11.317829 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215607404292'
        
      order by ordinal_position

  
[0m21:56:11.504836 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.186 seconds
[0m21:56:11.512067 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:11.512630 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:12.270654 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.757 seconds
[0m21:56:12.274001 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:56:12.284700 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:56:12.295253 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:56:12.296285 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:12.296633 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215607404292" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215607404292"
    )
  
[0m21:56:12.403606 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.106 seconds
[0m21:56:12.426626 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:56:12.427087 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:56:12.427386 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:56:12.603570 [debug] [Thread-2 (]: SQL status: COMMIT in 0.175 seconds
[0m21:56:12.607960 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:56:12.612026 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8629c0>]}
[0m21:56:12.613199 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 5.29s]
[0m21:56:12.614081 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:56:12.992609 [debug] [Thread-4 (]: SQL status: INSERT 0 30901 in 1.852 seconds
[0m21:56:12.997925 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:56:12.999271 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:56:13.000381 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:56:13.203137 [debug] [Thread-4 (]: SQL status: COMMIT in 0.202 seconds
[0m21:56:13.205360 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:56:13.207023 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1a810>]}
[0m21:56:13.208236 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 30901[0m in 5.89s]
[0m21:56:13.209432 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:56:16.109131 [debug] [Thread-1 (]: SQL status: SELECT 101377 in 8.701 seconds
[0m21:56:16.118976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:16.119519 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:56:16.203784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m21:56:16.204576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:16.205162 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215607396615'
        
      order by ordinal_position

  
[0m21:56:16.405999 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.200 seconds
[0m21:56:16.412616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:16.413384 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:16.503819 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.090 seconds
[0m21:56:16.510254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:16.510805 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215607396615'
        
      order by ordinal_position

  
[0m21:56:16.606117 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.095 seconds
[0m21:56:16.613948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:16.614668 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:16.716934 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.101 seconds
[0m21:56:16.721351 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:56:16.722848 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:56:16.724402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:16.725005 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp215607396615"
    )


  
[0m21:56:18.829132 [debug] [Thread-1 (]: SQL status: INSERT 0 101377 in 2.103 seconds
[0m21:56:18.833414 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:56:18.834000 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:56:18.834457 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:56:18.908992 [debug] [Thread-1 (]: SQL status: COMMIT in 0.074 seconds
[0m21:56:18.911411 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:56:18.913689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9e990>]}
[0m21:56:18.915554 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 101377[0m in 11.60s]
[0m21:56:18.916437 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:56:24.974779 [debug] [Thread-3 (]: SQL status: SELECT 199849 in 17.567 seconds
[0m21:56:24.979871 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:24.980505 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:56:25.026033 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m21:56:25.027121 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:25.028237 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215607405896'
        
      order by ordinal_position

  
[0m21:56:25.080110 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.051 seconds
[0m21:56:25.085979 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:25.086647 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:25.134890 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.047 seconds
[0m21:56:25.140814 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:25.141588 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215607405896'
        
      order by ordinal_position

  
[0m21:56:25.193284 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.051 seconds
[0m21:56:25.199063 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:25.199740 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:56:25.247439 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.047 seconds
[0m21:56:25.250272 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:56:25.251588 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:56:25.252968 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:25.253507 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp215607405896"
    )


  
[0m21:56:27.208066 [debug] [Thread-3 (]: SQL status: INSERT 0 199849 in 1.954 seconds
[0m21:56:27.210884 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:56:27.211677 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:56:27.212148 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:56:27.260120 [debug] [Thread-3 (]: SQL status: COMMIT in 0.047 seconds
[0m21:56:27.262748 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:56:27.264127 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b758c6-e215-406e-b15d-11de98f086bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089eed50>]}
[0m21:56:27.265095 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mINSERT 0 199849[0m in 19.95s]
[0m21:56:27.265904 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:56:27.268050 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:27.268420 [debug] [MainThread]: On master: BEGIN
[0m21:56:27.268905 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:56:28.007099 [debug] [MainThread]: SQL status: BEGIN in 0.738 seconds
[0m21:56:28.008227 [debug] [MainThread]: On master: COMMIT
[0m21:56:28.008924 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:28.009398 [debug] [MainThread]: On master: COMMIT
[0m21:56:28.054971 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:56:28.057174 [debug] [MainThread]: On master: Close
[0m21:56:28.058984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:28.059606 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:56:28.060103 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:56:28.060571 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:56:28.061010 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:56:28.061703 [info ] [MainThread]: 
[0m21:56:28.062303 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 24.26 seconds (24.26s).
[0m21:56:28.065808 [debug] [MainThread]: Command end result
[0m21:56:28.095218 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:56:28.096480 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:56:28.100225 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:56:28.100404 [info ] [MainThread]: 
[0m21:56:28.100603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:56:28.100761 [info ] [MainThread]: 
[0m21:56:28.100924 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:56:28.101841 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 24.548256, "process_in_blocks": "0", "process_kernel_time": 0.144767, "process_mem_max_rss": "141312000", "process_out_blocks": "0", "process_user_time": 1.223772}
[0m21:56:28.102097 [debug] [MainThread]: Command `dbt build` succeeded at 21:56:28.102045 after 24.55 seconds
[0m21:56:28.102299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c47230>]}
[0m21:56:28.102490 [debug] [MainThread]: Flushing usage events
[0m21:56:29.311495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:57:18.121159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035bf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab7b10>]}


============================== 21:57:18.123071 | 5f6b9fce-7a29-4d18-830f-55606260669e ==============================
[0m21:57:18.123071 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:57:18.123343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build -s config.materialized:incremental --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:57:18.186331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dbb490>]}
[0m21:57:18.207116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494e030>]}
[0m21:57:18.207491 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:57:18.240723 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:57:18.284174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:57:18.284351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:57:18.302464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105737450>]}
[0m21:57:18.334592 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:57:18.335421 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:57:18.345953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b9e50>]}
[0m21:57:18.346152 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:57:18.347014 [info ] [MainThread]: 
[0m21:57:18.347171 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:57:18.347289 [info ] [MainThread]: 
[0m21:57:18.347506 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:57:18.348986 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:57:18.366535 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:57:18.366720 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:57:18.366833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:19.480096 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.112 seconds
[0m21:57:19.483819 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:57:19.489378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:57:19.498130 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:57:19.498632 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:57:19.498944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:20.211378 [debug] [ThreadPool]: SQL status: BEGIN in 0.712 seconds
[0m21:57:20.212824 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:57:20.213518 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:57:20.304190 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.090 seconds
[0m21:57:20.308140 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:57:20.356974 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:57:20.369578 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:20.369938 [debug] [MainThread]: On master: BEGIN
[0m21:57:20.370204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:57:21.006606 [debug] [MainThread]: SQL status: BEGIN in 0.636 seconds
[0m21:57:21.008161 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:21.008999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:57:21.224363 [debug] [MainThread]: SQL status: SELECT 10 in 0.214 seconds
[0m21:57:21.230865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ce970>]}
[0m21:57:21.231942 [debug] [MainThread]: On master: ROLLBACK
[0m21:57:21.275651 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:21.276718 [debug] [MainThread]: On master: BEGIN
[0m21:57:21.365428 [debug] [MainThread]: SQL status: BEGIN in 0.088 seconds
[0m21:57:21.366332 [debug] [MainThread]: On master: COMMIT
[0m21:57:21.367323 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:21.368204 [debug] [MainThread]: On master: COMMIT
[0m21:57:21.412976 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m21:57:21.413909 [debug] [MainThread]: On master: Close
[0m21:57:21.421596 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:57:21.422334 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:57:21.422925 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:57:21.423389 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:57:21.424127 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:57:21.424852 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:57:21.425541 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:57:21.426190 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:57:21.426865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:57:21.427458 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:57:21.427986 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:57:21.428447 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:57:21.428838 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:57:21.429788 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:57:21.430372 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:57:21.430779 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:57:21.451297 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:57:21.451861 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:57:21.454171 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:57:21.456000 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:57:21.456619 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:57:21.456846 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:57:21.457048 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:57:21.457227 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:57:21.523039 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:57:21.525234 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:21.525764 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:57:21.526922 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:57:21.527153 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215721524053"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:57:21.527496 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:57:21.527704 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:21.527946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:21.528093 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:57:21.528264 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:21.528430 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:57:21.528573 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:57:21.528702 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:57:21.528827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:21.529029 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:57:22.449812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.921 seconds
[0m21:57:22.450999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:22.452293 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
  
    

  create  table "dev_ohwk"."dbt"."events_clean__dbt_tmp"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" < timestamp '2023-08-01'

  );
  
  
[0m21:57:23.406311 [debug] [Thread-4 (]: SQL status: BEGIN in 1.877 seconds
[0m21:57:23.406762 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:23.407073 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_users__dbt_tmp"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

      where
          t.id <= 75000

  );
  
  
[0m21:57:23.413061 [debug] [Thread-3 (]: SQL status: BEGIN in 1.884 seconds
[0m21:57:23.413467 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:23.413870 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:57:24.008713 [debug] [Thread-2 (]: SQL status: SELECT 3 in 2.480 seconds
[0m21:57:24.028982 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:24.029427 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:57:24.166434 [debug] [Thread-2 (]: SQL status: BEGIN in 0.136 seconds
[0m21:57:24.167838 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:24.168429 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215721524053'
        
      order by ordinal_position

  
[0m21:57:24.415028 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.246 seconds
[0m21:57:24.424178 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:24.425125 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:24.782166 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.356 seconds
[0m21:57:24.803792 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:24.804353 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215721524053'
        
      order by ordinal_position

  
[0m21:57:25.389850 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.585 seconds
[0m21:57:25.395347 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:25.395965 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:25.705893 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.309 seconds
[0m21:57:25.721927 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:57:25.729533 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:57:25.741213 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:57:25.742039 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:25.742320 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215721524053" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215721524053"
    )
  
[0m21:57:25.804208 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.061 seconds
[0m21:57:25.819905 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:57:25.820277 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:25.820538 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:57:25.906382 [debug] [Thread-2 (]: SQL status: COMMIT in 0.085 seconds
[0m21:57:25.910857 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:57:25.916005 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e8a5b0>]}
[0m21:57:25.917162 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 4.48s]
[0m21:57:25.918026 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:57:26.104270 [debug] [Thread-3 (]: SQL status: SELECT 10 in 2.690 seconds
[0m21:57:26.120449 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:26.121148 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m21:57:26.206865 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.085 seconds
[0m21:57:26.215579 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:26.216252 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m21:57:26.302291 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.085 seconds
[0m21:57:26.309696 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:57:26.310255 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:26.310685 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:57:26.403011 [debug] [Thread-3 (]: SQL status: COMMIT in 0.092 seconds
[0m21:57:26.415019 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_concurrency__dbt_backup"
[0m21:57:26.421062 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:26.421555 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_ohwk"."dbt"."trips_concurrency__dbt_backup" cascade
[0m21:57:26.709741 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.288 seconds
[0m21:57:26.712133 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:57:26.713590 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a01f10>]}
[0m21:57:26.714775 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mSELECT 10[0m in 5.29s]
[0m21:57:26.715777 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:57:31.305558 [debug] [Thread-4 (]: SQL status: SELECT 75000 in 7.898 seconds
[0m21:57:31.308115 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:31.308413 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users" rename to "trips_users__dbt_backup"
[0m21:57:31.407997 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.099 seconds
[0m21:57:31.414682 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:31.415285 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users__dbt_tmp" rename to "trips_users"
[0m21:57:31.506335 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m21:57:31.510461 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:57:31.511285 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:31.511962 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:57:32.144394 [debug] [Thread-4 (]: SQL status: COMMIT in 0.631 seconds
[0m21:57:32.148245 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_users__dbt_backup"
[0m21:57:32.149116 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:32.149577 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
drop table if exists "dev_ohwk"."dbt"."trips_users__dbt_backup" cascade
[0m21:57:32.451922 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.301 seconds
[0m21:57:32.456923 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:57:32.458657 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105982990>]}
[0m21:57:32.459649 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mSELECT 75000[0m in 11.03s]
[0m21:57:32.460423 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:57:32.705130 [debug] [Thread-1 (]: SQL status: SELECT 221370 in 10.252 seconds
[0m21:57:32.712322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:32.713030 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean" rename to "events_clean__dbt_backup"
[0m21:57:32.763358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.049 seconds
[0m21:57:32.770809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:32.771345 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
alter table "dev_ohwk"."dbt"."events_clean__dbt_tmp" rename to "events_clean"
[0m21:57:32.816103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m21:57:32.820554 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:57:32.821714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:32.822726 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:57:32.869485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.046 seconds
[0m21:57:32.874477 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."events_clean__dbt_backup"
[0m21:57:32.875561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:32.876150 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */
drop table if exists "dev_ohwk"."dbt"."events_clean__dbt_backup" cascade
[0m21:57:32.928099 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.051 seconds
[0m21:57:32.931610 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:57:32.933016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f6b9fce-7a29-4d18-830f-55606260669e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abc910>]}
[0m21:57:32.934248 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mSELECT 221370[0m in 11.51s]
[0m21:57:32.935266 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:57:32.937665 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:32.938231 [debug] [MainThread]: On master: BEGIN
[0m21:57:32.938735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:57:33.579777 [debug] [MainThread]: SQL status: BEGIN in 0.641 seconds
[0m21:57:33.580273 [debug] [MainThread]: On master: COMMIT
[0m21:57:33.580573 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:33.580827 [debug] [MainThread]: On master: COMMIT
[0m21:57:33.625732 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:57:33.626514 [debug] [MainThread]: On master: Close
[0m21:57:33.627483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:33.627851 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:57:33.628110 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:57:33.628371 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:57:33.628617 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:57:33.629066 [info ] [MainThread]: 
[0m21:57:33.629419 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 15.28 seconds (15.28s).
[0m21:57:33.630585 [debug] [MainThread]: Command end result
[0m21:57:33.653960 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:57:33.655619 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:57:33.659541 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:57:33.659745 [info ] [MainThread]: 
[0m21:57:33.659961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:57:33.660137 [info ] [MainThread]: 
[0m21:57:33.660314 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:57:33.661830 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 15.567552, "process_in_blocks": "0", "process_kernel_time": 0.145549, "process_mem_max_rss": "140804096", "process_out_blocks": "0", "process_user_time": 1.180753}
[0m21:57:33.662106 [debug] [MainThread]: Command `dbt build` succeeded at 21:57:33.662052 after 15.57 seconds
[0m21:57:33.662329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a39e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad72a0>]}
[0m21:57:33.662537 [debug] [MainThread]: Flushing usage events
[0m21:57:34.174188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:57:35.027157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041774d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d27b10>]}


============================== 21:57:35.029494 | e3aaf12d-d88c-43e4-87c7-cce107db9f39 ==============================
[0m21:57:35.029494 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:57:35.029757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -s config.materialized:incremental', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:57:35.094203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d27490>]}
[0m21:57:35.114714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbe030>]}
[0m21:57:35.115379 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:57:35.152084 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:57:35.201123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:57:35.201301 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:57:35.218828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aff450>]}
[0m21:57:35.249976 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:57:35.250791 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:57:35.266439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d81e50>]}
[0m21:57:35.266669 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:57:35.267553 [info ] [MainThread]: 
[0m21:57:35.267700 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:57:35.267807 [info ] [MainThread]: 
[0m21:57:35.268002 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:57:35.269484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:57:35.289943 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:57:35.290120 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:57:35.290228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:36.369363 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.079 seconds
[0m21:57:36.374703 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:57:36.378207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:57:36.384250 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:57:36.384640 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:57:36.384906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:37.101425 [debug] [ThreadPool]: SQL status: BEGIN in 0.716 seconds
[0m21:57:37.103127 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:57:37.104234 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:57:37.154746 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.049 seconds
[0m21:57:37.160037 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:57:37.205342 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:57:37.218098 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:37.218506 [debug] [MainThread]: On master: BEGIN
[0m21:57:37.218792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:57:38.732198 [debug] [MainThread]: SQL status: BEGIN in 1.513 seconds
[0m21:57:38.733785 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:38.735094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:57:38.911802 [debug] [MainThread]: SQL status: SELECT 10 in 0.175 seconds
[0m21:57:38.918067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d52970>]}
[0m21:57:38.918964 [debug] [MainThread]: On master: ROLLBACK
[0m21:57:38.962615 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:38.963779 [debug] [MainThread]: On master: BEGIN
[0m21:57:39.051675 [debug] [MainThread]: SQL status: BEGIN in 0.087 seconds
[0m21:57:39.052927 [debug] [MainThread]: On master: COMMIT
[0m21:57:39.053930 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:39.054874 [debug] [MainThread]: On master: COMMIT
[0m21:57:39.100804 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:57:39.102033 [debug] [MainThread]: On master: Close
[0m21:57:39.111469 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:57:39.111948 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:57:39.112312 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:57:39.112632 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:57:39.113235 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:57:39.113779 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:57:39.114805 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:57:39.115561 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:57:39.116161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:57:39.116701 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:57:39.117171 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:57:39.117605 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:57:39.117977 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:57:39.118281 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:57:39.118558 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:57:39.118830 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:57:39.130950 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:57:39.133947 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:57:39.136175 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:57:39.138615 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:57:39.139213 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:57:39.139450 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:57:39.139636 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:57:39.139804 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:57:39.196931 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:39.198703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:39.200254 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:39.201446 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:39.201611 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215739157365"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:57:39.201756 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp215739158690"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m21:57:39.201895 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp215739199524"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:57:39.202051 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp215739200959"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:57:39.202196 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:57:39.202309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:39.202415 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:57:39.202521 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:57:42.490736 [debug] [Thread-2 (]: SQL status: SELECT 3 in 3.288 seconds
[0m21:57:42.511626 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:42.512091 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:57:42.603859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.091 seconds
[0m21:57:42.604889 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:42.605566 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215739157365'
        
      order by ordinal_position

  
[0m21:57:43.304512 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.698 seconds
[0m21:57:43.313024 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:43.313562 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:43.508509 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.194 seconds
[0m21:57:43.518149 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:43.518507 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215739157365'
        
      order by ordinal_position

  
[0m21:57:44.333891 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.815 seconds
[0m21:57:44.343051 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:44.343659 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:44.640927 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.296 seconds
[0m21:57:44.657250 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:57:44.663404 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:57:44.674126 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:57:44.674849 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:44.675124 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215739157365" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215739157365"
    )
  
[0m21:57:44.804831 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.129 seconds
[0m21:57:44.826394 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:57:44.826787 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:57:44.827091 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:57:44.906507 [debug] [Thread-2 (]: SQL status: COMMIT in 0.079 seconds
[0m21:57:44.911864 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:57:44.915575 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d23a5b0>]}
[0m21:57:44.916602 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 5.80s]
[0m21:57:44.917373 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:57:46.484261 [debug] [Thread-4 (]: SQL status: SELECT 30901 in 7.281 seconds
[0m21:57:46.492651 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:46.493337 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:57:46.603584 [debug] [Thread-4 (]: SQL status: BEGIN in 0.109 seconds
[0m21:57:46.605185 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:46.606437 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215739199524'
        
      order by ordinal_position

  
[0m21:57:47.105388 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.498 seconds
[0m21:57:47.108642 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:47.109043 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:47.309292 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.200 seconds
[0m21:57:47.315120 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:47.315699 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215739199524'
        
      order by ordinal_position

  
[0m21:57:47.507164 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.190 seconds
[0m21:57:47.514627 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:47.515476 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:48.629146 [debug] [Thread-4 (]: SQL status: SELECT 17 in 1.113 seconds
[0m21:57:48.632302 [debug] [Thread-4 (]: 
    In "dev_ohwk"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:57:48.637607 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:57:48.638358 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:48.638696 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp215739199524"
    )


  
[0m21:57:49.454147 [debug] [Thread-1 (]: SQL status: SELECT 101377 in 10.251 seconds
[0m21:57:49.461545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:49.462323 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:57:49.507195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m21:57:49.508528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:49.509736 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215739158690'
        
      order by ordinal_position

  
[0m21:57:49.905245 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.394 seconds
[0m21:57:49.909809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:49.910368 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:50.106916 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.196 seconds
[0m21:57:50.111702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:50.112355 [debug] [Thread-4 (]: SQL status: INSERT 0 30901 in 1.473 seconds
[0m21:57:50.112848 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215739158690'
        
      order by ordinal_position

  
[0m21:57:50.114422 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:57:50.114959 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:57:50.115355 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:57:50.207093 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.092 seconds
[0m21:57:50.209604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:50.209932 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:50.306705 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.096 seconds
[0m21:57:50.311939 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:57:50.312758 [debug] [Thread-4 (]: SQL status: COMMIT in 0.197 seconds
[0m21:57:50.314382 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:57:50.315788 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:57:50.317386 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc5c10>]}
[0m21:57:50.317890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:50.318768 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 30901[0m in 11.20s]
[0m21:57:50.319208 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp215739158690"
    )


  
[0m21:57:50.319821 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:57:52.512157 [debug] [Thread-1 (]: SQL status: INSERT 0 101377 in 2.191 seconds
[0m21:57:52.516681 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:57:52.517277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:57:52.517709 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:57:52.607920 [debug] [Thread-1 (]: SQL status: COMMIT in 0.089 seconds
[0m21:57:52.610545 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:57:52.611864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071205d0>]}
[0m21:57:52.612742 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 101377[0m in 13.50s]
[0m21:57:52.613369 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:57:55.292591 [debug] [Thread-3 (]: SQL status: SELECT 199849 in 16.090 seconds
[0m21:57:55.297916 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:55.298771 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:57:55.344481 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m21:57:55.345369 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:55.345913 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215739200959'
        
      order by ordinal_position

  
[0m21:57:55.397655 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.051 seconds
[0m21:57:55.403705 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:55.404385 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:55.452863 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.048 seconds
[0m21:57:55.461512 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:55.462025 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215739200959'
        
      order by ordinal_position

  
[0m21:57:55.513179 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.050 seconds
[0m21:57:55.518728 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:55.519400 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:57:56.090621 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.570 seconds
[0m21:57:56.094743 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:57:56.095958 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:57:56.097444 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:56.097949 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp215739200959"
    )


  
[0m21:57:58.106873 [debug] [Thread-3 (]: SQL status: INSERT 0 199849 in 2.008 seconds
[0m21:57:58.108383 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:57:58.108786 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:57:58.109083 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:57:58.157436 [debug] [Thread-3 (]: SQL status: COMMIT in 0.048 seconds
[0m21:57:58.160339 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:57:58.161815 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3aaf12d-d88c-43e4-87c7-cce107db9f39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2853b0>]}
[0m21:57:58.162814 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mINSERT 0 199849[0m in 19.04s]
[0m21:57:58.163692 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:57:58.165621 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:58.166140 [debug] [MainThread]: On master: BEGIN
[0m21:57:58.166561 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:57:58.954462 [debug] [MainThread]: SQL status: BEGIN in 0.788 seconds
[0m21:57:58.955871 [debug] [MainThread]: On master: COMMIT
[0m21:57:58.956835 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:58.957424 [debug] [MainThread]: On master: COMMIT
[0m21:57:59.005940 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m21:57:59.007419 [debug] [MainThread]: On master: Close
[0m21:57:59.009495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:59.010107 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:57:59.010577 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:57:59.010997 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:57:59.011415 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:57:59.012095 [info ] [MainThread]: 
[0m21:57:59.012691 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 23.74 seconds (23.74s).
[0m21:57:59.014501 [debug] [MainThread]: Command end result
[0m21:57:59.044544 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:57:59.045845 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:57:59.049638 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:57:59.049845 [info ] [MainThread]: 
[0m21:57:59.050061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:57:59.050225 [info ] [MainThread]: 
[0m21:57:59.050396 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:57:59.051357 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 24.051727, "process_in_blocks": "0", "process_kernel_time": 0.157145, "process_mem_max_rss": "138510336", "process_out_blocks": "0", "process_user_time": 1.198997}
[0m21:57:59.051615 [debug] [MainThread]: Command `dbt build` succeeded at 21:57:59.051565 after 24.05 seconds
[0m21:57:59.051808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d91350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d01c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d47230>]}
[0m21:57:59.051994 [debug] [MainThread]: Flushing usage events
[0m21:58:00.358286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:28.517143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11101f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a27b10>]}


============================== 21:58:28.519444 | 2551b046-426a-4f39-854f-8729966d45f2 ==============================
[0m21:58:28.519444 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:58:28.519707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build -s config.materialized:incremental', 'send_anonymous_usage_stats': 'True'}
[0m21:58:28.587816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a27490>]}
[0m21:58:28.609798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128be030>]}
[0m21:58:28.610375 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:58:28.647997 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:58:28.700254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:58:28.700445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:58:28.719378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138db450>]}
[0m21:58:28.752677 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:58:28.753812 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:58:28.769691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b59e50>]}
[0m21:58:28.769914 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 435 macros
[0m21:58:28.770781 [info ] [MainThread]: 
[0m21:58:28.770927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:58:28.771038 [info ] [MainThread]: 
[0m21:58:28.771242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:58:28.772807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:58:28.795591 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:58:28.795799 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:58:28.795922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:29.433655 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.637 seconds
[0m21:58:29.437462 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:58:29.443103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:58:29.451756 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:58:29.452393 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:58:29.452722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:30.273680 [debug] [ThreadPool]: SQL status: BEGIN in 0.821 seconds
[0m21:58:30.275232 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:58:30.276349 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:58:30.328062 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.051 seconds
[0m21:58:30.332005 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:58:30.392002 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:58:30.406513 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:30.406984 [debug] [MainThread]: On master: BEGIN
[0m21:58:30.407326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:58:31.932394 [debug] [MainThread]: SQL status: BEGIN in 1.525 seconds
[0m21:58:31.933287 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:31.933914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:58:32.040250 [debug] [MainThread]: SQL status: SELECT 10 in 0.106 seconds
[0m21:58:32.046933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b72970>]}
[0m21:58:32.047820 [debug] [MainThread]: On master: ROLLBACK
[0m21:58:32.088960 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:32.090002 [debug] [MainThread]: On master: BEGIN
[0m21:58:32.204779 [debug] [MainThread]: SQL status: BEGIN in 0.114 seconds
[0m21:58:32.205741 [debug] [MainThread]: On master: COMMIT
[0m21:58:32.206384 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:32.206938 [debug] [MainThread]: On master: COMMIT
[0m21:58:32.248119 [debug] [MainThread]: SQL status: COMMIT in 0.040 seconds
[0m21:58:32.249391 [debug] [MainThread]: On master: Close
[0m21:58:32.258921 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:58:32.259538 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:58:32.259996 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m21:58:32.260396 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:58:32.261092 [info ] [Thread-1 (]: 1 of 4 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:58:32.261733 [info ] [Thread-3 (]: 3 of 4 START sql incremental model dbt.trips_concurrency ....................... [RUN]
[0m21:58:32.262323 [info ] [Thread-4 (]: 4 of 4 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:58:32.262883 [info ] [Thread-2 (]: 2 of 4 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:58:32.263515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m21:58:32.264120 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m21:58:32.264624 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_users'
[0m21:58:32.265274 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:58:32.266093 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:58:32.266546 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:58:32.266938 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:58:32.267410 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:58:32.284840 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:58:32.290004 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:58:32.293809 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:58:32.297680 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:58:32.298540 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:58:32.304833 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:58:32.305263 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m21:58:32.311960 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:58:32.366702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:32.368170 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:32.368800 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:32.370034 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:32.370202 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp215832354677"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m21:58:32.370360 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp215832367665"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:58:32.370539 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

    
  
    

  create temporary table "trips_concurrency__dbt_tmp215832357726"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
    group by
        1
    
    union all
    select
        "timestamp",
        concurrency as increment,
        false as preserve_row
    from
        "dev_ohwk"."dbt"."trips_concurrency"
    where
        "timestamp" = (select max("timestamp") from "dev_ohwk"."dbt"."trips_concurrency")
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
  
[0m21:58:32.370715 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp215832369504"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:58:32.370854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:32.370989 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:58:32.371120 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:58:32.371250 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:58:34.503732 [debug] [Thread-2 (]: SQL status: SELECT 3 in 2.132 seconds
[0m21:58:34.521653 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:34.522061 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:58:34.623660 [debug] [Thread-2 (]: SQL status: BEGIN in 0.101 seconds
[0m21:58:34.625282 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:34.626099 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215832369504'
        
      order by ordinal_position

  
[0m21:58:35.134675 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.507 seconds
[0m21:58:35.146145 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:35.146908 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:35.432139 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.284 seconds
[0m21:58:35.449832 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:35.450207 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp215832369504'
        
      order by ordinal_position

  
[0m21:58:35.602399 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.151 seconds
[0m21:58:35.610064 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:35.610807 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:35.707166 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.095 seconds
[0m21:58:35.723027 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:58:35.728849 [debug] [Thread-2 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:58:35.738851 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:58:35.739436 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:35.739681 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp215832369504" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp215832369504"
    )
  
[0m21:58:35.806507 [debug] [Thread-4 (]: SQL status: SELECT 0 in 3.435 seconds
[0m21:58:35.811176 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:35.811774 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.072 seconds
[0m21:58:35.812161 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:58:35.825467 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:58:35.825790 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:58:35.826045 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:58:35.871155 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m21:58:35.871608 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:35.871991 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215832367665'
        
      order by ordinal_position

  
[0m21:58:35.903610 [debug] [Thread-1 (]: SQL status: SELECT 0 in 3.533 seconds
[0m21:58:35.908748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:35.909260 [debug] [Thread-2 (]: SQL status: COMMIT in 0.083 seconds
[0m21:58:35.909752 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:58:35.912637 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:58:35.916686 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11464e0d0>]}
[0m21:58:35.917441 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 3.65s]
[0m21:58:35.918085 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:58:36.006159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.093 seconds
[0m21:58:36.006957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:36.007333 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215832354677'
        
      order by ordinal_position

  
[0m21:58:36.203561 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.195 seconds
[0m21:58:36.211772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:36.212345 [debug] [Thread-3 (]: SQL status: SELECT 0 in 3.841 seconds
[0m21:58:36.212840 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:36.215931 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.216536 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:58:36.304905 [debug] [Thread-3 (]: SQL status: BEGIN in 0.088 seconds
[0m21:58:36.306105 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.307154 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.435 seconds
[0m21:58:36.308389 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215832357726'
        
      order by ordinal_position

  
[0m21:58:36.309605 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.093 seconds
[0m21:58:36.313982 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:36.317430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:36.317894 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:36.318496 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp215832354677'
        
      order by ordinal_position

  
[0m21:58:36.407136 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.088 seconds
[0m21:58:36.408599 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.089 seconds
[0m21:58:36.409818 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.095 seconds
[0m21:58:36.414921 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:36.418380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:36.421396 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.421915 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp215832367665'
        
      order by ordinal_position

  
[0m21:58:36.422331 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:36.422729 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:36.507218 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.084 seconds
[0m21:58:36.508501 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.085 seconds
[0m21:58:36.509384 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.086 seconds
[0m21:58:36.513070 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:58:36.518933 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:36.522960 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.529811 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:58:36.530308 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:36.530697 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency__dbt_tmp215832357726'
        
      order by ordinal_position

  
[0m21:58:36.531565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:36.531893 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp215832354677"
    )


  
[0m21:58:36.603695 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.071 seconds
[0m21:58:36.604854 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.074 seconds
[0m21:58:36.607669 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:58:36.608337 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.077 seconds
[0m21:58:36.612908 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.613381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:58:36.616498 [debug] [Thread-4 (]: 
    In "dev_ohwk"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:58:36.616865 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_concurrency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:58:36.617183 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:58:36.618007 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:58:36.618815 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:36.619261 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp215832367665"
    )


  
[0m21:58:36.696394 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.077 seconds
[0m21:58:36.697806 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:58:36.698220 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.080 seconds
[0m21:58:36.698591 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:58:36.698887 [debug] [Thread-1 (]: SQL status: COMMIT in 0.081 seconds
[0m21:58:36.700330 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."trips_concurrency":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:58:36.700692 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:58:36.701359 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:58:36.702032 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:58:36.702686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ba5910>]}
[0m21:58:36.703622 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.703296 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 0[0m in 4.44s]
[0m21:58:36.704055 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

      insert into "dev_ohwk"."dbt"."trips_concurrency" ("timestamp", "concurrency", "updated_at")
    (
        select "timestamp", "concurrency", "updated_at"
        from "trips_concurrency__dbt_tmp215832357726"
    )


  
[0m21:58:36.704490 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:58:36.750887 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.046 seconds
[0m21:58:36.751291 [debug] [Thread-4 (]: SQL status: COMMIT in 0.049 seconds
[0m21:58:36.752879 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:58:36.753466 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m21:58:36.753755 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:58:36.754061 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:58:36.754464 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b1a570>]}
[0m21:58:36.755057 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 0[0m in 4.49s]
[0m21:58:36.755507 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m21:58:36.800417 [debug] [Thread-3 (]: SQL status: COMMIT in 0.046 seconds
[0m21:58:36.801256 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:58:36.801950 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2551b046-426a-4f39-854f-8729966d45f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146ef9d0>]}
[0m21:58:36.802632 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model dbt.trips_concurrency .................. [[32mINSERT 0 0[0m in 4.54s]
[0m21:58:36.803154 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:58:36.804369 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:36.804649 [debug] [MainThread]: On master: BEGIN
[0m21:58:36.804892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:58:37.419250 [debug] [MainThread]: SQL status: BEGIN in 0.614 seconds
[0m21:58:37.420891 [debug] [MainThread]: On master: COMMIT
[0m21:58:37.422095 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:37.422981 [debug] [MainThread]: On master: COMMIT
[0m21:58:37.466440 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m21:58:37.467986 [debug] [MainThread]: On master: Close
[0m21:58:37.469765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:37.470380 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:58:37.470880 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_concurrency' was properly closed.
[0m21:58:37.471339 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:58:37.471767 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:58:37.472475 [info ] [MainThread]: 
[0m21:58:37.473112 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 8.70 seconds (8.70s).
[0m21:58:37.475306 [debug] [MainThread]: Command end result
[0m21:58:37.506179 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:58:37.507423 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:58:37.511193 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:58:37.511383 [info ] [MainThread]: 
[0m21:58:37.511603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:58:37.511766 [info ] [MainThread]: 
[0m21:58:37.511947 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:58:37.513582 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.023063, "process_in_blocks": "0", "process_kernel_time": 0.162269, "process_mem_max_rss": "138706944", "process_out_blocks": "0", "process_user_time": 1.197076}
[0m21:58:37.513876 [debug] [MainThread]: Command `dbt build` succeeded at 21:58:37.513820 after 9.02 seconds
[0m21:58:37.514096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11395d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a01c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a47230>]}
[0m21:58:37.514298 [debug] [MainThread]: Flushing usage events
[0m21:58:38.033113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:35:34.513868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110527b10>]}


============================== 21:35:34.516972 | 80538c36-cd98-4d41-bb2f-eac3447335e1 ==============================
[0m21:35:34.516972 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:35:34.517307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ls -s trips_prep+', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:34.796879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80538c36-cd98-4d41-bb2f-eac3447335e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2b490>]}
[0m21:35:34.818109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80538c36-cd98-4d41-bb2f-eac3447335e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103be140>]}
[0m21:35:34.818719 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:35:34.866429 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:35:34.916928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:34.917106 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:34.934978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80538c36-cd98-4d41-bb2f-eac3447335e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bfb150>]}
[0m21:35:34.966022 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:35:34.967856 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:35:34.978206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80538c36-cd98-4d41-bb2f-eac3447335e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cdd6d0>]}
[0m21:35:34.978395 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 436 macros
[0m21:35:34.978533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80538c36-cd98-4d41-bb2f-eac3447335e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11132e5f0>]}
[0m21:35:34.978901 [info ] [MainThread]: dbt_scooters.companies_trips
[0m21:35:34.979042 [info ] [MainThread]: dbt_scooters.revenue_daily
[0m21:35:34.979147 [info ] [MainThread]: dbt_scooters.trips_age_daily
[0m21:35:34.979242 [info ] [MainThread]: dbt_scooters.trips_age_daily_stat
[0m21:35:34.979335 [info ] [MainThread]: dbt_scooters.trips_age_group
[0m21:35:34.979428 [info ] [MainThread]: dbt_scooters.trips_prep
[0m21:35:34.979526 [info ] [MainThread]: dbt_scooters.trips_stat
[0m21:35:34.979627 [info ] [MainThread]: dbt_scooters.trips_users
[0m21:35:35.008648 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.53002405, "process_in_blocks": "0", "process_kernel_time": 0.13378, "process_mem_max_rss": "119029760", "process_out_blocks": "0", "process_user_time": 0.733925}
[0m21:35:35.008957 [debug] [MainThread]: Command `dbt ls` succeeded at 21:35:35.008909 after 0.53 seconds
[0m21:35:35.009142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e264e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110404dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d62990>]}
[0m21:35:35.009300 [debug] [MainThread]: Flushing usage events
[0m21:35:35.847939 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:35:46.529243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076734d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6bb10>]}


============================== 21:35:46.531007 | 448cf7c7-f652-41fd-b9df-e602dfe3f5b0 ==============================
[0m21:35:46.531007 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:35:46.531261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build -s trips_prep+ --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m21:35:46.594462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6f490>]}
[0m21:35:46.614891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a02030>]}
[0m21:35:46.615200 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:35:46.648729 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:35:46.691722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:46.691909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:46.709728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097eb450>]}
[0m21:35:46.741404 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:35:46.742258 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:35:46.755337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a6de50>]}
[0m21:35:46.755541 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 436 macros
[0m21:35:46.756529 [info ] [MainThread]: 
[0m21:35:46.756674 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:46.756787 [info ] [MainThread]: 
[0m21:35:46.757000 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:35:46.758669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:35:46.794519 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:35:46.794728 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:35:46.794847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:47.693502 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.898 seconds
[0m21:35:47.696590 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:35:47.701417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:35:47.709933 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:35:47.710460 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:35:47.711173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:48.335284 [debug] [ThreadPool]: SQL status: BEGIN in 0.624 seconds
[0m21:35:48.336313 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:35:48.337217 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:35:48.386288 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.048 seconds
[0m21:35:48.390068 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:35:48.434639 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:35:48.449294 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:48.449831 [debug] [MainThread]: On master: BEGIN
[0m21:35:48.450206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:49.165395 [debug] [MainThread]: SQL status: BEGIN in 0.715 seconds
[0m21:35:49.166319 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:49.166992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:35:49.335929 [debug] [MainThread]: SQL status: SELECT 10 in 0.168 seconds
[0m21:35:49.339454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a47d90>]}
[0m21:35:49.340212 [debug] [MainThread]: On master: ROLLBACK
[0m21:35:49.387343 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:49.388205 [debug] [MainThread]: On master: BEGIN
[0m21:35:49.479459 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m21:35:49.480393 [debug] [MainThread]: On master: COMMIT
[0m21:35:49.481032 [debug] [MainThread]: Using postgres connection "master"
[0m21:35:49.481619 [debug] [MainThread]: On master: COMMIT
[0m21:35:49.530933 [debug] [MainThread]: SQL status: COMMIT in 0.049 seconds
[0m21:35:49.531681 [debug] [MainThread]: On master: Close
[0m21:35:49.536697 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m21:35:49.537411 [info ] [Thread-1 (]: 1 of 8 START sql view model dbt.trips_prep ..................................... [RUN]
[0m21:35:49.537983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.trips_prep)
[0m21:35:49.538543 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m21:35:49.548278 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m21:35:49.549646 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m21:35:49.576213 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m21:35:49.577328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:35:49.577591 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m21:35:49.577796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:51.196660 [debug] [Thread-1 (]: SQL status: BEGIN in 1.619 seconds
[0m21:35:51.197574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:35:51.198084 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_ohwk"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  );
[0m21:35:51.252710 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m21:35:51.261941 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:35:51.262619 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m21:35:51.314433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.051 seconds
[0m21:35:51.328332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:35:51.329022 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m21:35:51.372421 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m21:35:51.390863 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:35:51.391332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:35:51.391585 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:35:51.436893 [debug] [Thread-1 (]: SQL status: COMMIT in 0.045 seconds
[0m21:35:51.443599 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_prep__dbt_backup"
[0m21:35:51.447674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:35:51.447961 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_ohwk"."dbt"."trips_prep__dbt_backup" cascade
[0m21:35:51.494052 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.046 seconds
[0m21:35:51.495656 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m21:35:51.497587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed3ad0>]}
[0m21:35:51.498029 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dbt.trips_prep ................................ [[32mCREATE VIEW[0m in 1.96s]
[0m21:35:51.498416 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m21:35:51.498929 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies_trips
[0m21:35:51.499207 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat
[0m21:35:51.499429 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_users
[0m21:35:51.499627 [debug] [Thread-3 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:35:51.499869 [info ] [Thread-2 (]: 2 of 8 START sql table model dbt.companies_trips ............................... [RUN]
[0m21:35:51.500158 [info ] [Thread-4 (]: 4 of 8 START sql table model dbt.trips_stat .................................... [RUN]
[0m21:35:51.500416 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:35:51.500644 [info ] [Thread-3 (]: 3 of 8 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:35:51.500929 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.companies_trips'
[0m21:35:51.501158 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_stat'
[0m21:35:51.501339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.trips_users)
[0m21:35:51.501546 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:35:51.501713 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies_trips
[0m21:35:51.501873 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat
[0m21:35:51.502024 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:35:51.502175 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:35:51.533648 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m21:35:51.534699 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m21:35:51.538821 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:35:51.540075 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:35:51.541608 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies_trips
[0m21:35:51.541782 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat
[0m21:35:51.541937 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_users
[0m21:35:51.550514 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m21:35:51.550696 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:35:51.551766 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m21:35:51.562218 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:35:51.564104 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:51.564377 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp213551562960"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:35:51.564556 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:35:51.564838 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:35:51.565152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:35:51.565290 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:35:51.565417 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m21:35:51.565541 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:35:51.565660 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m21:35:51.565776 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:35:51.565888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:51.566000 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:35:52.330990 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.766 seconds
[0m21:35:52.353250 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.353660 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:35:52.396519 [debug] [Thread-3 (]: SQL status: BEGIN in 0.042 seconds
[0m21:35:52.397397 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.397981 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp213551562960'
        
      order by ordinal_position

  
[0m21:35:52.448963 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.050 seconds
[0m21:35:52.460544 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.461112 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:35:52.516129 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.054 seconds
[0m21:35:52.535756 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.536233 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp213551562960'
        
      order by ordinal_position

  
[0m21:35:52.583166 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.047 seconds
[0m21:35:52.586260 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.586627 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:35:52.635248 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.048 seconds
[0m21:35:52.650168 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:35:52.657082 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:35:52.668409 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:35:52.669026 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.669286 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp213551562960" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp213551562960"
    )
  
[0m21:35:52.713467 [debug] [Thread-3 (]: SQL status: INSERT 0 3 in 0.044 seconds
[0m21:35:52.714770 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:35:52.715102 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:35:52.715379 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:35:52.759547 [debug] [Thread-3 (]: SQL status: COMMIT in 0.044 seconds
[0m21:35:52.760296 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:35:52.761017 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab25d0>]}
[0m21:35:52.761619 [info ] [Thread-3 (]: 3 of 8 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 1.26s]
[0m21:35:52.762118 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:35:53.040352 [debug] [Thread-1 (]: SQL status: BEGIN in 1.474 seconds
[0m21:35:53.041796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:35:53.042526 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_ohwk"."dbt"."trips_users__dbt_tmp"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

      where
          t.id <= 75000

  );
  
  
[0m21:35:53.068626 [debug] [Thread-4 (]: SQL status: BEGIN in 1.502 seconds
[0m21:35:53.069637 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:35:53.070532 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_ohwk"."dbt"."trips_prep"
  );
  
[0m21:35:53.117814 [debug] [Thread-2 (]: SQL status: BEGIN in 1.552 seconds
[0m21:35:53.118675 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:35:53.119264 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
  
[0m21:35:54.437863 [debug] [Thread-2 (]: SQL status: SELECT 6 in 1.318 seconds
[0m21:35:54.448946 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:35:54.449499 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m21:35:54.532112 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.082 seconds
[0m21:35:54.536836 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:35:54.537424 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:35:54.537857 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:35:54.639055 [debug] [Thread-2 (]: SQL status: COMMIT in 0.101 seconds
[0m21:35:54.641798 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m21:35:54.645103 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:35:54.645491 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m21:35:54.729729 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.084 seconds
[0m21:35:54.731460 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: Close
[0m21:35:54.732304 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3de90>]}
[0m21:35:54.732984 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dbt.companies_trips .......................... [[32mSELECT 6[0m in 3.23s]
[0m21:35:54.733581 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies_trips
[0m21:35:57.030251 [debug] [Thread-4 (]: SQL status: SELECT 1 in 3.959 seconds
[0m21:35:57.038958 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:35:57.039715 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m21:35:57.084776 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m21:35:57.087698 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:35:57.088623 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:35:57.089341 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:35:57.138556 [debug] [Thread-4 (]: SQL status: COMMIT in 0.048 seconds
[0m21:35:57.141987 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat__dbt_backup"
[0m21:35:57.142762 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:35:57.143163 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_stat__dbt_backup" cascade
[0m21:35:57.188189 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.044 seconds
[0m21:35:57.190602 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: Close
[0m21:35:57.191997 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118482030>]}
[0m21:35:57.193090 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dbt.trips_stat ............................... [[32mSELECT 1[0m in 5.69s]
[0m21:35:57.194331 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat
[0m21:35:57.770191 [debug] [Thread-1 (]: SQL status: SELECT 75000 in 4.727 seconds
[0m21:35:57.774701 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:35:57.775188 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users" rename to "trips_users__dbt_backup"
[0m21:35:57.820217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m21:35:57.823617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:35:57.824158 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
alter table "dev_ohwk"."dbt"."trips_users__dbt_tmp" rename to "trips_users"
[0m21:35:57.869442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m21:35:57.872105 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:35:57.872799 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:35:57.873406 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:35:57.922344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.048 seconds
[0m21:35:57.927368 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_users__dbt_backup"
[0m21:35:57.928397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:35:57.929069 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */
drop table if exists "dev_ohwk"."dbt"."trips_users__dbt_backup" cascade
[0m21:35:57.977443 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.048 seconds
[0m21:35:57.980317 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: Close
[0m21:35:57.981971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10988a5d0>]}
[0m21:35:57.983035 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model dbt.trips_users ........................ [[32mSELECT 75000[0m in 6.48s]
[0m21:35:57.983859 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_users
[0m21:35:57.985403 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m21:35:57.985942 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m21:35:57.986620 [info ] [Thread-2 (]: 7 of 8 START sql table model dbt.trips_age_group ............................... [RUN]
[0m21:35:57.987389 [info ] [Thread-3 (]: 6 of 8 START sql table model dbt.trips_age_daily ............................... [RUN]
[0m21:35:57.988284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_group)
[0m21:35:57.988864 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_age_daily)
[0m21:35:57.989353 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m21:35:57.989753 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m21:35:57.994710 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m21:35:57.997489 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m21:35:57.999185 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m21:35:57.999533 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m21:35:58.002283 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m21:35:58.005139 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m21:35:58.006022 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:35:58.006374 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:35:58.006690 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m21:35:58.006966 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m21:35:58.007232 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:35:58.007481 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:35:59.084720 [debug] [Thread-3 (]: SQL status: BEGIN in 1.077 seconds
[0m21:35:59.085578 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:35:59.086039 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m21:35:59.930727 [debug] [Thread-2 (]: SQL status: BEGIN in 1.923 seconds
[0m21:35:59.931633 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:35:59.932204 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users" as tu
    cross join "dev_ohwk"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m21:36:00.336641 [debug] [Thread-3 (]: SQL status: SELECT 4946 in 1.249 seconds
[0m21:36:00.343513 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:00.344009 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m21:36:00.430815 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.086 seconds
[0m21:36:00.434740 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:36:00.435844 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:00.436423 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:36:00.536784 [debug] [Thread-3 (]: SQL status: COMMIT in 0.100 seconds
[0m21:36:00.543054 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily__dbt_backup"
[0m21:36:00.544162 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:00.544783 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily__dbt_backup" cascade
[0m21:36:00.632894 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.087 seconds
[0m21:36:00.636237 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m21:36:00.637734 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11847fcb0>]}
[0m21:36:00.638794 [info ] [Thread-3 (]: 6 of 8 OK created sql table model dbt.trips_age_daily .......................... [[32mSELECT 4946[0m in 2.65s]
[0m21:36:00.639641 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m21:36:00.640580 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m21:36:00.641373 [info ] [Thread-4 (]: 8 of 8 START sql table model dbt.trips_age_daily_stat .......................... [RUN]
[0m21:36:00.642096 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_age_daily_stat)
[0m21:36:00.642571 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m21:36:00.646604 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:00.649159 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m21:36:00.657052 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:00.657934 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:00.658286 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m21:36:00.658582 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:36:01.934829 [debug] [Thread-4 (]: SQL status: BEGIN in 1.276 seconds
[0m21:36:01.936182 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:01.937261 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_ohwk"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m21:36:02.131713 [debug] [Thread-4 (]: SQL status: SELECT 83 in 0.193 seconds
[0m21:36:02.138398 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:02.139138 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m21:36:02.233681 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m21:36:02.237219 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:36:02.238036 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:02.238685 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:36:02.334263 [debug] [Thread-4 (]: SQL status: COMMIT in 0.095 seconds
[0m21:36:02.338039 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup"
[0m21:36:02.338925 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:02.339577 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m21:36:02.432277 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.092 seconds
[0m21:36:02.434508 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m21:36:02.435736 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d1130>]}
[0m21:36:02.436755 [info ] [Thread-4 (]: 8 of 8 OK created sql table model dbt.trips_age_daily_stat ..................... [[32mSELECT 83[0m in 1.79s]
[0m21:36:02.437368 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m21:36:10.235133 [debug] [Thread-2 (]: SQL status: SELECT 7 in 10.302 seconds
[0m21:36:10.242820 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:10.243328 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m21:36:10.291598 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m21:36:10.295818 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:36:10.297010 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:10.297984 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:36:10.342674 [debug] [Thread-2 (]: SQL status: COMMIT in 0.044 seconds
[0m21:36:10.348114 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_group__dbt_backup"
[0m21:36:10.348944 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:10.349397 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_group__dbt_backup" cascade
[0m21:36:10.400952 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.051 seconds
[0m21:36:10.404785 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m21:36:10.406219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448cf7c7-f652-41fd-b9df-e602dfe3f5b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e33cb0>]}
[0m21:36:10.407298 [info ] [Thread-2 (]: 7 of 8 OK created sql table model dbt.trips_age_group .......................... [[32mSELECT 7[0m in 12.42s]
[0m21:36:10.408187 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m21:36:10.410403 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:10.410839 [debug] [MainThread]: On master: BEGIN
[0m21:36:10.411207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:11.420082 [debug] [MainThread]: SQL status: BEGIN in 1.009 seconds
[0m21:36:11.421588 [debug] [MainThread]: On master: COMMIT
[0m21:36:11.422616 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:11.423530 [debug] [MainThread]: On master: COMMIT
[0m21:36:11.472994 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m21:36:11.474215 [debug] [MainThread]: On master: Close
[0m21:36:11.476120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:11.477010 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m21:36:11.477830 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m21:36:11.478637 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m21:36:11.479074 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m21:36:11.479752 [info ] [MainThread]: 
[0m21:36:11.480310 [info ] [MainThread]: Finished running 2 incremental models, 5 table models, 1 view model in 0 hours 0 minutes and 24.72 seconds (24.72s).
[0m21:36:11.482909 [debug] [MainThread]: Command end result
[0m21:36:11.510768 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:36:11.512205 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:36:11.516801 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:36:11.517052 [info ] [MainThread]: 
[0m21:36:11.517293 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:11.517476 [info ] [MainThread]: 
[0m21:36:11.517660 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m21:36:11.518681 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 25.014128, "process_in_blocks": "0", "process_kernel_time": 0.176546, "process_mem_max_rss": "140394496", "process_out_blocks": "0", "process_user_time": 1.324771}
[0m21:36:11.518953 [debug] [MainThread]: Command `dbt build` succeeded at 21:36:11.518898 after 25.01 seconds
[0m21:36:11.519168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e18290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118453e30>]}
[0m21:36:11.519373 [debug] [MainThread]: Flushing usage events
[0m21:36:12.186209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:36:14.412792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112227b10>]}


============================== 21:36:14.414556 | 502f8149-2376-4d58-b933-5b34fa36b901 ==============================
[0m21:36:14.414556 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:36:14.414822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -s trips_prep+', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:36:14.476768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110927490>]}
[0m21:36:14.497303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120be030>]}
[0m21:36:14.497655 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:36:14.532475 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:36:14.578679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:36:14.578872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:36:14.597794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11285f450>]}
[0m21:36:14.631172 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:36:14.632127 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:36:14.643038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f2de50>]}
[0m21:36:14.643258 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 436 macros
[0m21:36:14.644248 [info ] [MainThread]: 
[0m21:36:14.644400 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:36:14.644522 [info ] [MainThread]: 
[0m21:36:14.644735 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:36:14.646307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:36:14.664665 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:36:14.664868 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:36:14.664990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:15.364988 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.700 seconds
[0m21:36:15.368397 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:36:15.374437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:36:15.383017 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:36:15.383580 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:36:15.383907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:16.004642 [debug] [ThreadPool]: SQL status: BEGIN in 0.620 seconds
[0m21:36:16.005195 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:36:16.005491 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:36:16.053323 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.047 seconds
[0m21:36:16.055285 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:36:16.100167 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:36:16.112788 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:16.113295 [debug] [MainThread]: On master: BEGIN
[0m21:36:16.113617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:36:17.603376 [debug] [MainThread]: SQL status: BEGIN in 1.490 seconds
[0m21:36:17.604894 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:17.606226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:36:17.837165 [debug] [MainThread]: SQL status: SELECT 6 in 0.230 seconds
[0m21:36:17.841662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f07d90>]}
[0m21:36:17.842546 [debug] [MainThread]: On master: ROLLBACK
[0m21:36:17.887290 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:17.888444 [debug] [MainThread]: On master: BEGIN
[0m21:36:17.980733 [debug] [MainThread]: SQL status: BEGIN in 0.091 seconds
[0m21:36:17.981890 [debug] [MainThread]: On master: COMMIT
[0m21:36:17.982874 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:17.983723 [debug] [MainThread]: On master: COMMIT
[0m21:36:18.031115 [debug] [MainThread]: SQL status: COMMIT in 0.047 seconds
[0m21:36:18.032370 [debug] [MainThread]: On master: Close
[0m21:36:18.040335 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m21:36:18.041407 [info ] [Thread-1 (]: 1 of 8 START sql view model dbt.trips_prep ..................................... [RUN]
[0m21:36:18.042258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.trips_prep)
[0m21:36:18.042831 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m21:36:18.052121 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m21:36:18.053309 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m21:36:18.079094 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m21:36:18.079650 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:36:18.079852 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m21:36:18.080029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:36:18.736705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.656 seconds
[0m21:36:18.738562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:36:18.739488 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_ohwk"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,
date(started_at) as "date"
from
"dev_ohwk"."scooters_raw"."trips"
  );
[0m21:36:18.788933 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m21:36:18.801753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:36:18.802387 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m21:36:18.850526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m21:36:18.864953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:36:18.865560 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m21:36:18.912868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m21:36:18.935964 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:36:18.936564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:36:18.936889 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:36:18.981113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.044 seconds
[0m21:36:18.990177 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_prep__dbt_backup"
[0m21:36:18.994615 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:36:18.994992 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_ohwk"."dbt"."trips_prep__dbt_backup" cascade
[0m21:36:19.042062 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.046 seconds
[0m21:36:19.046500 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m21:36:19.048977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e3a00>]}
[0m21:36:19.049762 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dbt.trips_prep ................................ [[32mCREATE VIEW[0m in 1.01s]
[0m21:36:19.050421 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m21:36:19.051419 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies_trips
[0m21:36:19.051950 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_users
[0m21:36:19.052383 [debug] [Thread-3 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:36:19.052714 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat
[0m21:36:19.053145 [info ] [Thread-2 (]: 2 of 8 START sql table model dbt.companies_trips ............................... [RUN]
[0m21:36:19.053597 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dbt.trips_users ............................. [RUN]
[0m21:36:19.054081 [info ] [Thread-3 (]: 3 of 8 START sql incremental model dbt.revenue_daily ........................... [RUN]
[0m21:36:19.054642 [info ] [Thread-4 (]: 4 of 8 START sql table model dbt.trips_stat .................................... [RUN]
[0m21:36:19.055128 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.companies_trips'
[0m21:36:19.055453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.trips_users)
[0m21:36:19.055828 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.revenue_daily'
[0m21:36:19.056181 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_stat'
[0m21:36:19.056492 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies_trips
[0m21:36:19.056783 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:36:19.057067 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:36:19.057344 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat
[0m21:36:19.096269 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m21:36:19.100641 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:36:19.102165 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:36:19.103083 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m21:36:19.103616 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies_trips
[0m21:36:19.103805 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat
[0m21:36:19.103965 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_users
[0m21:36:19.104096 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:36:19.113941 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m21:36:19.115216 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m21:36:19.127326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:19.128758 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:19.129051 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp213619125186"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:36:19.129225 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp213619128103"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:36:19.129402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:36:19.129568 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:36:19.129796 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:36:19.129959 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:36:19.130154 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m21:36:19.130292 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m21:36:19.130411 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:36:19.130527 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:36:20.432642 [debug] [Thread-4 (]: SQL status: BEGIN in 1.301 seconds
[0m21:36:20.434376 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:36:20.435675 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_ohwk"."dbt"."trips_prep"
  );
  
[0m21:36:20.730465 [debug] [Thread-2 (]: SQL status: BEGIN in 1.599 seconds
[0m21:36:20.732110 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:36:20.732848 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
  
[0m21:36:20.735390 [debug] [Thread-3 (]: SQL status: SELECT 3 in 1.606 seconds
[0m21:36:20.756321 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:20.756754 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:36:20.831608 [debug] [Thread-3 (]: SQL status: BEGIN in 0.074 seconds
[0m21:36:20.833271 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:20.834475 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp213619128103'
        
      order by ordinal_position

  
[0m21:36:21.630553 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.795 seconds
[0m21:36:21.636182 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:21.636560 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:36:21.834419 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.197 seconds
[0m21:36:21.853714 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:21.854153 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp213619128103'
        
      order by ordinal_position

  
[0m21:36:22.243956 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.389 seconds
[0m21:36:22.249951 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:22.250536 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:36:22.756853 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.505 seconds
[0m21:36:22.770472 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema changed: True
        Source columns not in target: []
        Target columns not in source: []
        New column types: [{'column_name': 'updated_at', 'new_type': 'timestamp with time zone'}]
  
[0m21:36:22.776056 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."revenue_daily":
        Schema change approach: append_new_columns
        Columns added: []
        Columns removed: 
        Data types changed: 
  
[0m21:36:22.786100 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:36:22.786643 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:22.786900 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp213619128103" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp213619128103"
    )
  
[0m21:36:22.833860 [debug] [Thread-2 (]: SQL status: SELECT 6 in 2.100 seconds
[0m21:36:22.839686 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:36:22.840015 [debug] [Thread-3 (]: SQL status: INSERT 0 3 in 0.053 seconds
[0m21:36:22.840315 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m21:36:22.841418 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:36:22.841737 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:36:22.841985 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:36:22.931963 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m21:36:22.938501 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:36:22.939023 [debug] [Thread-3 (]: SQL status: COMMIT in 0.097 seconds
[0m21:36:22.939444 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m21:36:22.940403 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:36:22.941666 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f72a50>]}
[0m21:36:22.942496 [info ] [Thread-3 (]: 3 of 8 OK created sql incremental model dbt.revenue_daily ...................... [[32mINSERT 0 3[0m in 3.89s]
[0m21:36:22.943115 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:36:23.048325 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.107 seconds
[0m21:36:23.051124 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:36:23.051722 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:36:23.052175 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:36:23.145431 [debug] [Thread-2 (]: SQL status: COMMIT in 0.092 seconds
[0m21:36:23.151706 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m21:36:23.156683 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:36:23.157185 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m21:36:23.247392 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.089 seconds
[0m21:36:23.251405 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: Close
[0m21:36:23.252996 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112efde90>]}
[0m21:36:23.254188 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dbt.companies_trips .......................... [[32mSELECT 6[0m in 4.20s]
[0m21:36:23.255145 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies_trips
[0m21:36:25.007227 [debug] [Thread-1 (]: SQL status: SELECT 30901 in 5.877 seconds
[0m21:36:25.014450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:25.015203 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:36:25.132661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.116 seconds
[0m21:36:25.134136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:25.135294 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp213619125186'
        
      order by ordinal_position

  
[0m21:36:25.433940 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.297 seconds
[0m21:36:25.440751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:25.441257 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:36:25.632799 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.190 seconds
[0m21:36:25.640877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:25.641462 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp213619125186'
        
      order by ordinal_position

  
[0m21:36:25.843606 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.201 seconds
[0m21:36:25.851172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:25.851904 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:36:25.938360 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.085 seconds
[0m21:36:25.944596 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:36:25.952082 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:36:25.953160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:25.953520 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp213619125186"
    )


  
[0m21:36:26.986569 [debug] [Thread-4 (]: SQL status: SELECT 1 in 6.550 seconds
[0m21:36:26.994753 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:36:26.995393 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m21:36:27.133686 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.137 seconds
[0m21:36:27.140554 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:36:27.141248 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m21:36:27.230326 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m21:36:27.234381 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:36:27.235023 [debug] [Thread-1 (]: SQL status: INSERT 0 30901 in 1.281 seconds
[0m21:36:27.235695 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:36:27.237864 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:36:27.238526 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:36:27.239176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:36:27.239893 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:36:27.337975 [debug] [Thread-1 (]: SQL status: COMMIT in 0.097 seconds
[0m21:36:27.339343 [debug] [Thread-4 (]: SQL status: COMMIT in 0.099 seconds
[0m21:36:27.341526 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: Close
[0m21:36:27.346633 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat__dbt_backup"
[0m21:36:27.347675 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:36:27.348411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114485d10>]}
[0m21:36:27.348866 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_stat__dbt_backup" cascade
[0m21:36:27.349823 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 30901[0m in 8.29s]
[0m21:36:27.350686 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_users
[0m21:36:27.351473 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m21:36:27.351834 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m21:36:27.352320 [info ] [Thread-2 (]: 7 of 8 START sql table model dbt.trips_age_group ............................... [RUN]
[0m21:36:27.352877 [info ] [Thread-3 (]: 6 of 8 START sql table model dbt.trips_age_daily ............................... [RUN]
[0m21:36:27.353360 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_group)
[0m21:36:27.353758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.trips_age_daily)
[0m21:36:27.354126 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m21:36:27.354468 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m21:36:27.358007 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m21:36:27.360683 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m21:36:27.361562 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m21:36:27.365222 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m21:36:27.365550 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m21:36:27.367794 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m21:36:27.368250 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:27.368552 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m21:36:27.368799 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:36:27.369060 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:27.369398 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m21:36:27.369625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:36:27.438401 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.088 seconds
[0m21:36:27.440652 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: Close
[0m21:36:27.441519 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133f17d0>]}
[0m21:36:27.442208 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dbt.trips_stat ............................... [[32mSELECT 1[0m in 8.39s]
[0m21:36:27.442803 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat
[0m21:36:28.336881 [debug] [Thread-2 (]: SQL status: BEGIN in 0.966 seconds
[0m21:36:28.338664 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:28.339616 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users" as tu
    cross join "dev_ohwk"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m21:36:29.133785 [debug] [Thread-3 (]: SQL status: BEGIN in 1.765 seconds
[0m21:36:29.135394 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:29.136623 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m21:36:32.075155 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 2.937 seconds
[0m21:36:32.088398 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:32.089018 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m21:36:32.133357 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m21:36:32.138607 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:32.139288 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m21:36:32.248715 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.109 seconds
[0m21:36:32.251405 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:36:32.252135 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:32.252547 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:36:32.435459 [debug] [Thread-3 (]: SQL status: COMMIT in 0.182 seconds
[0m21:36:32.440902 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily__dbt_backup"
[0m21:36:32.442187 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:36:32.442894 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily__dbt_backup" cascade
[0m21:36:32.540040 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.096 seconds
[0m21:36:32.543849 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m21:36:32.545300 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11445b8c0>]}
[0m21:36:32.546227 [info ] [Thread-3 (]: 6 of 8 OK created sql table model dbt.trips_age_daily .......................... [[32mSELECT 7049[0m in 5.19s]
[0m21:36:32.546923 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m21:36:32.547697 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m21:36:32.548239 [info ] [Thread-1 (]: 8 of 8 START sql table model dbt.trips_age_daily_stat .......................... [RUN]
[0m21:36:32.549050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily_stat)
[0m21:36:32.549768 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m21:36:32.553841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:32.554792 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m21:36:32.557652 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:32.558320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:32.558633 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m21:36:32.559373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:36:33.631672 [debug] [Thread-1 (]: SQL status: BEGIN in 1.072 seconds
[0m21:36:33.633526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:33.634406 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_ohwk"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m21:36:34.223025 [debug] [Thread-1 (]: SQL status: SELECT 83 in 0.587 seconds
[0m21:36:34.231777 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:34.232360 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m21:36:34.331124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.098 seconds
[0m21:36:34.338868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:34.339691 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m21:36:34.430506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m21:36:34.434610 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:36:34.435225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:34.435683 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:36:34.538863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.102 seconds
[0m21:36:34.543952 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup"
[0m21:36:34.544952 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:36:34.545565 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m21:36:34.633874 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.087 seconds
[0m21:36:34.638137 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m21:36:34.639622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111183770>]}
[0m21:36:34.640576 [info ] [Thread-1 (]: 8 of 8 OK created sql table model dbt.trips_age_daily_stat ..................... [[32mSELECT 83[0m in 2.09s]
[0m21:36:34.641368 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m21:36:39.956772 [debug] [Thread-2 (]: SQL status: SELECT 7 in 11.616 seconds
[0m21:36:39.963112 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:39.963756 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m21:36:40.007432 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m21:36:40.012709 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:40.013404 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m21:36:40.131437 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.117 seconds
[0m21:36:40.134063 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:36:40.134742 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:40.135305 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:36:40.180447 [debug] [Thread-2 (]: SQL status: COMMIT in 0.044 seconds
[0m21:36:40.185778 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_group__dbt_backup"
[0m21:36:40.186706 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:36:40.187279 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_group__dbt_backup" cascade
[0m21:36:40.233022 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.045 seconds
[0m21:36:40.238587 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m21:36:40.240196 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '502f8149-2376-4d58-b933-5b34fa36b901', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113440170>]}
[0m21:36:40.241210 [info ] [Thread-2 (]: 7 of 8 OK created sql table model dbt.trips_age_group .......................... [[32mSELECT 7[0m in 12.89s]
[0m21:36:40.241922 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m21:36:40.243928 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:40.244340 [debug] [MainThread]: On master: BEGIN
[0m21:36:40.244676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:41.074656 [debug] [MainThread]: SQL status: BEGIN in 0.830 seconds
[0m21:36:41.075734 [debug] [MainThread]: On master: COMMIT
[0m21:36:41.076388 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:41.076921 [debug] [MainThread]: On master: COMMIT
[0m21:36:41.121990 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m21:36:41.123494 [debug] [MainThread]: On master: Close
[0m21:36:41.125004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:41.125595 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m21:36:41.126077 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m21:36:41.126514 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m21:36:41.126930 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_stat' was properly closed.
[0m21:36:41.127642 [info ] [MainThread]: 
[0m21:36:41.128356 [info ] [MainThread]: Finished running 2 incremental models, 5 table models, 1 view model in 0 hours 0 minutes and 26.48 seconds (26.48s).
[0m21:36:41.131197 [debug] [MainThread]: Command end result
[0m21:36:41.158369 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:36:41.159966 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:36:41.164156 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:36:41.164371 [info ] [MainThread]: 
[0m21:36:41.164592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:41.164765 [info ] [MainThread]: 
[0m21:36:41.164939 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m21:36:41.165934 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 26.777496, "process_in_blocks": "0", "process_kernel_time": 0.175104, "process_mem_max_rss": "141197312", "process_out_blocks": "0", "process_user_time": 1.439427}
[0m21:36:41.166196 [debug] [MainThread]: Command `dbt build` succeeded at 21:36:41.166141 after 26.78 seconds
[0m21:36:41.166408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11085e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144520f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114452ff0>]}
[0m21:36:41.166609 [debug] [MainThread]: Flushing usage events
[0m21:36:41.902162 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:42.959754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b27b10>]}


============================== 21:28:42.961840 | 619de422-6a64-44dc-a012-670e6038ab69 ==============================
[0m21:28:42.961840 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:28:42.962116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:28:43.026023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2f490>]}
[0m21:28:43.046576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c2e00>]}
[0m21:28:43.046961 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:28:43.084960 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:28:43.121160 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:28:43.121378 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m21:28:43.121530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f8250>]}
[0m21:28:43.499339 [warn ] [MainThread]: [[33mWARNING[0m]: Found patch for macro "trips_geom_stat" which was not found
[0m21:28:43.593927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a858b0>]}
[0m21:28:43.625164 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:28:43.626455 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:28:43.639666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f019b0>]}
[0m21:28:43.639892 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 436 macros
[0m21:28:43.640890 [info ] [MainThread]: 
[0m21:28:43.641074 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:28:43.641227 [info ] [MainThread]: 
[0m21:28:43.641449 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:28:43.641811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:28:43.664436 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:28:43.664611 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:28:43.664714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:44.534060 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.869 seconds
[0m21:28:44.537508 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:28:44.546415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:28:44.552681 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:28:44.553044 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:28:44.553290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:46.078832 [debug] [ThreadPool]: SQL status: BEGIN in 1.525 seconds
[0m21:28:46.079900 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:28:46.080591 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:28:46.130421 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.049 seconds
[0m21:28:46.134711 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:28:46.185783 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:28:46.200927 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:46.201533 [debug] [MainThread]: On master: BEGIN
[0m21:28:46.201948 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:28:47.115357 [debug] [MainThread]: SQL status: BEGIN in 0.913 seconds
[0m21:28:47.117002 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:47.117875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:28:47.299695 [debug] [MainThread]: SQL status: SELECT 6 in 0.181 seconds
[0m21:28:47.303943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111bb520>]}
[0m21:28:47.305012 [debug] [MainThread]: On master: ROLLBACK
[0m21:28:47.351828 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:47.352904 [debug] [MainThread]: On master: BEGIN
[0m21:28:47.451667 [debug] [MainThread]: SQL status: BEGIN in 0.098 seconds
[0m21:28:47.452805 [debug] [MainThread]: On master: COMMIT
[0m21:28:47.453542 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:47.454115 [debug] [MainThread]: On master: COMMIT
[0m21:28:47.502978 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m21:28:47.504020 [debug] [MainThread]: On master: Close
[0m21:28:47.513638 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m21:28:47.514695 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.parking_start_stat ............................ [RUN]
[0m21:28:47.515751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.parking_start_stat)
[0m21:28:47.516619 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m21:28:47.525484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m21:28:47.527209 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m21:28:47.554988 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m21:28:47.555551 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:28:47.555738 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m21:28:47.555900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:48.478951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.923 seconds
[0m21:28:48.480191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:28:48.480986 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
where
    st_intersects(st_transform(t.start_point, 3857), hex.geom)
group by
    1
  );
  
[0m21:29:04.296175 [debug] [Thread-1 (]: SQL status: SELECT 142 in 15.815 seconds
[0m21:29:04.313607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:04.314298 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m21:29:04.360699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m21:29:04.367285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:04.367955 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m21:29:04.413105 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m21:29:04.437294 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:29:04.437798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:04.438122 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:29:04.486482 [debug] [Thread-1 (]: SQL status: COMMIT in 0.048 seconds
[0m21:29:04.494007 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_start_stat__dbt_backup"
[0m21:29:04.501430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:04.501789 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop view if exists "dev_ohwk"."dbt"."parking_start_stat__dbt_backup" cascade
[0m21:29:04.550761 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.048 seconds
[0m21:29:04.555010 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m21:29:04.558266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '619de422-6a64-44dc-a012-670e6038ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fcebd0>]}
[0m21:29:04.559032 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.parking_start_stat ....................... [[32mSELECT 142[0m in 17.04s]
[0m21:29:04.559602 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m21:29:04.560926 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:04.561207 [debug] [MainThread]: On master: BEGIN
[0m21:29:04.561433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:05.283477 [debug] [MainThread]: SQL status: BEGIN in 0.722 seconds
[0m21:29:05.284904 [debug] [MainThread]: On master: COMMIT
[0m21:29:05.285774 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:05.286499 [debug] [MainThread]: On master: COMMIT
[0m21:29:05.332850 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m21:29:05.333918 [debug] [MainThread]: On master: Close
[0m21:29:05.335433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:05.336013 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m21:29:05.336634 [info ] [MainThread]: 
[0m21:29:05.337246 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.70 seconds (21.70s).
[0m21:29:05.338492 [debug] [MainThread]: Command end result
[0m21:29:05.367885 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:29:05.369391 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:29:05.373838 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:29:05.374062 [info ] [MainThread]: 
[0m21:29:05.374298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:05.374461 [info ] [MainThread]: 
[0m21:29:05.374710 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:29:05.378362 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 22.448353, "process_in_blocks": "0", "process_kernel_time": 0.141872, "process_mem_max_rss": "148160512", "process_out_blocks": "0", "process_user_time": 1.404684}
[0m21:29:05.378679 [debug] [MainThread]: Command `cli build` succeeded at 21:29:05.378616 after 22.45 seconds
[0m21:29:05.378908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ff8c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11135ecb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11135eb70>]}
[0m21:29:05.379127 [debug] [MainThread]: Flushing usage events
[0m21:29:05.969081 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:46.798942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd7b10>]}


============================== 21:29:46.801011 | 6e1bb7f6-9f46-42a0-8605-a3e11014e1db ==============================
[0m21:29:46.801011 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:29:46.801284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:29:46.864419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e3490>]}
[0m21:29:46.885020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6ee00>]}
[0m21:29:46.885402 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:29:46.923951 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:29:46.960970 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:29:46.961201 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m21:29:46.961354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c44250>]}
[0m21:29:47.400363 [warn ] [MainThread]: [[33mWARNING[0m]: Found patch for macro "trips_geom_stat" which was not found
[0m21:29:47.446234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b0fc50>]}
[0m21:29:47.476856 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:29:47.478022 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:29:47.484622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a2270>]}
[0m21:29:47.484828 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 436 macros
[0m21:29:47.484978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b31300>]}
[0m21:29:47.485649 [info ] [MainThread]: 
[0m21:29:47.485784 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:29:47.485898 [info ] [MainThread]: 
[0m21:29:47.486143 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:29:47.486483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:29:47.503591 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:29:47.503761 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:29:47.503860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:48.268409 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.764 seconds
[0m21:29:48.270519 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:29:48.277281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:29:48.283649 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:29:48.284081 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:29:48.284341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:48.995323 [debug] [ThreadPool]: SQL status: BEGIN in 0.711 seconds
[0m21:29:48.996436 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:29:48.997375 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:29:49.066267 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.068 seconds
[0m21:29:49.069529 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:29:49.117338 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:29:49.129556 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:49.130129 [debug] [MainThread]: On master: BEGIN
[0m21:29:49.130618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:50.726430 [debug] [MainThread]: SQL status: BEGIN in 1.596 seconds
[0m21:29:50.727543 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:50.728185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:29:50.894205 [debug] [MainThread]: SQL status: SELECT 5 in 0.165 seconds
[0m21:29:50.896761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dcfb90>]}
[0m21:29:50.897330 [debug] [MainThread]: On master: ROLLBACK
[0m21:29:50.949629 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:50.950334 [debug] [MainThread]: On master: BEGIN
[0m21:29:51.042817 [debug] [MainThread]: SQL status: BEGIN in 0.092 seconds
[0m21:29:51.043651 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.044130 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.044599 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.090786 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m21:29:51.091863 [debug] [MainThread]: On master: Close
[0m21:29:51.101669 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m21:29:51.102832 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.parking_start_stat ............................ [RUN]
[0m21:29:51.103758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.parking_start_stat)
[0m21:29:51.104577 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m21:29:51.113831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m21:29:51.114996 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m21:29:51.142987 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m21:29:51.143554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:51.143742 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m21:29:51.143899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.777091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.633 seconds
[0m21:29:51.778167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:51.778788 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom" as t
cross join
    st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
where
    st_intersects(st_transform(t.start_point, 3857), hex.geom)
group by
    1
  );
  
[0m21:30:07.801395 [debug] [Thread-1 (]: SQL status: SELECT 142 in 16.022 seconds
[0m21:30:07.820634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:30:07.821212 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m21:30:07.868560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m21:30:07.875761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:30:07.876324 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m21:30:07.925382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m21:30:07.945790 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:30:07.946255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:30:07.946528 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:30:08.014872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.068 seconds
[0m21:30:08.025534 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_start_stat__dbt_backup"
[0m21:30:08.032222 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:30:08.032715 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_ohwk"."dbt"."parking_start_stat__dbt_backup" cascade
[0m21:30:08.082461 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.049 seconds
[0m21:30:08.087444 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m21:30:08.091889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e1bb7f6-9f46-42a0-8605-a3e11014e1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fedd30>]}
[0m21:30:08.092968 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.parking_start_stat ....................... [[32mSELECT 142[0m in 16.99s]
[0m21:30:08.093749 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m21:30:08.095538 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:08.095882 [debug] [MainThread]: On master: BEGIN
[0m21:30:08.096157 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:08.958317 [debug] [MainThread]: SQL status: BEGIN in 0.862 seconds
[0m21:30:08.960042 [debug] [MainThread]: On master: COMMIT
[0m21:30:08.961062 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:08.961892 [debug] [MainThread]: On master: COMMIT
[0m21:30:09.008712 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m21:30:09.009803 [debug] [MainThread]: On master: Close
[0m21:30:09.011440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:09.011905 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m21:30:09.012450 [info ] [MainThread]: 
[0m21:30:09.012991 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.53 seconds (21.53s).
[0m21:30:09.014156 [debug] [MainThread]: Command end result
[0m21:30:09.043192 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:30:09.045160 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:30:09.048820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:30:09.049014 [info ] [MainThread]: 
[0m21:30:09.049244 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:30:09.049418 [info ] [MainThread]: 
[0m21:30:09.049681 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:30:09.052501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.2824, "process_in_blocks": "0", "process_kernel_time": 0.135908, "process_mem_max_rss": "146210816", "process_out_blocks": "0", "process_user_time": 1.388711}
[0m21:30:09.052756 [debug] [MainThread]: Command `cli run` succeeded at 21:30:09.052700 after 22.28 seconds
[0m21:30:09.052967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f72a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e0b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ddadd0>]}
[0m21:30:09.053170 [debug] [MainThread]: Flushing usage events
[0m21:30:09.552364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:30:53.982573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112627b10>]}


============================== 21:30:53.984618 | a5d1909d-a19f-43b4-a73f-4ada13c97eb2 ==============================
[0m21:30:53.984618 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:30:53.984889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:30:54.049765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11032f490>]}
[0m21:30:54.071091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123bee00>]}
[0m21:30:54.071569 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:30:54.112890 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m21:30:54.149537 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:30:54.149762 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m21:30:54.149921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134f0250>]}
[0m21:30:54.643940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11370ea80>]}
[0m21:30:54.674384 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:30:54.675601 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:30:54.685728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113572cf0>]}
[0m21:30:54.685949 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 437 macros
[0m21:30:54.686091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113267d40>]}
[0m21:30:54.686836 [info ] [MainThread]: 
[0m21:30:54.687008 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:30:54.687140 [info ] [MainThread]: 
[0m21:30:54.687389 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:54.687795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:30:54.709423 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:30:54.709602 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:30:54.709701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:55.446946 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.737 seconds
[0m21:30:55.449976 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:30:55.458402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m21:30:55.464216 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:30:55.464543 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:30:55.464754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:56.153320 [debug] [ThreadPool]: SQL status: BEGIN in 0.688 seconds
[0m21:30:56.153927 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:30:56.154288 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:30:56.205469 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.051 seconds
[0m21:30:56.207696 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:30:56.256144 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:30:56.267707 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:56.268371 [debug] [MainThread]: On master: BEGIN
[0m21:30:56.268745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:56.909192 [debug] [MainThread]: SQL status: BEGIN in 0.640 seconds
[0m21:30:56.910161 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:56.910791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:57.087202 [debug] [MainThread]: SQL status: SELECT 5 in 0.176 seconds
[0m21:30:57.089224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11378bd10>]}
[0m21:30:57.089716 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:57.135866 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:57.136486 [debug] [MainThread]: On master: BEGIN
[0m21:30:57.261999 [debug] [MainThread]: SQL status: BEGIN in 0.125 seconds
[0m21:30:57.263016 [debug] [MainThread]: On master: COMMIT
[0m21:30:57.263551 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:57.263951 [debug] [MainThread]: On master: COMMIT
[0m21:30:57.310758 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m21:30:57.311818 [debug] [MainThread]: On master: Close
[0m21:30:57.320010 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m21:30:57.320825 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.parking_finish_stat ........................... [RUN]
[0m21:30:57.321511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.parking_finish_stat)
[0m21:30:57.322205 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m21:30:57.329876 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m21:30:57.330926 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m21:30:57.356986 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m21:30:57.357592 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:30:57.357782 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m21:30:57.357946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:58.097146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.739 seconds
[0m21:30:58.098023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:30:58.098797 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_ohwk"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)
-- group by
--     1


select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m21:31:13.389924 [debug] [Thread-1 (]: SQL status: SELECT 464 in 15.291 seconds
[0m21:31:13.404682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:31:13.405117 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m21:31:13.452030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m21:31:13.457440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:31:13.457959 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m21:31:13.504766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m21:31:13.526218 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m21:31:13.526599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:31:13.526856 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m21:31:13.576954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m21:31:13.586128 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup"
[0m21:31:13.590857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:31:13.591189 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop view if exists "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m21:31:13.640848 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.049 seconds
[0m21:31:13.645439 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m21:31:13.648683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5d1909d-a19f-43b4-a73f-4ada13c97eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139fa780>]}
[0m21:31:13.649424 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.parking_finish_stat ...................... [[32mSELECT 464[0m in 16.32s]
[0m21:31:13.650026 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m21:31:13.651415 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:13.651689 [debug] [MainThread]: On master: BEGIN
[0m21:31:13.651918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:31:14.282214 [debug] [MainThread]: SQL status: BEGIN in 0.630 seconds
[0m21:31:14.283901 [debug] [MainThread]: On master: COMMIT
[0m21:31:14.284745 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:14.285306 [debug] [MainThread]: On master: COMMIT
[0m21:31:14.337567 [debug] [MainThread]: SQL status: COMMIT in 0.052 seconds
[0m21:31:14.338792 [debug] [MainThread]: On master: Close
[0m21:31:14.340431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:14.340996 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m21:31:14.341633 [info ] [MainThread]: 
[0m21:31:14.342206 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 19.65 seconds (19.65s).
[0m21:31:14.343440 [debug] [MainThread]: Command end result
[0m21:31:14.376750 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:31:14.378270 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:31:14.381896 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:31:14.382091 [info ] [MainThread]: 
[0m21:31:14.382314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:31:14.382479 [info ] [MainThread]: 
[0m21:31:14.382776 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:31:14.384825 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.431522, "process_in_blocks": "0", "process_kernel_time": 0.148568, "process_mem_max_rss": "145227776", "process_out_blocks": "0", "process_user_time": 1.409343}
[0m21:31:14.385103 [debug] [MainThread]: Command `cli run` succeeded at 21:31:14.385046 after 20.43 seconds
[0m21:31:14.385306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cadd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bb7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f3650>]}
[0m21:31:14.385499 [debug] [MainThread]: Flushing usage events
[0m21:31:15.027757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:35.019135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039074d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dfb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dfbb10>]}


============================== 10:03:35.021796 | 48cdac4e-360f-4175-a6fb-1c86f2348d96 ==============================
[0m10:03:35.021796 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:03:35.022113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:03:35.101603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104103490>]}
[0m10:03:35.122932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c92e00>]}
[0m10:03:35.123542 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:03:35.162208 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m10:03:35.217741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:03:35.217940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:03:35.237186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105463550>]}
[0m10:03:35.271794 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:03:35.273241 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:03:35.285089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7d7c0>]}
[0m10:03:35.285322 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 437 macros
[0m10:03:35.285463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e4210>]}
[0m10:03:35.286196 [info ] [MainThread]: 
[0m10:03:35.286338 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:03:35.286496 [info ] [MainThread]: 
[0m10:03:35.286767 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:35.287137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m10:03:35.309910 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m10:03:35.310101 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m10:03:35.310215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:36.375226 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.064 seconds
[0m10:03:36.378834 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m10:03:36.389076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m10:03:36.396004 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m10:03:36.396436 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m10:03:36.396686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:37.193295 [debug] [ThreadPool]: SQL status: BEGIN in 0.796 seconds
[0m10:03:37.194202 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m10:03:37.194877 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:03:37.267569 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.072 seconds
[0m10:03:37.271124 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m10:03:37.341984 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m10:03:37.348816 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:37.349092 [debug] [MainThread]: On master: BEGIN
[0m10:03:37.349288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:38.900475 [debug] [MainThread]: SQL status: BEGIN in 1.551 seconds
[0m10:03:38.901567 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:38.902348 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:39.067474 [debug] [MainThread]: SQL status: SELECT 4 in 0.164 seconds
[0m10:03:39.072777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb9e60>]}
[0m10:03:39.073746 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:39.118494 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:39.119378 [debug] [MainThread]: On master: BEGIN
[0m10:03:39.209758 [debug] [MainThread]: SQL status: BEGIN in 0.089 seconds
[0m10:03:39.210788 [debug] [MainThread]: On master: COMMIT
[0m10:03:39.211479 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:39.212049 [debug] [MainThread]: On master: COMMIT
[0m10:03:39.257390 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m10:03:39.258499 [debug] [MainThread]: On master: Close
[0m10:03:39.266261 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m10:03:39.267437 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.events_clean ............................ [RUN]
[0m10:03:39.268219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m10:03:39.268736 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m10:03:39.284220 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m10:03:39.285543 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m10:03:39.318781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:39.319087 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp100339306471"
  
  
    as
  
  (
    select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")

  );
  
  
[0m10:03:39.319261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:40.711194 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.391 seconds
[0m10:03:40.733613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:40.734041 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m10:03:40.779059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m10:03:40.779894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:40.780416 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp100339306471'
        
      order by ordinal_position

  
[0m10:03:40.832873 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.052 seconds
[0m10:03:40.843341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:40.844153 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:03:40.937667 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.093 seconds
[0m10:03:40.958093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:40.958568 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp100339306471'
        
      order by ordinal_position

  
[0m10:03:41.007665 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.049 seconds
[0m10:03:41.013532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:41.014034 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:03:41.061202 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.046 seconds
[0m10:03:41.073283 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:03:41.081730 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m10:03:41.082386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:41.082669 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp100339306471"
    )


  
[0m10:03:41.135322 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.052 seconds
[0m10:03:41.149104 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:03:41.149434 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:03:41.149679 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:03:41.222197 [debug] [Thread-1 (]: SQL status: COMMIT in 0.072 seconds
[0m10:03:41.225179 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m10:03:41.228968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48cdac4e-360f-4175-a6fb-1c86f2348d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10608c410>]}
[0m10:03:41.229744 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 0[0m in 1.96s]
[0m10:03:41.230366 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m10:03:41.231781 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:41.232203 [debug] [MainThread]: On master: BEGIN
[0m10:03:41.232498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:03:41.895221 [debug] [MainThread]: SQL status: BEGIN in 0.662 seconds
[0m10:03:41.896156 [debug] [MainThread]: On master: COMMIT
[0m10:03:41.897202 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:41.897809 [debug] [MainThread]: On master: COMMIT
[0m10:03:41.944963 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m10:03:41.946020 [debug] [MainThread]: On master: Close
[0m10:03:41.947285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:41.947877 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m10:03:41.948401 [info ] [MainThread]: 
[0m10:03:41.949170 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.66 seconds (6.66s).
[0m10:03:41.951140 [debug] [MainThread]: Command end result
[0m10:03:42.015296 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:03:42.016480 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:03:42.019664 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m10:03:42.019804 [info ] [MainThread]: 
[0m10:03:42.019966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:03:42.020083 [info ] [MainThread]: 
[0m10:03:42.020214 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:03:42.053099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.063138, "process_in_blocks": "0", "process_kernel_time": 0.167728, "process_mem_max_rss": "138543104", "process_out_blocks": "0", "process_user_time": 1.056158}
[0m10:03:42.053426 [debug] [MainThread]: Command `cli run` succeeded at 10:03:42.053378 after 7.06 seconds
[0m10:03:42.053622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee5180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105458ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105458f50>]}
[0m10:03:42.053800 [debug] [MainThread]: Flushing usage events
[0m10:03:42.682719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:08.037595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059634d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5bb10>]}


============================== 10:14:08.040109 | 05acd809-bce4-4282-bc42-d6316fe72383 ==============================
[0m10:14:08.040109 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:14:08.040373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -s events_clean --vars {date: 2023-06-01}', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:08.106338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05acd809-bce4-4282-bc42-d6316fe72383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615f490>]}
[0m10:14:08.127226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05acd809-bce4-4282-bc42-d6316fe72383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf2030>]}
[0m10:14:08.128296 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:14:08.165254 [debug] [MainThread]: checksum: 1eabf0d320596055ed45cbce2f2d8d9d10c502a91e79a3d337baeb459c660cd9, vars: {'date': datetime.date(2023, 6, 1)}, profile: , target: , version: 1.10.6
[0m10:14:08.201570 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:14:08.201775 [debug] [MainThread]: previous checksum: 1eabf0d320596055ed45cbce2f2d8d9d10c502a91e79a3d337baeb459c660cd9, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m10:14:08.201913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05acd809-bce4-4282-bc42-d6316fe72383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107adbe50>]}
[0m10:14:08.609194 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named events_clean. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for events_clean in this file:
   - models/properties.yml
  
[0m10:14:08.611096 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.6023357, "process_in_blocks": "0", "process_kernel_time": 0.108413, "process_mem_max_rss": "125730816", "process_out_blocks": "0", "process_user_time": 1.027037}
[0m10:14:08.611285 [debug] [MainThread]: Command `dbt build` failed at 10:14:08.611247 after 0.60 seconds
[0m10:14:08.611426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3fe70>]}
[0m10:14:08.611575 [debug] [MainThread]: Flushing usage events
[0m10:14:09.294472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:41.508584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e274d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae27b10>]}


============================== 10:14:41.510317 | 64e0eedd-9050-4549-ba44-ffe8da1c340f ==============================
[0m10:14:41.510317 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:14:41.510575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build -s events_clean --vars date: 2023-06-01', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:41.573968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64e0eedd-9050-4549-ba44-ffe8da1c340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10952b490>]}
[0m10:14:41.594960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64e0eedd-9050-4549-ba44-ffe8da1c340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abbe030>]}
[0m10:14:41.595320 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:14:41.649031 [debug] [MainThread]: checksum: 1eabf0d320596055ed45cbce2f2d8d9d10c502a91e79a3d337baeb459c660cd9, vars: {'date': datetime.date(2023, 6, 1)}, profile: , target: , version: 1.10.6
[0m10:14:41.686342 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:14:41.686551 [debug] [MainThread]: previous checksum: 1eabf0d320596055ed45cbce2f2d8d9d10c502a91e79a3d337baeb459c660cd9, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m10:14:41.686691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '64e0eedd-9050-4549-ba44-ffe8da1c340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8dbe50>]}
[0m10:14:42.094995 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named events_clean. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for events_clean in this file:
   - models/properties.yml
  
[0m10:14:42.097386 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.6181564, "process_in_blocks": "0", "process_kernel_time": 0.099393, "process_mem_max_rss": "126746624", "process_out_blocks": "0", "process_user_time": 1.030305}
[0m10:14:42.097593 [debug] [MainThread]: Command `dbt build` failed at 10:14:42.097553 after 0.62 seconds
[0m10:14:42.097748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d20ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d20a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae0be70>]}
[0m10:14:42.097885 [debug] [MainThread]: Flushing usage events
[0m10:14:42.596670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:22:06.944869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111227b10>]}


============================== 10:22:06.947874 | 2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5 ==============================
[0m10:22:06.947874 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:22:06.948192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build -s events_clean --vars date: 2023-06-01', 'send_anonymous_usage_stats': 'True'}
[0m10:22:07.016321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11022b490>]}
[0m10:22:07.038150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110be030>]}
[0m10:22:07.038815 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:22:07.075849 [debug] [MainThread]: checksum: 1eabf0d320596055ed45cbce2f2d8d9d10c502a91e79a3d337baeb459c660cd9, vars: {'date': datetime.date(2023, 6, 1)}, profile: , target: , version: 1.10.6
[0m10:22:07.113886 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:22:07.114123 [debug] [MainThread]: previous checksum: 1eabf0d320596055ed45cbce2f2d8d9d10c502a91e79a3d337baeb459c660cd9, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m10:22:07.114281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133fbe50>]}
[0m10:22:07.600827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d06e40>]}
[0m10:22:07.631239 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:22:07.632500 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:22:07.648678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ee75b0>]}
[0m10:22:07.648878 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 437 macros
[0m10:22:07.649648 [info ] [MainThread]: 
[0m10:22:07.649786 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:22:07.649895 [info ] [MainThread]: 
[0m10:22:07.650084 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:22:07.650419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m10:22:07.671552 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m10:22:07.671750 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m10:22:07.671865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:08.737231 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.065 seconds
[0m10:22:08.742474 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m10:22:08.750972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m10:22:08.757881 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m10:22:08.758350 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m10:22:08.758631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:10.492853 [debug] [ThreadPool]: SQL status: BEGIN in 1.734 seconds
[0m10:22:10.493415 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m10:22:10.493781 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:22:10.547577 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.053 seconds
[0m10:22:10.549803 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m10:22:10.598015 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m10:22:10.607790 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:10.608228 [debug] [MainThread]: On master: BEGIN
[0m10:22:10.608511 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:11.568197 [debug] [MainThread]: SQL status: BEGIN in 0.959 seconds
[0m10:22:11.569784 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:11.571149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:22:11.684969 [debug] [MainThread]: SQL status: SELECT 4 in 0.113 seconds
[0m10:22:11.689679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11432f6c0>]}
[0m10:22:11.690445 [debug] [MainThread]: On master: ROLLBACK
[0m10:22:11.744681 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:11.745572 [debug] [MainThread]: On master: BEGIN
[0m10:22:11.845026 [debug] [MainThread]: SQL status: BEGIN in 0.099 seconds
[0m10:22:11.846347 [debug] [MainThread]: On master: COMMIT
[0m10:22:11.847381 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:11.848331 [debug] [MainThread]: On master: COMMIT
[0m10:22:11.933295 [debug] [MainThread]: SQL status: COMMIT in 0.084 seconds
[0m10:22:11.934443 [debug] [MainThread]: On master: Close
[0m10:22:11.943935 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m10:22:11.944996 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.events_clean ............................ [RUN]
[0m10:22:11.945660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.events_clean)
[0m10:22:11.946136 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m10:22:11.959074 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m10:22:11.960173 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m10:22:11.994591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:11.994885 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp102211982012"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    
        date("timestamp") = date '2023-06-01'
    

  );
  
  
[0m10:22:11.995070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:13.179602 [debug] [Thread-1 (]: SQL status: SELECT 3852 in 1.184 seconds
[0m10:22:13.195465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:13.195849 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m10:22:13.244878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m10:22:13.245289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:13.245646 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp102211982012'
        
      order by ordinal_position

  
[0m10:22:13.298048 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.052 seconds
[0m10:22:13.307636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:13.308340 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:22:13.358162 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.049 seconds
[0m10:22:13.373559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:13.374074 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp102211982012'
        
      order by ordinal_position

  
[0m10:22:13.448261 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.074 seconds
[0m10:22:13.454079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:13.454841 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:22:13.503775 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.048 seconds
[0m10:22:13.515867 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:22:13.530307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m10:22:13.531159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:13.531467 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        delete from "dev_ohwk"."dbt"."events_clean" as DBT_INTERNAL_DEST
        where (user_id, timestamp, type_id) in (
            select distinct user_id, timestamp, type_id
            from "events_clean__dbt_tmp102211982012" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp102211982012"
    )
  
[0m10:22:14.096998 [debug] [Thread-1 (]: SQL status: INSERT 0 3852 in 0.565 seconds
[0m10:22:14.119327 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:22:14.119810 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:22:14.120121 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:22:14.167531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.047 seconds
[0m10:22:14.171183 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m10:22:14.175784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce1f665-5d6c-45ca-bc19-7a7403d1e8d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fba450>]}
[0m10:22:14.176559 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 3852[0m in 2.23s]
[0m10:22:14.177181 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m10:22:14.178634 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:14.178966 [debug] [MainThread]: On master: BEGIN
[0m10:22:14.179242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:22:15.838117 [debug] [MainThread]: SQL status: BEGIN in 1.659 seconds
[0m10:22:15.839329 [debug] [MainThread]: On master: COMMIT
[0m10:22:15.840056 [debug] [MainThread]: Using postgres connection "master"
[0m10:22:15.840587 [debug] [MainThread]: On master: COMMIT
[0m10:22:15.885409 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m10:22:15.886577 [debug] [MainThread]: On master: Close
[0m10:22:15.888593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:15.889235 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m10:22:15.889814 [info ] [MainThread]: 
[0m10:22:15.890379 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.24 seconds (8.24s).
[0m10:22:15.891535 [debug] [MainThread]: Command end result
[0m10:22:15.920062 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:22:15.921464 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:22:15.925428 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m10:22:15.925629 [info ] [MainThread]: 
[0m10:22:15.925864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:22:15.926035 [info ] [MainThread]: 
[0m10:22:15.926214 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:22:15.928095 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.014997, "process_in_blocks": "0", "process_kernel_time": 0.154062, "process_mem_max_rss": "147079168", "process_out_blocks": "0", "process_user_time": 1.448748}
[0m10:22:15.928423 [debug] [MainThread]: Command `dbt build` succeeded at 10:22:15.928361 after 9.02 seconds
[0m10:22:15.928672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114035de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140b82d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140b8050>]}
[0m10:22:15.928901 [debug] [MainThread]: Flushing usage events
[0m10:22:16.516379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:46:10.390012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1fb10>]}


============================== 10:46:10.392126 | 3063be39-dc9f-44c9-a2e1-ac33d071ffc2 ==============================
[0m10:46:10.392126 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:46:10.392419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:46:10.435199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3063be39-dc9f-44c9-a2e1-ac33d071ffc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c2b490>]}
[0m10:46:10.441812 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:46:10.442415 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:46:10.469151 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.109680586, "process_in_blocks": "0", "process_kernel_time": 0.069436, "process_mem_max_rss": "110837760", "process_out_blocks": "0", "process_user_time": 0.534454}
[0m10:46:10.469423 [debug] [MainThread]: Command `cli deps` succeeded at 10:46:10.469371 after 0.11 seconds
[0m10:46:10.469605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc18c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba3650>]}
[0m10:46:10.469765 [debug] [MainThread]: Flushing usage events
[0m10:46:10.996411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:47:48.688981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106327b10>]}


============================== 10:47:48.691731 | ca93193a-f755-4e72-98b7-91b9fcd41bf0 ==============================
[0m10:47:48.691731 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:47:48.692035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:47:48.756424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca93193a-f755-4e72-98b7-91b9fcd41bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522f490>]}
[0m10:47:48.777424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca93193a-f755-4e72-98b7-91b9fcd41bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c2e00>]}
[0m10:47:48.777832 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:47:48.816621 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m10:47:48.854553 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:47:48.854793 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m10:47:48.854971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca93193a-f755-4e72-98b7-91b9fcd41bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f0250>]}
[0m10:47:49.341472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca93193a-f755-4e72-98b7-91b9fcd41bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107418320>]}
[0m10:47:49.372125 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:47:49.373532 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:47:49.380507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca93193a-f755-4e72-98b7-91b9fcd41bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685fd90>]}
[0m10:47:49.380722 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 437 macros
[0m10:47:49.380858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca93193a-f755-4e72-98b7-91b9fcd41bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b5bf0>]}
[0m10:47:49.381572 [info ] [MainThread]: 
[0m10:47:49.381703 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:47:49.381812 [info ] [MainThread]: 
[0m10:47:49.382053 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:47:49.382439 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m10:47:49.399593 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m10:47:49.399804 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m10:47:49.399914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:50.188700 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.788 seconds
[0m10:47:50.192606 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m10:47:50.203244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m10:47:50.211072 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m10:47:50.211559 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m10:47:50.211810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:50.826593 [debug] [ThreadPool]: SQL status: BEGIN in 0.615 seconds
[0m10:47:50.827218 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m10:47:50.827573 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:47:50.875458 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.047 seconds
[0m10:47:50.877440 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m10:47:50.922376 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m10:47:50.931436 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:50.931857 [debug] [MainThread]: On master: BEGIN
[0m10:47:50.932117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:47:51.569504 [debug] [MainThread]: SQL status: BEGIN in 0.637 seconds
[0m10:47:51.570459 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:51.571109 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:47:51.810414 [debug] [MainThread]: SQL status: SELECT 4 in 0.239 seconds
[0m10:47:51.812576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca93193a-f755-4e72-98b7-91b9fcd41bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747ff50>]}
[0m10:47:51.813212 [debug] [MainThread]: On master: ROLLBACK
[0m10:47:51.858118 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:51.858616 [debug] [MainThread]: On master: BEGIN
[0m10:47:51.951190 [debug] [MainThread]: SQL status: BEGIN in 0.092 seconds
[0m10:47:51.952063 [debug] [MainThread]: On master: COMMIT
[0m10:47:51.953031 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:51.953534 [debug] [MainThread]: On master: COMMIT
[0m10:47:52.000700 [debug] [MainThread]: SQL status: COMMIT in 0.047 seconds
[0m10:47:52.001582 [debug] [MainThread]: On master: Close
[0m10:47:52.009763 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_users
[0m10:47:52.010500 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.trips_users ............................. [RUN]
[0m10:47:52.011223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.trips_users)
[0m10:47:52.011688 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_users
[0m10:47:52.023344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m10:47:52.024799 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_users
[0m10:47:52.060529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:47:52.060827 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp104752046888"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m10:47:52.061012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:52.910185 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.849 seconds
[0m10:47:52.932704 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:47:52.933280 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: BEGIN
[0m10:47:52.979104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m10:47:52.979986 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:47:52.980795 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp104752046888'
        
      order by ordinal_position

  
[0m10:47:53.311580 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.330 seconds
[0m10:47:53.324541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:47:53.325510 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:47:53.414661 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.088 seconds
[0m10:47:53.436697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:47:53.437184 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp104752046888'
        
      order by ordinal_position

  
[0m10:47:53.528255 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.090 seconds
[0m10:47:53.544520 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:47:53.545049 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:47:53.645222 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.099 seconds
[0m10:47:53.664456 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:47:53.674639 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m10:47:53.675515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:47:53.675814 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp104752046888"
    )


  
[0m10:47:53.809277 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.133 seconds
[0m10:47:53.831357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:47:53.831853 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m10:47:56.413492 [debug] [Thread-1 (]: SQL status: ANALYZE in 2.581 seconds
[0m10:47:56.415714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:47:56.416529 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m10:47:56.468786 [debug] [Thread-1 (]: Postgres adapter: Postgres error: VACUUM cannot run inside a transaction block

[0m10:47:56.470329 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: ROLLBACK
[0m10:47:56.518805 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: Close
[0m10:47:56.531776 [debug] [Thread-1 (]: Database Error in model trips_users (models/trips_users.sql)
  VACUUM cannot run inside a transaction block
  compiled code at target/run/dbt_scooters/models/trips_users.sql
[0m10:47:56.534460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca93193a-f755-4e72-98b7-91b9fcd41bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac4260>]}
[0m10:47:56.535378 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dbt.trips_users .................... [[31mERROR[0m in 4.52s]
[0m10:47:56.536086 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_users
[0m10:47:56.536878 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_users' to be skipped because of status 'error'.  Reason: Database Error in model trips_users (models/trips_users.sql)
  VACUUM cannot run inside a transaction block
  compiled code at target/run/dbt_scooters/models/trips_users.sql.
[0m10:47:56.538666 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:56.538952 [debug] [MainThread]: On master: BEGIN
[0m10:47:56.539147 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:47:57.362119 [debug] [MainThread]: SQL status: BEGIN in 0.823 seconds
[0m10:47:57.363156 [debug] [MainThread]: On master: COMMIT
[0m10:47:57.363752 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:57.364210 [debug] [MainThread]: On master: COMMIT
[0m10:47:57.412358 [debug] [MainThread]: SQL status: COMMIT in 0.048 seconds
[0m10:47:57.413340 [debug] [MainThread]: On master: Close
[0m10:47:57.414725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:57.415206 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m10:47:57.416435 [info ] [MainThread]: 
[0m10:47:57.417741 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.03 seconds (8.03s).
[0m10:47:57.419237 [debug] [MainThread]: Command end result
[0m10:47:57.450078 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:47:57.451609 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:47:57.455441 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m10:47:57.455637 [info ] [MainThread]: 
[0m10:47:57.455861 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:47:57.456033 [info ] [MainThread]: 
[0m10:47:57.456312 [error] [MainThread]: [31mFailure in model trips_users (models/trips_users.sql)[0m
[0m10:47:57.456599 [error] [MainThread]:   Database Error in model trips_users (models/trips_users.sql)
  VACUUM cannot run inside a transaction block
  compiled code at target/run/dbt_scooters/models/trips_users.sql
[0m10:47:57.456788 [info ] [MainThread]: 
[0m10:47:57.456982 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/trips_users.sql
[0m10:47:57.457275 [info ] [MainThread]: 
[0m10:47:57.457679 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:47:57.459488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.800601, "process_in_blocks": "0", "process_kernel_time": 0.142115, "process_mem_max_rss": "147521536", "process_out_blocks": "0", "process_user_time": 1.487092}
[0m10:47:57.459747 [debug] [MainThread]: Command `cli run` failed at 10:47:57.459696 after 8.80 seconds
[0m10:47:57.459957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a668f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e1e50>]}
[0m10:47:57.460157 [debug] [MainThread]: Flushing usage events
[0m10:47:58.177861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:46.583445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d27b10>]}


============================== 10:50:46.586013 | e1cf4c2d-988d-4a4b-89ee-b56e4a86c40e ==============================
[0m10:50:46.586013 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:50:46.586280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:50:46.653285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1cf4c2d-988d-4a4b-89ee-b56e4a86c40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b33490>]}
[0m10:50:46.673816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1cf4c2d-988d-4a4b-89ee-b56e4a86c40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac2e00>]}
[0m10:50:46.674959 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:50:46.712867 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m10:50:46.750721 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:50:46.750951 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m10:50:46.751101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e1cf4c2d-988d-4a4b-89ee-b56e4a86c40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109fc250>]}
[0m10:50:47.227871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1cf4c2d-988d-4a4b-89ee-b56e4a86c40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b29400>]}
[0m10:50:47.258341 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:50:47.259533 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:50:47.269677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1cf4c2d-988d-4a4b-89ee-b56e4a86c40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dec210>]}
[0m10:50:47.269906 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 437 macros
[0m10:50:47.270046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1cf4c2d-988d-4a4b-89ee-b56e4a86c40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108a76c0>]}
[0m10:50:47.270785 [info ] [MainThread]: 
[0m10:50:47.270924 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:50:47.271056 [info ] [MainThread]: 
[0m10:50:47.271294 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:50:47.271673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m10:50:47.293081 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m10:50:47.293279 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m10:50:47.293385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:47.937906 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.644 seconds
[0m10:50:47.941086 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m10:50:47.950891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m10:50:47.958651 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m10:50:47.959228 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m10:50:47.959479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:48.577432 [debug] [ThreadPool]: SQL status: BEGIN in 0.618 seconds
[0m10:50:48.577945 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m10:50:48.578300 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:50:48.628135 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.049 seconds
[0m10:50:48.631391 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m10:50:48.679263 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m10:50:48.690045 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:48.690460 [debug] [MainThread]: On master: BEGIN
[0m10:50:48.690719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:49.432899 [debug] [MainThread]: SQL status: BEGIN in 0.742 seconds
[0m10:50:49.433618 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:49.434129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:50:49.615963 [debug] [MainThread]: SQL status: SELECT 4 in 0.181 seconds
[0m10:50:49.619688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1cf4c2d-988d-4a4b-89ee-b56e4a86c40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b93f50>]}
[0m10:50:49.620607 [debug] [MainThread]: On master: ROLLBACK
[0m10:50:49.667166 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:49.668107 [debug] [MainThread]: On master: BEGIN
[0m10:50:49.907979 [debug] [MainThread]: SQL status: BEGIN in 0.239 seconds
[0m10:50:49.909014 [debug] [MainThread]: On master: COMMIT
[0m10:50:49.909416 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:49.909678 [debug] [MainThread]: On master: COMMIT
[0m10:50:49.955398 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m10:50:49.956239 [debug] [MainThread]: On master: Close
[0m10:50:49.962875 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_users
[0m10:50:49.963982 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt.trips_users ............................. [RUN]
[0m10:50:49.964834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.trips_users)
[0m10:50:49.965781 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_users
[0m10:50:49.977504 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m10:50:49.978849 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_users
[0m10:50:50.015324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:50:50.015734 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp105050002183"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m10:50:50.015925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:51.716222 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.700 seconds
[0m10:50:51.736692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:50:51.737295 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: BEGIN
[0m10:50:51.784211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m10:50:51.785006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:50:51.785514 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp105050002183'
        
      order by ordinal_position

  
[0m10:50:51.846172 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.060 seconds
[0m10:50:51.856557 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:50:51.857496 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:50:51.908486 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.050 seconds
[0m10:50:51.925915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:50:51.926513 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp105050002183'
        
      order by ordinal_position

  
[0m10:50:51.975894 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.049 seconds
[0m10:50:51.986147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:50:51.986762 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:50:52.037173 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.050 seconds
[0m10:50:52.051673 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:50:52.061501 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m10:50:52.062344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:50:52.062663 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp105050002183"
    )


  
[0m10:50:52.110414 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.047 seconds
[0m10:50:52.124759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:50:52.125069 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m10:50:55.329301 [debug] [Thread-1 (]: SQL status: ANALYZE in 3.204 seconds
[0m10:50:55.331338 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m10:50:55.332253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:50:55.332902 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m10:50:55.382837 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m10:50:55.384257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:50:55.384883 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m10:50:55.436763 [debug] [Thread-1 (]: SQL status: COMMIT in 0.051 seconds
[0m10:50:55.438770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:50:55.439269 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m10:50:55.488147 [debug] [Thread-1 (]: SQL status: VACUUM in 0.048 seconds
[0m10:50:55.493817 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: Close
[0m10:50:55.498355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cf4c2d-988d-4a4b-89ee-b56e4a86c40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dff1d0>]}
[0m10:50:55.499646 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt.trips_users ........................ [[32mINSERT 0 0[0m in 5.53s]
[0m10:50:55.500350 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_users
[0m10:50:55.502280 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:55.502728 [debug] [MainThread]: On master: BEGIN
[0m10:50:55.503002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:50:57.004339 [debug] [MainThread]: SQL status: BEGIN in 1.501 seconds
[0m10:50:57.005331 [debug] [MainThread]: On master: COMMIT
[0m10:50:57.005930 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:57.006395 [debug] [MainThread]: On master: COMMIT
[0m10:50:57.050744 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m10:50:57.051656 [debug] [MainThread]: On master: Close
[0m10:50:57.053063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:50:57.053651 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m10:50:57.054219 [info ] [MainThread]: 
[0m10:50:57.054805 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.78 seconds (9.78s).
[0m10:50:57.055860 [debug] [MainThread]: Command end result
[0m10:50:57.086726 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:50:57.088192 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:50:57.091915 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m10:50:57.092116 [info ] [MainThread]: 
[0m10:50:57.092341 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:50:57.092503 [info ] [MainThread]: 
[0m10:50:57.092757 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:50:57.094683 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.541242, "process_in_blocks": "0", "process_kernel_time": 0.153258, "process_mem_max_rss": "147308544", "process_out_blocks": "0", "process_user_time": 1.467967}
[0m10:50:57.095010 [debug] [MainThread]: Command `cli run` succeeded at 10:50:57.094948 after 10.54 seconds
[0m10:50:57.095244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de0870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118bea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d877d0>]}
[0m10:50:57.095461 [debug] [MainThread]: Flushing usage events
[0m10:50:57.597496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:33:06.460814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a574d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f439d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f43b10>]}


============================== 21:33:06.462846 | b50329a8-2bcc-4e97-b256-641121fc1581 ==============================
[0m21:33:06.462846 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:33:06.463114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:33:06.507712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b50329a8-2bcc-4e97-b256-641121fc1581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624f490>]}
[0m21:33:06.514704 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:33:06.515317 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:33:06.543942 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11684075, "process_in_blocks": "0", "process_kernel_time": 0.071049, "process_mem_max_rss": "109871104", "process_out_blocks": "0", "process_user_time": 0.543743}
[0m21:33:06.544187 [debug] [MainThread]: Command `cli deps` succeeded at 21:33:06.544139 after 0.12 seconds
[0m21:33:06.544341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de58c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcb650>]}
[0m21:33:06.544483 [debug] [MainThread]: Flushing usage events
[0m21:33:07.156780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:34:43.055061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081534d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096439d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109643b10>]}


============================== 21:34:43.056854 | 948b0b8f-d7d1-4e08-ac8a-9f1a192dcfbf ==============================
[0m21:34:43.056854 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:34:43.057119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run-operation create_role --args name: finance', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:34:43.121772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '948b0b8f-d7d1-4e08-ac8a-9f1a192dcfbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894f490>]}
[0m21:34:43.143376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '948b0b8f-d7d1-4e08-ac8a-9f1a192dcfbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e2030>]}
[0m21:34:43.143722 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:34:43.181347 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:34:43.231779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:34:43.231986 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:34:43.250492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '948b0b8f-d7d1-4e08-ac8a-9f1a192dcfbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2cf550>]}
[0m21:34:43.282147 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:34:43.283823 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:34:43.292244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '948b0b8f-d7d1-4e08-ac8a-9f1a192dcfbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b56d0>]}
[0m21:34:43.292448 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 438 macros
[0m21:34:43.292594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '948b0b8f-d7d1-4e08-ac8a-9f1a192dcfbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b77bd0>]}
[0m21:34:43.292826 [debug] [MainThread]: Acquiring new postgres connection 'macro_create_role'
[0m21:34:43.292952 [debug] [MainThread]: Using postgres connection "macro_create_role"
[0m21:34:43.293057 [debug] [MainThread]: On macro_create_role: BEGIN
[0m21:34:43.293152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:44.602221 [debug] [MainThread]: SQL status: BEGIN in 1.309 seconds
[0m21:34:44.602575 [debug] [MainThread]: On macro_create_role: COMMIT
[0m21:34:44.602759 [debug] [MainThread]: Using postgres connection "macro_create_role"
[0m21:34:44.602917 [debug] [MainThread]: On macro_create_role: COMMIT
[0m21:34:44.646762 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m21:34:44.651197 [info ] [MainThread]: Creating role: finance
[0m21:34:44.682624 [debug] [MainThread]: Using postgres connection "macro_create_role"
[0m21:34:44.682869 [debug] [MainThread]: On macro_create_role: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "macro_create_role"} */

    
        create role finance nologin;
    
  
[0m21:34:44.736085 [debug] [MainThread]: SQL status: CREATE ROLE in 0.053 seconds
[0m21:34:44.736960 [debug] [MainThread]: On macro_create_role: Close
[0m21:34:44.741913 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:34:44.743824 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 1.7170821, "process_in_blocks": "0", "process_kernel_time": 0.117805, "process_mem_max_rss": "132022272", "process_out_blocks": "0", "process_user_time": 0.709746}
[0m21:34:44.744186 [debug] [MainThread]: Command `dbt run-operation` succeeded at 21:34:44.744117 after 1.72 seconds
[0m21:34:44.744404 [debug] [MainThread]: Connection 'macro_create_role' was properly closed.
[0m21:34:44.744613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a543c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10952cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4fe8d0>]}
[0m21:34:44.744835 [debug] [MainThread]: Flushing usage events
[0m21:34:45.378326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:39:18.244473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cbf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111327b10>]}


============================== 21:39:18.246795 | 7d9071c7-30b9-407a-8616-1f5112b7e05c ==============================
[0m21:39:18.246795 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:39:18.247056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build -s finance', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:39:18.314401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d9071c7-30b9-407a-8616-1f5112b7e05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11032f490>]}
[0m21:39:18.336072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d9071c7-30b9-407a-8616-1f5112b7e05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111be030>]}
[0m21:39:18.336744 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:39:18.373450 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:39:18.419548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:39:18.419730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:39:18.438892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d9071c7-30b9-407a-8616-1f5112b7e05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111962f50>]}
[0m21:39:18.472894 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:39:18.474054 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:39:18.490757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d9071c7-30b9-407a-8616-1f5112b7e05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112975e50>]}
[0m21:39:18.490984 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 438 macros
[0m21:39:18.491824 [info ] [MainThread]: 
[0m21:39:18.491970 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:39:18.492079 [info ] [MainThread]: 
[0m21:39:18.492285 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:39:18.492631 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m21:39:18.514665 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m21:39:18.514880 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m21:39:18.515001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:20.255539 [debug] [ThreadPool]: SQL status: SELECT 22 in 1.740 seconds
[0m21:39:20.260639 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m21:39:20.262791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now create_dev_ohwk_dbt_finance)
[0m21:39:20.264812 [debug] [ThreadPool]: Creating schema "database: "dev_ohwk"
schema: "dbt_finance"
"
[0m21:39:20.272257 [debug] [ThreadPool]: Using postgres connection "create_dev_ohwk_dbt_finance"
[0m21:39:20.272675 [debug] [ThreadPool]: On create_dev_ohwk_dbt_finance: BEGIN
[0m21:39:20.272996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:39:20.964924 [debug] [ThreadPool]: SQL status: BEGIN in 0.692 seconds
[0m21:39:20.966402 [debug] [ThreadPool]: Using postgres connection "create_dev_ohwk_dbt_finance"
[0m21:39:20.967496 [debug] [ThreadPool]: On create_dev_ohwk_dbt_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "create_dev_ohwk_dbt_finance"} */
create schema if not exists "dbt_finance"
[0m21:39:21.020844 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.052 seconds
[0m21:39:21.024317 [debug] [ThreadPool]: On create_dev_ohwk_dbt_finance: COMMIT
[0m21:39:21.024990 [debug] [ThreadPool]: Using postgres connection "create_dev_ohwk_dbt_finance"
[0m21:39:21.025496 [debug] [ThreadPool]: On create_dev_ohwk_dbt_finance: COMMIT
[0m21:39:21.073048 [debug] [ThreadPool]: SQL status: COMMIT in 0.047 seconds
[0m21:39:21.074103 [debug] [ThreadPool]: On create_dev_ohwk_dbt_finance: Close
[0m21:39:21.085068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_ohwk_dbt_finance, now list_dev_ohwk_dbt_finance)
[0m21:39:21.092782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_dbt'
[0m21:39:21.093654 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt_finance"
[0m21:39:21.096365 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:39:21.096699 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: BEGIN
[0m21:39:21.096958 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m21:39:21.097202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:39:21.097425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:21.740285 [debug] [ThreadPool]: SQL status: BEGIN in 0.643 seconds
[0m21:39:21.741740 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt_finance"
[0m21:39:21.742798 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt_finance"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_finance'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_finance'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_finance'
  
[0m21:39:21.762131 [debug] [ThreadPool]: SQL status: BEGIN in 0.665 seconds
[0m21:39:21.763228 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m21:39:21.764041 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:39:21.796682 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.053 seconds
[0m21:39:21.800772 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: ROLLBACK
[0m21:39:21.815658 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.051 seconds
[0m21:39:21.818342 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m21:39:21.846421 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: Close
[0m21:39:21.864267 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m21:39:21.877007 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:21.877533 [debug] [MainThread]: On master: BEGIN
[0m21:39:21.877833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:39:22.718899 [debug] [MainThread]: SQL status: BEGIN in 0.841 seconds
[0m21:39:22.720386 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:22.721614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:39:22.967621 [debug] [MainThread]: SQL status: SELECT 4 in 0.245 seconds
[0m21:39:22.968909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d9071c7-30b9-407a-8616-1f5112b7e05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129ff850>]}
[0m21:39:22.969257 [debug] [MainThread]: On master: ROLLBACK
[0m21:39:23.020403 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:23.020722 [debug] [MainThread]: On master: BEGIN
[0m21:39:23.118265 [debug] [MainThread]: SQL status: BEGIN in 0.097 seconds
[0m21:39:23.119288 [debug] [MainThread]: On master: COMMIT
[0m21:39:23.120089 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:23.120585 [debug] [MainThread]: On master: COMMIT
[0m21:39:23.171411 [debug] [MainThread]: SQL status: COMMIT in 0.050 seconds
[0m21:39:23.172523 [debug] [MainThread]: On master: Close
[0m21:39:23.179360 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:39:23.180280 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_finance.revenue_daily ................... [RUN]
[0m21:39:23.180833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt_finance, now model.dbt_scooters.revenue_daily)
[0m21:39:23.181210 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:39:23.198119 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:39:23.199084 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:39:23.254842 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:39:23.255499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:39:23.255662 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:39:23.255789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:24.298018 [debug] [Thread-1 (]: SQL status: BEGIN in 1.042 seconds
[0m21:39:24.299346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:39:24.300070 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_ohwk"."dbt_finance"."revenue_daily"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
  );
  
  
[0m21:39:25.224069 [debug] [Thread-1 (]: SQL status: SELECT 91 in 0.922 seconds
[0m21:39:25.249545 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:39:25.250029 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:39:25.250310 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:39:25.298985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.048 seconds
[0m21:39:25.302591 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:39:25.307054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9071c7-30b9-407a-8616-1f5112b7e05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e20120>]}
[0m21:39:25.308129 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt_finance.revenue_daily .............. [[32mSELECT 91[0m in 2.12s]
[0m21:39:25.308761 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:39:25.310341 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:25.310734 [debug] [MainThread]: On master: BEGIN
[0m21:39:25.311004 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:39:26.177047 [debug] [MainThread]: SQL status: BEGIN in 0.866 seconds
[0m21:39:26.178634 [debug] [MainThread]: On master: COMMIT
[0m21:39:26.179656 [debug] [MainThread]: Using postgres connection "master"
[0m21:39:26.180161 [debug] [MainThread]: On master: COMMIT
[0m21:39:26.225149 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m21:39:26.226549 [debug] [MainThread]: On master: Close
[0m21:39:26.228508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:26.229136 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m21:39:26.229550 [debug] [MainThread]: Connection 'list_dev_ohwk_dbt' was properly closed.
[0m21:39:26.230172 [info ] [MainThread]: 
[0m21:39:26.230739 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.74 seconds (7.74s).
[0m21:39:26.231985 [debug] [MainThread]: Command end result
[0m21:39:26.261130 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:39:26.262735 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:39:26.266733 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:39:26.266963 [info ] [MainThread]: 
[0m21:39:26.267212 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:39:26.267385 [info ] [MainThread]: 
[0m21:39:26.267590 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:39:26.269443 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.052869, "process_in_blocks": "0", "process_kernel_time": 0.152821, "process_mem_max_rss": "137789440", "process_out_blocks": "0", "process_user_time": 1.005642}
[0m21:39:26.269730 [debug] [MainThread]: Command `dbt build` succeeded at 21:39:26.269674 after 8.05 seconds
[0m21:39:26.269960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11120cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ed8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ed8b50>]}
[0m21:39:26.270167 [debug] [MainThread]: Flushing usage events
[0m21:39:27.082636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:21.689184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036bf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104baf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bafb10>]}


============================== 18:17:21.691929 | 57caaf0b-5163-46cb-8786-0fe1cadb4817 ==============================
[0m18:17:21.691929 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:17:21.692229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run-operation create_role --args name: finance', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:17:21.776369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57caaf0b-5163-46cb-8786-0fe1cadb4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ebf490>]}
[0m18:17:21.798858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57caaf0b-5163-46cb-8786-0fe1cadb4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a4e030>]}
[0m18:17:21.799425 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:17:21.837777 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:17:21.889340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:21.889520 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:21.907832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57caaf0b-5163-46cb-8786-0fe1cadb4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105837550>]}
[0m18:17:21.940162 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:17:21.941937 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:17:21.951719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57caaf0b-5163-46cb-8786-0fe1cadb4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059216d0>]}
[0m18:17:21.951897 [info ] [MainThread]: Found 17 models, 3 seeds, 17 sources, 438 macros
[0m18:17:21.952039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57caaf0b-5163-46cb-8786-0fe1cadb4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e3d90>]}
[0m18:17:21.952275 [debug] [MainThread]: Acquiring new postgres connection 'macro_create_role'
[0m18:17:21.952407 [debug] [MainThread]: Using postgres connection "macro_create_role"
[0m18:17:21.952515 [debug] [MainThread]: On macro_create_role: BEGIN
[0m18:17:21.952614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:22.942529 [debug] [MainThread]: SQL status: BEGIN in 0.990 seconds
[0m18:17:22.943904 [debug] [MainThread]: On macro_create_role: COMMIT
[0m18:17:22.944962 [debug] [MainThread]: Using postgres connection "macro_create_role"
[0m18:17:22.945856 [debug] [MainThread]: On macro_create_role: COMMIT
[0m18:17:22.990062 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m18:17:23.000136 [info ] [MainThread]: Creating role: finance
[0m18:17:23.047024 [debug] [MainThread]: Using postgres connection "macro_create_role"
[0m18:17:23.047268 [debug] [MainThread]: On macro_create_role: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "macro_create_role"} */

    
        create role finance nologin;
    
  
[0m18:17:23.090967 [debug] [MainThread]: Postgres adapter: Postgres error: role "finance" already exists

[0m18:17:23.091289 [debug] [MainThread]: Postgres adapter: Error running SQL: macro create_role
[0m18:17:23.091429 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m18:17:23.091570 [debug] [MainThread]: On macro_create_role: Close
[0m18:17:23.091932 [error] [MainThread]: Encountered an error while running operation: Database Error
  role "finance" already exists
[0m18:17:23.096615 [debug] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/postgres/connections.py", line 76, in exception_handler
    yield
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 148, in add_query
    _execute_query_with_retry(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        cursor=cursor,
        ^^^^^^^^^^^^^^
    ...<4 lines>...
        attempt=1,
        ^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 97, in _execute_query_with_retry
    cursor.execute(sql, bindings)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
psycopg2.errors.DuplicateObject: role "finance" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 64, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 45, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1287, in execute_macro
    result = macro_function(**kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 427, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 38, in macro
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt_common/record.py", line 507, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 449, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 219, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 131, in add_query
    with self.exception_handler(sql):
         ~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/postgres/connections.py", line 87, in exception_handler
    raise DbtDatabaseError(str(e).strip()) from e
dbt_common.exceptions.base.DbtDatabaseError: Database Error
  role "finance" already exists

[0m18:17:23.099970 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m18:17:23.124498 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 1.4677032, "process_in_blocks": "0", "process_kernel_time": 0.174418, "process_mem_max_rss": "133087232", "process_out_blocks": "0", "process_user_time": 0.744905}
[0m18:17:23.124804 [debug] [MainThread]: Command `dbt run-operation` failed at 18:17:23.124755 after 1.47 seconds
[0m18:17:23.124976 [debug] [MainThread]: Connection 'macro_create_role' was properly closed.
[0m18:17:23.125132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aafad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a9cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a668d0>]}
[0m18:17:23.125301 [debug] [MainThread]: Flushing usage events
[0m18:17:23.746156 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:35.879123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ffb10>]}


============================== 18:17:35.881624 | 58a92eca-8b5b-465a-afc5-26972c6bfd7b ==============================
[0m18:17:35.881624 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:17:35.881917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run-operation create_role --args name: finance', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:17:35.883286 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m18:17:35.884519 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.03666246, "process_in_blocks": "0", "process_kernel_time": 0.072649, "process_mem_max_rss": "105807872", "process_out_blocks": "0", "process_user_time": 0.509332}
[0m18:17:35.884717 [debug] [MainThread]: Command `dbt run-operation` failed at 18:17:35.884675 after 0.04 seconds
[0m18:17:35.884847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071eb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107202c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719d9d0>]}
[0m18:17:35.884968 [debug] [MainThread]: Flushing usage events
[0m18:17:36.376194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:18:05.191206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f939d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f93b10>]}


============================== 18:18:05.193672 | 078b3c9c-2b13-4a13-ab03-0038b1a314ae ==============================
[0m18:18:05.193672 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:18:05.193939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run-operation create_role --args name: finance', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:18:05.195253 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m18:18:05.196495 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.03498475, "process_in_blocks": "0", "process_kernel_time": 0.075809, "process_mem_max_rss": "106987520", "process_out_blocks": "0", "process_user_time": 0.505045}
[0m18:18:05.196744 [debug] [MainThread]: Command `dbt run-operation` failed at 18:18:05.196699 after 0.04 seconds
[0m18:18:05.196904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e96c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e319d0>]}
[0m18:18:05.197039 [debug] [MainThread]: Flushing usage events
[0m18:18:05.688441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:18:23.439669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077af4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca7b10>]}


============================== 18:18:23.441483 | d9815d4b-8ddc-4e22-91e7-fb52cb75b955 ==============================
[0m18:18:23.441483 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:18:23.441760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -s finance', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:18:23.443050 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m18:18:23.443636 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.029714542, "process_in_blocks": "0", "process_kernel_time": 0.061394, "process_mem_max_rss": "105725952", "process_out_blocks": "0", "process_user_time": 0.514792}
[0m18:18:23.443823 [debug] [MainThread]: Command `dbt build` failed at 18:18:23.443785 after 0.03 seconds
[0m18:18:23.443952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b87490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba6c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3d9d0>]}
[0m18:18:23.444078 [debug] [MainThread]: Flushing usage events
[0m18:18:24.108795 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:18:37.720090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd27b10>]}


============================== 18:18:37.722665 | 4b5f5003-19e7-4554-b875-2229d79dfbdb ==============================
[0m18:18:37.722665 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:18:37.722929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:18:37.724458 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m18:18:37.725809 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.035256084, "process_in_blocks": "0", "process_kernel_time": 0.082149, "process_mem_max_rss": "108199936", "process_out_blocks": "0", "process_user_time": 0.522329}
[0m18:18:37.726039 [debug] [MainThread]: Command `cli build` failed at 18:18:37.725997 after 0.04 seconds
[0m18:18:37.726196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc0f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc22e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbc17b0>]}
[0m18:18:37.726359 [debug] [MainThread]: Flushing usage events
[0m18:18:38.230465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:21:17.389273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f274d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110627b10>]}


============================== 18:21:17.392246 | 5d9abc23-cd5f-4188-82cf-13a943bfab00 ==============================
[0m18:21:17.392246 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:21:17.393670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -s finance', 'send_anonymous_usage_stats': 'True'}
[0m18:21:17.463655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d9abc23-cd5f-4188-82cf-13a943bfab00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752f490>]}
[0m18:21:17.484656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d9abc23-cd5f-4188-82cf-13a943bfab00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103be030>]}
[0m18:21:17.485368 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:21:17.522540 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:21:17.572536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:21:17.572721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:21:17.594812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d9abc23-cd5f-4188-82cf-13a943bfab00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bff050>]}
[0m18:21:17.632047 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:21:17.633182 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:21:17.650105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d9abc23-cd5f-4188-82cf-13a943bfab00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fa1e50>]}
[0m18:21:17.650356 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 438 macros
[0m18:21:17.651222 [info ] [MainThread]: 
[0m18:21:17.651374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:21:17.651484 [info ] [MainThread]: 
[0m18:21:17.651689 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:21:17.652064 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m18:21:17.675226 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m18:21:17.675445 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m18:21:17.675575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:18.415684 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.740 seconds
[0m18:21:18.420318 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m18:21:18.428779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt_finance)
[0m18:21:18.435717 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt_finance"
[0m18:21:18.436384 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_dbt'
[0m18:21:18.436729 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: BEGIN
[0m18:21:18.438324 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m18:21:18.438632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:21:18.438889 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m18:21:18.439277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:19.061973 [debug] [ThreadPool]: SQL status: BEGIN in 0.622 seconds
[0m18:21:19.063511 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m18:21:19.064297 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m18:21:19.111904 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.047 seconds
[0m18:21:19.117845 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m18:21:19.161036 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m18:21:19.169610 [debug] [ThreadPool]: SQL status: BEGIN in 0.731 seconds
[0m18:21:19.170253 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt_finance"
[0m18:21:19.170844 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt_finance"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_finance'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_finance'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_finance'
  
[0m18:21:19.217759 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.046 seconds
[0m18:21:19.220779 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: ROLLBACK
[0m18:21:19.263658 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: Close
[0m18:21:19.274726 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:19.275409 [debug] [MainThread]: On master: BEGIN
[0m18:21:19.275718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:21:19.901398 [debug] [MainThread]: SQL status: BEGIN in 0.625 seconds
[0m18:21:19.902202 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:19.902792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:21:20.145065 [debug] [MainThread]: SQL status: SELECT 4 in 0.241 seconds
[0m18:21:20.148857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d9abc23-cd5f-4188-82cf-13a943bfab00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f70c90>]}
[0m18:21:20.149881 [debug] [MainThread]: On master: ROLLBACK
[0m18:21:20.194770 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:20.195824 [debug] [MainThread]: On master: BEGIN
[0m18:21:20.286778 [debug] [MainThread]: SQL status: BEGIN in 0.090 seconds
[0m18:21:20.287680 [debug] [MainThread]: On master: COMMIT
[0m18:21:20.288293 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:20.288799 [debug] [MainThread]: On master: COMMIT
[0m18:21:20.332895 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m18:21:20.334374 [debug] [MainThread]: On master: Close
[0m18:21:20.342408 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m18:21:20.343383 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_finance.revenue_daily ................... [RUN]
[0m18:21:20.344219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt_finance, now model.dbt_scooters.revenue_daily)
[0m18:21:20.344745 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m18:21:20.363428 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m18:21:20.364417 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m18:21:20.428475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:21:20.428733 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp182120383690"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt_finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m18:21:20.428884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:21.242150 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.813 seconds
[0m18:21:21.263585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:21:21.264159 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m18:21:21.307863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m18:21:21.308250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:21:21.308508 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp182120383690'
        
      order by ordinal_position

  
[0m18:21:21.360646 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.052 seconds
[0m18:21:21.365366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:21:21.365735 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt_finance'
        
      order by ordinal_position

  
[0m18:21:21.443547 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.077 seconds
[0m18:21:21.458634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:21:21.458984 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp182120383690'
        
      order by ordinal_position

  
[0m18:21:21.518231 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.059 seconds
[0m18:21:21.523427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:21:21.524227 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt_finance'
        
      order by ordinal_position

  
[0m18:21:21.574924 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.050 seconds
[0m18:21:21.588901 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt_finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:21:21.602089 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m18:21:21.602899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:21:21.603180 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt_finance"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp182120383690" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt_finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp182120383690"
    )
  
[0m18:21:21.652448 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.049 seconds
[0m18:21:21.663167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:21:21.663464 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_ohwk".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'dbt_finance'
        and table_name = 'revenue_daily'
  
[0m18:21:21.717167 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.053 seconds
[0m18:21:21.731587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:21:21.731922 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

        
            grant select on "dev_ohwk"."dbt_finance"."revenue_daily" to finance;
        
    
[0m18:21:21.776073 [debug] [Thread-1 (]: SQL status: GRANT in 0.044 seconds
[0m18:21:21.783271 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:21:21.783718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:21:21.784030 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:21:21.829465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.045 seconds
[0m18:21:21.832887 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m18:21:21.836271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d9abc23-cd5f-4188-82cf-13a943bfab00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11272be10>]}
[0m18:21:21.837004 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt_finance.revenue_daily .............. [[32mINSERT 0 3[0m in 1.49s]
[0m18:21:21.837590 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m18:21:21.838797 [info ] [MainThread]: 
[0m18:21:21.839142 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:21.839397 [debug] [MainThread]: On master: BEGIN
[0m18:21:21.839628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:21:22.638884 [debug] [MainThread]: SQL status: BEGIN in 0.799 seconds
[0m18:21:22.640420 [debug] [MainThread]: On master: COMMIT
[0m18:21:22.641678 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:22.642641 [debug] [MainThread]: On master: COMMIT
[0m18:21:22.687360 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m18:21:22.692316 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m18:21:22.698894 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m18:21:22.699678 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:22.700077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema dbt_finance to finance;
[0m18:21:22.754328 [debug] [MainThread]: SQL status: GRANT in 0.054 seconds
[0m18:21:22.756892 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.07s]
[0m18:21:22.757457 [debug] [MainThread]: On master: Close
[0m18:21:22.758373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:21:22.758641 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m18:21:22.758870 [debug] [MainThread]: Connection 'list_dev_ohwk_dbt' was properly closed.
[0m18:21:22.759143 [info ] [MainThread]: 
[0m18:21:22.759432 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m18:21:22.760159 [debug] [MainThread]: Command end result
[0m18:21:22.781290 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:21:22.782635 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:21:22.786271 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m18:21:22.786464 [info ] [MainThread]: 
[0m18:21:22.786680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:21:22.786833 [info ] [MainThread]: 
[0m18:21:22.787006 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:21:22.788216 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.4276447, "process_in_blocks": "0", "process_kernel_time": 0.160594, "process_mem_max_rss": "139870208", "process_out_blocks": "0", "process_user_time": 1.090418}
[0m18:21:22.788441 [debug] [MainThread]: Command `dbt build` succeeded at 18:21:22.788397 after 5.43 seconds
[0m18:21:22.788626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11050cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112019bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11201a4c0>]}
[0m18:21:22.788801 [debug] [MainThread]: Flushing usage events
[0m18:21:23.431390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:21:45.701428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080db4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095cb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095cbb10>]}


============================== 18:21:45.703164 | d8129b1d-9395-454f-b902-b885c2af8e8e ==============================
[0m18:21:45.703164 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:21:45.703443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run-operation create_role --args name: finance', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:21:45.768247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8129b1d-9395-454f-b902-b885c2af8e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d7490>]}
[0m18:21:45.789800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8129b1d-9395-454f-b902-b885c2af8e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946a030>]}
[0m18:21:45.790144 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:21:45.823512 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:21:45.873127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:21:45.873311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:21:45.895339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8129b1d-9395-454f-b902-b885c2af8e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a254750>]}
[0m18:21:45.932658 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:21:45.933499 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:21:45.938683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8129b1d-9395-454f-b902-b885c2af8e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3416d0>]}
[0m18:21:45.938881 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 438 macros
[0m18:21:45.939025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8129b1d-9395-454f-b902-b885c2af8e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aff150>]}
[0m18:21:45.939256 [debug] [MainThread]: Acquiring new postgres connection 'macro_create_role'
[0m18:21:45.939386 [debug] [MainThread]: Using postgres connection "macro_create_role"
[0m18:21:45.939490 [debug] [MainThread]: On macro_create_role: BEGIN
[0m18:21:45.939586 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:21:46.554185 [debug] [MainThread]: SQL status: BEGIN in 0.614 seconds
[0m18:21:46.555837 [debug] [MainThread]: On macro_create_role: COMMIT
[0m18:21:46.556889 [debug] [MainThread]: Using postgres connection "macro_create_role"
[0m18:21:46.557526 [debug] [MainThread]: On macro_create_role: COMMIT
[0m18:21:46.600794 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m18:21:46.610218 [info ] [MainThread]: Creating role: finance
[0m18:21:46.642473 [debug] [MainThread]: Using postgres connection "macro_create_role"
[0m18:21:46.642765 [debug] [MainThread]: On macro_create_role: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "macro_create_role"} */

    
        create role finance nologin;
    
  
[0m18:21:46.685524 [debug] [MainThread]: Postgres adapter: Postgres error: role "finance" already exists

[0m18:21:46.685872 [debug] [MainThread]: Postgres adapter: Error running SQL: macro create_role
[0m18:21:46.686085 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m18:21:46.686304 [debug] [MainThread]: On macro_create_role: Close
[0m18:21:46.686765 [error] [MainThread]: Encountered an error while running operation: Database Error
  role "finance" already exists
[0m18:21:46.693970 [debug] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/postgres/connections.py", line 76, in exception_handler
    yield
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 148, in add_query
    _execute_query_with_retry(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        cursor=cursor,
        ^^^^^^^^^^^^^^
    ...<4 lines>...
        attempt=1,
        ^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 97, in _execute_query_with_retry
    cursor.execute(sql, bindings)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
psycopg2.errors.DuplicateObject: role "finance" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 64, in run
    self._run_unsafe(package_name, macro_name)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/task/run_operation.py", line 45, in _run_unsafe
    res = adapter.execute_macro(
        macro_name, project=package_name, kwargs=macro_kwargs, macro_resolver=self.manifest
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1287, in execute_macro
    result = macro_function(**kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 427, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 38, in macro
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt_common/record.py", line 507, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 449, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 219, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 131, in add_query
    with self.exception_handler(sql):
         ~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/adapters/postgres/connections.py", line 87, in exception_handler
    raise DbtDatabaseError(str(e).strip()) from e
dbt_common.exceptions.base.DbtDatabaseError: Database Error
  role "finance" already exists

[0m18:21:46.698895 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m18:21:46.700147 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 1.024344, "process_in_blocks": "0", "process_kernel_time": 0.108572, "process_mem_max_rss": "134496256", "process_out_blocks": "0", "process_user_time": 0.763496}
[0m18:21:46.700463 [debug] [MainThread]: Command `dbt run-operation` failed at 18:21:46.700400 after 1.02 seconds
[0m18:21:46.700665 [debug] [MainThread]: Connection 'macro_create_role' was properly closed.
[0m18:21:46.700862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a47ae10>]}
[0m18:21:46.701067 [debug] [MainThread]: Flushing usage events
[0m18:21:47.203103 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:22:09.630566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058234d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107327b10>]}


============================== 18:22:09.632643 | 731a284e-40fd-4007-b961-9541b0312afa ==============================
[0m18:22:09.632643 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:22:09.632898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m18:22:09.696197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '731a284e-40fd-4007-b961-9541b0312afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106233490>]}
[0m18:22:09.717371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '731a284e-40fd-4007-b961-9541b0312afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c2e00>]}
[0m18:22:09.717805 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:22:09.753553 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:22:09.799032 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:22:09.799309 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m18:22:09.799488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '731a284e-40fd-4007-b961-9541b0312afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180ec450>]}
[0m18:22:10.335831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '731a284e-40fd-4007-b961-9541b0312afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118323110>]}
[0m18:22:10.371731 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:22:10.372820 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:22:10.388691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '731a284e-40fd-4007-b961-9541b0312afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187af770>]}
[0m18:22:10.388914 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 438 macros
[0m18:22:10.389733 [info ] [MainThread]: 
[0m18:22:10.389872 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:22:10.390082 [info ] [MainThread]: 
[0m18:22:10.390425 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:22:10.390788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m18:22:10.412194 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m18:22:10.412378 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m18:22:10.412486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:11.178135 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.765 seconds
[0m18:22:11.182188 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m18:22:11.191637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt_finance)
[0m18:22:11.192696 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_dbt'
[0m18:22:11.200792 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt_finance"
[0m18:22:11.202641 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m18:22:11.202982 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: BEGIN
[0m18:22:11.203237 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m18:22:11.203469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:22:11.203685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:11.863396 [debug] [ThreadPool]: SQL status: BEGIN in 0.660 seconds
[0m18:22:11.864008 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m18:22:11.864378 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m18:22:11.922341 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.057 seconds
[0m18:22:11.926431 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m18:22:11.974951 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m18:22:12.706038 [debug] [ThreadPool]: SQL status: BEGIN in 1.502 seconds
[0m18:22:12.707643 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt_finance"
[0m18:22:12.708400 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt_finance"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_finance'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_finance'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_finance'
  
[0m18:22:12.777308 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.068 seconds
[0m18:22:12.780489 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: ROLLBACK
[0m18:22:12.824800 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: Close
[0m18:22:12.835448 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:12.836180 [debug] [MainThread]: On master: BEGIN
[0m18:22:12.836546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:22:13.852072 [debug] [MainThread]: SQL status: BEGIN in 1.015 seconds
[0m18:22:13.853229 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:13.854035 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:22:14.042857 [debug] [MainThread]: SQL status: SELECT 4 in 0.188 seconds
[0m18:22:14.044951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '731a284e-40fd-4007-b961-9541b0312afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a90870>]}
[0m18:22:14.045592 [debug] [MainThread]: On master: ROLLBACK
[0m18:22:14.090131 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:14.091247 [debug] [MainThread]: On master: BEGIN
[0m18:22:14.184335 [debug] [MainThread]: SQL status: BEGIN in 0.092 seconds
[0m18:22:14.185455 [debug] [MainThread]: On master: COMMIT
[0m18:22:14.186141 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:14.186727 [debug] [MainThread]: On master: COMMIT
[0m18:22:14.231749 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m18:22:14.232889 [debug] [MainThread]: On master: Close
[0m18:22:14.241302 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies_trips
[0m18:22:14.242423 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.companies_trips ............................... [RUN]
[0m18:22:14.243759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt_finance, now model.dbt_scooters.companies_trips)
[0m18:22:14.244282 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies_trips
[0m18:22:14.253111 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m18:22:14.254621 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies_trips
[0m18:22:14.280730 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m18:22:14.281311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:22:14.281501 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m18:22:14.281659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:15.760107 [debug] [Thread-1 (]: SQL status: BEGIN in 1.478 seconds
[0m18:22:15.761367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:22:15.762112 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
  
[0m18:22:16.365398 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.602 seconds
[0m18:22:16.383549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:22:16.384088 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m18:22:16.427266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m18:22:16.431697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:22:16.432115 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m18:22:16.480354 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.048 seconds
[0m18:22:16.496444 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:22:16.496851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:22:16.497101 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:22:16.544813 [debug] [Thread-1 (]: SQL status: COMMIT in 0.047 seconds
[0m18:22:16.551729 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m18:22:16.555864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:22:16.556174 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m18:22:16.603427 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.047 seconds
[0m18:22:16.605753 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: Close
[0m18:22:16.608140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '731a284e-40fd-4007-b961-9541b0312afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118786ed0>]}
[0m18:22:16.608652 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.companies_trips .......................... [[32mSELECT 6[0m in 2.36s]
[0m18:22:16.609031 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies_trips
[0m18:22:16.610154 [info ] [MainThread]: 
[0m18:22:16.610485 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:16.610743 [debug] [MainThread]: On master: BEGIN
[0m18:22:16.610929 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:22:17.275727 [debug] [MainThread]: SQL status: BEGIN in 0.665 seconds
[0m18:22:17.276779 [debug] [MainThread]: On master: COMMIT
[0m18:22:17.277366 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:17.277754 [debug] [MainThread]: On master: COMMIT
[0m18:22:17.322560 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m18:22:17.326224 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m18:22:17.333380 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m18:22:17.334117 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:17.334496 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema dbt_finance to finance;
[0m18:22:17.379510 [debug] [MainThread]: SQL status: GRANT in 0.045 seconds
[0m18:22:17.380792 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.06s]
[0m18:22:17.381215 [debug] [MainThread]: On master: Close
[0m18:22:17.382242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:22:17.382644 [debug] [MainThread]: Connection 'model.dbt_scooters.companies_trips' was properly closed.
[0m18:22:17.382918 [debug] [MainThread]: Connection 'list_dev_ohwk_dbt' was properly closed.
[0m18:22:17.383222 [info ] [MainThread]: 
[0m18:22:17.383540 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 6.99 seconds (6.99s).
[0m18:22:17.384542 [debug] [MainThread]: Command end result
[0m18:22:17.407235 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:22:17.408501 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:22:17.412014 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m18:22:17.412179 [info ] [MainThread]: 
[0m18:22:17.412388 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:22:17.412537 [info ] [MainThread]: 
[0m18:22:17.412771 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:22:17.414102 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.8089986, "process_in_blocks": "0", "process_kernel_time": 0.146479, "process_mem_max_rss": "148897792", "process_out_blocks": "0", "process_user_time": 1.474059}
[0m18:22:17.414343 [debug] [MainThread]: Command `cli build` succeeded at 18:22:17.414293 after 7.81 seconds
[0m18:22:17.414536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187e5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c4bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c485f0>]}
[0m18:22:17.414717 [debug] [MainThread]: Flushing usage events
[0m18:22:18.006172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:22:23.804757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088234d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a327b10>]}


============================== 18:22:23.806735 | eb9b2a9b-a1d5-4635-967e-3d3a99f14737 ==============================
[0m18:22:23.806735 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:22:23.807031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:22:23.873346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922b490>]}
[0m18:22:23.894749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0c2e00>]}
[0m18:22:23.895221 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:22:23.931823 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:22:23.983224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:22:23.983433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:22:24.006543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0ff150>]}
[0m18:22:24.044962 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:22:24.045946 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:22:24.057100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b397e30>]}
[0m18:22:24.057345 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 438 macros
[0m18:22:24.058686 [info ] [MainThread]: 
[0m18:22:24.058843 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:22:24.059065 [info ] [MainThread]: 
[0m18:22:24.059357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:22:24.061274 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m18:22:24.065962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m18:22:24.079907 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m18:22:24.080111 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m18:22:24.080249 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m18:22:24.080376 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m18:22:24.080484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:24.080576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:24.734993 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.654 seconds
[0m18:22:24.736033 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m18:22:25.585495 [debug] [ThreadPool]: SQL status: SELECT 23 in 1.505 seconds
[0m18:22:25.588630 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m18:22:25.593999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt_finance)
[0m18:22:25.601251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m18:22:25.603099 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt_finance"
[0m18:22:25.604945 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m18:22:25.605284 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: BEGIN
[0m18:22:25.605528 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m18:22:25.605775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:22:25.605995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:22:27.153421 [debug] [ThreadPool]: SQL status: BEGIN in 1.547 seconds
[0m18:22:27.154524 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m18:22:27.155100 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m18:22:27.170079 [debug] [ThreadPool]: SQL status: BEGIN in 1.564 seconds
[0m18:22:27.170960 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt_finance"
[0m18:22:27.171517 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt_finance"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_finance'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_finance'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_finance'
  
[0m18:22:27.203562 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.048 seconds
[0m18:22:27.206737 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m18:22:27.222548 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.050 seconds
[0m18:22:27.225576 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: ROLLBACK
[0m18:22:27.252959 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m18:22:27.270406 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: Close
[0m18:22:27.288285 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:27.288891 [debug] [MainThread]: On master: BEGIN
[0m18:22:27.289183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:22:27.986843 [debug] [MainThread]: SQL status: BEGIN in 0.697 seconds
[0m18:22:27.988038 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:27.989032 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:22:28.245604 [debug] [MainThread]: SQL status: SELECT 4 in 0.256 seconds
[0m18:22:28.249264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b35f770>]}
[0m18:22:28.250274 [debug] [MainThread]: On master: ROLLBACK
[0m18:22:28.294438 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:28.295539 [debug] [MainThread]: On master: BEGIN
[0m18:22:28.392627 [debug] [MainThread]: SQL status: BEGIN in 0.096 seconds
[0m18:22:28.393793 [debug] [MainThread]: On master: COMMIT
[0m18:22:28.394463 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:28.394993 [debug] [MainThread]: On master: COMMIT
[0m18:22:28.439559 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m18:22:28.441242 [debug] [MainThread]: On master: Close
[0m18:22:28.448575 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m18:22:28.449473 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m18:22:28.450313 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m18:22:28.450955 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m18:22:28.451727 [info ] [Thread-3 (]: 3 of 20 START sql table model dbt.trips_geom ................................... [RUN]
[0m18:22:28.452539 [info ] [Thread-4 (]: 4 of 20 START sql view model dbt.trips_prep .................................... [RUN]
[0m18:22:28.453306 [info ] [Thread-1 (]: 1 of 20 START sql incremental model dbt.events_clean ........................... [RUN]
[0m18:22:28.454490 [info ] [Thread-2 (]: 2 of 20 START sql table model dbt.trips_concurrency ............................ [RUN]
[0m18:22:28.455540 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m18:22:28.456163 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_prep'
[0m18:22:28.456669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt_finance, now model.dbt_scooters.events_clean)
[0m18:22:28.457112 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.trips_concurrency)
[0m18:22:28.457543 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m18:22:28.457914 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m18:22:28.458368 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m18:22:28.459031 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m18:22:28.466979 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m18:22:28.506401 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m18:22:28.510965 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m18:22:28.512862 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m18:22:28.513366 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m18:22:28.528267 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m18:22:28.528596 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m18:22:28.528764 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m18:22:28.528890 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m18:22:28.537483 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m18:22:28.549016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:22:28.550335 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m18:22:28.550524 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:22:28.550717 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp182228546846"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_ohwk"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_ohwk"."dbt"."events_clean")
    

  );
  
  
[0m18:22:28.550929 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m18:22:28.551069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:28.551190 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:22:28.551494 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:22:28.551642 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m18:22:28.551763 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:22:28.552003 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:22:28.552166 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m18:22:28.552299 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:22:29.207566 [debug] [Thread-2 (]: SQL status: BEGIN in 0.655 seconds
[0m18:22:29.210458 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:22:29.211464 [debug] [Thread-4 (]: SQL status: BEGIN in 0.660 seconds
[0m18:22:29.212252 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_ohwk"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
[0m18:22:29.213041 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:22:29.213906 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_ohwk"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,

    date(started_at at time zone 'Europe/Moscow')
 as "date" 
from
"dev_ohwk"."scooters_raw"."trips"
  );
[0m18:22:29.541246 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.326 seconds
[0m18:22:29.553141 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:22:29.553773 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m18:22:29.638911 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.084 seconds
[0m18:22:29.645618 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:22:29.646587 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_ohwk"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m18:22:29.739335 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m18:22:29.764217 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m18:22:29.764741 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:22:29.765052 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m18:22:29.846643 [debug] [Thread-4 (]: SQL status: COMMIT in 0.081 seconds
[0m18:22:29.853326 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_prep__dbt_backup"
[0m18:22:29.857672 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:22:29.858034 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_ohwk"."dbt"."trips_prep__dbt_backup" cascade
[0m18:22:29.967357 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.109 seconds
[0m18:22:29.972189 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m18:22:29.974778 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8568f0>]}
[0m18:22:29.975556 [info ] [Thread-4 (]: 4 of 20 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 1.52s]
[0m18:22:29.976103 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m18:22:29.976450 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m18:22:29.976985 [info ] [Thread-4 (]: 5 of 20 START sql table model dbt.trips_stat_daily ............................. [RUN]
[0m18:22:29.977519 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.trips_stat_daily)
[0m18:22:29.977861 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m18:22:29.979475 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m18:22:29.980730 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m18:22:29.983897 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m18:22:29.984532 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:22:29.984781 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m18:22:29.985011 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:22:30.543096 [debug] [Thread-3 (]: SQL status: BEGIN in 1.990 seconds
[0m18:22:30.544414 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:22:30.545191 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_geom__dbt_tmp"
  
  
    as
  
  (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_ohwk"."scooters_raw"."trips"
  );
  
[0m18:22:31.161675 [debug] [Thread-1 (]: SQL status: SELECT 0 in 2.610 seconds
[0m18:22:31.182491 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:22:31.183039 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m18:22:31.242141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m18:22:31.243049 [debug] [Thread-4 (]: SQL status: BEGIN in 1.258 seconds
[0m18:22:31.243617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:22:31.244188 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:22:31.244687 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp182228546846'
        
      order by ordinal_position

  
[0m18:22:31.245153 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
  
[0m18:22:31.544250 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.298 seconds
[0m18:22:31.557050 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:22:31.558032 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:22:31.741703 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.183 seconds
[0m18:22:31.753898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:22:31.754284 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp182228546846'
        
      order by ordinal_position

  
[0m18:22:32.045089 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.290 seconds
[0m18:22:32.051683 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:22:32.052322 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:22:32.241471 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.188 seconds
[0m18:22:32.257966 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:22:32.271561 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m18:22:32.272470 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:22:32.272743 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        delete from "dev_ohwk"."dbt"."events_clean" as DBT_INTERNAL_DEST
        where (user_id, timestamp, type_id) in (
            select distinct user_id, timestamp, type_id
            from "events_clean__dbt_tmp182228546846" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp182228546846"
    )
  
[0m18:22:32.338875 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.066 seconds
[0m18:22:32.340728 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m18:22:32.341178 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:22:32.341522 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m18:22:32.443286 [debug] [Thread-1 (]: SQL status: COMMIT in 0.101 seconds
[0m18:22:32.445278 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m18:22:32.447110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3da210>]}
[0m18:22:32.448353 [info ] [Thread-1 (]: 1 of 20 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 3.99s]
[0m18:22:32.450394 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m18:22:32.451072 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.age_groups
[0m18:22:32.451981 [info ] [Thread-1 (]: 6 of 20 START seed file dbt.age_groups ......................................... [RUN]
[0m18:22:32.452773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now seed.dbt_scooters.age_groups)
[0m18:22:32.453390 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.age_groups
[0m18:22:32.453911 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.age_groups
[0m18:22:32.478245 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:22:32.478544 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m18:22:32.478760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:32.541676 [debug] [Thread-2 (]: SQL status: SELECT 10 in 3.328 seconds
[0m18:22:32.547996 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:22:32.548498 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m18:22:32.639707 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m18:22:32.647759 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:22:32.648522 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_ohwk"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m18:22:32.741184 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m18:22:32.744533 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m18:22:32.745230 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:22:32.745801 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m18:22:32.938770 [debug] [Thread-2 (]: SQL status: COMMIT in 0.192 seconds
[0m18:22:32.944022 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_concurrency__dbt_backup"
[0m18:22:32.949693 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:22:32.950444 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_ohwk"."dbt"."trips_concurrency__dbt_backup" cascade
[0m18:22:33.141049 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.189 seconds
[0m18:22:33.144834 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m18:22:33.146911 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b40e620>]}
[0m18:22:33.148009 [info ] [Thread-2 (]: 2 of 20 OK created sql table model dbt.trips_concurrency ....................... [[32mSELECT 10[0m in 4.69s]
[0m18:22:33.149166 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m18:22:33.150070 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.event_types
[0m18:22:33.150823 [info ] [Thread-2 (]: 7 of 20 START seed file dbt.event_types ........................................ [RUN]
[0m18:22:33.151669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now seed.dbt_scooters.event_types)
[0m18:22:33.152248 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.event_types
[0m18:22:33.152680 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.event_types
[0m18:22:33.159704 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:22:33.160114 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: BEGIN
[0m18:22:33.160384 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:22:33.539462 [debug] [Thread-1 (]: SQL status: BEGIN in 1.060 seconds
[0m18:22:33.540196 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:22:33.540567 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_ohwk"."dbt"."age_groups"
[0m18:22:33.742373 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.201 seconds
[0m18:22:33.761739 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:22:33.762286 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_ohwk"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m18:22:33.840656 [debug] [Thread-1 (]: SQL status: INSERT 0 8 in 0.078 seconds
[0m18:22:33.849346 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m18:22:33.850499 [debug] [Thread-4 (]: SQL status: SELECT 91 in 2.605 seconds
[0m18:22:33.856959 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:22:33.857307 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m18:22:33.858436 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m18:22:33.858739 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:22:33.858989 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m18:22:33.902288 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m18:22:33.905213 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:22:33.905597 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_ohwk"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m18:22:33.944917 [debug] [Thread-1 (]: SQL status: COMMIT in 0.085 seconds
[0m18:22:33.945994 [debug] [Thread-1 (]: On seed.dbt_scooters.age_groups: Close
[0m18:22:33.946928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8fcc30>]}
[0m18:22:33.947560 [info ] [Thread-1 (]: 6 of 20 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 1.49s]
[0m18:22:33.948274 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.age_groups
[0m18:22:33.948751 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.scooters
[0m18:22:33.949460 [info ] [Thread-1 (]: 8 of 20 START seed file dbt.scooters ........................................... [RUN]
[0m18:22:33.949902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now seed.dbt_scooters.scooters)
[0m18:22:33.950539 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.scooters
[0m18:22:33.951034 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.scooters
[0m18:22:33.957909 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:22:33.958321 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: BEGIN
[0m18:22:33.959563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:34.040291 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.134 seconds
[0m18:22:34.042016 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m18:22:34.042497 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:22:34.042846 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m18:22:34.145946 [debug] [Thread-4 (]: SQL status: COMMIT in 0.102 seconds
[0m18:22:34.151287 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup"
[0m18:22:34.152647 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:22:34.153398 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop view if exists "dev_ohwk"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m18:22:34.238657 [debug] [Thread-2 (]: SQL status: BEGIN in 1.078 seconds
[0m18:22:34.240114 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:22:34.241086 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_ohwk"."dbt"."event_types"
[0m18:22:34.247114 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.093 seconds
[0m18:22:34.250057 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m18:22:34.251709 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7363d0>]}
[0m18:22:34.252931 [info ] [Thread-4 (]: 5 of 20 OK created sql table model dbt.trips_stat_daily ........................ [[32mSELECT 91[0m in 4.27s]
[0m18:22:34.253908 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m18:22:34.254867 [debug] [Thread-4 (]: Began running node model.dbt_scooters.revenue_daily
[0m18:22:34.255858 [info ] [Thread-4 (]: 9 of 20 START sql incremental model dbt_finance.revenue_daily .................. [RUN]
[0m18:22:34.256743 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.revenue_daily)
[0m18:22:34.257249 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m18:22:34.263624 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m18:22:34.264531 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.revenue_daily
[0m18:22:34.268128 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:22:34.268563 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp182234266710"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt_finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m18:22:34.268864 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:22:34.348356 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.106 seconds
[0m18:22:34.354100 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:22:34.354752 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_ohwk"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m18:22:34.401682 [debug] [Thread-2 (]: SQL status: INSERT 0 4 in 0.046 seconds
[0m18:22:34.403454 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m18:22:34.407849 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: COMMIT
[0m18:22:34.408536 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:22:34.409189 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: COMMIT
[0m18:22:34.550515 [debug] [Thread-2 (]: SQL status: COMMIT in 0.140 seconds
[0m18:22:34.552992 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: Close
[0m18:22:34.553767 [debug] [Thread-3 (]: SQL status: SELECT 105901 in 4.008 seconds
[0m18:22:34.560824 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b743a10>]}
[0m18:22:34.561524 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:22:34.562662 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m18:22:34.562296 [info ] [Thread-2 (]: 7 of 20 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 1.41s]
[0m18:22:34.563544 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.event_types
[0m18:22:34.564068 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m18:22:34.564733 [info ] [Thread-2 (]: 10 of 20 START sql table model dbt.trips_stat .................................. [RUN]
[0m18:22:34.565496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now model.dbt_scooters.trips_stat)
[0m18:22:34.565956 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m18:22:34.569154 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m18:22:34.570135 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m18:22:34.573813 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m18:22:34.574465 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:22:34.574765 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m18:22:34.575031 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:22:34.612018 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.049 seconds
[0m18:22:34.615095 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:22:34.615465 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_ohwk"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m18:22:34.662341 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m18:22:34.665043 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m18:22:34.665632 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:22:34.666143 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m18:22:34.711783 [debug] [Thread-3 (]: SQL status: COMMIT in 0.045 seconds
[0m18:22:34.717817 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_geom__dbt_backup"
[0m18:22:34.718786 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:22:34.719265 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop view if exists "dev_ohwk"."dbt"."trips_geom__dbt_backup" cascade
[0m18:22:34.766002 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.046 seconds
[0m18:22:34.769293 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m18:22:34.771123 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70ecf0>]}
[0m18:22:34.772244 [info ] [Thread-3 (]: 3 of 20 OK created sql table model dbt.trips_geom .............................. [[32mSELECT 105901[0m in 6.32s]
[0m18:22:34.773004 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m18:22:34.773534 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_users
[0m18:22:34.774213 [info ] [Thread-3 (]: 11 of 20 START sql incremental model dbt.trips_users ........................... [RUN]
[0m18:22:34.775254 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.trips_users)
[0m18:22:34.775698 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_users
[0m18:22:34.780939 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m18:22:34.783419 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_users
[0m18:22:34.787038 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:22:34.787442 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp182234785539"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep" as t
left join
    "dev_ohwk"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_ohwk"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m18:22:34.787771 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:22:35.281878 [debug] [Thread-2 (]: SQL status: BEGIN in 0.706 seconds
[0m18:22:35.283155 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:22:35.283875 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_ohwk"."dbt"."trips_prep"
  );
  
[0m18:22:35.541024 [debug] [Thread-1 (]: SQL status: BEGIN in 1.581 seconds
[0m18:22:35.541641 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:22:35.542024 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_ohwk"."dbt"."scooters"
[0m18:22:35.746132 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.203 seconds
[0m18:22:35.754689 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:22:35.755580 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_ohwk"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m18:22:35.839675 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.083 seconds
[0m18:22:35.841340 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m18:22:35.846055 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m18:22:35.846597 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:22:35.846981 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: COMMIT
[0m18:22:35.942913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.095 seconds
[0m18:22:35.944731 [debug] [Thread-1 (]: On seed.dbt_scooters.scooters: Close
[0m18:22:35.946507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a86e390>]}
[0m18:22:35.947528 [info ] [Thread-1 (]: 8 of 20 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 2.00s]
[0m18:22:35.948487 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.scooters
[0m18:22:35.949580 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_full
[0m18:22:35.950624 [info ] [Thread-1 (]: 12 of 20 START sql view model dbt.events_full .................................. [RUN]
[0m18:22:35.951750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now model.dbt_scooters.events_full)
[0m18:22:35.952264 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_full
[0m18:22:35.957521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m18:22:35.960802 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_full
[0m18:22:35.965238 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m18:22:35.966438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:22:35.966792 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: BEGIN
[0m18:22:35.967078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:37.042589 [debug] [Thread-3 (]: SQL status: SELECT 0 in 2.254 seconds
[0m18:22:37.050156 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:22:37.050977 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: BEGIN
[0m18:22:37.140221 [debug] [Thread-3 (]: SQL status: BEGIN in 0.089 seconds
[0m18:22:37.141227 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:22:37.141817 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp182234785539'
        
      order by ordinal_position

  
[0m18:22:37.542469 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.400 seconds
[0m18:22:37.547826 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:22:37.548582 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:22:37.645022 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.096 seconds
[0m18:22:37.651101 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:22:37.651882 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp182234785539'
        
      order by ordinal_position

  
[0m18:22:37.838705 [debug] [Thread-1 (]: SQL status: BEGIN in 1.871 seconds
[0m18:22:37.840056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:22:37.840848 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_ohwk"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_ohwk"."dbt"."events_clean"
    left join "dev_ohwk"."dbt"."event_types"
        using (type_id)
  );
[0m18:22:37.940601 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.288 seconds
[0m18:22:37.946171 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:22:37.947016 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.105 seconds
[0m18:22:37.947719 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:22:37.951981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:22:37.952596 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_ohwk"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m18:22:38.038579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.085 seconds
[0m18:22:38.041938 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:22:38.042468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:22:38.042793 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:22:38.142222 [debug] [Thread-1 (]: SQL status: COMMIT in 0.099 seconds
[0m18:22:38.146203 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."events_full__dbt_backup"
[0m18:22:38.148278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:22:38.148948 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_ohwk"."dbt"."events_full__dbt_backup" cascade
[0m18:22:38.152796 [debug] [Thread-4 (]: SQL status: SELECT 3 in 3.884 seconds
[0m18:22:38.156619 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:22:38.157042 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.205 seconds
[0m18:22:38.157403 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m18:22:38.160895 [debug] [Thread-3 (]: 
    In "dev_ohwk"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:22:38.167837 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m18:22:38.168871 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:22:38.169229 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_ohwk"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp182234785539"
    )


  
[0m18:22:38.239102 [debug] [Thread-4 (]: SQL status: BEGIN in 0.077 seconds
[0m18:22:38.239888 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.070 seconds
[0m18:22:38.240300 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.091 seconds
[0m18:22:38.240671 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:22:38.243141 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:22:38.245144 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: Close
[0m18:22:38.245658 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp182234266710'
        
      order by ordinal_position

  
[0m18:22:38.246087 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m18:22:38.247426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8b3a10>]}
[0m18:22:38.248511 [info ] [Thread-1 (]: 12 of 20 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 2.30s]
[0m18:22:38.249421 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_full
[0m18:22:38.250034 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m18:22:38.250676 [info ] [Thread-1 (]: 13 of 20 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m18:22:38.251526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.parking_finish_stat)
[0m18:22:38.251946 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m18:22:38.256240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m18:22:38.257036 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m18:22:38.260173 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m18:22:38.260756 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:22:38.261111 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m18:22:38.261727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:38.340503 [debug] [Thread-2 (]: SQL status: SELECT 1 in 3.056 seconds
[0m18:22:38.344462 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:22:38.344995 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m18:22:38.389682 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m18:22:38.398339 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:22:38.398920 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_ohwk"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m18:22:38.444528 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m18:22:38.446442 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m18:22:38.446930 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:22:38.447287 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m18:22:38.539371 [debug] [Thread-2 (]: SQL status: COMMIT in 0.091 seconds
[0m18:22:38.540714 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.294 seconds
[0m18:22:38.544411 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_stat__dbt_backup"
[0m18:22:38.549411 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:22:38.550193 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:22:38.550784 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt_finance'
        
      order by ordinal_position

  
[0m18:22:38.551361 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_stat__dbt_backup" cascade
[0m18:22:38.643041 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.091 seconds
[0m18:22:38.646187 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m18:22:38.647319 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70dd30>]}
[0m18:22:38.648230 [info ] [Thread-2 (]: 10 of 20 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 4.08s]
[0m18:22:38.649164 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m18:22:38.649846 [debug] [Thread-2 (]: Began running node model.dbt_scooters.parking_start_stat
[0m18:22:38.650669 [info ] [Thread-2 (]: 14 of 20 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m18:22:38.651481 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.parking_start_stat)
[0m18:22:38.652445 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m18:22:38.658223 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m18:22:38.659820 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m18:22:38.663777 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m18:22:38.665052 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:22:38.665405 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m18:22:38.665697 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:22:38.750053 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.198 seconds
[0m18:22:38.757283 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:22:38.757845 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp182234266710'
        
      order by ordinal_position

  
[0m18:22:38.847911 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.090 seconds
[0m18:22:38.851581 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:22:38.852065 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt_finance'
        
      order by ordinal_position

  
[0m18:22:38.949324 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.096 seconds
[0m18:22:38.953562 [debug] [Thread-4 (]: 
    In "dev_ohwk"."dbt_finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:22:38.955270 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m18:22:38.956977 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:22:38.957627 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt_finance"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp182234266710" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt_finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp182234266710"
    )
  
[0m18:22:39.038220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.776 seconds
[0m18:22:39.039649 [debug] [Thread-4 (]: SQL status: INSERT 0 3 in 0.081 seconds
[0m18:22:39.040603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:22:39.049256 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:22:39.049830 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_ohwk"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)
-- group by
--     1


select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:22:39.050401 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_ohwk".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'dbt_finance'
        and table_name = 'revenue_daily'
  
[0m18:22:39.239380 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.188 seconds
[0m18:22:39.243307 [debug] [Thread-4 (]: On "dev_ohwk"."dbt_finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m18:22:39.244684 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:22:39.245387 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:22:39.245983 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:22:39.439909 [debug] [Thread-4 (]: SQL status: COMMIT in 0.193 seconds
[0m18:22:39.443116 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: Close
[0m18:22:39.445247 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8b1790>]}
[0m18:22:39.446525 [info ] [Thread-4 (]: 9 of 20 OK created sql incremental model dbt_finance.revenue_daily ............. [[32mINSERT 0 3[0m in 5.19s]
[0m18:22:39.447546 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.revenue_daily
[0m18:22:39.448351 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies
[0m18:22:39.449232 [info ] [Thread-4 (]: 15 of 20 START sql table model dbt.companies ................................... [RUN]
[0m18:22:39.449898 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.companies)
[0m18:22:39.450403 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies
[0m18:22:39.456178 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m18:22:39.457728 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies
[0m18:22:39.461624 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m18:22:39.462559 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:22:39.463238 [debug] [Thread-4 (]: On model.dbt_scooters.companies: BEGIN
[0m18:22:39.463637 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:22:39.842149 [debug] [Thread-2 (]: SQL status: BEGIN in 1.176 seconds
[0m18:22:39.843464 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:22:39.844180 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_ohwk"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.start_point, 3857), hex.geom)
-- group by
--     1

select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_ohwk"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:22:40.538676 [debug] [Thread-4 (]: SQL status: BEGIN in 1.075 seconds
[0m18:22:40.539951 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:22:40.540746 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_ohwk"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_ohwk"."dbt"."scooters"
group by
    1
  );
  
[0m18:22:40.946502 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.405 seconds
[0m18:22:40.953443 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:22:40.954135 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies" rename to "companies__dbt_backup"
[0m18:22:41.042826 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m18:22:41.050311 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:22:41.050972 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_ohwk"."dbt"."companies__dbt_tmp" rename to "companies"
[0m18:22:41.386262 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.334 seconds
[0m18:22:41.389689 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m18:22:41.390523 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:22:41.391158 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m18:22:41.441227 [debug] [Thread-4 (]: SQL status: COMMIT in 0.049 seconds
[0m18:22:41.446368 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."companies__dbt_backup"
[0m18:22:41.447481 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:22:41.448123 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop view if exists "dev_ohwk"."dbt"."companies__dbt_backup" cascade
[0m18:22:41.545624 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.096 seconds
[0m18:22:41.550224 [debug] [Thread-4 (]: On model.dbt_scooters.companies: Close
[0m18:22:41.551941 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8b3e30>]}
[0m18:22:41.553040 [info ] [Thread-4 (]: 15 of 20 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 2.10s]
[0m18:22:41.553850 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies
[0m18:22:41.554585 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m18:22:41.555387 [info ] [Thread-4 (]: 16 of 20 START sql table model dbt.events_stat ................................. [RUN]
[0m18:22:41.556202 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.events_stat)
[0m18:22:41.556641 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m18:22:41.560491 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m18:22:41.563271 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m18:22:41.567210 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m18:22:41.567987 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:22:41.568304 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m18:22:41.568579 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:22:42.840664 [debug] [Thread-4 (]: SQL status: BEGIN in 1.272 seconds
[0m18:22:42.842169 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:22:42.842954 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_ohwk"."dbt"."events_full"
  );
  
[0m18:22:48.438091 [debug] [Thread-3 (]: SQL status: ANALYZE in 10.191 seconds
[0m18:22:48.442081 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m18:22:48.443079 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:22:48.443751 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m18:22:48.741873 [debug] [Thread-3 (]: SQL status: COMMIT in 0.297 seconds
[0m18:22:48.744188 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:22:48.745037 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m18:22:48.838744 [debug] [Thread-3 (]: SQL status: COMMIT in 0.093 seconds
[0m18:22:48.841089 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:22:48.841650 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m18:22:48.947058 [debug] [Thread-3 (]: SQL status: VACUUM in 0.104 seconds
[0m18:22:48.950954 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: Close
[0m18:22:48.952559 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8b3650>]}
[0m18:22:48.953837 [info ] [Thread-3 (]: 11 of 20 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 14.18s]
[0m18:22:48.955041 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_users
[0m18:22:48.955987 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies_trips
[0m18:22:48.956961 [info ] [Thread-3 (]: 17 of 20 START sql table model dbt.companies_trips ............................. [RUN]
[0m18:22:48.957973 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.companies_trips)
[0m18:22:48.958548 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies_trips
[0m18:22:48.963340 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m18:22:48.964566 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies_trips
[0m18:22:48.969770 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m18:22:48.971161 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:22:48.971569 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m18:22:48.971848 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:22:50.138719 [debug] [Thread-3 (]: SQL status: BEGIN in 1.166 seconds
[0m18:22:50.140452 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:22:50.141261 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_ohwk"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_ohwk"."dbt"."trips_prep" as t
        join "dev_ohwk"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_ohwk"."dbt"."companies" as c
        using (company)
  );
  
[0m18:22:52.142663 [debug] [Thread-4 (]: SQL status: SELECT 1 in 9.299 seconds
[0m18:22:52.149108 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:22:52.149738 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_ohwk"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m18:22:52.241956 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m18:22:52.245384 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m18:22:52.246224 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:22:52.247045 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m18:22:52.341232 [debug] [Thread-4 (]: SQL status: COMMIT in 0.093 seconds
[0m18:22:52.346702 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."events_stat__dbt_backup"
[0m18:22:52.347589 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:22:52.348021 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_ohwk"."dbt"."events_stat__dbt_backup" cascade
[0m18:22:52.443053 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.094 seconds
[0m18:22:52.445623 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m18:22:52.446847 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8315b0>]}
[0m18:22:52.447813 [info ] [Thread-4 (]: 16 of 20 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 10.89s]
[0m18:22:52.448760 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m18:22:52.449646 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_daily
[0m18:22:52.450797 [info ] [Thread-4 (]: 18 of 20 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m18:22:52.451640 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now model.dbt_scooters.trips_age_daily)
[0m18:22:52.452129 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m18:22:52.456524 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m18:22:52.457994 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m18:22:52.462259 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m18:22:52.463344 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:22:52.463692 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m18:22:52.464008 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:22:53.838925 [debug] [Thread-4 (]: SQL status: BEGIN in 1.374 seconds
[0m18:22:53.840524 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:22:53.841568 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m18:22:54.044369 [debug] [Thread-3 (]: SQL status: SELECT 6 in 3.902 seconds
[0m18:22:54.053001 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:22:54.053856 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m18:22:54.140136 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.085 seconds
[0m18:22:54.146824 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:22:54.147571 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_ohwk"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m18:22:54.242538 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:22:54.246127 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:22:54.246918 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:22:54.247706 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:22:54.352435 [debug] [Thread-3 (]: SQL status: COMMIT in 0.102 seconds
[0m18:22:54.359912 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."companies_trips__dbt_backup"
[0m18:22:54.361353 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:22:54.361934 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_ohwk"."dbt"."companies_trips__dbt_backup" cascade
[0m18:22:54.540006 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.177 seconds
[0m18:22:54.544038 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: Close
[0m18:22:54.545772 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70db50>]}
[0m18:22:54.547009 [info ] [Thread-3 (]: 17 of 20 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 5.59s]
[0m18:22:54.548202 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies_trips
[0m18:22:54.549249 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_group
[0m18:22:54.549965 [info ] [Thread-3 (]: 19 of 20 START sql table model dbt.trips_age_group ............................. [RUN]
[0m18:22:54.550578 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_group)
[0m18:22:54.551201 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m18:22:54.555556 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m18:22:54.556755 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_group
[0m18:22:54.560361 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m18:22:54.561129 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:22:54.561433 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m18:22:54.561861 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:22:55.739730 [debug] [Thread-3 (]: SQL status: BEGIN in 1.178 seconds
[0m18:22:55.740880 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:22:55.741587 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_ohwk"."dbt"."trips_users" as tu
    cross join "dev_ohwk"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m18:22:58.644062 [debug] [Thread-4 (]: SQL status: SELECT 7049 in 4.801 seconds
[0m18:22:58.652017 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:22:58.652724 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m18:22:58.738685 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.085 seconds
[0m18:22:58.745432 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:22:58.746168 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_ohwk"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m18:22:58.841848 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m18:22:58.845248 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m18:22:58.846193 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:22:58.846818 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m18:22:58.942943 [debug] [Thread-4 (]: SQL status: COMMIT in 0.095 seconds
[0m18:22:58.949252 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily__dbt_backup"
[0m18:22:58.950401 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:22:58.951322 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily__dbt_backup" cascade
[0m18:22:59.139976 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.188 seconds
[0m18:22:59.143497 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: Close
[0m18:22:59.145149 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70cfb0>]}
[0m18:22:59.146355 [info ] [Thread-4 (]: 18 of 20 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 6.69s]
[0m18:22:59.147476 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m18:22:59.148800 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m18:22:59.149525 [info ] [Thread-4 (]: 20 of 20 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m18:22:59.150443 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now model.dbt_scooters.trips_age_daily_stat)
[0m18:22:59.151273 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m18:22:59.155305 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m18:22:59.156565 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m18:22:59.160587 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m18:22:59.161699 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:22:59.162042 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m18:22:59.162327 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:23:00.641968 [debug] [Thread-4 (]: SQL status: BEGIN in 1.479 seconds
[0m18:23:00.643401 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:23:00.644510 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_ohwk"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m18:23:01.440435 [debug] [Thread-4 (]: SQL status: SELECT 83 in 0.795 seconds
[0m18:23:01.455679 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:23:01.456425 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m18:23:01.540750 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.083 seconds
[0m18:23:01.547202 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:23:01.548017 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m18:23:01.639189 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m18:23:01.642607 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m18:23:01.643403 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:23:01.644016 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m18:23:01.742059 [debug] [Thread-4 (]: SQL status: COMMIT in 0.097 seconds
[0m18:23:01.748581 [debug] [Thread-4 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup"
[0m18:23:01.749441 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:23:01.749853 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m18:23:01.955254 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.204 seconds
[0m18:23:01.959966 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m18:23:01.961462 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8300b0>]}
[0m18:23:01.962433 [info ] [Thread-4 (]: 20 of 20 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 2.81s]
[0m18:23:01.963497 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m18:23:17.411091 [debug] [Thread-1 (]: SQL status: SELECT 464 in 38.360 seconds
[0m18:23:17.417690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:23:17.418484 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m18:23:17.538633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.119 seconds
[0m18:23:17.544932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:23:17.545514 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_ohwk"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m18:23:17.638956 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m18:23:17.642884 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m18:23:17.643675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:23:17.644278 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m18:23:17.743095 [debug] [Thread-1 (]: SQL status: COMMIT in 0.098 seconds
[0m18:23:17.749002 [debug] [Thread-1 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup"
[0m18:23:17.750268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:23:17.751025 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_ohwk"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m18:23:17.843559 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.092 seconds
[0m18:23:17.847153 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m18:23:17.849072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70e3f0>]}
[0m18:23:17.850409 [info ] [Thread-1 (]: 13 of 20 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 39.60s]
[0m18:23:17.851644 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m18:23:22.850032 [debug] [Thread-3 (]: SQL status: SELECT 7 in 27.107 seconds
[0m18:23:22.857266 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:23:22.858078 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m18:23:22.939428 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.080 seconds
[0m18:23:22.946264 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:23:22.946984 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_ohwk"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m18:23:23.071500 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.124 seconds
[0m18:23:23.074655 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m18:23:23.075419 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:23:23.076022 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m18:23:23.146841 [debug] [Thread-3 (]: SQL status: COMMIT in 0.070 seconds
[0m18:23:23.153754 [debug] [Thread-3 (]: Applying DROP to: "dev_ohwk"."dbt"."trips_age_group__dbt_backup"
[0m18:23:23.155051 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:23:23.155704 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_ohwk"."dbt"."trips_age_group__dbt_backup" cascade
[0m18:23:23.391989 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.235 seconds
[0m18:23:23.395524 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: Close
[0m18:23:23.397430 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70daf0>]}
[0m18:23:23.398660 [info ] [Thread-3 (]: 19 of 20 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 28.85s]
[0m18:23:23.399620 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_group
[0m18:23:27.347599 [debug] [Thread-2 (]: SQL status: SELECT 142 in 47.502 seconds
[0m18:23:27.354638 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:23:27.355439 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m18:23:27.425003 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.068 seconds
[0m18:23:27.431231 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:23:27.431936 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_ohwk"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m18:23:27.477122 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m18:23:27.480434 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m18:23:27.481226 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:23:27.481861 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m18:23:27.532304 [debug] [Thread-2 (]: SQL status: COMMIT in 0.050 seconds
[0m18:23:27.538967 [debug] [Thread-2 (]: Applying DROP to: "dev_ohwk"."dbt"."parking_start_stat__dbt_backup"
[0m18:23:27.540095 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:23:27.540627 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_ohwk"."dbt"."parking_start_stat__dbt_backup" cascade
[0m18:23:27.590869 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.049 seconds
[0m18:23:27.594656 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: Close
[0m18:23:27.596638 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b2a9b-a1d5-4635-967e-3d3a99f14737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70dd30>]}
[0m18:23:27.597946 [info ] [Thread-2 (]: 14 of 20 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 48.95s]
[0m18:23:27.598943 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m18:23:27.601573 [info ] [MainThread]: 
[0m18:23:27.602147 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:27.602545 [debug] [MainThread]: On master: BEGIN
[0m18:23:27.602900 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:23:29.115861 [debug] [MainThread]: SQL status: BEGIN in 1.513 seconds
[0m18:23:29.117185 [debug] [MainThread]: On master: COMMIT
[0m18:23:29.117957 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:29.118577 [debug] [MainThread]: On master: COMMIT
[0m18:23:29.161674 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m18:23:29.166876 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m18:23:29.174455 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m18:23:29.175271 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:29.175761 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema dbt_finance to finance;
[0m18:23:29.220850 [debug] [MainThread]: SQL status: GRANT in 0.044 seconds
[0m18:23:29.222470 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.06s]
[0m18:23:29.222959 [debug] [MainThread]: On master: Close
[0m18:23:29.223784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:29.224068 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m18:23:29.224291 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m18:23:29.224484 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m18:23:29.224692 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m18:23:29.225081 [info ] [MainThread]: 
[0m18:23:29.225368 [info ] [MainThread]: Finished running 3 incremental models, 1 project hook, 3 seeds, 12 table models, 2 view models in 0 hours 1 minutes and 5.17 seconds (65.17s).
[0m18:23:29.228087 [debug] [MainThread]: Command end result
[0m18:23:29.248523 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:23:29.250270 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:23:29.254344 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m18:23:29.254534 [info ] [MainThread]: 
[0m18:23:29.254737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:23:29.254893 [info ] [MainThread]: 
[0m18:23:29.255100 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=21
[0m18:23:29.256423 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 65.48011, "process_in_blocks": "0", "process_kernel_time": 0.269996, "process_mem_max_rss": "141623296", "process_out_blocks": "0", "process_user_time": 2.123429}
[0m18:23:29.256661 [debug] [MainThread]: Command `cli build` succeeded at 18:23:29.256613 after 65.48 seconds
[0m18:23:29.256857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087dab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be795b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be78830>]}
[0m18:23:29.257035 [debug] [MainThread]: Flushing usage events
[0m18:23:30.052956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:03:35.691907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c774d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112727b10>]}


============================== 22:03:35.694753 | 7826c788-3341-4e2c-9b9a-e5a2a8be53db ==============================
[0m22:03:35.694753 [info ] [MainThread]: Running with dbt=1.10.6
[0m22:03:35.695040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -s finance', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:03:35.969429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7826c788-3341-4e2c-9b9a-e5a2a8be53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11172b490>]}
[0m22:03:35.991311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7826c788-3341-4e2c-9b9a-e5a2a8be53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124be030>]}
[0m22:03:35.991805 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:03:36.038581 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m22:03:36.100003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:03:36.100288 [debug] [MainThread]: Partial parsing: added file: dbt_scooters://macros/generate_schema_name.sql
[0m22:03:36.140481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7826c788-3341-4e2c-9b9a-e5a2a8be53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136a0650>]}
[0m22:03:36.180190 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:03:36.181268 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:03:36.198925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7826c788-3341-4e2c-9b9a-e5a2a8be53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113771e50>]}
[0m22:03:36.199143 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 438 macros
[0m22:03:36.199979 [info ] [MainThread]: 
[0m22:03:36.200127 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:03:36.200236 [info ] [MainThread]: 
[0m22:03:36.200436 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:03:36.200790 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m22:03:36.233999 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m22:03:36.234198 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m22:03:36.234313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:37.300643 [debug] [ThreadPool]: SQL status: SELECT 23 in 1.066 seconds
[0m22:03:37.302671 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m22:03:37.310234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now list_dev_ohwk_dbt)
[0m22:03:37.318193 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_dbt_finance'
[0m22:03:37.319016 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m22:03:37.320947 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt_finance"
[0m22:03:37.321342 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m22:03:37.321644 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: BEGIN
[0m22:03:37.321915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:37.322182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:38.134113 [debug] [ThreadPool]: SQL status: BEGIN in 0.812 seconds
[0m22:03:38.135614 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m22:03:38.136745 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m22:03:38.209998 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.072 seconds
[0m22:03:38.222739 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m22:03:38.292963 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m22:03:38.795074 [debug] [ThreadPool]: SQL status: BEGIN in 1.473 seconds
[0m22:03:38.796670 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt_finance"
[0m22:03:38.797850 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt_finance"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_finance'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_finance'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_finance'
  
[0m22:03:38.847052 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.048 seconds
[0m22:03:38.850453 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: ROLLBACK
[0m22:03:38.901016 [debug] [ThreadPool]: On list_dev_ohwk_dbt_finance: Close
[0m22:03:38.912637 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:38.913115 [debug] [MainThread]: On master: BEGIN
[0m22:03:38.913473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:40.400899 [debug] [MainThread]: SQL status: BEGIN in 1.487 seconds
[0m22:03:40.402377 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:40.403677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:03:40.772753 [debug] [MainThread]: SQL status: SELECT 3 in 0.368 seconds
[0m22:03:40.777160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7826c788-3341-4e2c-9b9a-e5a2a8be53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113732f90>]}
[0m22:03:40.777980 [debug] [MainThread]: On master: ROLLBACK
[0m22:03:40.824928 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:40.825928 [debug] [MainThread]: On master: BEGIN
[0m22:03:40.915032 [debug] [MainThread]: SQL status: BEGIN in 0.088 seconds
[0m22:03:40.916134 [debug] [MainThread]: On master: COMMIT
[0m22:03:40.917327 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:40.918340 [debug] [MainThread]: On master: COMMIT
[0m22:03:40.965746 [debug] [MainThread]: SQL status: COMMIT in 0.047 seconds
[0m22:03:40.966787 [debug] [MainThread]: On master: Close
[0m22:03:40.974670 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m22:03:40.975615 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dbt_finance.revenue_daily ................... [RUN]
[0m22:03:40.976347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_dbt, now model.dbt_scooters.revenue_daily)
[0m22:03:40.976809 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m22:03:41.034891 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m22:03:41.035481 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m22:03:41.058895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:03:41.059146 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp220341048674"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_ohwk"."dbt_finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m22:03:41.059299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:42.106656 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.047 seconds
[0m22:03:42.127893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:03:42.128388 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m22:03:42.173336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m22:03:42.174199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:03:42.174743 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp220341048674'
        
      order by ordinal_position

  
[0m22:03:42.228514 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.053 seconds
[0m22:03:42.241658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:03:42.242448 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt_finance'
        
      order by ordinal_position

  
[0m22:03:42.290829 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.048 seconds
[0m22:03:42.307713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:03:42.308252 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp220341048674'
        
      order by ordinal_position

  
[0m22:03:42.356792 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.048 seconds
[0m22:03:42.361807 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:03:42.362290 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_ohwk".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'dbt_finance'
        
      order by ordinal_position

  
[0m22:03:42.411064 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.048 seconds
[0m22:03:42.417434 [debug] [Thread-1 (]: 
    In "dev_ohwk"."dbt_finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:03:42.426712 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m22:03:42.427260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:03:42.427471 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_ohwk"."dbt_finance"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp220341048674" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_ohwk"."dbt_finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp220341048674"
    )
  
[0m22:03:42.472517 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.045 seconds
[0m22:03:42.481658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:03:42.481926 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_ohwk".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'dbt_finance'
        and table_name = 'revenue_daily'
  
[0m22:03:42.532450 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.050 seconds
[0m22:03:42.533581 [debug] [Thread-1 (]: On "dev_ohwk"."dbt_finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m22:03:42.537901 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:03:42.538222 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:03:42.538506 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:03:42.584768 [debug] [Thread-1 (]: SQL status: COMMIT in 0.046 seconds
[0m22:03:42.587675 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m22:03:42.590735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7826c788-3341-4e2c-9b9a-e5a2a8be53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bdb5f0>]}
[0m22:03:42.591566 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dbt_finance.revenue_daily .............. [[32mINSERT 0 3[0m in 1.61s]
[0m22:03:42.592287 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m22:03:42.593987 [info ] [MainThread]: 
[0m22:03:42.594444 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:42.594745 [debug] [MainThread]: On master: BEGIN
[0m22:03:42.595020 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:03:43.991872 [debug] [MainThread]: SQL status: BEGIN in 1.396 seconds
[0m22:03:43.993596 [debug] [MainThread]: On master: COMMIT
[0m22:03:43.994945 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:43.995571 [debug] [MainThread]: On master: COMMIT
[0m22:03:44.054240 [debug] [MainThread]: SQL status: COMMIT in 0.058 seconds
[0m22:03:44.059002 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m22:03:44.066077 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m22:03:44.066774 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:44.067190 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema dbt_finance to finance;
[0m22:03:44.113434 [debug] [MainThread]: SQL status: GRANT in 0.046 seconds
[0m22:03:44.114816 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.06s]
[0m22:03:44.115249 [debug] [MainThread]: On master: Close
[0m22:03:44.115980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:44.116286 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m22:03:44.116506 [debug] [MainThread]: Connection 'list_dev_ohwk_dbt_finance' was properly closed.
[0m22:03:44.116770 [info ] [MainThread]: 
[0m22:03:44.117038 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 7.92 seconds (7.92s).
[0m22:03:44.117743 [debug] [MainThread]: Command end result
[0m22:03:44.138847 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:03:44.140152 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:03:44.143901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m22:03:44.144091 [info ] [MainThread]: 
[0m22:03:44.144315 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:03:44.144493 [info ] [MainThread]: 
[0m22:03:44.144667 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m22:03:44.170327 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.509052, "process_in_blocks": "0", "process_kernel_time": 0.21619, "process_mem_max_rss": "140197888", "process_out_blocks": "0", "process_user_time": 1.163876}
[0m22:03:44.170663 [debug] [MainThread]: Command `dbt build` succeeded at 22:03:44.170611 after 8.51 seconds
[0m22:03:44.170868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112608dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137c47e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137c71d0>]}
[0m22:03:44.171057 [debug] [MainThread]: Flushing usage events
[0m22:03:44.711047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:04:59.321109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c774d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107727b10>]}


============================== 22:04:59.323645 | c54049c2-563b-4c80-9278-eadcef3d205f ==============================
[0m22:04:59.323645 [info ] [MainThread]: Running with dbt=1.10.6
[0m22:04:59.323941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -s finance', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:04:59.389949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c54049c2-563b-4c80-9278-eadcef3d205f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672f490>]}
[0m22:04:59.410648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c54049c2-563b-4c80-9278-eadcef3d205f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075be030>]}
[0m22:04:59.411723 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:04:59.449414 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m22:04:59.501866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:04:59.502039 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:04:59.523268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c54049c2-563b-4c80-9278-eadcef3d205f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffb050>]}
[0m22:04:59.560740 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:04:59.561838 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:04:59.577980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c54049c2-563b-4c80-9278-eadcef3d205f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108e1e50>]}
[0m22:04:59.578210 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 439 macros
[0m22:04:59.579087 [info ] [MainThread]: 
[0m22:04:59.579234 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:59.579347 [info ] [MainThread]: 
[0m22:04:59.579555 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:04:59.579931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk'
[0m22:04:59.601454 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk"
[0m22:04:59.601681 [debug] [ThreadPool]: On list_dev_ohwk: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk"} */

    select distinct nspname from pg_namespace
  
[0m22:04:59.601808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:01.117911 [debug] [ThreadPool]: SQL status: SELECT 23 in 1.516 seconds
[0m22:05:01.122059 [debug] [ThreadPool]: On list_dev_ohwk: Close
[0m22:05:01.123978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_ohwk, now create_dev_ohwk_finance)
[0m22:05:01.124758 [debug] [ThreadPool]: Creating schema "database: "dev_ohwk"
schema: "finance"
"
[0m22:05:01.132253 [debug] [ThreadPool]: Using postgres connection "create_dev_ohwk_finance"
[0m22:05:01.132685 [debug] [ThreadPool]: On create_dev_ohwk_finance: BEGIN
[0m22:05:01.133042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:02.414022 [debug] [ThreadPool]: SQL status: BEGIN in 1.281 seconds
[0m22:05:02.415572 [debug] [ThreadPool]: Using postgres connection "create_dev_ohwk_finance"
[0m22:05:02.416589 [debug] [ThreadPool]: On create_dev_ohwk_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "create_dev_ohwk_finance"} */
create schema if not exists "finance"
[0m22:05:02.465876 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.048 seconds
[0m22:05:02.467195 [debug] [ThreadPool]: On create_dev_ohwk_finance: COMMIT
[0m22:05:02.467369 [debug] [ThreadPool]: Using postgres connection "create_dev_ohwk_finance"
[0m22:05:02.467481 [debug] [ThreadPool]: On create_dev_ohwk_finance: COMMIT
[0m22:05:02.513324 [debug] [ThreadPool]: SQL status: COMMIT in 0.046 seconds
[0m22:05:02.513591 [debug] [ThreadPool]: On create_dev_ohwk_finance: Close
[0m22:05:02.516909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_ohwk_finance, now list_dev_ohwk_finance)
[0m22:05:02.520357 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_finance"
[0m22:05:02.520662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_dbt'
[0m22:05:02.520922 [debug] [ThreadPool]: On list_dev_ohwk_finance: BEGIN
[0m22:05:02.524136 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m22:05:02.524354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:02.524527 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m22:05:02.524815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:03.290741 [debug] [ThreadPool]: SQL status: BEGIN in 0.766 seconds
[0m22:05:03.292293 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_finance"
[0m22:05:03.293392 [debug] [ThreadPool]: On list_dev_ohwk_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_finance"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m22:05:03.346500 [debug] [ThreadPool]: SQL status: BEGIN in 0.821 seconds
[0m22:05:03.347602 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m22:05:03.348305 [debug] [ThreadPool]: On list_dev_ohwk_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_ohwk_dbt"} */
select
      'dev_ohwk' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_ohwk' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m22:05:03.378074 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.084 seconds
[0m22:05:03.382350 [debug] [ThreadPool]: On list_dev_ohwk_finance: ROLLBACK
[0m22:05:03.418484 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.069 seconds
[0m22:05:03.423614 [debug] [ThreadPool]: On list_dev_ohwk_dbt: ROLLBACK
[0m22:05:03.446162 [debug] [ThreadPool]: On list_dev_ohwk_finance: Close
[0m22:05:03.483572 [debug] [ThreadPool]: On list_dev_ohwk_dbt: Close
[0m22:05:03.496718 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:03.497361 [debug] [MainThread]: On master: BEGIN
[0m22:05:03.497681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:05.078492 [debug] [MainThread]: SQL status: BEGIN in 1.580 seconds
[0m22:05:05.080016 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:05.080939 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:05.267557 [debug] [MainThread]: SQL status: SELECT 3 in 0.186 seconds
[0m22:05:05.271568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c54049c2-563b-4c80-9278-eadcef3d205f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a73770>]}
[0m22:05:05.272536 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:05.316813 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:05.317705 [debug] [MainThread]: On master: BEGIN
[0m22:05:05.423582 [debug] [MainThread]: SQL status: BEGIN in 0.105 seconds
[0m22:05:05.424590 [debug] [MainThread]: On master: COMMIT
[0m22:05:05.425284 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:05.425969 [debug] [MainThread]: On master: COMMIT
[0m22:05:05.471962 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m22:05:05.473084 [debug] [MainThread]: On master: Close
[0m22:05:05.480978 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m22:05:05.481790 [info ] [Thread-1 (]: 1 of 1 START sql incremental model finance.revenue_daily ....................... [RUN]
[0m22:05:05.482410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_ohwk_finance, now model.dbt_scooters.revenue_daily)
[0m22:05:05.482840 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m22:05:05.546951 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m22:05:05.547550 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m22:05:05.569781 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m22:05:05.570213 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:05:05.570362 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m22:05:05.570483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:06.331363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.760 seconds
[0m22:05:06.332887 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:05:06.333688 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_ohwk"."finance"."revenue_daily"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_ohwk"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
  );
  
  
[0m22:05:07.449270 [debug] [Thread-1 (]: SQL status: SELECT 91 in 1.114 seconds
[0m22:05:07.480464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:05:07.480874 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

        
            grant select on "dev_ohwk"."finance"."revenue_daily" to finance;
        
    
[0m22:05:07.528918 [debug] [Thread-1 (]: SQL status: GRANT in 0.048 seconds
[0m22:05:07.534628 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:05:07.534983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:05:07.535282 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:05:07.586154 [debug] [Thread-1 (]: SQL status: COMMIT in 0.050 seconds
[0m22:05:07.590358 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m22:05:07.594817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c54049c2-563b-4c80-9278-eadcef3d205f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d4ed00>]}
[0m22:05:07.595883 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model finance.revenue_daily .................. [[32mSELECT 91[0m in 2.11s]
[0m22:05:07.596658 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m22:05:07.598859 [info ] [MainThread]: 
[0m22:05:07.599405 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:07.599744 [debug] [MainThread]: On master: BEGIN
[0m22:05:07.600035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:08.457444 [debug] [MainThread]: SQL status: BEGIN in 0.857 seconds
[0m22:05:08.458780 [debug] [MainThread]: On master: COMMIT
[0m22:05:08.459710 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:08.460309 [debug] [MainThread]: On master: COMMIT
[0m22:05:08.504541 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m22:05:08.509882 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m22:05:08.516388 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m22:05:08.517124 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:08.517570 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m22:05:08.564041 [debug] [MainThread]: SQL status: GRANT in 0.046 seconds
[0m22:05:08.565913 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.06s]
[0m22:05:08.566523 [debug] [MainThread]: On master: Close
[0m22:05:08.567775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:08.568269 [debug] [MainThread]: Connection 'model.dbt_scooters.revenue_daily' was properly closed.
[0m22:05:08.568571 [debug] [MainThread]: Connection 'list_dev_ohwk_dbt' was properly closed.
[0m22:05:08.568928 [info ] [MainThread]: 
[0m22:05:08.569275 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 8.99 seconds (8.99s).
[0m22:05:08.570321 [debug] [MainThread]: Command end result
[0m22:05:08.592716 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:05:08.594055 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:05:08.597819 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m22:05:08.598012 [info ] [MainThread]: 
[0m22:05:08.598233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:05:08.598391 [info ] [MainThread]: 
[0m22:05:08.598560 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m22:05:08.600215 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.308412, "process_in_blocks": "0", "process_kernel_time": 0.151339, "process_mem_max_rss": "139984896", "process_out_blocks": "0", "process_user_time": 1.02495}
[0m22:05:08.600465 [debug] [MainThread]: Command `dbt build` succeeded at 22:05:08.600415 after 9.31 seconds
[0m22:05:08.600664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107608dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a7de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a7dde0>]}
[0m22:05:08.600854 [debug] [MainThread]: Flushing usage events
[0m22:05:09.116495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:31:55.722924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10557b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a779d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a77b10>]}


============================== 09:31:55.725843 | 1dc8754e-5ef5-494f-ae1d-f3a362cef4ab ==============================
[0m09:31:55.725843 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:31:55.726113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:31:55.815592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dc8754e-5ef5-494f-ae1d-f3a362cef4ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d77490>]}
[0m09:31:55.837354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dc8754e-5ef5-494f-ae1d-f3a362cef4ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690a030>]}
[0m09:31:55.837972 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:31:55.876852 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:31:55.940898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:31:55.941113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:31:55.962054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dc8754e-5ef5-494f-ae1d-f3a362cef4ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f4750>]}
[0m09:31:55.999435 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m09:31:56.001234 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m09:31:56.012362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dc8754e-5ef5-494f-ae1d-f3a362cef4ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af5d60>]}
[0m09:31:56.012565 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 439 macros
[0m09:31:56.012710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dc8754e-5ef5-494f-ae1d-f3a362cef4ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d6dd0>]}
[0m09:31:56.013564 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:31:56.023834 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m09:31:56.024724 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m09:31:56.026088 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/flerinvs/dbt_scooters/target/sources.json
[0m09:31:56.026202 [info ] [MainThread]: Done.
[0m09:31:56.027534 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.3361866, "process_in_blocks": "0", "process_kernel_time": 0.125404, "process_mem_max_rss": "122093568", "process_out_blocks": "0", "process_user_time": 0.732157}
[0m09:31:56.027785 [debug] [MainThread]: Command `dbt source freshness` succeeded at 09:31:56.027741 after 0.34 seconds
[0m09:31:56.027963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10799bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106958dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107962c90>]}
[0m09:31:56.028111 [debug] [MainThread]: Flushing usage events
[0m09:31:56.562319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:27.710915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f2b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f2bb10>]}


============================== 09:34:27.713399 | c5dc1867-fb8f-48fa-abe7-8356bed9ac0f ==============================
[0m09:34:27.713399 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:34:27.713690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:34:27.780478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5dc1867-fb8f-48fa-abe7-8356bed9ac0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108deb490>]}
[0m09:34:27.800682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5dc1867-fb8f-48fa-abe7-8356bed9ac0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dbe030>]}
[0m09:34:27.801157 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:34:27.838701 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:34:27.901950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:34:27.902139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:34:27.924352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5dc1867-fb8f-48fa-abe7-8356bed9ac0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac8c750>]}
[0m09:34:27.964405 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m09:34:27.965654 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m09:34:27.976325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5dc1867-fb8f-48fa-abe7-8356bed9ac0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa9d60>]}
[0m09:34:27.976571 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 439 macros
[0m09:34:27.976715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5dc1867-fb8f-48fa-abe7-8356bed9ac0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1c2dd0>]}
[0m09:34:27.977583 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:34:27.988092 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m09:34:27.989162 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m09:34:27.990596 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/flerinvs/dbt_scooters/target/sources.json
[0m09:34:27.990720 [info ] [MainThread]: Done.
[0m09:34:27.992111 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.31170595, "process_in_blocks": "0", "process_kernel_time": 0.108488, "process_mem_max_rss": "120111104", "process_out_blocks": "0", "process_user_time": 0.719917}
[0m09:34:27.992344 [debug] [MainThread]: Command `dbt source freshness` succeeded at 09:34:27.992299 after 0.31 seconds
[0m09:34:27.992505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b493ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e08dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b46ac90>]}
[0m09:34:27.992651 [debug] [MainThread]: Flushing usage events
[0m09:34:28.578522 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:40.129076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b834d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11242b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11242bb10>]}


============================== 09:34:40.131390 | 3684f7d8-13c4-4802-9891-043909c2fcb4 ==============================
[0m09:34:40.131390 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:34:40.131659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt source freshness', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:34:40.198697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3684f7d8-13c4-4802-9891-043909c2fcb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11072b490>]}
[0m09:34:40.220182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3684f7d8-13c4-4802-9891-043909c2fcb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122be030>]}
[0m09:34:40.220797 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:34:40.259330 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:34:40.322356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:34:40.322556 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:34:40.343503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3684f7d8-13c4-4802-9891-043909c2fcb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132ac750>]}
[0m09:34:40.379842 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m09:34:40.380921 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m09:34:40.391170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3684f7d8-13c4-4802-9891-043909c2fcb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124a9d60>]}
[0m09:34:40.391367 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 439 macros
[0m09:34:40.391514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3684f7d8-13c4-4802-9891-043909c2fcb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11338edd0>]}
[0m09:34:40.392314 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:34:40.402471 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m09:34:40.403226 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m09:34:40.404823 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/flerinvs/dbt_scooters/target/sources.json
[0m09:34:40.404947 [info ] [MainThread]: Done.
[0m09:34:40.406108 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.30803603, "process_in_blocks": "0", "process_kernel_time": 0.09759, "process_mem_max_rss": "122568704", "process_out_blocks": "0", "process_user_time": 0.725247}
[0m09:34:40.406324 [debug] [MainThread]: Command `dbt source freshness` succeeded at 09:34:40.406285 after 0.31 seconds
[0m09:34:40.406463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113543ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112308dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11351ac90>]}
[0m09:34:40.406591 [debug] [MainThread]: Flushing usage events
[0m09:34:40.908648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:37:52.303728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036374d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b33b10>]}


============================== 09:37:52.306290 | 81c49616-250c-4d42-a397-28593bc35573 ==============================
[0m09:37:52.306290 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:37:52.306589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:37:52.375491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81c49616-250c-4d42-a397-28593bc35573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e33490>]}
[0m09:37:52.396313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81c49616-250c-4d42-a397-28593bc35573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c6030>]}
[0m09:37:52.396704 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:37:52.434115 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:37:52.486883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:37:52.487078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:37:52.508997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81c49616-250c-4d42-a397-28593bc35573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b0750>]}
[0m09:37:52.547267 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m09:37:52.548582 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m09:37:52.559982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81c49616-250c-4d42-a397-28593bc35573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb1d60>]}
[0m09:37:52.560237 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 439 macros
[0m09:37:52.560389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81c49616-250c-4d42-a397-28593bc35573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105896dd0>]}
[0m09:37:52.561289 [info ] [MainThread]: 
[0m09:37:52.561430 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:37:52.561532 [info ] [MainThread]: 
[0m09:37:52.561734 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:37:52.563679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_finance'
[0m09:37:52.569481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_dbt'
[0m09:37:52.588851 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_finance"
[0m09:37:52.589056 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m09:37:52.589186 [debug] [ThreadPool]: On list_dev_ohwk_finance: BEGIN
[0m09:37:52.589307 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m09:37:52.589422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:52.589525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:53.283350 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com" (3.120.236.187), port 5432 failed: SSL connection has been closed unexpectedly

[0m09:37:53.488312 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com" (3.120.236.187), port 5432 failed: SSL connection has been closed unexpectedly

[0m09:37:53.952094 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m09:37:53.953038 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:37:53.953807 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m09:37:53.954361 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:37:53.954959 [debug] [ThreadPool]: On list_dev_ohwk_dbt: No close available on handle
[0m09:37:54.615738 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m09:37:54.616355 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:37:54.616854 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m09:37:54.617182 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:37:54.617520 [debug] [ThreadPool]: On list_dev_ohwk_finance: No close available on handle
[0m09:37:54.618315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:54.618640 [debug] [MainThread]: Connection 'list_dev_ohwk_finance' was properly closed.
[0m09:37:54.618868 [debug] [MainThread]: Connection 'list_dev_ohwk_dbt' was properly closed.
[0m09:37:54.619152 [info ] [MainThread]: 
[0m09:37:54.619508 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m09:37:54.619957 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com" (3.120.236.187), port 5432 failed: SSL connection has been closed unexpectedly
  
[0m09:37:54.622255 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 2.3471336, "process_in_blocks": "0", "process_kernel_time": 0.146576, "process_mem_max_rss": "135249920", "process_out_blocks": "0", "process_user_time": 0.77362}
[0m09:37:54.622941 [debug] [MainThread]: Command `dbt source freshness` failed at 09:37:54.622802 after 2.35 seconds
[0m09:37:54.623228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a30fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a14dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b6690>]}
[0m09:37:54.623417 [debug] [MainThread]: Flushing usage events
[0m09:37:55.114815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:35.862366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642bb10>]}


============================== 09:38:35.864104 | 4ef7d3d8-3395-4a45-8233-93e6db87e718 ==============================
[0m09:38:35.864104 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:38:35.864359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:38:35.926958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ef7d3d8-3395-4a45-8233-93e6db87e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2b490>]}
[0m09:38:35.948398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ef7d3d8-3395-4a45-8233-93e6db87e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061be030>]}
[0m09:38:35.948739 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:38:35.981898 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:38:36.037065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:38:36.037234 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:38:36.057543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ef7d3d8-3395-4a45-8233-93e6db87e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5c750>]}
[0m09:38:36.095409 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m09:38:36.096186 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m09:38:36.102283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ef7d3d8-3395-4a45-8233-93e6db87e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a5d60>]}
[0m09:38:36.102473 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 439 macros
[0m09:38:36.102615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ef7d3d8-3395-4a45-8233-93e6db87e718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e2dd0>]}
[0m09:38:36.103462 [info ] [MainThread]: 
[0m09:38:36.103606 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:38:36.103712 [info ] [MainThread]: 
[0m09:38:36.103904 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:38:36.105740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_finance'
[0m09:38:36.105980 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_ohwk_dbt'
[0m09:38:36.125525 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_finance"
[0m09:38:36.125730 [debug] [ThreadPool]: Using postgres connection "list_dev_ohwk_dbt"
[0m09:38:36.125864 [debug] [ThreadPool]: On list_dev_ohwk_finance: BEGIN
[0m09:38:36.125988 [debug] [ThreadPool]: On list_dev_ohwk_dbt: BEGIN
[0m09:38:36.126099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:36.126200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:36.610848 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com" (3.120.236.187), port 5432 failed: SSL connection has been closed unexpectedly

[0m09:38:36.612524 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com" (3.120.236.187), port 5432 failed: SSL connection has been closed unexpectedly

[0m09:38:37.076357 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m09:38:37.077315 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:38:37.078060 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m09:38:37.078622 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:38:37.079199 [debug] [ThreadPool]: On list_dev_ohwk_dbt: No close available on handle
[0m09:38:38.043268 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m09:38:38.044912 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:38:38.046202 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m09:38:38.047138 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m09:38:38.048003 [debug] [ThreadPool]: On list_dev_ohwk_finance: No close available on handle
[0m09:38:38.049154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:38.049556 [debug] [MainThread]: Connection 'list_dev_ohwk_finance' was properly closed.
[0m09:38:38.050016 [debug] [MainThread]: Connection 'list_dev_ohwk_dbt' was properly closed.
[0m09:38:38.050644 [info ] [MainThread]: 
[0m09:38:38.051055 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m09:38:38.051520 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "dpg-d25i2hnfte5s7386hncg-a.frankfurt-postgres.render.com" (3.120.236.187), port 5432 failed: SSL connection has been closed unexpectedly
  
[0m09:38:38.053541 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 2.21547, "process_in_blocks": "0", "process_kernel_time": 0.11514, "process_mem_max_rss": "134004736", "process_out_blocks": "0", "process_user_time": 0.741425}
[0m09:38:38.054186 [debug] [MainThread]: Command `dbt source freshness` failed at 09:38:38.054078 after 2.22 seconds
[0m09:38:38.054664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107236690>]}
[0m09:38:38.055070 [debug] [MainThread]: Flushing usage events
[0m09:38:38.572268 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:56.652330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040e74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055df9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055dfb10>]}


============================== 10:03:56.655066 | dd83d081-e2c0-4ded-ab05-5d2bb3806d98 ==============================
[0m10:03:56.655066 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:03:56.655390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:03:56.742471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e3490>]}
[0m10:03:56.763906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105476030>]}
[0m10:03:56.764482 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:03:56.803507 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m10:03:56.867579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:03:56.867812 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:03:56.890856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10625b050>]}
[0m10:03:56.928772 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:03:56.930554 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:03:56.949375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106509e50>]}
[0m10:03:56.949613 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 439 macros
[0m10:03:56.950888 [info ] [MainThread]: 
[0m10:03:56.951036 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:03:56.951145 [info ] [MainThread]: 
[0m10:03:56.951352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:56.953182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af'
[0m10:03:56.957966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af'
[0m10:03:56.976707 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af"
[0m10:03:56.976880 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af"
[0m10:03:56.977019 [debug] [ThreadPool]: On list_dev_o0af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af"} */

    select distinct nspname from pg_namespace
  
[0m10:03:56.977146 [debug] [ThreadPool]: On list_dev_o0af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af"} */

    select distinct nspname from pg_namespace
  
[0m10:03:56.977258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:56.977357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:58.675793 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.698 seconds
[0m10:03:58.678533 [debug] [ThreadPool]: On list_dev_o0af: Close
[0m10:03:58.723344 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.746 seconds
[0m10:03:58.727201 [debug] [ThreadPool]: On list_dev_o0af: Close
[0m10:03:58.729192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_o0af, now create_dev_o0af_dbt)
[0m10:03:58.729782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_o0af, now create_dev_o0af_finance)
[0m10:03:58.731529 [debug] [ThreadPool]: Creating schema "database: "dev_o0af"
schema: "dbt"
"
[0m10:03:58.732058 [debug] [ThreadPool]: Creating schema "database: "dev_o0af"
schema: "finance"
"
[0m10:03:58.738963 [debug] [ThreadPool]: Using postgres connection "create_dev_o0af_dbt"
[0m10:03:58.741114 [debug] [ThreadPool]: Using postgres connection "create_dev_o0af_finance"
[0m10:03:58.741513 [debug] [ThreadPool]: On create_dev_o0af_dbt: BEGIN
[0m10:03:58.741782 [debug] [ThreadPool]: On create_dev_o0af_finance: BEGIN
[0m10:03:58.742026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:58.742268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:59.398432 [debug] [ThreadPool]: SQL status: BEGIN in 0.656 seconds
[0m10:03:59.400039 [debug] [ThreadPool]: Using postgres connection "create_dev_o0af_finance"
[0m10:03:59.401066 [debug] [ThreadPool]: On create_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "create_dev_o0af_finance"} */
create schema if not exists "finance"
[0m10:03:59.446103 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.044 seconds
[0m10:03:59.449560 [debug] [ThreadPool]: On create_dev_o0af_finance: COMMIT
[0m10:03:59.450564 [debug] [ThreadPool]: Using postgres connection "create_dev_o0af_finance"
[0m10:03:59.451434 [debug] [ThreadPool]: On create_dev_o0af_finance: COMMIT
[0m10:03:59.497072 [debug] [ThreadPool]: SQL status: COMMIT in 0.045 seconds
[0m10:03:59.498266 [debug] [ThreadPool]: On create_dev_o0af_finance: Close
[0m10:03:59.849811 [debug] [ThreadPool]: SQL status: BEGIN in 1.107 seconds
[0m10:03:59.851208 [debug] [ThreadPool]: Using postgres connection "create_dev_o0af_dbt"
[0m10:03:59.852195 [debug] [ThreadPool]: On create_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "create_dev_o0af_dbt"} */
create schema if not exists "dbt"
[0m10:03:59.897902 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.045 seconds
[0m10:03:59.900005 [debug] [ThreadPool]: On create_dev_o0af_dbt: COMMIT
[0m10:03:59.900779 [debug] [ThreadPool]: Using postgres connection "create_dev_o0af_dbt"
[0m10:03:59.901263 [debug] [ThreadPool]: On create_dev_o0af_dbt: COMMIT
[0m10:04:00.160574 [debug] [ThreadPool]: SQL status: COMMIT in 0.259 seconds
[0m10:04:00.162067 [debug] [ThreadPool]: On create_dev_o0af_dbt: Close
[0m10:04:00.167806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_o0af_dbt, now list_dev_o0af_dbt)
[0m10:04:00.175707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_o0af_finance, now list_dev_o0af_finance)
[0m10:04:00.181013 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m10:04:00.182474 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m10:04:00.182807 [debug] [ThreadPool]: On list_dev_o0af_dbt: BEGIN
[0m10:04:00.183062 [debug] [ThreadPool]: On list_dev_o0af_finance: BEGIN
[0m10:04:00.183304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:04:00.183534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:04:01.408009 [debug] [ThreadPool]: SQL status: BEGIN in 1.224 seconds
[0m10:04:01.409513 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m10:04:01.410588 [debug] [ThreadPool]: On list_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_dbt"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:04:01.459494 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.048 seconds
[0m10:04:01.463627 [debug] [ThreadPool]: On list_dev_o0af_dbt: ROLLBACK
[0m10:04:01.509007 [debug] [ThreadPool]: On list_dev_o0af_dbt: Close
[0m10:04:01.554342 [debug] [ThreadPool]: SQL status: BEGIN in 1.371 seconds
[0m10:04:01.555528 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m10:04:01.556528 [debug] [ThreadPool]: On list_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_finance"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m10:04:01.781722 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.224 seconds
[0m10:04:01.785511 [debug] [ThreadPool]: On list_dev_o0af_finance: ROLLBACK
[0m10:04:01.828245 [debug] [ThreadPool]: On list_dev_o0af_finance: Close
[0m10:04:01.838353 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:01.838766 [debug] [MainThread]: On master: BEGIN
[0m10:04:01.839093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:04:02.549187 [debug] [MainThread]: SQL status: BEGIN in 0.710 seconds
[0m10:04:02.550592 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:02.551828 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:04:02.629203 [debug] [MainThread]: SQL status: SELECT 0 in 0.076 seconds
[0m10:04:02.632941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064dc750>]}
[0m10:04:02.633832 [debug] [MainThread]: On master: ROLLBACK
[0m10:04:02.680303 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:02.681510 [debug] [MainThread]: On master: BEGIN
[0m10:04:02.869400 [debug] [MainThread]: SQL status: BEGIN in 0.187 seconds
[0m10:04:02.870635 [debug] [MainThread]: On master: COMMIT
[0m10:04:02.871602 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:02.872474 [debug] [MainThread]: On master: COMMIT
[0m10:04:02.918808 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m10:04:02.920014 [debug] [MainThread]: On master: Close
[0m10:04:02.982950 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m10:04:02.983223 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m10:04:02.983401 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m10:04:02.983560 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m10:04:02.983792 [info ] [Thread-1 (]: 1 of 20 START sql incremental model dbt.events_clean ........................... [RUN]
[0m10:04:02.984071 [info ] [Thread-2 (]: 2 of 20 START sql table model dbt.trips_concurrency ............................ [RUN]
[0m10:04:02.984307 [info ] [Thread-4 (]: 4 of 20 START sql view model dbt.trips_prep .................................... [RUN]
[0m10:04:02.984525 [info ] [Thread-3 (]: 3 of 20 START sql table model dbt.trips_geom ................................... [RUN]
[0m10:04:02.984788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_o0af_dbt, now model.dbt_scooters.events_clean)
[0m10:04:02.985027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_o0af_finance, now model.dbt_scooters.trips_concurrency)
[0m10:04:02.985258 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_prep'
[0m10:04:02.985466 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m10:04:02.985639 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m10:04:02.985797 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m10:04:02.985944 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m10:04:02.986088 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m10:04:02.992286 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m10:04:02.994528 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m10:04:02.996221 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m10:04:02.997439 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m10:04:02.999320 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m10:04:02.999499 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m10:04:02.999640 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m10:04:02.999773 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m10:04:03.015771 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m10:04:03.017045 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m10:04:03.028588 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m10:04:03.035055 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m10:04:03.035587 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:04:03.035769 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:04:03.035904 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:04:03.036028 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:04:03.036154 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m10:04:03.036279 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m10:04:03.036395 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m10:04:03.036507 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m10:04:03.036631 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:04:03.036743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:03.036850 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:04:03.036961 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:04:03.657344 [debug] [Thread-2 (]: SQL status: BEGIN in 0.620 seconds
[0m10:04:03.659078 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:04:03.660378 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

  
    

  create  table "dev_o0af"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_o0af"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
[0m10:04:03.665560 [debug] [Thread-1 (]: SQL status: BEGIN in 0.629 seconds
[0m10:04:03.666051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:04:03.666467 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
  
    

  create  table "dev_o0af"."dbt"."events_clean"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_o0af"."scooters_raw"."events"
where

    "timestamp" < timestamp '2023-08-01'

  );
  
  
[0m10:04:03.778660 [debug] [Thread-3 (]: SQL status: BEGIN in 0.742 seconds
[0m10:04:03.780096 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:04:03.781227 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  
    

  create  table "dev_o0af"."dbt"."trips_geom__dbt_tmp"
  
  
    as
  
  (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_o0af"."scooters_raw"."trips"
  );
  
[0m10:04:04.078839 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function st_makepoint(double precision, double precision) does not exist
LINE 14:     st_setsrid(st_makepoint(start_lon, start_lat), 4326) as ...
                        ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m10:04:04.080487 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: ROLLBACK
[0m10:04:04.175910 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m10:04:04.194625 [debug] [Thread-3 (]: Database Error in model trips_geom (models/trips_geom.sql)
  function st_makepoint(double precision, double precision) does not exist
  LINE 14:     st_setsrid(st_makepoint(start_lon, start_lat), 4326) as ...
                          ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dbt_scooters/models/trips_geom.sql
[0m10:04:04.196981 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a5090>]}
[0m10:04:04.197638 [error] [Thread-3 (]: 3 of 20 ERROR creating sql table model dbt.trips_geom .......................... [[31mERROR[0m in 1.21s]
[0m10:04:04.198178 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m10:04:04.198523 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m10:04:04.199005 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_geom' to be skipped because of status 'error'.  Reason: Database Error in model trips_geom (models/trips_geom.sql)
  function st_makepoint(double precision, double precision) does not exist
  LINE 14:     st_setsrid(st_makepoint(start_lon, start_lat), 4326) as ...
                          ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dbt_scooters/models/trips_geom.sql.
[0m10:04:04.199507 [info ] [Thread-3 (]: 5 of 20 START sql table model dbt.trips_stat_daily ............................. [RUN]
[0m10:04:04.200388 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.trips_stat_daily)
[0m10:04:04.200779 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m10:04:04.202108 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m10:04:04.202775 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m10:04:04.204816 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m10:04:04.205344 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:04:04.205602 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m10:04:04.205840 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:04:05.378687 [debug] [Thread-4 (]: SQL status: BEGIN in 2.341 seconds
[0m10:04:05.380314 [debug] [Thread-2 (]: SQL status: SELECT 10 in 1.719 seconds
[0m10:04:05.380947 [debug] [Thread-3 (]: SQL status: BEGIN in 1.175 seconds
[0m10:04:05.381498 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:04:05.394493 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:04:05.398058 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:04:05.398586 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_o0af"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,

    date(started_at at time zone 'Europe/Moscow')
 as "date" 
from
"dev_o0af"."scooters_raw"."trips"
  );
[0m10:04:05.399005 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_o0af"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
  
[0m10:04:05.399394 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_o0af"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m10:04:05.477991 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.078 seconds
[0m10:04:05.500244 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m10:04:05.500718 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:04:05.501036 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m10:04:05.576470 [debug] [Thread-2 (]: SQL status: COMMIT in 0.075 seconds
[0m10:04:05.578061 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.178 seconds
[0m10:04:05.588499 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."trips_concurrency__dbt_backup"
[0m10:04:05.591025 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:04:05.594779 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:04:05.595072 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_o0af"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m10:04:05.595329 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_o0af"."dbt"."trips_concurrency__dbt_backup" cascade
[0m10:04:05.676383 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.081 seconds
[0m10:04:05.677193 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.081 seconds
[0m10:04:05.679654 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m10:04:05.684033 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m10:04:05.684581 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:04:05.685107 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m10:04:05.685970 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652e990>]}
[0m10:04:05.686929 [info ] [Thread-2 (]: 2 of 20 OK created sql table model dbt.trips_concurrency ....................... [[32mSELECT 10[0m in 2.70s]
[0m10:04:05.687631 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m10:04:05.688102 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m10:04:05.688703 [info ] [Thread-2 (]: 6 of 20 START seed file dbt.age_groups ......................................... [RUN]
[0m10:04:05.689204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now seed.dbt_scooters.age_groups)
[0m10:04:05.689585 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m10:04:05.690310 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m10:04:05.711007 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:04:05.711375 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m10:04:05.711609 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:04:05.778664 [debug] [Thread-4 (]: SQL status: COMMIT in 0.092 seconds
[0m10:04:05.781177 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."trips_prep__dbt_backup"
[0m10:04:05.783988 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:04:05.784356 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_o0af"."dbt"."trips_prep__dbt_backup" cascade
[0m10:04:05.875541 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.090 seconds
[0m10:04:05.879382 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m10:04:05.880864 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106511ff0>]}
[0m10:04:05.882068 [info ] [Thread-4 (]: 4 of 20 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 2.90s]
[0m10:04:05.882993 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m10:04:05.883697 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.event_types
[0m10:04:05.884655 [info ] [Thread-4 (]: 7 of 20 START seed file dbt.event_types ........................................ [RUN]
[0m10:04:05.885629 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now seed.dbt_scooters.event_types)
[0m10:04:05.886270 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.event_types
[0m10:04:05.886737 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.event_types
[0m10:04:05.892599 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:04:05.892950 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: BEGIN
[0m10:04:05.893256 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:04:06.880656 [debug] [Thread-4 (]: SQL status: BEGIN in 0.987 seconds
[0m10:04:06.882443 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:04:06.883606 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    create table "dev_o0af"."dbt"."event_types" ("type_id" integer,"type" text)
  
[0m10:04:06.984767 [debug] [Thread-4 (]: SQL status: CREATE TABLE in 0.100 seconds
[0m10:04:07.006007 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:04:07.006532 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_o0af"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m10:04:07.076858 [debug] [Thread-4 (]: SQL status: INSERT 0 4 in 0.070 seconds
[0m10:04:07.085789 [debug] [Thread-3 (]: SQL status: SELECT 91 in 1.686 seconds
[0m10:04:07.086578 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m10:04:07.090874 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:04:07.091680 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_o0af"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m10:04:07.095780 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: COMMIT
[0m10:04:07.096206 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:04:07.096558 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: COMMIT
[0m10:04:07.176061 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.083 seconds
[0m10:04:07.177479 [debug] [Thread-4 (]: SQL status: COMMIT in 0.080 seconds
[0m10:04:07.180864 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m10:04:07.182223 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: Close
[0m10:04:07.182915 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:04:07.183629 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m10:04:07.185879 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4c370>]}
[0m10:04:07.186981 [info ] [Thread-4 (]: 7 of 20 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 1.30s]
[0m10:04:07.187860 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.event_types
[0m10:04:07.188434 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.scooters
[0m10:04:07.189200 [info ] [Thread-4 (]: 8 of 20 START seed file dbt.scooters ........................................... [RUN]
[0m10:04:07.189942 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now seed.dbt_scooters.scooters)
[0m10:04:07.190457 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.scooters
[0m10:04:07.190925 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.scooters
[0m10:04:07.197981 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:04:07.198527 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: BEGIN
[0m10:04:07.198872 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:04:07.279681 [debug] [Thread-3 (]: SQL status: COMMIT in 0.093 seconds
[0m10:04:07.283502 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_stat_daily__dbt_backup"
[0m10:04:07.284206 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:04:07.284582 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_o0af"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m10:04:07.375336 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.090 seconds
[0m10:04:07.380265 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m10:04:07.381601 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a71150>]}
[0m10:04:07.382492 [info ] [Thread-3 (]: 5 of 20 OK created sql table model dbt.trips_stat_daily ........................ [[32mSELECT 91[0m in 3.18s]
[0m10:04:07.383210 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m10:04:07.383718 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m10:04:07.384249 [info ] [Thread-3 (]: 9 of 20 SKIP relation dbt.parking_finish_stat .................................. [[33mSKIP[0m]
[0m10:04:07.384729 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m10:04:07.385114 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_start_stat
[0m10:04:07.385427 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.parking_finish_stat' to be skipped because of status 'skipped'. 
[0m10:04:07.385785 [info ] [Thread-3 (]: 10 of 20 SKIP relation dbt.parking_start_stat .................................. [[33mSKIP[0m]
[0m10:04:07.386302 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m10:04:07.386618 [debug] [Thread-3 (]: Began running node model.dbt_scooters.revenue_daily
[0m10:04:07.386853 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.parking_start_stat' to be skipped because of status 'skipped'. 
[0m10:04:07.387247 [info ] [Thread-3 (]: 11 of 20 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m10:04:07.388055 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.revenue_daily)
[0m10:04:07.388618 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m10:04:07.393115 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m10:04:07.395957 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.revenue_daily
[0m10:04:07.399139 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m10:04:07.399874 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:04:07.400149 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m10:04:07.400383 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:04:07.474549 [debug] [Thread-2 (]: SQL status: BEGIN in 1.763 seconds
[0m10:04:07.475581 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:04:07.476135 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    create table "dev_o0af"."dbt"."age_groups" ("group" text,"age_start" integer,"age_end" integer)
  
[0m10:04:07.575943 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.099 seconds
[0m10:04:07.589570 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:04:07.590137 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_o0af"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m10:04:07.634256 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.043 seconds
[0m10:04:07.636421 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m10:04:07.642230 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m10:04:07.642770 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:04:07.643123 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m10:04:07.778925 [debug] [Thread-2 (]: SQL status: COMMIT in 0.135 seconds
[0m10:04:07.781202 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m10:04:07.782684 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9ef90>]}
[0m10:04:07.783737 [info ] [Thread-2 (]: 6 of 20 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 2.09s]
[0m10:04:07.784711 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m10:04:07.785393 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m10:04:07.786362 [info ] [Thread-2 (]: 12 of 20 START sql table model dbt.trips_stat .................................. [RUN]
[0m10:04:07.787116 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now model.dbt_scooters.trips_stat)
[0m10:04:07.787615 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m10:04:07.792247 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m10:04:07.793544 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m10:04:07.798686 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m10:04:07.799817 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:04:07.800161 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m10:04:07.800452 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:04:07.923284 [debug] [Thread-4 (]: SQL status: BEGIN in 0.724 seconds
[0m10:04:07.924425 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:04:07.925156 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    create table "dev_o0af"."dbt"."scooters" ("company" text,"model" text,"hardware_id" text,"scooters" integer)
  
[0m10:04:07.977283 [debug] [Thread-4 (]: SQL status: CREATE TABLE in 0.051 seconds
[0m10:04:07.986168 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:04:07.986792 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_o0af"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m10:04:08.076667 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.089 seconds
[0m10:04:08.078545 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m10:04:08.083199 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m10:04:08.083876 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:04:08.084314 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m10:04:08.179501 [debug] [Thread-4 (]: SQL status: COMMIT in 0.095 seconds
[0m10:04:08.180290 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: Close
[0m10:04:08.180777 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687fef0>]}
[0m10:04:08.181114 [info ] [Thread-4 (]: 8 of 20 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 0.99s]
[0m10:04:08.181439 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.scooters
[0m10:04:08.181698 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_users
[0m10:04:08.182063 [info ] [Thread-4 (]: 13 of 20 START sql incremental model dbt.trips_users ........................... [RUN]
[0m10:04:08.182471 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now model.dbt_scooters.trips_users)
[0m10:04:08.182914 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_users
[0m10:04:08.187186 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m10:04:08.187863 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_users
[0m10:04:08.189487 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m10:04:08.190098 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:04:08.190261 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: BEGIN
[0m10:04:08.190407 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:04:08.277936 [debug] [Thread-3 (]: SQL status: BEGIN in 0.877 seconds
[0m10:04:08.278942 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:04:08.279607 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_o0af"."finance"."revenue_daily"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_o0af"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
  );
  
  
[0m10:04:08.777102 [debug] [Thread-2 (]: SQL status: BEGIN in 0.976 seconds
[0m10:04:08.778780 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:04:08.779458 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_o0af"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_o0af"."dbt"."trips_prep"
  );
  
[0m10:04:09.276289 [debug] [Thread-4 (]: SQL status: BEGIN in 1.086 seconds
[0m10:04:09.276721 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:04:09.277008 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_o0af"."dbt"."trips_users"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_o0af"."dbt"."trips_prep" as t
left join
    "dev_o0af"."scooters_raw"."users" as u
    on t.user_id = u.id

      where
          t.id <= 75000

  );
  
  
[0m10:04:13.978550 [debug] [Thread-3 (]: SQL status: SELECT 91 in 5.698 seconds
[0m10:04:13.999922 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:04:14.000523 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

        
            grant select on "dev_o0af"."finance"."revenue_daily" to finance;
        
    
[0m10:04:14.079130 [debug] [Thread-3 (]: Postgres adapter: Postgres error: role "finance" does not exist

[0m10:04:14.080791 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: ROLLBACK
[0m10:04:14.176900 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: Close
[0m10:04:14.189304 [debug] [Thread-3 (]: Database Error in model revenue_daily (models/finance/revenue_daily.sql)
  role "finance" does not exist
  compiled code at target/run/dbt_scooters/models/finance/revenue_daily.sql
[0m10:04:14.190101 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1d130>]}
[0m10:04:14.191073 [error] [Thread-3 (]: 11 of 20 ERROR creating sql incremental model finance.revenue_daily ............ [[31mERROR[0m in 6.80s]
[0m10:04:14.191753 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.revenue_daily
[0m10:04:14.192242 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies
[0m10:04:14.192743 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.revenue_daily' to be skipped because of status 'error'.  Reason: Database Error in model revenue_daily (models/finance/revenue_daily.sql)
  role "finance" does not exist
  compiled code at target/run/dbt_scooters/models/finance/revenue_daily.sql.
[0m10:04:14.193687 [info ] [Thread-3 (]: 14 of 20 START sql table model dbt.companies ................................... [RUN]
[0m10:04:14.194419 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.companies)
[0m10:04:14.194850 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies
[0m10:04:14.197927 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m10:04:14.200166 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies
[0m10:04:14.203853 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m10:04:14.204593 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:04:14.204886 [debug] [Thread-3 (]: On model.dbt_scooters.companies: BEGIN
[0m10:04:14.205130 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:04:15.079267 [debug] [Thread-2 (]: SQL status: SELECT 1 in 6.299 seconds
[0m10:04:15.085247 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:04:15.085735 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_o0af"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m10:04:15.179591 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m10:04:15.183150 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m10:04:15.183887 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:04:15.184463 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m10:04:15.289211 [debug] [Thread-3 (]: SQL status: BEGIN in 1.083 seconds
[0m10:04:15.290997 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:04:15.292187 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_o0af"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_o0af"."dbt"."scooters"
group by
    1
  );
  
[0m10:04:15.299055 [debug] [Thread-2 (]: SQL status: COMMIT in 0.114 seconds
[0m10:04:15.303483 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."trips_stat__dbt_backup"
[0m10:04:15.304609 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:04:15.305219 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_o0af"."dbt"."trips_stat__dbt_backup" cascade
[0m10:04:15.375065 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.069 seconds
[0m10:04:15.379311 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m10:04:15.380934 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1e330>]}
[0m10:04:15.382157 [info ] [Thread-2 (]: 12 of 20 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 7.59s]
[0m10:04:15.383136 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m10:04:15.478539 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.185 seconds
[0m10:04:15.485950 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:04:15.486488 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_o0af"."dbt"."companies__dbt_tmp" rename to "companies"
[0m10:04:15.576888 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m10:04:15.579956 [debug] [Thread-3 (]: On model.dbt_scooters.companies: COMMIT
[0m10:04:15.580801 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:04:15.581434 [debug] [Thread-3 (]: On model.dbt_scooters.companies: COMMIT
[0m10:04:15.679467 [debug] [Thread-3 (]: SQL status: COMMIT in 0.097 seconds
[0m10:04:15.686338 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."companies__dbt_backup"
[0m10:04:15.687198 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:04:15.687665 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_o0af"."dbt"."companies__dbt_backup" cascade
[0m10:04:15.775673 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.087 seconds
[0m10:04:15.780285 [debug] [Thread-3 (]: On model.dbt_scooters.companies: Close
[0m10:04:15.782150 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1d130>]}
[0m10:04:15.783164 [info ] [Thread-3 (]: 14 of 20 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 1.59s]
[0m10:04:15.783857 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies
[0m10:04:15.784661 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies_trips
[0m10:04:15.785242 [info ] [Thread-2 (]: 15 of 20 START sql table model dbt.companies_trips ............................. [RUN]
[0m10:04:15.785785 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.companies_trips)
[0m10:04:15.786180 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies_trips
[0m10:04:15.790395 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m10:04:15.793506 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies_trips
[0m10:04:15.797449 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m10:04:15.799121 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:04:15.799427 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m10:04:15.799675 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:04:16.479288 [debug] [Thread-1 (]: SQL status: SELECT 221370 in 12.812 seconds
[0m10:04:16.483667 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:04:16.484276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:04:16.484714 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:04:16.579476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.094 seconds
[0m10:04:16.581987 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m10:04:16.584157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104921850>]}
[0m10:04:16.585630 [info ] [Thread-1 (]: 1 of 20 OK created sql incremental model dbt.events_clean ...................... [[32mSELECT 221370[0m in 13.60s]
[0m10:04:16.586582 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m10:04:16.587521 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_full
[0m10:04:16.588341 [info ] [Thread-3 (]: 16 of 20 START sql view model dbt.events_full .................................. [RUN]
[0m10:04:16.589116 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.events_full)
[0m10:04:16.589707 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_full
[0m10:04:16.594741 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m10:04:16.598335 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_full
[0m10:04:16.603690 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m10:04:16.605114 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:04:16.605450 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: BEGIN
[0m10:04:16.605741 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:04:16.619982 [debug] [Thread-2 (]: SQL status: BEGIN in 0.820 seconds
[0m10:04:16.620416 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:04:16.620818 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_o0af"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_o0af"."dbt"."trips_prep" as t
        join "dev_o0af"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_o0af"."dbt"."companies" as c
        using (company)
  );
  
[0m10:04:17.837383 [debug] [Thread-2 (]: SQL status: SELECT 6 in 1.216 seconds
[0m10:04:17.843155 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:04:17.843826 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_o0af"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m10:04:17.938574 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m10:04:17.942584 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m10:04:17.943825 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:04:17.944585 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m10:04:18.301270 [debug] [Thread-4 (]: SQL status: SELECT 75000 in 9.023 seconds
[0m10:04:18.306308 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:04:18.307295 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m10:04:18.383542 [debug] [Thread-3 (]: SQL status: BEGIN in 1.778 seconds
[0m10:04:18.384345 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:04:18.384835 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_o0af"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_o0af"."dbt"."events_clean"
    left join "dev_o0af"."dbt"."event_types"
        using (type_id)
  );
[0m10:04:18.581127 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.196 seconds
[0m10:04:18.587197 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:04:18.587825 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_o0af"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m10:04:18.682004 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m10:04:18.684759 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m10:04:18.685386 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:04:18.685872 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m10:04:18.882016 [debug] [Thread-3 (]: SQL status: COMMIT in 0.195 seconds
[0m10:04:18.887375 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."events_full__dbt_backup"
[0m10:04:18.888355 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:04:18.888861 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_o0af"."dbt"."events_full__dbt_backup" cascade
[0m10:04:18.974728 [debug] [Thread-2 (]: SQL status: COMMIT in 1.029 seconds
[0m10:04:18.976176 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.087 seconds
[0m10:04:18.981496 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."companies_trips__dbt_backup"
[0m10:04:18.984073 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: Close
[0m10:04:18.985071 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:04:18.985745 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_o0af"."dbt"."companies_trips__dbt_backup" cascade
[0m10:04:18.986478 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1d310>]}
[0m10:04:18.987437 [info ] [Thread-3 (]: 16 of 20 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 2.40s]
[0m10:04:18.988105 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_full
[0m10:04:18.988790 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_stat
[0m10:04:18.989293 [info ] [Thread-1 (]: 17 of 20 START sql table model dbt.events_stat ................................. [RUN]
[0m10:04:18.989761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.events_stat)
[0m10:04:18.990122 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_stat
[0m10:04:18.993645 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m10:04:18.996045 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_stat
[0m10:04:18.999260 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m10:04:18.999960 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:04:19.000276 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: BEGIN
[0m10:04:19.000552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:19.076431 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.089 seconds
[0m10:04:19.078903 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: Close
[0m10:04:19.079795 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba9d90>]}
[0m10:04:19.080511 [info ] [Thread-2 (]: 15 of 20 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 3.29s]
[0m10:04:19.081166 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies_trips
[0m10:04:20.235446 [debug] [Thread-1 (]: SQL status: BEGIN in 1.234 seconds
[0m10:04:20.237014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:04:20.237811 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_o0af"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_o0af"."dbt"."events_full"
  );
  
[0m10:04:22.983947 [debug] [Thread-4 (]: SQL status: ANALYZE in 4.676 seconds
[0m10:04:22.985071 [debug] [Thread-1 (]: SQL status: SELECT 1 in 2.746 seconds
[0m10:04:22.986736 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m10:04:22.992794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:04:22.993467 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:04:22.994093 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_o0af"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m10:04:22.994643 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: COMMIT
[0m10:04:23.038587 [debug] [Thread-4 (]: SQL status: COMMIT in 0.043 seconds
[0m10:04:23.039932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m10:04:23.041585 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:04:23.043892 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: COMMIT
[0m10:04:23.044490 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m10:04:23.045049 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:04:23.045678 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: COMMIT
[0m10:04:23.120848 [debug] [Thread-1 (]: SQL status: COMMIT in 0.075 seconds
[0m10:04:23.122977 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."events_stat__dbt_backup"
[0m10:04:23.123614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:04:23.123954 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_o0af"."dbt"."events_stat__dbt_backup" cascade
[0m10:04:23.166954 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.043 seconds
[0m10:04:23.168285 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: Close
[0m10:04:23.168947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c24b0>]}
[0m10:04:23.169490 [info ] [Thread-1 (]: 17 of 20 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 4.18s]
[0m10:04:23.169952 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_stat
[0m10:04:23.291960 [debug] [Thread-4 (]: SQL status: COMMIT in 0.246 seconds
[0m10:04:23.294383 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:04:23.295067 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m10:04:23.350495 [debug] [Thread-4 (]: SQL status: VACUUM in 0.055 seconds
[0m10:04:23.353824 [debug] [Thread-4 (]: On model.dbt_scooters.trips_users: Close
[0m10:04:23.355200 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1fb90>]}
[0m10:04:23.356128 [info ] [Thread-4 (]: 13 of 20 OK created sql incremental model dbt.trips_users ...................... [[32mSELECT 75000[0m in 15.17s]
[0m10:04:23.356829 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_users
[0m10:04:23.358133 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m10:04:23.358566 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m10:04:23.359354 [info ] [Thread-2 (]: 19 of 20 START sql table model dbt.trips_age_group ............................. [RUN]
[0m10:04:23.360208 [info ] [Thread-3 (]: 18 of 20 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m10:04:23.360824 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_group)
[0m10:04:23.361359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_age_daily)
[0m10:04:23.361838 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m10:04:23.362345 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m10:04:23.366384 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m10:04:23.371268 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m10:04:23.373783 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m10:04:23.374217 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m10:04:23.377036 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m10:04:23.382500 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m10:04:23.383192 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:04:23.383517 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:04:23.383803 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m10:04:23.384047 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m10:04:23.384287 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:04:23.384505 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:04:24.036774 [debug] [Thread-3 (]: SQL status: BEGIN in 0.652 seconds
[0m10:04:24.038651 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:04:24.039566 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_o0af"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m10:04:24.623044 [debug] [Thread-3 (]: SQL status: SELECT 4946 in 0.583 seconds
[0m10:04:24.629663 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:04:24.630555 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_o0af"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m10:04:24.674905 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m10:04:24.677728 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m10:04:24.678502 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:04:24.679359 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m10:04:24.733440 [debug] [Thread-3 (]: SQL status: COMMIT in 0.053 seconds
[0m10:04:24.735285 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_daily__dbt_backup"
[0m10:04:24.735624 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:04:24.735828 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_o0af"."dbt"."trips_age_daily__dbt_backup" cascade
[0m10:04:24.778389 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.042 seconds
[0m10:04:24.779474 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m10:04:24.780002 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d03cb0>]}
[0m10:04:24.780495 [info ] [Thread-3 (]: 18 of 20 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 4946[0m in 1.42s]
[0m10:04:24.780912 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m10:04:24.781349 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m10:04:24.781779 [info ] [Thread-1 (]: 20 of 20 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m10:04:24.782125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now model.dbt_scooters.trips_age_daily_stat)
[0m10:04:24.782405 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m10:04:24.784393 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m10:04:24.785837 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m10:04:24.788065 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m10:04:24.788688 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:04:24.788927 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m10:04:24.789136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:24.860741 [debug] [Thread-2 (]: SQL status: BEGIN in 1.476 seconds
[0m10:04:24.861412 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:04:24.861822 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_o0af"."dbt"."trips_users" as tu
    cross join "dev_o0af"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m10:04:25.480104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.690 seconds
[0m10:04:25.481440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:04:25.482309 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_o0af"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m10:04:25.578124 [debug] [Thread-1 (]: SQL status: SELECT 83 in 0.095 seconds
[0m10:04:25.586247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:04:25.586769 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_o0af"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m10:04:25.675266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m10:04:25.679722 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m10:04:25.680325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:04:25.680761 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m10:04:25.730399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m10:04:25.736075 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_daily_stat__dbt_backup"
[0m10:04:25.737152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:04:25.737786 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_o0af"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m10:04:25.784099 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.045 seconds
[0m10:04:25.788897 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m10:04:25.790501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687d9d0>]}
[0m10:04:25.791743 [info ] [Thread-1 (]: 20 of 20 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 1.01s]
[0m10:04:25.792739 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m10:04:34.863235 [debug] [Thread-2 (]: SQL status: SELECT 7 in 10.000 seconds
[0m10:04:34.870266 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:04:34.870902 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_o0af"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m10:04:34.915040 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m10:04:34.921046 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m10:04:34.921616 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:04:34.922063 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m10:04:34.970485 [debug] [Thread-2 (]: SQL status: COMMIT in 0.048 seconds
[0m10:04:34.974483 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_group__dbt_backup"
[0m10:04:34.975512 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:04:34.976128 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_o0af"."dbt"."trips_age_group__dbt_backup" cascade
[0m10:04:35.020565 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.044 seconds
[0m10:04:35.024146 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m10:04:35.025440 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd83d081-e2c0-4ded-ab05-5d2bb3806d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba9d90>]}
[0m10:04:35.026337 [info ] [Thread-2 (]: 19 of 20 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 11.66s]
[0m10:04:35.027287 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m10:04:35.029384 [info ] [MainThread]: 
[0m10:04:35.030203 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:35.030703 [debug] [MainThread]: On master: BEGIN
[0m10:04:35.031138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:35.761810 [debug] [MainThread]: SQL status: BEGIN in 0.730 seconds
[0m10:04:35.762871 [debug] [MainThread]: On master: COMMIT
[0m10:04:35.763450 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:35.763838 [debug] [MainThread]: On master: COMMIT
[0m10:04:35.824598 [debug] [MainThread]: SQL status: COMMIT in 0.060 seconds
[0m10:04:35.828488 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m10:04:35.837858 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m10:04:35.838610 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:35.839065 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m10:04:35.885012 [debug] [MainThread]: Postgres adapter: Postgres error: role "finance" does not exist

[0m10:04:35.886224 [info ] [MainThread]: 1 of 1 ERROR hook: dbt_scooters.on-run-end.0 ................................... [[31mERROR[0m in 0.06s]
[0m10:04:35.886895 [debug] [MainThread]: On master: Close
[0m10:04:35.888043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:35.888392 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m10:04:35.888689 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m10:04:35.888962 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m10:04:35.889232 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily' was properly closed.
[0m10:04:35.889776 [info ] [MainThread]: 
[0m10:04:35.890138 [info ] [MainThread]: Finished running 3 incremental models, 1 project hook, 3 seeds, 12 table models, 2 view models in 0 hours 0 minutes and 38.94 seconds (38.94s).
[0m10:04:35.893484 [debug] [MainThread]: Command end result
[0m10:04:35.916086 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:04:35.917725 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:04:35.922299 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m10:04:35.922502 [info ] [MainThread]: 
[0m10:04:35.922705 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m10:04:35.922952 [info ] [MainThread]: 
[0m10:04:35.923212 [error] [MainThread]: [31mFailure in model trips_geom (models/trips_geom.sql)[0m
[0m10:04:35.923431 [error] [MainThread]:   Database Error in model trips_geom (models/trips_geom.sql)
  function st_makepoint(double precision, double precision) does not exist
  LINE 14:     st_setsrid(st_makepoint(start_lon, start_lat), 4326) as ...
                          ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dbt_scooters/models/trips_geom.sql
[0m10:04:35.923593 [info ] [MainThread]: 
[0m10:04:35.923770 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/trips_geom.sql
[0m10:04:35.923916 [info ] [MainThread]: 
[0m10:04:35.924086 [error] [MainThread]: [31mFailure in model revenue_daily (models/finance/revenue_daily.sql)[0m
[0m10:04:35.924270 [error] [MainThread]:   Database Error in model revenue_daily (models/finance/revenue_daily.sql)
  role "finance" does not exist
  compiled code at target/run/dbt_scooters/models/finance/revenue_daily.sql
[0m10:04:35.924409 [info ] [MainThread]: 
[0m10:04:35.924571 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/finance/revenue_daily.sql
[0m10:04:35.924713 [info ] [MainThread]: 
[0m10:04:35.924882 [error] [MainThread]: [31mFailure in operation dbt_scooters-on-run-end-0 (./dbt_project.yml)[0m
[0m10:04:35.925040 [error] [MainThread]:   dbt_scooters.on-run-end.0 failed, error:
 role "finance" does not exist
[0m10:04:35.925159 [info ] [MainThread]: 
[0m10:04:35.925315 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/./dbt_project.yml/hooks/dbt_scooters-on-run-end-0.sql
[0m10:04:35.925451 [info ] [MainThread]: 
[0m10:04:35.925602 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=3 SKIP=2 NO-OP=0 TOTAL=21
[0m10:04:35.926835 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 39.30769, "process_in_blocks": "0", "process_kernel_time": 0.262794, "process_mem_max_rss": "142802944", "process_out_blocks": "0", "process_user_time": 1.806948}
[0m10:04:35.927065 [debug] [MainThread]: Command `dbt build` failed at 10:04:35.927019 after 39.31 seconds
[0m10:04:35.927263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047db050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c0d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687f230>]}
[0m10:04:35.927440 [debug] [MainThread]: Flushing usage events
[0m10:04:36.547905 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:05:26.695799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11090f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e27b10>]}


============================== 10:05:26.698521 | dd909ab7-a89c-42cf-9990-7ae736495f90 ==============================
[0m10:05:26.698521 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:05:26.698821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:05:26.781601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2b490>]}
[0m10:05:26.803450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bbe030>]}
[0m10:05:26.804029 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:05:26.841534 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m10:05:26.904489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:05:26.904727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:05:26.927418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129ab050>]}
[0m10:05:26.965742 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:05:26.967205 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:05:26.978901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ea9c70>]}
[0m10:05:26.979114 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 439 macros
[0m10:05:26.979261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112314050>]}
[0m10:05:26.980252 [info ] [MainThread]: 
[0m10:05:26.980391 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:05:26.980497 [info ] [MainThread]: 
[0m10:05:26.980692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:05:26.982435 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af'
[0m10:05:26.987099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af'
[0m10:05:27.005829 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af"
[0m10:05:27.006009 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af"
[0m10:05:27.006136 [debug] [ThreadPool]: On list_dev_o0af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af"} */

    select distinct nspname from pg_namespace
  
[0m10:05:27.006259 [debug] [ThreadPool]: On list_dev_o0af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af"} */

    select distinct nspname from pg_namespace
  
[0m10:05:27.006372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:27.006470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:27.744378 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.738 seconds
[0m10:05:27.746837 [debug] [ThreadPool]: On list_dev_o0af: Close
[0m10:05:27.817564 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.811 seconds
[0m10:05:27.820900 [debug] [ThreadPool]: On list_dev_o0af: Close
[0m10:05:27.824946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_o0af, now list_dev_o0af_finance)
[0m10:05:27.825842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_o0af, now list_dev_o0af_dbt)
[0m10:05:27.834120 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m10:05:27.836295 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m10:05:27.836712 [debug] [ThreadPool]: On list_dev_o0af_finance: BEGIN
[0m10:05:27.837008 [debug] [ThreadPool]: On list_dev_o0af_dbt: BEGIN
[0m10:05:27.837282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:05:27.837541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:05:28.972241 [debug] [ThreadPool]: SQL status: BEGIN in 1.135 seconds
[0m10:05:28.972873 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m10:05:28.973253 [debug] [ThreadPool]: On list_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_finance"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m10:05:29.020575 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.046 seconds
[0m10:05:29.022357 [debug] [ThreadPool]: On list_dev_o0af_finance: ROLLBACK
[0m10:05:29.069995 [debug] [ThreadPool]: On list_dev_o0af_finance: Close
[0m10:05:29.529530 [debug] [ThreadPool]: SQL status: BEGIN in 1.692 seconds
[0m10:05:29.530826 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m10:05:29.531821 [debug] [ThreadPool]: On list_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_dbt"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:05:29.582932 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.050 seconds
[0m10:05:29.586411 [debug] [ThreadPool]: On list_dev_o0af_dbt: ROLLBACK
[0m10:05:29.630614 [debug] [ThreadPool]: On list_dev_o0af_dbt: Close
[0m10:05:29.643339 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:29.643941 [debug] [MainThread]: On master: BEGIN
[0m10:05:29.644267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:05:30.266924 [debug] [MainThread]: SQL status: BEGIN in 0.622 seconds
[0m10:05:30.267873 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:30.268570 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:05:30.324104 [debug] [MainThread]: SQL status: SELECT 3 in 0.055 seconds
[0m10:05:30.327000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dfe340>]}
[0m10:05:30.327691 [debug] [MainThread]: On master: ROLLBACK
[0m10:05:30.370911 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:30.371378 [debug] [MainThread]: On master: BEGIN
[0m10:05:30.471048 [debug] [MainThread]: SQL status: BEGIN in 0.099 seconds
[0m10:05:30.472435 [debug] [MainThread]: On master: COMMIT
[0m10:05:30.473445 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:30.474263 [debug] [MainThread]: On master: COMMIT
[0m10:05:30.518213 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m10:05:30.519192 [debug] [MainThread]: On master: Close
[0m10:05:30.526263 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m10:05:30.526921 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_clean
[0m10:05:30.527507 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_geom
[0m10:05:30.528004 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_concurrency
[0m10:05:30.528686 [info ] [Thread-1 (]: 1 of 17 START sql table model dbt.companies .................................... [RUN]
[0m10:05:30.529292 [info ] [Thread-2 (]: 2 of 17 START sql incremental model dbt.events_clean ........................... [RUN]
[0m10:05:30.529951 [info ] [Thread-4 (]: 4 of 17 START sql table model dbt.trips_geom ................................... [RUN]
[0m10:05:30.530600 [info ] [Thread-3 (]: 3 of 17 START sql table model dbt.trips_concurrency ............................ [RUN]
[0m10:05:30.531279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_o0af_finance, now model.dbt_scooters.companies)
[0m10:05:30.531800 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_o0af_dbt, now model.dbt_scooters.events_clean)
[0m10:05:30.532357 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m10:05:30.532889 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_concurrency'
[0m10:05:30.533331 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m10:05:30.533740 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_clean
[0m10:05:30.534088 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_geom
[0m10:05:30.534421 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m10:05:30.544219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m10:05:30.553281 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m10:05:30.555107 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m10:05:30.557650 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m10:05:30.558716 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_geom
[0m10:05:30.559029 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_clean
[0m10:05:30.581254 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m10:05:30.623665 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:05:30.623946 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m10:05:30.624142 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m10:05:30.624341 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp100530621521"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_o0af"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_o0af"."dbt"."events_clean")
    

  );
  
  
[0m10:05:30.625831 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m10:05:30.626963 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m10:05:30.627129 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:05:30.627302 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:05:30.627588 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m10:05:30.627729 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:05:30.627956 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:05:30.628104 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m10:05:30.628225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:05:30.628368 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:05:30.628550 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m10:05:30.628674 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:05:31.294745 [debug] [Thread-4 (]: SQL status: BEGIN in 0.666 seconds
[0m10:05:31.295957 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:05:31.296713 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  
    

  create  table "dev_o0af"."dbt"."trips_geom__dbt_tmp"
  
  
    as
  
  (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_o0af"."scooters_raw"."trips"
  );
  
[0m10:05:31.353737 [debug] [Thread-3 (]: SQL status: BEGIN in 0.725 seconds
[0m10:05:31.354808 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:05:31.355559 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

  
    

  create  table "dev_o0af"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_o0af"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
[0m10:05:31.494400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.866 seconds
[0m10:05:31.496217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:05:31.497315 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_o0af"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_o0af"."dbt"."scooters"
group by
    1
  );
  
[0m10:05:31.578254 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.080 seconds
[0m10:05:31.594405 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:05:31.594989 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_o0af"."dbt"."companies" rename to "companies__dbt_backup"
[0m10:05:31.639583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m10:05:31.645614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:05:31.646328 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_o0af"."dbt"."companies__dbt_tmp" rename to "companies"
[0m10:05:31.778170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.131 seconds
[0m10:05:31.801365 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m10:05:31.801872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:05:31.802190 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m10:05:31.886209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.083 seconds
[0m10:05:31.895037 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."companies__dbt_backup"
[0m10:05:31.900791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:05:31.901248 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_o0af"."dbt"."companies__dbt_backup" cascade
[0m10:05:32.781888 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.880 seconds
[0m10:05:32.786824 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m10:05:32.791064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113880a10>]}
[0m10:05:32.792078 [info ] [Thread-1 (]: 1 of 17 OK created sql table model dbt.companies ............................... [[32mSELECT 6[0m in 2.26s]
[0m10:05:32.792835 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m10:05:32.793360 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_prep
[0m10:05:32.794099 [info ] [Thread-1 (]: 5 of 17 START sql view model dbt.trips_prep .................................... [RUN]
[0m10:05:32.794946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.trips_prep)
[0m10:05:32.795703 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_prep
[0m10:05:32.801018 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m10:05:32.802642 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_prep
[0m10:05:32.819041 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m10:05:32.819694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:05:32.819932 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m10:05:32.820139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:05:33.743101 [debug] [Thread-3 (]: SQL status: SELECT 10 in 2.387 seconds
[0m10:05:33.745768 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:05:33.746085 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_o0af"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m10:05:33.877011 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.130 seconds
[0m10:05:33.885795 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:05:33.886522 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_o0af"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m10:05:33.979435 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m10:05:33.983899 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m10:05:33.984592 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:05:33.985138 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m10:05:34.578590 [debug] [Thread-3 (]: SQL status: COMMIT in 0.593 seconds
[0m10:05:34.583737 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_concurrency__dbt_backup"
[0m10:05:34.584616 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:05:34.585067 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_o0af"."dbt"."trips_concurrency__dbt_backup" cascade
[0m10:05:34.676176 [debug] [Thread-1 (]: SQL status: BEGIN in 1.856 seconds
[0m10:05:34.677474 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:05:34.678629 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_o0af"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,

    date(started_at at time zone 'Europe/Moscow')
 as "date" 
from
"dev_o0af"."scooters_raw"."trips"
  );
[0m10:05:34.775999 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.190 seconds
[0m10:05:34.780454 [debug] [Thread-3 (]: On model.dbt_scooters.trips_concurrency: Close
[0m10:05:34.782025 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c47490>]}
[0m10:05:34.782979 [info ] [Thread-3 (]: 3 of 17 OK created sql table model dbt.trips_concurrency ....................... [[32mSELECT 10[0m in 4.25s]
[0m10:05:34.783722 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m10:05:34.784257 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m10:05:34.784916 [info ] [Thread-3 (]: 6 of 17 START sql table model dbt.trips_stat_daily ............................. [RUN]
[0m10:05:34.785522 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.trips_stat_daily)
[0m10:05:34.785967 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m10:05:34.788024 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m10:05:34.789082 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m10:05:34.793877 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m10:05:34.795164 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:05:34.795527 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m10:05:34.796005 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:05:34.874851 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.195 seconds
[0m10:05:34.879318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:05:34.879813 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_o0af"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m10:05:34.976676 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.096 seconds
[0m10:05:34.983659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:05:34.984181 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_o0af"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m10:05:35.076228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m10:05:35.080741 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m10:05:35.081379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:05:35.081816 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m10:05:35.278001 [debug] [Thread-1 (]: SQL status: COMMIT in 0.195 seconds
[0m10:05:35.283834 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."trips_prep__dbt_backup"
[0m10:05:35.287977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:05:35.288397 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_o0af"."dbt"."trips_prep__dbt_backup" cascade
[0m10:05:35.380851 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.092 seconds
[0m10:05:35.384972 [debug] [Thread-1 (]: On model.dbt_scooters.trips_prep: Close
[0m10:05:35.386597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113939630>]}
[0m10:05:35.387776 [info ] [Thread-1 (]: 5 of 17 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 2.59s]
[0m10:05:35.388783 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_prep
[0m10:05:35.389930 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies_trips
[0m10:05:35.390730 [info ] [Thread-1 (]: 7 of 17 START sql table model dbt.companies_trips .............................. [RUN]
[0m10:05:35.391498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.companies_trips)
[0m10:05:35.392000 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies_trips
[0m10:05:35.396625 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m10:05:35.399339 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies_trips
[0m10:05:35.403709 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m10:05:35.404531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:05:35.404855 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m10:05:35.405150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:05:35.876395 [debug] [Thread-3 (]: SQL status: BEGIN in 1.080 seconds
[0m10:05:35.878216 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:05:35.879422 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_o0af"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
  
[0m10:05:37.676462 [debug] [Thread-4 (]: SQL status: SELECT 105901 in 6.378 seconds
[0m10:05:37.678184 [debug] [Thread-1 (]: SQL status: BEGIN in 2.273 seconds
[0m10:05:37.684792 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:05:37.685433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:05:37.685925 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_o0af"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m10:05:37.686463 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_o0af"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_o0af"."dbt"."trips_prep" as t
        join "dev_o0af"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_o0af"."dbt"."companies" as c
        using (company)
  );
  
[0m10:05:37.878545 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.191 seconds
[0m10:05:37.881187 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m10:05:37.881702 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:05:37.882118 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m10:05:37.976620 [debug] [Thread-4 (]: SQL status: COMMIT in 0.094 seconds
[0m10:05:37.983320 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."trips_geom__dbt_backup"
[0m10:05:37.984265 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:05:37.984716 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop table if exists "dev_o0af"."dbt"."trips_geom__dbt_backup" cascade
[0m10:05:38.081189 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.096 seconds
[0m10:05:38.083259 [debug] [Thread-4 (]: On model.dbt_scooters.trips_geom: Close
[0m10:05:38.084545 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e44750>]}
[0m10:05:38.085657 [info ] [Thread-4 (]: 4 of 17 OK created sql table model dbt.trips_geom .............................. [[32mSELECT 105901[0m in 7.55s]
[0m10:05:38.086613 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_geom
[0m10:05:38.087270 [debug] [Thread-4 (]: Began running node model.dbt_scooters.revenue_daily
[0m10:05:38.088164 [info ] [Thread-4 (]: 8 of 17 START sql incremental model finance.revenue_daily ...................... [RUN]
[0m10:05:38.089103 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.revenue_daily)
[0m10:05:38.089642 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m10:05:38.095002 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m10:05:38.096738 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.revenue_daily
[0m10:05:38.101389 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m10:05:38.102434 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:05:38.102806 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m10:05:38.103134 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:05:38.781599 [debug] [Thread-2 (]: SQL status: SELECT 101377 in 8.154 seconds
[0m10:05:38.796015 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:05:38.796419 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: BEGIN
[0m10:05:38.875137 [debug] [Thread-2 (]: SQL status: BEGIN in 0.078 seconds
[0m10:05:38.876280 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:05:38.877013 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp100530621521'
        
      order by ordinal_position

  
[0m10:05:39.678686 [debug] [Thread-3 (]: SQL status: SELECT 91 in 3.798 seconds
[0m10:05:39.680313 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.802 seconds
[0m10:05:39.681432 [debug] [Thread-4 (]: SQL status: BEGIN in 1.578 seconds
[0m10:05:39.686485 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:05:39.693570 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:05:39.694107 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:05:39.694453 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_o0af"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m10:05:39.694794 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:05:39.695122 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_o0af"."finance"."revenue_daily"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_o0af"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
  );
  
  
[0m10:05:39.777213 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.081 seconds
[0m10:05:39.782185 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:05:39.782990 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_o0af"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m10:05:39.878960 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m10:05:39.882093 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m10:05:39.882808 [debug] [Thread-1 (]: SQL status: SELECT 6 in 2.196 seconds
[0m10:05:39.883310 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.188 seconds
[0m10:05:39.883815 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:05:39.893731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:05:39.907481 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m10:05:39.908866 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:05:39.909207 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_o0af"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m10:05:39.909609 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp100530621521'
        
      order by ordinal_position

  
[0m10:05:39.975052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.065 seconds
[0m10:05:39.979459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:05:39.979956 [debug] [Thread-3 (]: SQL status: COMMIT in 0.070 seconds
[0m10:05:39.980387 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_o0af"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m10:05:39.983136 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_stat_daily__dbt_backup"
[0m10:05:39.984089 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:05:39.984577 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_o0af"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m10:05:40.028067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m10:05:40.031148 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m10:05:40.031837 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.047 seconds
[0m10:05:40.032532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:05:40.035107 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m10:05:40.035808 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m10:05:40.037319 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138a77e0>]}
[0m10:05:40.038298 [info ] [Thread-3 (]: 6 of 17 OK created sql table model dbt.trips_stat_daily ........................ [[32mSELECT 91[0m in 5.25s]
[0m10:05:40.039052 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m10:05:40.039558 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat
[0m10:05:40.040144 [info ] [Thread-3 (]: 9 of 17 START sql table model dbt.trips_stat ................................... [RUN]
[0m10:05:40.040690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.trips_stat)
[0m10:05:40.041091 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat
[0m10:05:40.044632 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m10:05:40.045560 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat
[0m10:05:40.049439 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m10:05:40.050168 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:05:40.050484 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m10:05:40.050766 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:05:40.078077 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.168 seconds
[0m10:05:40.080804 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:05:40.081129 [debug] [Thread-1 (]: SQL status: COMMIT in 0.045 seconds
[0m10:05:40.081406 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:05:40.083019 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."companies_trips__dbt_backup"
[0m10:05:40.083474 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:05:40.083752 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_o0af"."dbt"."companies_trips__dbt_backup" cascade
[0m10:05:40.179662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.095 seconds
[0m10:05:40.182479 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: Close
[0m10:05:40.182934 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.100 seconds
[0m10:05:40.190390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139abb90>]}
[0m10:05:40.193645 [debug] [Thread-2 (]: 
    In "dev_o0af"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:05:40.194258 [info ] [Thread-1 (]: 7 of 17 OK created sql table model dbt.companies_trips ......................... [[32mSELECT 6[0m in 4.80s]
[0m10:05:40.205952 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m10:05:40.206434 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies_trips
[0m10:05:40.206842 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_users
[0m10:05:40.207256 [info ] [Thread-1 (]: 10 of 17 START sql incremental model dbt.trips_users ........................... [RUN]
[0m10:05:40.207563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_users)
[0m10:05:40.207770 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_users
[0m10:05:40.210049 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m10:05:40.210469 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:05:40.210728 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        delete from "dev_o0af"."dbt"."events_clean" as DBT_INTERNAL_DEST
        where (user_id, timestamp, type_id) in (
            select distinct user_id, timestamp, type_id
            from "events_clean__dbt_tmp100530621521" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_o0af"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp100530621521"
    )
  
[0m10:05:40.210961 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_users
[0m10:05:40.213022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:05:40.213271 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp100540212162"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_o0af"."dbt"."trips_prep" as t
left join
    "dev_o0af"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_o0af"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m10:05:40.213476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:05:41.175312 [debug] [Thread-3 (]: SQL status: BEGIN in 1.124 seconds
[0m10:05:41.176915 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:05:41.178024 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_o0af"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_o0af"."dbt"."trips_prep"
  );
  
[0m10:05:44.802988 [debug] [Thread-3 (]: SQL status: SELECT 1 in 3.624 seconds
[0m10:05:44.809768 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:05:44.810344 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_o0af"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m10:05:44.977620 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.166 seconds
[0m10:05:44.984397 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:05:44.984910 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_o0af"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m10:05:45.077074 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m10:05:45.081399 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m10:05:45.081976 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:05:45.082414 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m10:05:45.184733 [debug] [Thread-3 (]: SQL status: COMMIT in 0.101 seconds
[0m10:05:45.191657 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_stat__dbt_backup"
[0m10:05:45.192353 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:05:45.192723 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_o0af"."dbt"."trips_stat__dbt_backup" cascade
[0m10:05:45.278793 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.085 seconds
[0m10:05:45.281988 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: Close
[0m10:05:45.283455 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11388d1f0>]}
[0m10:05:45.284337 [info ] [Thread-3 (]: 9 of 17 OK created sql table model dbt.trips_stat .............................. [[32mSELECT 1[0m in 5.24s]
[0m10:05:45.284966 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat
[0m10:05:45.285369 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m10:05:45.285976 [info ] [Thread-3 (]: 11 of 17 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m10:05:45.286580 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.parking_finish_stat)
[0m10:05:45.287016 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m10:05:45.292655 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m10:05:45.294626 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m10:05:45.298499 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m10:05:45.299938 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:05:45.300381 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m10:05:45.302051 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:05:45.378354 [debug] [Thread-4 (]: SQL status: SELECT 91 in 5.683 seconds
[0m10:05:45.387415 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:05:45.387698 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

        
            grant select on "dev_o0af"."finance"."revenue_daily" to finance;
        
    
[0m10:05:45.477908 [debug] [Thread-4 (]: Postgres adapter: Postgres error: role "finance" does not exist

[0m10:05:45.478351 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: ROLLBACK
[0m10:05:45.576970 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: Close
[0m10:05:45.595393 [debug] [Thread-4 (]: Database Error in model revenue_daily (models/finance/revenue_daily.sql)
  role "finance" does not exist
  compiled code at target/run/dbt_scooters/models/finance/revenue_daily.sql
[0m10:05:45.596008 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11396f530>]}
[0m10:05:45.596665 [error] [Thread-4 (]: 8 of 17 ERROR creating sql incremental model finance.revenue_daily ............. [[31mERROR[0m in 7.51s]
[0m10:05:45.597198 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.revenue_daily
[0m10:05:45.597556 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_start_stat
[0m10:05:45.598065 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.revenue_daily' to be skipped because of status 'error'.  Reason: Database Error in model revenue_daily (models/finance/revenue_daily.sql)
  role "finance" does not exist
  compiled code at target/run/dbt_scooters/models/finance/revenue_daily.sql.
[0m10:05:45.598583 [info ] [Thread-4 (]: 12 of 17 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m10:05:45.599772 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.parking_start_stat)
[0m10:05:45.600121 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m10:05:45.602769 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m10:05:45.603652 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m10:05:45.606776 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m10:05:45.607370 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:05:45.607615 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m10:05:45.607827 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:05:46.079888 [debug] [Thread-1 (]: SQL status: SELECT 30901 in 5.866 seconds
[0m10:05:46.086886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:05:46.087843 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: BEGIN
[0m10:05:46.132490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m10:05:46.133216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:05:46.133628 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp100540212162'
        
      order by ordinal_position

  
[0m10:05:46.280758 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.146 seconds
[0m10:05:46.287436 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:05:46.288103 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:05:46.479939 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.191 seconds
[0m10:05:46.486680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:05:46.487112 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp100540212162'
        
      order by ordinal_position

  
[0m10:05:46.675285 [debug] [Thread-3 (]: SQL status: BEGIN in 1.373 seconds
[0m10:05:46.675659 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:05:46.675904 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_o0af"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_o0af"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)
-- group by
--     1


select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_o0af"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m10:05:46.678716 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.191 seconds
[0m10:05:46.681068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:05:46.681378 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:05:46.880591 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.199 seconds
[0m10:05:46.888313 [debug] [Thread-1 (]: 
    In "dev_o0af"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:05:46.898752 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m10:05:46.899916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:05:46.900294 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_o0af"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp100540212162"
    )


  
[0m10:05:46.996056 [debug] [Thread-4 (]: SQL status: BEGIN in 1.388 seconds
[0m10:05:46.996827 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:05:46.997237 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_o0af"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_o0af"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.start_point, 3857), hex.geom)
-- group by
--     1

select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_o0af"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m10:05:48.879645 [debug] [Thread-1 (]: SQL status: INSERT 0 30901 in 1.979 seconds
[0m10:05:48.882104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:05:48.882505 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m10:05:50.983837 [debug] [Thread-2 (]: SQL status: INSERT 0 101377 in 10.772 seconds
[0m10:05:50.986497 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:05:50.987283 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:05:50.987794 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:05:51.078274 [debug] [Thread-2 (]: SQL status: COMMIT in 0.090 seconds
[0m10:05:51.080641 [debug] [Thread-2 (]: On model.dbt_scooters.events_clean: Close
[0m10:05:51.081882 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139aa990>]}
[0m10:05:51.082932 [info ] [Thread-2 (]: 2 of 17 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 101377[0m in 20.55s]
[0m10:05:51.083777 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_clean
[0m10:05:51.084558 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_full
[0m10:05:51.085345 [info ] [Thread-2 (]: 13 of 17 START sql view model dbt.events_full .................................. [RUN]
[0m10:05:51.086040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.events_full)
[0m10:05:51.086600 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_full
[0m10:05:51.091761 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m10:05:51.093458 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_full
[0m10:05:51.098163 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m10:05:51.099255 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:05:51.099652 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: BEGIN
[0m10:05:51.099980 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:05:52.177904 [debug] [Thread-2 (]: SQL status: BEGIN in 1.077 seconds
[0m10:05:52.181321 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:05:52.182065 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_o0af"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_o0af"."dbt"."events_clean"
    left join "dev_o0af"."dbt"."event_types"
        using (type_id)
  );
[0m10:05:52.277745 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.095 seconds
[0m10:05:52.285480 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:05:52.286150 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_o0af"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m10:05:52.379563 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m10:05:52.384625 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:05:52.385319 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_o0af"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m10:05:52.476628 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m10:05:52.480954 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m10:05:52.481711 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:05:52.482181 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m10:05:52.578487 [debug] [Thread-2 (]: SQL status: COMMIT in 0.095 seconds
[0m10:05:52.584138 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."events_full__dbt_backup"
[0m10:05:52.585554 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:05:52.586020 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_o0af"."dbt"."events_full__dbt_backup" cascade
[0m10:05:52.679022 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.092 seconds
[0m10:05:52.683864 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: Close
[0m10:05:52.685351 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11706d2b0>]}
[0m10:05:52.686496 [info ] [Thread-2 (]: 13 of 17 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 1.60s]
[0m10:05:52.687430 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_full
[0m10:05:52.688393 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_stat
[0m10:05:52.689187 [info ] [Thread-2 (]: 14 of 17 START sql table model dbt.events_stat ................................. [RUN]
[0m10:05:52.689898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.events_stat)
[0m10:05:52.690349 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_stat
[0m10:05:52.694225 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m10:05:52.697878 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_stat
[0m10:05:52.702566 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m10:05:52.703608 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:05:52.703947 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: BEGIN
[0m10:05:52.704237 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:05:53.675421 [debug] [Thread-2 (]: SQL status: BEGIN in 0.971 seconds
[0m10:05:53.676029 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:05:53.676425 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_o0af"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_o0af"."dbt"."events_full"
  );
  
[0m10:05:55.077350 [debug] [Thread-1 (]: SQL status: ANALYZE in 6.194 seconds
[0m10:05:55.080875 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m10:05:55.081671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:05:55.082265 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m10:05:55.177278 [debug] [Thread-1 (]: SQL status: COMMIT in 0.094 seconds
[0m10:05:55.179429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:05:55.180270 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m10:05:55.275445 [debug] [Thread-1 (]: SQL status: COMMIT in 0.095 seconds
[0m10:05:55.276960 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:05:55.277360 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m10:05:55.379863 [debug] [Thread-1 (]: SQL status: VACUUM in 0.102 seconds
[0m10:05:55.383021 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: Close
[0m10:05:55.384035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11396c290>]}
[0m10:05:55.384945 [info ] [Thread-1 (]: 10 of 17 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 30901[0m in 15.18s]
[0m10:05:55.385774 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_users
[0m10:05:55.386541 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_daily
[0m10:05:55.387107 [info ] [Thread-1 (]: 15 of 17 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m10:05:55.387584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily)
[0m10:05:55.387880 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m10:05:55.395566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m10:05:55.397081 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m10:05:55.399010 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m10:05:55.399390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:05:55.399537 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m10:05:55.399667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:05:56.479643 [debug] [Thread-2 (]: SQL status: SELECT 1 in 2.802 seconds
[0m10:05:56.486449 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:05:56.487161 [debug] [Thread-1 (]: SQL status: BEGIN in 1.087 seconds
[0m10:05:56.487783 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_o0af"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m10:05:56.488450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:05:56.488969 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_o0af"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m10:05:56.577649 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m10:05:56.583616 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:05:56.584203 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_o0af"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m10:05:56.682777 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.098 seconds
[0m10:05:56.686214 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: COMMIT
[0m10:05:56.687046 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:05:56.687695 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: COMMIT
[0m10:05:56.775886 [debug] [Thread-2 (]: SQL status: COMMIT in 0.087 seconds
[0m10:05:56.781024 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."events_stat__dbt_backup"
[0m10:05:56.782335 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:05:56.783193 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_o0af"."dbt"."events_stat__dbt_backup" cascade
[0m10:05:56.887793 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.104 seconds
[0m10:05:56.891529 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: Close
[0m10:05:56.893393 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bb7ef0>]}
[0m10:05:56.894782 [info ] [Thread-2 (]: 14 of 17 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 4.20s]
[0m10:05:56.895964 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_stat
[0m10:05:56.896744 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m10:05:56.897650 [info ] [Thread-2 (]: 16 of 17 START sql table model dbt.trips_age_group ............................. [RUN]
[0m10:05:56.898417 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now model.dbt_scooters.trips_age_group)
[0m10:05:56.898924 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m10:05:56.905303 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m10:05:56.906524 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m10:05:56.910113 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m10:05:56.910863 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:05:56.911183 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m10:05:56.911475 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:05:58.277500 [debug] [Thread-2 (]: SQL status: BEGIN in 1.366 seconds
[0m10:05:58.278047 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:05:58.278444 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_o0af"."dbt"."trips_users" as tu
    cross join "dev_o0af"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m10:06:00.382508 [debug] [Thread-1 (]: SQL status: SELECT 7049 in 3.893 seconds
[0m10:06:00.389774 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:06:00.390416 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_o0af"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m10:06:00.477316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.086 seconds
[0m10:06:00.481278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:06:00.481938 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_o0af"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m10:06:00.576968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m10:06:00.580140 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m10:06:00.580912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:06:00.581494 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m10:06:00.625431 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m10:06:00.629079 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_daily__dbt_backup"
[0m10:06:00.629798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:06:00.630218 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_o0af"."dbt"."trips_age_daily__dbt_backup" cascade
[0m10:06:00.678214 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.047 seconds
[0m10:06:00.681834 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily: Close
[0m10:06:00.683028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c10170>]}
[0m10:06:00.684092 [info ] [Thread-1 (]: 15 of 17 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 5.30s]
[0m10:06:00.685040 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m10:06:00.685946 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m10:06:00.686593 [info ] [Thread-1 (]: 17 of 17 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m10:06:00.687056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now model.dbt_scooters.trips_age_daily_stat)
[0m10:06:00.687393 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m10:06:00.692077 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m10:06:00.693298 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m10:06:00.697499 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m10:06:00.698673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:06:00.699081 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m10:06:00.699423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:06:02.577267 [debug] [Thread-1 (]: SQL status: BEGIN in 1.877 seconds
[0m10:06:02.578479 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:06:02.578936 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_o0af"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m10:06:03.377084 [debug] [Thread-2 (]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m10:06:03.378034 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: ROLLBACK
[0m10:06:03.383031 [debug] [Thread-2 (]: Failed to rollback 'model.dbt_scooters.trips_age_group'
[0m10:06:03.383980 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m10:06:03.389375 [debug] [Thread-2 (]: Database Error in model trips_age_group (models/trips_age_group.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/trips_age_group.sql
[0m10:06:03.390017 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bb7ef0>]}
[0m10:06:03.390818 [error] [Thread-2 (]: 16 of 17 ERROR creating sql table model dbt.trips_age_group .................... [[31mERROR[0m in 6.49s]
[0m10:06:03.391414 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m10:06:03.392008 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_age_group' to be skipped because of status 'error'.  Reason: Database Error in model trips_age_group (models/trips_age_group.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/trips_age_group.sql.
[0m10:06:03.579532 [debug] [Thread-1 (]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m10:06:03.580293 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: ROLLBACK
[0m10:06:03.581524 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_scooters.trips_age_daily_stat'
[0m10:06:03.581980 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m10:06:03.587149 [debug] [Thread-1 (]: Database Error in model trips_age_daily_stat (models/trips_age_daily_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/trips_age_daily_stat.sql
[0m10:06:03.587854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c10170>]}
[0m10:06:03.588774 [error] [Thread-1 (]: 17 of 17 ERROR creating sql table model dbt.trips_age_daily_stat ............... [[31mERROR[0m in 2.90s]
[0m10:06:03.589447 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m10:06:03.590013 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_age_daily_stat' to be skipped because of status 'error'.  Reason: Database Error in model trips_age_daily_stat (models/trips_age_daily_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/trips_age_daily_stat.sql.
[0m10:06:03.676110 [debug] [Thread-3 (]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m10:06:03.676663 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: ROLLBACK
[0m10:06:03.677691 [debug] [Thread-3 (]: Failed to rollback 'model.dbt_scooters.parking_finish_stat'
[0m10:06:03.678077 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m10:06:03.681206 [debug] [Thread-3 (]: Database Error in model parking_finish_stat (models/parking_finish_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/parking_finish_stat.sql
[0m10:06:03.681567 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139c1550>]}
[0m10:06:03.682002 [error] [Thread-3 (]: 11 of 17 ERROR creating sql table model dbt.parking_finish_stat ................ [[31mERROR[0m in 18.40s]
[0m10:06:03.682372 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m10:06:03.682756 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.parking_finish_stat' to be skipped because of status 'error'.  Reason: Database Error in model parking_finish_stat (models/parking_finish_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/parking_finish_stat.sql.
[0m10:06:03.783975 [debug] [Thread-4 (]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m10:06:03.784385 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: ROLLBACK
[0m10:06:03.785319 [debug] [Thread-4 (]: Failed to rollback 'model.dbt_scooters.parking_start_stat'
[0m10:06:03.785704 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: Close
[0m10:06:03.788836 [debug] [Thread-4 (]: Database Error in model parking_start_stat (models/parking_start_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/parking_start_stat.sql
[0m10:06:03.789166 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd909ab7-a89c-42cf-9990-7ae736495f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139c1370>]}
[0m10:06:03.789616 [error] [Thread-4 (]: 12 of 17 ERROR creating sql table model dbt.parking_start_stat ................. [[31mERROR[0m in 18.19s]
[0m10:06:03.790011 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m10:06:03.790351 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.parking_start_stat' to be skipped because of status 'error'.  Reason: Database Error in model parking_start_stat (models/parking_start_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/parking_start_stat.sql.
[0m10:06:03.791457 [info ] [MainThread]: 
[0m10:06:03.791845 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:03.792086 [debug] [MainThread]: On master: BEGIN
[0m10:06:03.792297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:06:04.263250 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dpg-d2pv24mr433s73dnd4e0-a.frankfurt-postgres.render.com" (18.196.138.205), port 5432 failed: SSL connection has been closed unexpectedly

[0m10:06:04.736141 [debug] [MainThread]: Postgres adapter: Error running SQL: BEGIN
[0m10:06:04.737029 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:06:04.737489 [debug] [MainThread]: On master: No close available on handle
[0m10:06:04.747184 [info ] [MainThread]: 
[0m10:06:04.747755 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m10:06:04.748326 [info ] [MainThread]: 
[0m10:06:04.748835 [error] [MainThread]: [31mFailure in model revenue_daily (models/finance/revenue_daily.sql)[0m
[0m10:06:04.749243 [error] [MainThread]:   Database Error in model revenue_daily (models/finance/revenue_daily.sql)
  role "finance" does not exist
  compiled code at target/run/dbt_scooters/models/finance/revenue_daily.sql
[0m10:06:04.749526 [info ] [MainThread]: 
[0m10:06:04.749870 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/finance/revenue_daily.sql
[0m10:06:04.750148 [info ] [MainThread]: 
[0m10:06:04.750485 [error] [MainThread]: [31mFailure in model trips_age_group (models/trips_age_group.sql)[0m
[0m10:06:04.750830 [error] [MainThread]:   Database Error in model trips_age_group (models/trips_age_group.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/trips_age_group.sql
[0m10:06:04.751090 [info ] [MainThread]: 
[0m10:06:04.751406 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/trips_age_group.sql
[0m10:06:04.751659 [info ] [MainThread]: 
[0m10:06:04.751984 [error] [MainThread]: [31mFailure in model trips_age_daily_stat (models/trips_age_daily_stat.sql)[0m
[0m10:06:04.752323 [error] [MainThread]:   Database Error in model trips_age_daily_stat (models/trips_age_daily_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/trips_age_daily_stat.sql
[0m10:06:04.752581 [info ] [MainThread]: 
[0m10:06:04.752904 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/trips_age_daily_stat.sql
[0m10:06:04.753168 [info ] [MainThread]: 
[0m10:06:04.753494 [error] [MainThread]: [31mFailure in model parking_finish_stat (models/parking_finish_stat.sql)[0m
[0m10:06:04.753819 [error] [MainThread]:   Database Error in model parking_finish_stat (models/parking_finish_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/parking_finish_stat.sql
[0m10:06:04.754075 [info ] [MainThread]: 
[0m10:06:04.754561 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/parking_finish_stat.sql
[0m10:06:04.754851 [info ] [MainThread]: 
[0m10:06:04.755265 [error] [MainThread]: [31mFailure in model parking_start_stat (models/parking_start_stat.sql)[0m
[0m10:06:04.755831 [error] [MainThread]:   Database Error in model parking_start_stat (models/parking_start_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/parking_start_stat.sql
[0m10:06:04.756303 [info ] [MainThread]: 
[0m10:06:04.756680 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/parking_start_stat.sql
[0m10:06:04.756979 [info ] [MainThread]: 
[0m10:06:04.757277 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=17
[0m10:06:04.757661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:06:04.758202 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m10:06:04.758483 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m10:06:04.758712 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m10:06:04.758923 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m10:06:04.759269 [info ] [MainThread]: 
[0m10:06:04.759556 [info ] [MainThread]: Finished running 3 incremental models, 12 table models, 2 view models in 0 hours 0 minutes and 37.78 seconds (37.78s).
[0m10:06:04.760030 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "dpg-d2pv24mr433s73dnd4e0-a.frankfurt-postgres.render.com" (18.196.138.205), port 5432 failed: SSL connection has been closed unexpectedly
  
[0m10:06:04.762791 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 38.098957, "process_in_blocks": "0", "process_kernel_time": 0.251269, "process_mem_max_rss": "141279232", "process_out_blocks": "0", "process_user_time": 1.798237}
[0m10:06:04.763223 [debug] [MainThread]: Command `dbt run` failed at 10:06:04.763134 after 38.10 seconds
[0m10:06:04.763542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e62570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112beda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139c15b0>]}
[0m10:06:04.763832 [debug] [MainThread]: Flushing usage events
[0m10:06:05.477765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:18:54.641921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d1f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125b279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125b27b10>]}


============================== 10:18:54.644956 | c32656c3-5019-4d36-8f15-b6e54aefbe00 ==============================
[0m10:18:54.644956 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:18:54.645270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:18:54.733231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a17490>]}
[0m10:18:54.756581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1259be030>]}
[0m10:18:54.757236 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:18:54.798268 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m10:18:54.862909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:18:54.863107 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:18:54.885568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1269ff050>]}
[0m10:18:54.922901 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:18:54.924059 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:18:54.941051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ca1e50>]}
[0m10:18:54.941257 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 439 macros
[0m10:18:54.942593 [info ] [MainThread]: 
[0m10:18:54.942787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:18:54.942907 [info ] [MainThread]: 
[0m10:18:54.943111 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:18:54.944926 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af'
[0m10:18:54.949931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af'
[0m10:18:54.968713 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af"
[0m10:18:54.968893 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af"
[0m10:18:54.969030 [debug] [ThreadPool]: On list_dev_o0af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af"} */

    select distinct nspname from pg_namespace
  
[0m10:18:54.969154 [debug] [ThreadPool]: On list_dev_o0af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af"} */

    select distinct nspname from pg_namespace
  
[0m10:18:54.969267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:54.969366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:55.678466 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.709 seconds
[0m10:18:55.680087 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.710 seconds
[0m10:18:55.683461 [debug] [ThreadPool]: On list_dev_o0af: Close
[0m10:18:55.685528 [debug] [ThreadPool]: On list_dev_o0af: Close
[0m10:18:55.690654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_o0af, now list_dev_o0af_finance)
[0m10:18:55.697677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_o0af, now list_dev_o0af_dbt)
[0m10:18:55.699655 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m10:18:55.701599 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m10:18:55.701942 [debug] [ThreadPool]: On list_dev_o0af_finance: BEGIN
[0m10:18:55.702200 [debug] [ThreadPool]: On list_dev_o0af_dbt: BEGIN
[0m10:18:55.702459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:55.702699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:56.315098 [debug] [ThreadPool]: SQL status: BEGIN in 0.612 seconds
[0m10:18:56.316594 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m10:18:56.317653 [debug] [ThreadPool]: On list_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_dbt"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:18:56.375215 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.057 seconds
[0m10:18:56.376776 [debug] [ThreadPool]: On list_dev_o0af_dbt: ROLLBACK
[0m10:18:56.419870 [debug] [ThreadPool]: On list_dev_o0af_dbt: Close
[0m10:18:57.248901 [debug] [ThreadPool]: SQL status: BEGIN in 1.546 seconds
[0m10:18:57.250579 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m10:18:57.251723 [debug] [ThreadPool]: On list_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_finance"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m10:18:57.303852 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.051 seconds
[0m10:18:57.307971 [debug] [ThreadPool]: On list_dev_o0af_finance: ROLLBACK
[0m10:18:57.352508 [debug] [ThreadPool]: On list_dev_o0af_finance: Close
[0m10:18:57.369838 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:57.370427 [debug] [MainThread]: On master: BEGIN
[0m10:18:57.370743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:58.842503 [debug] [MainThread]: SQL status: BEGIN in 1.471 seconds
[0m10:18:58.844006 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:58.845184 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:18:58.901974 [debug] [MainThread]: SQL status: SELECT 3 in 0.056 seconds
[0m10:18:58.903310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126cbb5b0>]}
[0m10:18:58.903615 [debug] [MainThread]: On master: ROLLBACK
[0m10:18:58.946695 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:58.946924 [debug] [MainThread]: On master: BEGIN
[0m10:18:59.039358 [debug] [MainThread]: SQL status: BEGIN in 0.092 seconds
[0m10:18:59.040242 [debug] [MainThread]: On master: COMMIT
[0m10:18:59.040796 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:59.041277 [debug] [MainThread]: On master: COMMIT
[0m10:18:59.085137 [debug] [MainThread]: SQL status: COMMIT in 0.043 seconds
[0m10:18:59.086280 [debug] [MainThread]: On master: Close
[0m10:18:59.093740 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m10:18:59.094204 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m10:18:59.094558 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m10:18:59.094897 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m10:18:59.095544 [info ] [Thread-1 (]: 1 of 20 START sql incremental model dbt.events_clean ........................... [RUN]
[0m10:18:59.096092 [info ] [Thread-4 (]: 4 of 20 START sql view model dbt.trips_prep .................................... [RUN]
[0m10:18:59.096791 [info ] [Thread-3 (]: 3 of 20 START sql table model dbt.trips_geom ................................... [RUN]
[0m10:18:59.097644 [info ] [Thread-2 (]: 2 of 20 START sql table model dbt.trips_concurrency ............................ [RUN]
[0m10:18:59.098263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_o0af_finance, now model.dbt_scooters.events_clean)
[0m10:18:59.098800 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_prep'
[0m10:18:59.099248 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m10:18:59.099610 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_o0af_dbt, now model.dbt_scooters.trips_concurrency)
[0m10:18:59.099998 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m10:18:59.100342 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m10:18:59.100623 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m10:18:59.100890 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m10:18:59.143576 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m10:18:59.145955 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m10:18:59.147198 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m10:18:59.149247 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m10:18:59.151259 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m10:18:59.151451 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m10:18:59.151612 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m10:18:59.151749 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m10:18:59.172484 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m10:18:59.172725 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m10:18:59.179594 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m10:18:59.190834 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:18:59.191156 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp101859188795"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_o0af"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_o0af"."dbt"."events_clean")
    

  );
  
  
[0m10:18:59.191369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:59.191821 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:18:59.191979 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:18:59.192128 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m10:18:59.192258 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:18:59.192383 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m10:18:59.192503 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:18:59.192621 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m10:18:59.192734 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:18:59.192909 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:18:59.876820 [debug] [Thread-2 (]: SQL status: BEGIN in 0.683 seconds
[0m10:18:59.878502 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:18:59.879841 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

  
    

  create  table "dev_o0af"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_o0af"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
[0m10:19:00.939540 [debug] [Thread-3 (]: SQL status: BEGIN in 1.746 seconds
[0m10:19:00.941220 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:19:00.942457 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  
    

  create  table "dev_o0af"."dbt"."trips_geom__dbt_tmp"
  
  
    as
  
  (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_o0af"."scooters_raw"."trips"
  );
  
[0m10:19:01.175897 [debug] [Thread-4 (]: SQL status: BEGIN in 1.983 seconds
[0m10:19:01.176275 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:19:01.176564 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_o0af"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,

    date(started_at at time zone 'Europe/Moscow')
 as "date" 
from
"dev_o0af"."scooters_raw"."trips"
  );
[0m10:19:01.280750 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.104 seconds
[0m10:19:01.292021 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:19:01.292618 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_o0af"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m10:19:01.375093 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.082 seconds
[0m10:19:01.383661 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:19:01.384183 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_o0af"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m10:19:01.475734 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m10:19:01.494357 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m10:19:01.494829 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:19:01.495089 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m10:19:01.576506 [debug] [Thread-4 (]: SQL status: COMMIT in 0.081 seconds
[0m10:19:01.587201 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."trips_prep__dbt_backup"
[0m10:19:01.593438 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m10:19:01.593928 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_o0af"."dbt"."trips_prep__dbt_backup" cascade
[0m10:19:01.778788 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.184 seconds
[0m10:19:01.784299 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m10:19:01.788659 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12717b1e0>]}
[0m10:19:01.789735 [info ] [Thread-4 (]: 4 of 20 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 2.69s]
[0m10:19:01.790529 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m10:19:01.790988 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m10:19:01.791680 [info ] [Thread-4 (]: 5 of 20 START sql table model dbt.trips_stat_daily ............................. [RUN]
[0m10:19:01.792403 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.trips_stat_daily)
[0m10:19:01.792818 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m10:19:01.795087 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m10:19:01.795826 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m10:19:01.798575 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m10:19:01.799172 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:19:01.799422 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m10:19:01.799657 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:19:02.979735 [debug] [Thread-1 (]: SQL status: SELECT 0 in 3.788 seconds
[0m10:19:03.000900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:19:03.001344 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m10:19:03.076984 [debug] [Thread-2 (]: SQL status: SELECT 10 in 3.196 seconds
[0m10:19:03.078606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m10:19:03.091298 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:19:03.091902 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:19:03.092305 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp101859188795'
        
      order by ordinal_position

  
[0m10:19:03.092737 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_o0af"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m10:19:03.278525 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.185 seconds
[0m10:19:03.285724 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:19:03.286346 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_o0af"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m10:19:03.374532 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.087 seconds
[0m10:19:03.379088 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m10:19:03.379877 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:19:03.380465 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m10:19:03.482994 [debug] [Thread-2 (]: SQL status: COMMIT in 0.102 seconds
[0m10:19:03.484528 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.391 seconds
[0m10:19:03.489232 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."trips_concurrency__dbt_backup"
[0m10:19:03.495545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:19:03.498482 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m10:19:03.498848 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:19:03.499180 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_o0af"."dbt"."trips_concurrency__dbt_backup" cascade
[0m10:19:03.580311 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.080 seconds
[0m10:19:03.583901 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m10:19:03.585689 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ccef90>]}
[0m10:19:03.586572 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.087 seconds
[0m10:19:03.587817 [info ] [Thread-2 (]: 2 of 20 OK created sql table model dbt.trips_concurrency ....................... [[32mSELECT 10[0m in 4.49s]
[0m10:19:03.601603 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m10:19:03.605556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:19:03.605938 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m10:19:03.606298 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp101859188795'
        
      order by ordinal_position

  
[0m10:19:03.606684 [info ] [Thread-2 (]: 6 of 20 START seed file dbt.age_groups ......................................... [RUN]
[0m10:19:03.607134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now seed.dbt_scooters.age_groups)
[0m10:19:03.607404 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m10:19:03.607913 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m10:19:03.618631 [debug] [Thread-4 (]: SQL status: BEGIN in 1.819 seconds
[0m10:19:03.618950 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:19:03.623782 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:19:03.624051 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_o0af"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
  
[0m10:19:03.624380 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m10:19:03.624709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:19:03.778841 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.171 seconds
[0m10:19:03.785964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:19:03.786501 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:19:03.882364 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.095 seconds
[0m10:19:03.891925 [debug] [Thread-1 (]: 
    In "dev_o0af"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:19:03.902417 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m10:19:03.903219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:19:03.903479 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        delete from "dev_o0af"."dbt"."events_clean" as DBT_INTERNAL_DEST
        where (user_id, timestamp, type_id) in (
            select distinct user_id, timestamp, type_id
            from "events_clean__dbt_tmp101859188795" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_o0af"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp101859188795"
    )
  
[0m10:19:04.098862 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.195 seconds
[0m10:19:04.104172 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:19:04.105028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m10:19:04.105624 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m10:19:04.278863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.172 seconds
[0m10:19:04.281319 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m10:19:04.282827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d1de90>]}
[0m10:19:04.283799 [info ] [Thread-1 (]: 1 of 20 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 5.18s]
[0m10:19:04.284531 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m10:19:04.285083 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.event_types
[0m10:19:04.285737 [info ] [Thread-1 (]: 7 of 20 START seed file dbt.event_types ........................................ [RUN]
[0m10:19:04.286353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now seed.dbt_scooters.event_types)
[0m10:19:04.286757 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.event_types
[0m10:19:04.287138 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.event_types
[0m10:19:04.294328 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:19:04.294846 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: BEGIN
[0m10:19:04.295198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:04.676003 [debug] [Thread-2 (]: SQL status: BEGIN in 1.051 seconds
[0m10:19:04.677777 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:19:04.678557 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_o0af"."dbt"."age_groups"
[0m10:19:04.776651 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.097 seconds
[0m10:19:04.801849 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:19:04.802328 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_o0af"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m10:19:04.977697 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.175 seconds
[0m10:19:04.987944 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m10:19:04.991872 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m10:19:04.992324 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m10:19:04.992661 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m10:19:05.176515 [debug] [Thread-2 (]: SQL status: COMMIT in 0.183 seconds
[0m10:19:05.179856 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m10:19:05.181745 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127196850>]}
[0m10:19:05.182618 [info ] [Thread-2 (]: 6 of 20 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 1.57s]
[0m10:19:05.183335 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m10:19:05.183831 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.scooters
[0m10:19:05.184586 [info ] [Thread-2 (]: 8 of 20 START seed file dbt.scooters ........................................... [RUN]
[0m10:19:05.185293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now seed.dbt_scooters.scooters)
[0m10:19:05.185756 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.scooters
[0m10:19:05.186138 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.scooters
[0m10:19:05.195209 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:19:05.195695 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: BEGIN
[0m10:19:05.196013 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:19:05.476204 [debug] [Thread-4 (]: SQL status: SELECT 91 in 1.851 seconds
[0m10:19:05.483173 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:19:05.483683 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_o0af"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m10:19:05.574822 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m10:19:05.583805 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:19:05.584359 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_o0af"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m10:19:05.630441 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m10:19:05.633334 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m10:19:05.634047 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:19:05.634577 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m10:19:05.774425 [debug] [Thread-4 (]: SQL status: COMMIT in 0.139 seconds
[0m10:19:05.781327 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."trips_stat_daily__dbt_backup"
[0m10:19:05.782259 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m10:19:05.782731 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_o0af"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m10:19:05.968455 [debug] [Thread-1 (]: SQL status: BEGIN in 1.673 seconds
[0m10:19:05.969983 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:19:05.971177 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_o0af"."dbt"."event_types"
[0m10:19:05.976124 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.193 seconds
[0m10:19:05.978896 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m10:19:05.980376 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1270321d0>]}
[0m10:19:05.981324 [info ] [Thread-4 (]: 5 of 20 OK created sql table model dbt.trips_stat_daily ........................ [[32mSELECT 91[0m in 4.19s]
[0m10:19:05.982053 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m10:19:05.982519 [debug] [Thread-4 (]: Began running node model.dbt_scooters.revenue_daily
[0m10:19:05.983106 [info ] [Thread-4 (]: 9 of 20 START sql incremental model finance.revenue_daily ...................... [RUN]
[0m10:19:05.983687 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now model.dbt_scooters.revenue_daily)
[0m10:19:05.984101 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m10:19:05.988764 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m10:19:05.990963 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.revenue_daily
[0m10:19:05.995198 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m10:19:05.996608 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:19:05.996944 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m10:19:05.997230 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:19:06.024708 [debug] [Thread-2 (]: SQL status: BEGIN in 0.829 seconds
[0m10:19:06.025071 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:19:06.025412 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_o0af"."dbt"."scooters"
[0m10:19:06.074775 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.049 seconds
[0m10:19:06.081741 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:19:06.082232 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.110 seconds
[0m10:19:06.082682 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_o0af"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m10:19:06.085483 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:19:06.086231 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_o0af"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m10:19:06.174586 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.088 seconds
[0m10:19:06.174940 [debug] [Thread-2 (]: SQL status: INSERT 0 10 in 0.089 seconds
[0m10:19:06.175474 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m10:19:06.175923 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m10:19:06.177497 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: COMMIT
[0m10:19:06.177742 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m10:19:06.178548 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: COMMIT
[0m10:19:06.178782 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: COMMIT
[0m10:19:06.179027 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m10:19:06.179273 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: COMMIT
[0m10:19:06.276569 [debug] [Thread-3 (]: SQL status: SELECT 105901 in 5.333 seconds
[0m10:19:06.281104 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:19:06.281649 [debug] [Thread-1 (]: SQL status: COMMIT in 0.102 seconds
[0m10:19:06.282039 [debug] [Thread-2 (]: SQL status: COMMIT in 0.103 seconds
[0m10:19:06.282396 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_o0af"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m10:19:06.283199 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: Close
[0m10:19:06.283888 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: Close
[0m10:19:06.284719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f90e50>]}
[0m10:19:06.285228 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271fb7e0>]}
[0m10:19:06.285733 [info ] [Thread-1 (]: 7 of 20 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 2.00s]
[0m10:19:06.286202 [info ] [Thread-2 (]: 8 of 20 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 1.10s]
[0m10:19:06.286725 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.event_types
[0m10:19:06.287169 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.scooters
[0m10:19:06.287516 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_stat
[0m10:19:06.287907 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_users
[0m10:19:06.288452 [info ] [Thread-1 (]: 10 of 20 START sql table model dbt.trips_stat .................................. [RUN]
[0m10:19:06.288958 [info ] [Thread-2 (]: 11 of 20 START sql incremental model dbt.trips_users ........................... [RUN]
[0m10:19:06.289350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now model.dbt_scooters.trips_stat)
[0m10:19:06.289664 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now model.dbt_scooters.trips_users)
[0m10:19:06.289971 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_stat
[0m10:19:06.290252 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_users
[0m10:19:06.292517 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m10:19:06.295849 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m10:19:06.297303 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_stat
[0m10:19:06.297552 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_users
[0m10:19:06.299495 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m10:19:06.301868 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:19:06.302194 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp101906300939"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_o0af"."dbt"."trips_prep" as t
left join
    "dev_o0af"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_o0af"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m10:19:06.302446 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:19:06.302807 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:19:06.303000 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m10:19:06.303176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:06.329366 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m10:19:06.331345 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:19:06.331506 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_o0af"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m10:19:06.375052 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m10:19:06.376382 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m10:19:06.376755 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:19:06.377047 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m10:19:06.425458 [debug] [Thread-3 (]: SQL status: COMMIT in 0.048 seconds
[0m10:19:06.430991 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_geom__dbt_backup"
[0m10:19:06.431971 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m10:19:06.432397 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop table if exists "dev_o0af"."dbt"."trips_geom__dbt_backup" cascade
[0m10:19:06.480138 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.047 seconds
[0m10:19:06.482805 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m10:19:06.483925 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f703b0>]}
[0m10:19:06.484703 [info ] [Thread-3 (]: 3 of 20 OK created sql table model dbt.trips_geom .............................. [[32mSELECT 105901[0m in 7.38s]
[0m10:19:06.485318 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m10:19:06.485871 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_full
[0m10:19:06.486578 [info ] [Thread-3 (]: 12 of 20 START sql view model dbt.events_full .................................. [RUN]
[0m10:19:06.487272 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now model.dbt_scooters.events_full)
[0m10:19:06.487668 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_full
[0m10:19:06.490959 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m10:19:06.492344 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_full
[0m10:19:06.495388 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m10:19:06.496125 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:19:06.496448 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: BEGIN
[0m10:19:06.496726 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:19:06.913227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.610 seconds
[0m10:19:06.914229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:19:06.914774 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_o0af"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_o0af"."dbt"."trips_prep"
  );
  
[0m10:19:07.477110 [debug] [Thread-3 (]: SQL status: BEGIN in 0.980 seconds
[0m10:19:07.478716 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:19:07.479895 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_o0af"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_o0af"."dbt"."events_clean"
    left join "dev_o0af"."dbt"."event_types"
        using (type_id)
  );
[0m10:19:07.578909 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.098 seconds
[0m10:19:07.588091 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:19:07.588659 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_o0af"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m10:19:07.774907 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.186 seconds
[0m10:19:07.780014 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:19:07.780647 [debug] [Thread-2 (]: SQL status: SELECT 0 in 1.478 seconds
[0m10:19:07.781271 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_o0af"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m10:19:07.785863 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:19:07.786662 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: BEGIN
[0m10:19:07.829448 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m10:19:07.834462 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m10:19:07.835106 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:19:07.835646 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m10:19:07.876361 [debug] [Thread-4 (]: SQL status: BEGIN in 1.879 seconds
[0m10:19:07.877492 [debug] [Thread-2 (]: SQL status: BEGIN in 0.090 seconds
[0m10:19:07.878536 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:19:07.879601 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:19:07.880533 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_o0af"."finance"."revenue_daily"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_o0af"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
  );
  
  
[0m10:19:07.881065 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp101906300939'
        
      order by ordinal_position

  
[0m10:19:07.882985 [debug] [Thread-3 (]: SQL status: COMMIT in 0.047 seconds
[0m10:19:07.886005 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."events_full__dbt_backup"
[0m10:19:07.886736 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m10:19:07.887146 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_o0af"."dbt"."events_full__dbt_backup" cascade
[0m10:19:07.978605 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.091 seconds
[0m10:19:07.979754 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.098 seconds
[0m10:19:07.982672 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: Close
[0m10:19:07.987731 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:19:07.988353 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:19:07.989109 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12701a750>]}
[0m10:19:07.990053 [info ] [Thread-3 (]: 12 of 20 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 1.50s]
[0m10:19:07.990753 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_full
[0m10:19:07.991215 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies
[0m10:19:07.991788 [info ] [Thread-3 (]: 13 of 20 START sql table model dbt.companies ................................... [RUN]
[0m10:19:07.992478 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.companies)
[0m10:19:07.992862 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies
[0m10:19:07.996530 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m10:19:07.998190 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies
[0m10:19:08.001270 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m10:19:08.001859 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:19:08.002146 [debug] [Thread-3 (]: On model.dbt_scooters.companies: BEGIN
[0m10:19:08.002411 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:19:08.275368 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.285 seconds
[0m10:19:08.284663 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:19:08.285283 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp101906300939'
        
      order by ordinal_position

  
[0m10:19:08.476810 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.191 seconds
[0m10:19:08.484441 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:19:08.484941 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m10:19:08.781083 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.295 seconds
[0m10:19:08.789937 [debug] [Thread-2 (]: 
    In "dev_o0af"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m10:19:08.794768 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m10:19:08.795347 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:19:08.795603 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_o0af"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp101906300939"
    )


  
[0m10:19:08.877403 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.081 seconds
[0m10:19:08.878795 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:19:08.879105 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m10:19:09.175019 [debug] [Thread-3 (]: SQL status: BEGIN in 1.172 seconds
[0m10:19:09.176524 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:19:09.177151 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_o0af"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_o0af"."dbt"."scooters"
group by
    1
  );
  
[0m10:19:09.379257 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.201 seconds
[0m10:19:09.391747 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:19:09.392174 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_o0af"."dbt"."companies" rename to "companies__dbt_backup"
[0m10:19:09.574845 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.182 seconds
[0m10:19:09.582869 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:19:09.583364 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_o0af"."dbt"."companies__dbt_tmp" rename to "companies"
[0m10:19:09.676358 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m10:19:09.680421 [debug] [Thread-3 (]: On model.dbt_scooters.companies: COMMIT
[0m10:19:09.681458 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:19:09.682022 [debug] [Thread-3 (]: On model.dbt_scooters.companies: COMMIT
[0m10:19:09.882263 [debug] [Thread-3 (]: SQL status: COMMIT in 0.196 seconds
[0m10:19:09.889977 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."companies__dbt_backup"
[0m10:19:09.890848 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m10:19:09.891308 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_o0af"."dbt"."companies__dbt_backup" cascade
[0m10:19:10.320165 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.428 seconds
[0m10:19:10.324005 [debug] [Thread-3 (]: On model.dbt_scooters.companies: Close
[0m10:19:10.325727 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127018830>]}
[0m10:19:10.327037 [info ] [Thread-3 (]: 13 of 20 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 2.33s]
[0m10:19:10.328019 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies
[0m10:19:10.328550 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m10:19:10.329263 [info ] [Thread-3 (]: 14 of 20 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m10:19:10.330049 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.parking_finish_stat)
[0m10:19:10.330551 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m10:19:10.337615 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m10:19:10.338574 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m10:19:10.341581 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m10:19:10.342191 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:19:10.342490 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m10:19:10.342768 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:19:10.978490 [debug] [Thread-1 (]: SQL status: SELECT 1 in 4.063 seconds
[0m10:19:10.985506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:19:10.987059 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_o0af"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m10:19:11.077101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.089 seconds
[0m10:19:11.085667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:19:11.086157 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_o0af"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m10:19:11.175631 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.089 seconds
[0m10:19:11.179020 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m10:19:11.179742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:19:11.180300 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m10:19:11.278532 [debug] [Thread-1 (]: SQL status: COMMIT in 0.098 seconds
[0m10:19:11.280479 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."trips_stat__dbt_backup"
[0m10:19:11.280924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m10:19:11.281198 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_o0af"."dbt"."trips_stat__dbt_backup" cascade
[0m10:19:11.649736 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.368 seconds
[0m10:19:11.653888 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: Close
[0m10:19:11.655451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127019bb0>]}
[0m10:19:11.656627 [info ] [Thread-1 (]: 10 of 20 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 5.37s]
[0m10:19:11.657572 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_stat
[0m10:19:11.658250 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m10:19:11.659076 [info ] [Thread-1 (]: 15 of 20 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m10:19:11.659880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.parking_start_stat)
[0m10:19:11.660492 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m10:19:11.666430 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m10:19:11.667571 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m10:19:11.671115 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m10:19:11.671880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:19:11.672225 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m10:19:11.672557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:11.676149 [debug] [Thread-4 (]: SQL status: SELECT 91 in 3.795 seconds
[0m10:19:11.685576 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:19:11.685817 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

        
            grant select on "dev_o0af"."finance"."revenue_daily" to finance;
        
    
[0m10:19:11.774643 [debug] [Thread-4 (]: SQL status: GRANT in 0.088 seconds
[0m10:19:11.776876 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m10:19:11.777367 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m10:19:11.777806 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m10:19:11.875741 [debug] [Thread-4 (]: SQL status: COMMIT in 0.097 seconds
[0m10:19:11.878163 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: Close
[0m10:19:11.879640 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12701a7b0>]}
[0m10:19:11.880872 [info ] [Thread-4 (]: 9 of 20 OK created sql incremental model finance.revenue_daily ................. [[32mSELECT 91[0m in 5.90s]
[0m10:19:11.881805 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.revenue_daily
[0m10:19:11.882495 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m10:19:11.883251 [info ] [Thread-4 (]: 16 of 20 START sql table model dbt.events_stat ................................. [RUN]
[0m10:19:11.883844 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.events_stat)
[0m10:19:11.884301 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m10:19:11.889234 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m10:19:11.892095 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m10:19:11.895641 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m10:19:11.896296 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:19:11.896589 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m10:19:11.896854 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:19:12.075702 [debug] [Thread-3 (]: SQL status: BEGIN in 1.732 seconds
[0m10:19:12.077209 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:19:12.078446 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_o0af"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_o0af"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)
-- group by
--     1


select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_o0af"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m10:19:12.977741 [debug] [Thread-1 (]: SQL status: BEGIN in 1.305 seconds
[0m10:19:12.979410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:19:12.980677 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_o0af"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_o0af"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.start_point, 3857), hex.geom)
-- group by
--     1

select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_o0af"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m10:19:13.081944 [debug] [Thread-4 (]: SQL status: BEGIN in 1.185 seconds
[0m10:19:13.083445 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:19:13.084615 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_o0af"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_o0af"."dbt"."events_full"
  );
  
[0m10:19:17.079324 [debug] [Thread-4 (]: SQL status: SELECT 1 in 3.993 seconds
[0m10:19:17.089297 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:19:17.089802 [debug] [Thread-2 (]: SQL status: ANALYZE in 8.210 seconds
[0m10:19:17.090205 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_o0af"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m10:19:17.091231 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m10:19:17.091771 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:19:17.092304 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m10:19:17.138821 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m10:19:17.143472 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:19:17.144157 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_o0af"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m10:19:17.177948 [debug] [Thread-2 (]: SQL status: COMMIT in 0.085 seconds
[0m10:19:17.179894 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:19:17.180955 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m10:19:17.187919 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m10:19:17.191015 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m10:19:17.191649 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:19:17.192188 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m10:19:17.275168 [debug] [Thread-2 (]: SQL status: COMMIT in 0.093 seconds
[0m10:19:17.276425 [debug] [Thread-4 (]: SQL status: COMMIT in 0.084 seconds
[0m10:19:17.279497 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m10:19:17.282447 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."events_stat__dbt_backup"
[0m10:19:17.283086 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m10:19:17.283753 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m10:19:17.284263 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_o0af"."dbt"."events_stat__dbt_backup" cascade
[0m10:19:17.377531 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.092 seconds
[0m10:19:17.382091 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m10:19:17.382799 [debug] [Thread-2 (]: SQL status: VACUUM in 0.099 seconds
[0m10:19:17.384657 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: Close
[0m10:19:17.385431 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127203cb0>]}
[0m10:19:17.386907 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127203470>]}
[0m10:19:17.386387 [info ] [Thread-4 (]: 16 of 20 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 5.50s]
[0m10:19:17.387723 [info ] [Thread-2 (]: 11 of 20 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 11.10s]
[0m10:19:17.388433 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m10:19:17.388993 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_users
[0m10:19:17.389471 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies_trips
[0m10:19:17.390188 [info ] [Thread-4 (]: 17 of 20 START sql table model dbt.companies_trips ............................. [RUN]
[0m10:19:17.390799 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now model.dbt_scooters.companies_trips)
[0m10:19:17.391178 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_daily
[0m10:19:17.391505 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies_trips
[0m10:19:17.392177 [info ] [Thread-2 (]: 18 of 20 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m10:19:17.397341 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m10:19:17.397912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily)
[0m10:19:17.398434 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m10:19:17.400865 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m10:19:17.401517 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies_trips
[0m10:19:17.404482 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m10:19:17.404848 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m10:19:17.407123 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m10:19:17.407615 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:19:17.407921 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:19:17.408178 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m10:19:17.408429 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m10:19:17.408665 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:19:17.408889 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:19:19.674929 [debug] [Thread-4 (]: SQL status: BEGIN in 2.266 seconds
[0m10:19:19.676558 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:19:19.677752 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_o0af"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_o0af"."dbt"."trips_prep" as t
        join "dev_o0af"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_o0af"."dbt"."companies" as c
        using (company)
  );
  
[0m10:19:20.176205 [debug] [Thread-2 (]: SQL status: BEGIN in 2.767 seconds
[0m10:19:20.177818 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:19:20.179013 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_o0af"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m10:19:24.278077 [debug] [Thread-4 (]: SQL status: SELECT 6 in 4.599 seconds
[0m10:19:24.285449 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:19:24.285967 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_o0af"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m10:19:24.331312 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m10:19:24.337789 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:19:24.338465 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_o0af"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m10:19:24.477734 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.138 seconds
[0m10:19:24.481699 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m10:19:24.482440 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:19:24.483032 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m10:19:24.540145 [debug] [Thread-4 (]: SQL status: COMMIT in 0.056 seconds
[0m10:19:24.545232 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."companies_trips__dbt_backup"
[0m10:19:24.546212 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m10:19:24.546678 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_o0af"."dbt"."companies_trips__dbt_backup" cascade
[0m10:19:24.779519 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.232 seconds
[0m10:19:24.784172 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: Close
[0m10:19:24.785763 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12701a210>]}
[0m10:19:24.787010 [info ] [Thread-4 (]: 17 of 20 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 7.39s]
[0m10:19:24.788025 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies_trips
[0m10:19:24.788668 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_group
[0m10:19:24.789589 [info ] [Thread-4 (]: 19 of 20 START sql table model dbt.trips_age_group ............................. [RUN]
[0m10:19:24.790411 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_group)
[0m10:19:24.791040 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m10:19:24.796420 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m10:19:24.797666 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_group
[0m10:19:24.801393 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m10:19:24.802202 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:19:24.802588 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m10:19:24.802883 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:19:25.175959 [debug] [Thread-2 (]: SQL status: SELECT 7049 in 4.996 seconds
[0m10:19:25.183046 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:19:25.183713 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_o0af"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m10:19:25.282386 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.098 seconds
[0m10:19:25.289959 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:19:25.290476 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_o0af"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m10:19:25.375225 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.084 seconds
[0m10:19:25.379614 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m10:19:25.380188 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:19:25.380612 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m10:19:25.478551 [debug] [Thread-2 (]: SQL status: COMMIT in 0.097 seconds
[0m10:19:25.485298 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_daily__dbt_backup"
[0m10:19:25.486087 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m10:19:25.486507 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_o0af"."dbt"."trips_age_daily__dbt_backup" cascade
[0m10:19:25.579013 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.092 seconds
[0m10:19:25.583390 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: Close
[0m10:19:25.584693 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1272035f0>]}
[0m10:19:25.585661 [info ] [Thread-2 (]: 18 of 20 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 8.19s]
[0m10:19:25.586347 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m10:19:25.587108 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m10:19:25.587624 [info ] [Thread-2 (]: 20 of 20 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m10:19:25.588150 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now model.dbt_scooters.trips_age_daily_stat)
[0m10:19:25.588540 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m10:19:25.592667 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m10:19:25.593757 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m10:19:25.597244 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m10:19:25.598061 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:19:25.598405 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m10:19:25.598698 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:19:26.179502 [debug] [Thread-4 (]: SQL status: BEGIN in 1.376 seconds
[0m10:19:26.181139 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:19:26.182313 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_o0af"."dbt"."trips_users" as tu
    cross join "dev_o0af"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m10:19:26.582902 [debug] [Thread-2 (]: SQL status: BEGIN in 0.984 seconds
[0m10:19:26.584534 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:19:26.585732 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_o0af"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m10:19:27.112902 [debug] [Thread-2 (]: SQL status: SELECT 83 in 0.526 seconds
[0m10:19:27.119862 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:19:27.120262 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_o0af"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m10:19:27.175940 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.055 seconds
[0m10:19:27.186493 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:19:27.186960 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_o0af"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m10:19:27.277567 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m10:19:27.281478 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m10:19:27.282111 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:19:27.282652 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m10:19:27.476097 [debug] [Thread-2 (]: SQL status: COMMIT in 0.192 seconds
[0m10:19:27.482358 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_daily_stat__dbt_backup"
[0m10:19:27.483124 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m10:19:27.483547 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_o0af"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m10:19:27.584730 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.100 seconds
[0m10:19:27.588507 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m10:19:27.589796 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271df530>]}
[0m10:19:27.590692 [info ] [Thread-2 (]: 20 of 20 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 2.00s]
[0m10:19:27.591391 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m10:19:51.478179 [debug] [Thread-1 (]: SQL status: SELECT 142 in 38.495 seconds
[0m10:19:51.486160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:19:51.486758 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_o0af"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m10:19:51.575654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m10:19:51.579984 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m10:19:51.580597 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:19:51.581051 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m10:19:51.678331 [debug] [Thread-1 (]: SQL status: COMMIT in 0.097 seconds
[0m10:19:51.682044 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."parking_start_stat__dbt_backup"
[0m10:19:51.682902 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m10:19:51.683304 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_o0af"."dbt"."parking_start_stat__dbt_backup" cascade
[0m10:19:51.727467 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.044 seconds
[0m10:19:51.732231 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m10:19:51.733673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271dfd70>]}
[0m10:19:51.734792 [info ] [Thread-1 (]: 15 of 20 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 40.07s]
[0m10:19:51.735709 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m10:20:00.186711 [debug] [Thread-3 (]: SQL status: SELECT 464 in 48.106 seconds
[0m10:20:00.193890 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:20:00.194715 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_o0af"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m10:20:00.240402 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m10:20:00.243032 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m10:20:00.243644 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:20:00.244100 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m10:20:00.377472 [debug] [Thread-3 (]: SQL status: COMMIT in 0.133 seconds
[0m10:20:00.383520 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."parking_finish_stat__dbt_backup"
[0m10:20:00.384763 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m10:20:00.385506 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_o0af"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m10:20:00.434929 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.049 seconds
[0m10:20:00.438234 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m10:20:00.439841 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271df9b0>]}
[0m10:20:00.441073 [info ] [Thread-3 (]: 14 of 20 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 50.11s]
[0m10:20:00.442171 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m10:20:00.980779 [debug] [Thread-4 (]: SQL status: SELECT 7 in 34.797 seconds
[0m10:20:00.985288 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:20:00.985897 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_o0af"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m10:20:01.030923 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m10:20:01.037211 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:20:01.037818 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_o0af"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m10:20:01.081844 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m10:20:01.084626 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m10:20:01.085372 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:20:01.085940 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m10:20:01.131282 [debug] [Thread-4 (]: SQL status: COMMIT in 0.045 seconds
[0m10:20:01.136938 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_group__dbt_backup"
[0m10:20:01.137889 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m10:20:01.138353 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_o0af"."dbt"."trips_age_group__dbt_backup" cascade
[0m10:20:01.186621 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.048 seconds
[0m10:20:01.189345 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: Close
[0m10:20:01.190864 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32656c3-5019-4d36-8f15-b6e54aefbe00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271deed0>]}
[0m10:20:01.191901 [info ] [Thread-4 (]: 19 of 20 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 36.40s]
[0m10:20:01.192913 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_group
[0m10:20:01.195633 [info ] [MainThread]: 
[0m10:20:01.196294 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:01.196670 [debug] [MainThread]: On master: BEGIN
[0m10:20:01.196991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:20:02.761928 [debug] [MainThread]: SQL status: BEGIN in 1.565 seconds
[0m10:20:02.763481 [debug] [MainThread]: On master: COMMIT
[0m10:20:02.764562 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:02.765539 [debug] [MainThread]: On master: COMMIT
[0m10:20:02.810733 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m10:20:02.815849 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m10:20:02.823078 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m10:20:02.823669 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:02.824053 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m10:20:02.870408 [debug] [MainThread]: SQL status: GRANT in 0.046 seconds
[0m10:20:02.871841 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.06s]
[0m10:20:02.872270 [debug] [MainThread]: On master: Close
[0m10:20:02.873062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:02.873375 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m10:20:02.873634 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m10:20:02.873852 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m10:20:02.874059 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m10:20:02.874446 [info ] [MainThread]: 
[0m10:20:02.874753 [info ] [MainThread]: Finished running 3 incremental models, 1 project hook, 3 seeds, 12 table models, 2 view models in 0 hours 1 minutes and 7.93 seconds (67.93s).
[0m10:20:02.877412 [debug] [MainThread]: Command end result
[0m10:20:02.898599 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:20:02.899841 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:20:02.904422 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m10:20:02.904586 [info ] [MainThread]: 
[0m10:20:02.904768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:02.904919 [info ] [MainThread]: 
[0m10:20:02.905076 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=21
[0m10:20:02.906501 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 68.31411, "process_in_blocks": "0", "process_kernel_time": 0.270442, "process_mem_max_rss": "142573568", "process_out_blocks": "0", "process_user_time": 2.078643}
[0m10:20:02.906794 [debug] [MainThread]: Command `dbt build` succeeded at 10:20:02.906738 after 68.31 seconds
[0m10:20:02.906997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127367950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127367e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127367890>]}
[0m10:20:02.907188 [debug] [MainThread]: Flushing usage events
[0m10:20:03.594950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:20:07.379892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11032b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11032bb10>]}


============================== 10:20:07.382115 | 8a957edc-04f6-4948-ad12-b3509173923b ==============================
[0m10:20:07.382115 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:20:07.382378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:20:07.450183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a957edc-04f6-4948-ad12-b3509173923b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722b490>]}
[0m10:20:07.471676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a957edc-04f6-4948-ad12-b3509173923b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101be030>]}
[0m10:20:07.472295 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:20:07.510069 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m10:20:07.568826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:20:07.569012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:20:07.591827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a957edc-04f6-4948-ad12-b3509173923b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110edc750>]}
[0m10:20:07.630178 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:20:07.631102 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:20:07.640970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a957edc-04f6-4948-ad12-b3509173923b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103a9d60>]}
[0m10:20:07.641170 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 439 macros
[0m10:20:07.641314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a957edc-04f6-4948-ad12-b3509173923b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc2510>]}
[0m10:20:07.642172 [info ] [MainThread]: 
[0m10:20:07.642327 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:20:07.642432 [info ] [MainThread]: 
[0m10:20:07.642628 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:20:07.644579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af_dbt'
[0m10:20:07.650295 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af_finance'
[0m10:20:07.668022 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m10:20:07.668237 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m10:20:07.668382 [debug] [ThreadPool]: On list_dev_o0af_dbt: BEGIN
[0m10:20:07.668512 [debug] [ThreadPool]: On list_dev_o0af_finance: BEGIN
[0m10:20:07.668631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:07.668745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:08.418178 [debug] [ThreadPool]: SQL status: BEGIN in 0.749 seconds
[0m10:20:08.419829 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m10:20:08.420925 [debug] [ThreadPool]: On list_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_finance"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m10:20:08.577564 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.155 seconds
[0m10:20:08.582072 [debug] [ThreadPool]: On list_dev_o0af_finance: ROLLBACK
[0m10:20:08.627069 [debug] [ThreadPool]: On list_dev_o0af_finance: Close
[0m10:20:09.177230 [debug] [ThreadPool]: SQL status: BEGIN in 1.508 seconds
[0m10:20:09.178024 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m10:20:09.178438 [debug] [ThreadPool]: On list_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_dbt"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m10:20:09.227153 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.048 seconds
[0m10:20:09.231867 [debug] [ThreadPool]: On list_dev_o0af_dbt: ROLLBACK
[0m10:20:09.279593 [debug] [ThreadPool]: On list_dev_o0af_dbt: Close
[0m10:20:09.292923 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:09.293466 [debug] [MainThread]: On master: BEGIN
[0m10:20:09.293779 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:20:10.358345 [debug] [MainThread]: SQL status: BEGIN in 1.064 seconds
[0m10:20:10.359305 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:10.359972 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:20:10.417965 [debug] [MainThread]: SQL status: SELECT 3 in 0.057 seconds
[0m10:20:10.422864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a957edc-04f6-4948-ad12-b3509173923b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11132e0d0>]}
[0m10:20:10.423848 [debug] [MainThread]: On master: ROLLBACK
[0m10:20:10.467996 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:10.468949 [debug] [MainThread]: On master: BEGIN
[0m10:20:10.563621 [debug] [MainThread]: SQL status: BEGIN in 0.094 seconds
[0m10:20:10.564835 [debug] [MainThread]: On master: COMMIT
[0m10:20:10.565814 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:10.566665 [debug] [MainThread]: On master: COMMIT
[0m10:20:10.612325 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m10:20:10.613431 [debug] [MainThread]: On master: Close
[0m10:20:10.620048 [debug] [Thread-1 (]: Began running node source.dbt_scooters.scooters_raw.trips
[0m10:20:10.620712 [info ] [Thread-1 (]: 1 of 1 START freshness of scooters_raw.trips ................................... [RUN]
[0m10:20:10.621618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_o0af_dbt, now source.dbt_scooters.scooters_raw.trips)
[0m10:20:10.622195 [debug] [Thread-1 (]: Began compiling node source.dbt_scooters.scooters_raw.trips
[0m10:20:10.622666 [debug] [Thread-1 (]: Began executing node source.dbt_scooters.scooters_raw.trips
[0m10:20:10.623411 [debug] [Thread-1 (]: Using postgres connection "source.dbt_scooters.scooters_raw.trips"
[0m10:20:10.623837 [debug] [Thread-1 (]: On source.dbt_scooters.scooters_raw.trips: BEGIN
[0m10:20:10.624260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:11.494082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.870 seconds
[0m10:20:11.494591 [debug] [Thread-1 (]: On source.dbt_scooters.scooters_raw.trips: COMMIT
[0m10:20:11.494854 [debug] [Thread-1 (]: Using postgres connection "source.dbt_scooters.scooters_raw.trips"
[0m10:20:11.495081 [debug] [Thread-1 (]: On source.dbt_scooters.scooters_raw.trips: COMMIT
[0m10:20:11.538632 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m10:20:11.544408 [debug] [Thread-1 (]: Using postgres connection "source.dbt_scooters.scooters_raw.trips"
[0m10:20:11.544656 [debug] [Thread-1 (]: On source.dbt_scooters.scooters_raw.trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "source.dbt_scooters.scooters_raw.trips"} */
select
      max(finished_at) as max_loaded_at,
      now() as snapshotted_at
    from "dev_o0af"."scooters_raw"."trips"
    
  
[0m10:20:11.677717 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.132 seconds
[0m10:20:11.681984 [debug] [Thread-1 (]: On source.dbt_scooters.scooters_raw.trips: Close
[0m10:20:11.685186 [warn ] [Thread-1 (]: 1 of 1 WARN freshness of scooters_raw.trips .................................... [[33mWARN[0m in 1.06s]
[0m10:20:11.686064 [debug] [Thread-1 (]: Finished running node source.dbt_scooters.scooters_raw.trips
[0m10:20:11.687959 [info ] [MainThread]: 
[0m10:20:11.688459 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:11.688748 [debug] [MainThread]: On master: BEGIN
[0m10:20:11.689019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:20:12.770895 [debug] [MainThread]: SQL status: BEGIN in 1.082 seconds
[0m10:20:12.772431 [debug] [MainThread]: On master: COMMIT
[0m10:20:12.773478 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:12.774341 [debug] [MainThread]: On master: COMMIT
[0m10:20:12.820847 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m10:20:12.832570 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m10:20:12.837611 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m10:20:12.838208 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:12.838497 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m10:20:12.884319 [debug] [MainThread]: SQL status: GRANT in 0.045 seconds
[0m10:20:12.885772 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.06s]
[0m10:20:12.886226 [debug] [MainThread]: On master: Close
[0m10:20:12.886974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:12.887253 [debug] [MainThread]: Connection 'source.dbt_scooters.scooters_raw.trips' was properly closed.
[0m10:20:12.887463 [debug] [MainThread]: Connection 'list_dev_o0af_finance' was properly closed.
[0m10:20:12.887716 [info ] [MainThread]: 
[0m10:20:12.888002 [info ] [MainThread]: Finished running 1 project hook, 1 source in 0 hours 0 minutes and 5.25 seconds (5.25s).
[0m10:20:12.938474 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m10:20:12.939509 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m10:20:12.942253 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/flerinvs/dbt_scooters/target/sources.json
[0m10:20:12.942384 [info ] [MainThread]: Done.
[0m10:20:12.943254 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 5.5901036, "process_in_blocks": "0", "process_kernel_time": 0.145405, "process_mem_max_rss": "134512640", "process_out_blocks": "0", "process_user_time": 0.918587}
[0m10:20:12.943473 [debug] [MainThread]: Command `dbt source freshness` succeeded at 10:20:12.943433 after 5.59 seconds
[0m10:20:12.943630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110208dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111664c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111166a40>]}
[0m10:20:12.943786 [debug] [MainThread]: Flushing usage events
[0m10:20:13.442166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:36.029196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e1fb10>]}


============================== 10:52:36.031290 | a65fc216-5ea9-4708-8ccb-cceba725d81f ==============================
[0m10:52:36.031290 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:52:36.031551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:52:36.078376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a65fc216-5ea9-4708-8ccb-cceba725d81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c2f490>]}
[0m10:52:36.085122 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:52:36.085572 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:52:36.107947 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.10810221, "process_in_blocks": "0", "process_kernel_time": 0.06306, "process_mem_max_rss": "111607808", "process_out_blocks": "0", "process_user_time": 0.565765}
[0m10:52:36.108243 [debug] [MainThread]: Command `cli deps` succeeded at 10:52:36.108189 after 0.11 seconds
[0m10:52:36.108404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bc18c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bc2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ba7b50>]}
[0m10:52:36.108559 [debug] [MainThread]: Flushing usage events
[0m10:52:36.824838 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:16:13.283347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b234d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1fb10>]}


============================== 21:16:13.285483 | 571143c8-e067-4996-b512-fb1483095bbe ==============================
[0m21:16:13.285483 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:16:13.285748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:16:13.329477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '571143c8-e067-4996-b512-fb1483095bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2f490>]}
[0m21:16:13.336155 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:16:13.336632 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:16:13.362029 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.10945962, "process_in_blocks": "0", "process_kernel_time": 0.06757, "process_mem_max_rss": "112427008", "process_out_blocks": "0", "process_user_time": 0.559853}
[0m21:16:13.362298 [debug] [MainThread]: Command `cli deps` succeeded at 21:16:13.362246 after 0.11 seconds
[0m21:16:13.362456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c18c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a3b50>]}
[0m21:16:13.362602 [debug] [MainThread]: Flushing usage events
[0m21:16:14.139261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:17:43.746066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041174d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10560f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10560fb10>]}


============================== 21:17:43.747899 | 01de9bd0-4983-484f-94a0-b47326ad5aaa ==============================
[0m21:17:43.747899 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:17:43.748169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test -s source:scooters_raw.users', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:17:43.815242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01de9bd0-4983-484f-94a0-b47326ad5aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104917490>]}
[0m21:17:43.835895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01de9bd0-4983-484f-94a0-b47326ad5aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a5f20>]}
[0m21:17:43.837011 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:17:43.873835 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:17:43.932413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:17:43.932578 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:17:43.955408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01de9bd0-4983-484f-94a0-b47326ad5aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106290650>]}
[0m21:17:43.994213 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:17:43.996175 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:17:44.011607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01de9bd0-4983-484f-94a0-b47326ad5aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652b2f0>]}
[0m21:17:44.011821 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 17 sources, 439 macros
[0m21:17:44.011968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01de9bd0-4983-484f-94a0-b47326ad5aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650e6d0>]}
[0m21:17:44.012684 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:17:44.013453 [debug] [MainThread]: Command end result
[0m21:17:44.024100 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:17:44.024979 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:17:44.026801 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:17:44.028146 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.31357276, "process_in_blocks": "0", "process_kernel_time": 0.103523, "process_mem_max_rss": "120193024", "process_out_blocks": "0", "process_user_time": 0.725535}
[0m21:17:44.028347 [debug] [MainThread]: Command `dbt test` succeeded at 21:17:44.028307 after 0.31 seconds
[0m21:17:44.028502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106508650>]}
[0m21:17:44.028634 [debug] [MainThread]: Flushing usage events
[0m21:17:44.753902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:17:53.512043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111027b10>]}


============================== 21:17:53.514422 | 066ec886-176d-40d2-9f78-46f1f0dc3716 ==============================
[0m21:17:53.514422 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:17:53.514697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt test -s source:scooters_raw.users', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:17:53.583030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '066ec886-176d-40d2-9f78-46f1f0dc3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762b490>]}
[0m21:17:53.604595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '066ec886-176d-40d2-9f78-46f1f0dc3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ebdf20>]}
[0m21:17:53.605682 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:17:53.642106 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:17:53.701331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:17:53.701519 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:17:53.727064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '066ec886-176d-40d2-9f78-46f1f0dc3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cfcd50>]}
[0m21:17:53.771006 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:17:53.771864 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:17:53.786083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '066ec886-176d-40d2-9f78-46f1f0dc3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120372f0>]}
[0m21:17:53.786312 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 1 test, 17 sources, 439 macros
[0m21:17:53.786461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '066ec886-176d-40d2-9f78-46f1f0dc3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112026b30>]}
[0m21:17:53.787299 [info ] [MainThread]: 
[0m21:17:53.787443 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:17:53.787548 [info ] [MainThread]: 
[0m21:17:53.787744 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:17:53.789742 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af_dbt'
[0m21:17:53.789974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af_finance'
[0m21:17:53.827641 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m21:17:53.827864 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m21:17:53.828009 [debug] [ThreadPool]: On list_dev_o0af_dbt: BEGIN
[0m21:17:53.828137 [debug] [ThreadPool]: On list_dev_o0af_finance: BEGIN
[0m21:17:53.828252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:53.828360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:55.140348 [debug] [ThreadPool]: SQL status: BEGIN in 1.312 seconds
[0m21:17:55.141503 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m21:17:55.142147 [debug] [ThreadPool]: On list_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_dbt"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:17:55.191413 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.048 seconds
[0m21:17:55.197197 [debug] [ThreadPool]: On list_dev_o0af_dbt: ROLLBACK
[0m21:17:55.243028 [debug] [ThreadPool]: On list_dev_o0af_dbt: Close
[0m21:17:55.248285 [debug] [ThreadPool]: SQL status: BEGIN in 1.420 seconds
[0m21:17:55.248860 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m21:17:55.249394 [debug] [ThreadPool]: On list_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_finance"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m21:17:55.302877 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.053 seconds
[0m21:17:55.307059 [debug] [ThreadPool]: On list_dev_o0af_finance: ROLLBACK
[0m21:17:55.352747 [debug] [ThreadPool]: On list_dev_o0af_finance: Close
[0m21:17:55.363693 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:55.364105 [debug] [MainThread]: On master: BEGIN
[0m21:17:55.364419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:17:56.040582 [debug] [MainThread]: SQL status: BEGIN in 0.676 seconds
[0m21:17:56.042071 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:56.042683 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:17:56.094948 [debug] [MainThread]: SQL status: SELECT 3 in 0.052 seconds
[0m21:17:56.099524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '066ec886-176d-40d2-9f78-46f1f0dc3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11251c120>]}
[0m21:17:56.100320 [debug] [MainThread]: On master: ROLLBACK
[0m21:17:56.142180 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:56.143190 [debug] [MainThread]: On master: BEGIN
[0m21:17:56.226405 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m21:17:56.227656 [debug] [MainThread]: On master: COMMIT
[0m21:17:56.228616 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:56.229403 [debug] [MainThread]: On master: COMMIT
[0m21:17:56.272025 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m21:17:56.273438 [debug] [MainThread]: On master: Close
[0m21:17:56.281949 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m21:17:56.282671 [info ] [Thread-1 (]: 1 of 1 START test source_accepted_values_scooters_raw_users_sex__M__F .......... [RUN]
[0m21:17:56.283370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_o0af_dbt, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m21:17:56.283872 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m21:17:56.344505 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m21:17:56.345248 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m21:17:56.353563 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m21:17:56.354003 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m21:17:56.354155 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m21:17:56.354289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:56.992682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.638 seconds
[0m21:17:56.993782 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m21:17:56.994468 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_o0af"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



  
  
      
    ) dbt_internal_test
[0m21:17:57.057263 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.062 seconds
[0m21:17:57.064915 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m21:17:57.111009 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m21:17:57.113637 [info ] [Thread-1 (]: 1 of 1 PASS source_accepted_values_scooters_raw_users_sex__M__F ................ [[32mPASS[0m in 0.83s]
[0m21:17:57.114720 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m21:17:57.117062 [info ] [MainThread]: 
[0m21:17:57.117690 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:57.118179 [debug] [MainThread]: On master: BEGIN
[0m21:17:57.118610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:17:58.704965 [debug] [MainThread]: SQL status: BEGIN in 1.586 seconds
[0m21:17:58.706143 [debug] [MainThread]: On master: COMMIT
[0m21:17:58.706857 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:58.707456 [debug] [MainThread]: On master: COMMIT
[0m21:17:58.752807 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m21:17:58.755734 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m21:17:58.759552 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m21:17:58.760055 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:58.760303 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m21:17:58.805601 [debug] [MainThread]: SQL status: GRANT in 0.045 seconds
[0m21:17:58.807182 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.05s]
[0m21:17:58.807635 [debug] [MainThread]: On master: Close
[0m21:17:58.808272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:58.808538 [debug] [MainThread]: Connection 'test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b' was properly closed.
[0m21:17:58.808749 [debug] [MainThread]: Connection 'list_dev_o0af_finance' was properly closed.
[0m21:17:58.809044 [info ] [MainThread]: 
[0m21:17:58.809433 [info ] [MainThread]: Finished running 1 project hook, 1 test in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m21:17:58.810418 [debug] [MainThread]: Command end result
[0m21:17:58.833861 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:17:58.835228 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:17:58.839394 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:17:58.839596 [info ] [MainThread]: 
[0m21:17:58.839819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:17:58.839990 [info ] [MainThread]: 
[0m21:17:58.840176 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m21:17:58.841551 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.360344, "process_in_blocks": "0", "process_kernel_time": 0.164368, "process_mem_max_rss": "137166848", "process_out_blocks": "0", "process_user_time": 0.976397}
[0m21:17:58.841801 [debug] [MainThread]: Command `dbt test` succeeded at 21:17:58.841750 after 5.36 seconds
[0m21:17:58.842001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f08dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11209ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11209adb0>]}
[0m21:17:58.842189 [debug] [MainThread]: Flushing usage events
[0m21:17:59.394003 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:20:57.794251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cbb10>]}


============================== 21:20:57.795993 | f0b6d2a7-769c-4659-9c1d-11cd2d23683f ==============================
[0m21:20:57.795993 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:20:57.796258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test -s source:scooters_raw.users', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:20:57.863103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0b6d2a7-769c-4659-9c1d-11cd2d23683f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d3490>]}
[0m21:20:57.883697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0b6d2a7-769c-4659-9c1d-11cd2d23683f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107261f20>]}
[0m21:20:57.884059 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:20:57.917653 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:20:57.977783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:57.977980 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:58.003442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0b6d2a7-769c-4659-9c1d-11cd2d23683f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10804cd50>]}
[0m21:20:58.047068 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:20:58.047941 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:20:58.057595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0b6d2a7-769c-4659-9c1d-11cd2d23683f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083832f0>]}
[0m21:20:58.057815 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 2 data tests, 17 sources, 439 macros
[0m21:20:58.057961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0b6d2a7-769c-4659-9c1d-11cd2d23683f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108376eb0>]}
[0m21:20:58.058722 [info ] [MainThread]: 
[0m21:20:58.058867 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:20:58.058979 [info ] [MainThread]: 
[0m21:20:58.059183 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:20:58.061024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af_dbt'
[0m21:20:58.061247 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af_finance'
[0m21:20:58.081893 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m21:20:58.082092 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m21:20:58.082222 [debug] [ThreadPool]: On list_dev_o0af_dbt: BEGIN
[0m21:20:58.082341 [debug] [ThreadPool]: On list_dev_o0af_finance: BEGIN
[0m21:20:58.082450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:58.082571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:59.845214 [debug] [ThreadPool]: SQL status: BEGIN in 1.762 seconds
[0m21:20:59.846791 [debug] [ThreadPool]: SQL status: BEGIN in 1.764 seconds
[0m21:20:59.847401 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m21:20:59.848038 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m21:20:59.848696 [debug] [ThreadPool]: On list_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_dbt"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:20:59.849335 [debug] [ThreadPool]: On list_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_finance"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m21:20:59.904863 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.055 seconds
[0m21:20:59.905964 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.056 seconds
[0m21:20:59.910194 [debug] [ThreadPool]: On list_dev_o0af_finance: ROLLBACK
[0m21:20:59.912103 [debug] [ThreadPool]: On list_dev_o0af_dbt: ROLLBACK
[0m21:20:59.955738 [debug] [ThreadPool]: On list_dev_o0af_finance: Close
[0m21:20:59.956881 [debug] [ThreadPool]: On list_dev_o0af_dbt: Close
[0m21:20:59.970723 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:59.971144 [debug] [MainThread]: On master: BEGIN
[0m21:20:59.971643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:21:01.964897 [debug] [MainThread]: SQL status: BEGIN in 1.993 seconds
[0m21:21:01.966328 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:01.967069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:21:02.169815 [debug] [MainThread]: SQL status: SELECT 3 in 0.202 seconds
[0m21:21:02.174974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0b6d2a7-769c-4659-9c1d-11cd2d23683f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108780120>]}
[0m21:21:02.175838 [debug] [MainThread]: On master: ROLLBACK
[0m21:21:02.266071 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:02.267476 [debug] [MainThread]: On master: BEGIN
[0m21:21:02.376045 [debug] [MainThread]: SQL status: BEGIN in 0.107 seconds
[0m21:21:02.377404 [debug] [MainThread]: On master: COMMIT
[0m21:21:02.378410 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:02.379438 [debug] [MainThread]: On master: COMMIT
[0m21:21:02.425858 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m21:21:02.427101 [debug] [MainThread]: On master: Close
[0m21:21:02.433726 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m21:21:02.434467 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m21:21:02.435168 [info ] [Thread-2 (]: 2 of 2 START test source_not_null_scooters_raw_users_sex ....................... [RUN]
[0m21:21:02.435887 [info ] [Thread-1 (]: 1 of 2 START test source_accepted_values_scooters_raw_users_sex__M__F .......... [RUN]
[0m21:21:02.436723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_o0af_finance, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m21:21:02.437435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_o0af_dbt, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m21:21:02.437940 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m21:21:02.438386 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m21:21:02.493693 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m21:21:02.497651 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m21:21:02.498215 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m21:21:02.498419 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m21:21:02.506524 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m21:21:02.507373 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m21:21:02.507765 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m21:21:02.507919 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m21:21:02.508081 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m21:21:02.508241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:02.508391 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m21:21:02.508589 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:21:03.182262 [debug] [Thread-2 (]: SQL status: BEGIN in 0.673 seconds
[0m21:21:03.184134 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m21:21:03.185442 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sex
from "dev_o0af"."scooters_raw"."users"
where sex is null



  
  
      
    ) dbt_internal_test
[0m21:21:03.231383 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.045 seconds
[0m21:21:03.240362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.732 seconds
[0m21:21:03.241133 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m21:21:03.241694 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m21:21:03.242379 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_o0af"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



  
  
      
    ) dbt_internal_test
[0m21:21:03.287381 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m21:21:03.288665 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.046 seconds
[0m21:21:03.291710 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m21:21:03.292782 [error] [Thread-2 (]: 2 of 2 FAIL 216 source_not_null_scooters_raw_users_sex ......................... [[31mFAIL 216[0m in 0.86s]
[0m21:21:03.293791 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m21:21:03.341012 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m21:21:03.342777 [info ] [Thread-1 (]: 1 of 2 PASS source_accepted_values_scooters_raw_users_sex__M__F ................ [[32mPASS[0m in 0.91s]
[0m21:21:03.343610 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m21:21:03.345329 [info ] [MainThread]: 
[0m21:21:03.345867 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:03.346191 [debug] [MainThread]: On master: BEGIN
[0m21:21:03.346490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:21:04.063378 [debug] [MainThread]: SQL status: BEGIN in 0.717 seconds
[0m21:21:04.064886 [debug] [MainThread]: On master: COMMIT
[0m21:21:04.065831 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:04.066166 [debug] [MainThread]: On master: COMMIT
[0m21:21:04.108526 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m21:21:04.113688 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m21:21:04.120714 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m21:21:04.121383 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:04.121772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m21:21:04.165069 [debug] [MainThread]: SQL status: GRANT in 0.043 seconds
[0m21:21:04.166919 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.06s]
[0m21:21:04.167476 [debug] [MainThread]: On master: Close
[0m21:21:04.168479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:21:04.169061 [debug] [MainThread]: Connection 'test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b' was properly closed.
[0m21:21:04.169372 [debug] [MainThread]: Connection 'test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee' was properly closed.
[0m21:21:04.169733 [info ] [MainThread]: 
[0m21:21:04.170077 [info ] [MainThread]: Finished running 1 project hook, 2 data tests in 0 hours 0 minutes and 6.11 seconds (6.11s).
[0m21:21:04.171045 [debug] [MainThread]: Command end result
[0m21:21:04.194424 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:21:04.195752 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:21:04.199861 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:21:04.200054 [info ] [MainThread]: 
[0m21:21:04.200261 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:21:04.200424 [info ] [MainThread]: 
[0m21:21:04.200633 [error] [MainThread]: [31mFailure in test source_not_null_scooters_raw_users_sex (models/properties.yml)[0m
[0m21:21:04.200819 [error] [MainThread]:   Got 216 results, configured to fail if != 0
[0m21:21:04.200959 [info ] [MainThread]: 
[0m21:21:04.201132 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/source_not_null_scooters_raw_users_sex.sql
[0m21:21:04.201272 [info ] [MainThread]: 
[0m21:21:04.201439 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m21:21:04.202392 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.432588, "process_in_blocks": "0", "process_kernel_time": 0.145449, "process_mem_max_rss": "137166848", "process_out_blocks": "0", "process_user_time": 0.967805}
[0m21:21:04.202629 [debug] [MainThread]: Command `dbt test` failed at 21:21:04.202582 after 6.43 seconds
[0m21:21:04.202832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083eae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083eafc0>]}
[0m21:21:04.203020 [debug] [MainThread]: Flushing usage events
[0m21:21:04.950915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:39.039140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e1f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113827b10>]}


============================== 21:28:39.041556 | 8ecaf0f9-32aa-4f85-bbf1-60311dc1a567 ==============================
[0m21:28:39.041556 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:28:39.041828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:28:39.109597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11282b490>]}
[0m21:28:39.131119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136bdf20>]}
[0m21:28:39.132267 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:28:39.172069 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:28:39.244383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:28:39.244570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:28:39.270608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147fc450>]}
[0m21:28:39.315872 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:28:39.317079 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:28:39.333006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ad7e30>]}
[0m21:28:39.333223 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 2 data tests, 17 sources, 439 macros
[0m21:28:39.334578 [info ] [MainThread]: 
[0m21:28:39.334721 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:28:39.334831 [info ] [MainThread]: 
[0m21:28:39.335033 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:28:39.336903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af'
[0m21:28:39.337142 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af'
[0m21:28:39.360841 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af"
[0m21:28:39.361034 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af"
[0m21:28:39.361193 [debug] [ThreadPool]: On list_dev_o0af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af"} */

    select distinct nspname from pg_namespace
  
[0m21:28:39.361319 [debug] [ThreadPool]: On list_dev_o0af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af"} */

    select distinct nspname from pg_namespace
  
[0m21:28:39.361432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:39.361536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:40.207918 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.846 seconds
[0m21:28:40.210826 [debug] [ThreadPool]: On list_dev_o0af: Close
[0m21:28:40.214043 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.852 seconds
[0m21:28:40.215973 [debug] [ThreadPool]: On list_dev_o0af: Close
[0m21:28:40.219018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_o0af, now list_dev_o0af_finance)
[0m21:28:40.224720 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m21:28:40.225114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_o0af, now list_dev_o0af_dbt)
[0m21:28:40.225356 [debug] [ThreadPool]: On list_dev_o0af_finance: BEGIN
[0m21:28:40.226657 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m21:28:40.226894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:40.227107 [debug] [ThreadPool]: On list_dev_o0af_dbt: BEGIN
[0m21:28:40.227435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:41.776562 [debug] [ThreadPool]: SQL status: BEGIN in 1.549 seconds
[0m21:28:41.777836 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m21:28:41.778140 [debug] [ThreadPool]: On list_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_dbt"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:28:41.809504 [debug] [ThreadPool]: SQL status: BEGIN in 1.582 seconds
[0m21:28:41.810234 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m21:28:41.810575 [debug] [ThreadPool]: On list_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_finance"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m21:28:41.829510 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.051 seconds
[0m21:28:41.833026 [debug] [ThreadPool]: On list_dev_o0af_dbt: ROLLBACK
[0m21:28:41.863162 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.052 seconds
[0m21:28:41.866936 [debug] [ThreadPool]: On list_dev_o0af_finance: ROLLBACK
[0m21:28:41.878507 [debug] [ThreadPool]: On list_dev_o0af_dbt: Close
[0m21:28:41.933312 [debug] [ThreadPool]: On list_dev_o0af_finance: Close
[0m21:28:42.001496 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:42.001756 [debug] [MainThread]: On master: BEGIN
[0m21:28:42.001896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:28:42.670513 [debug] [MainThread]: SQL status: BEGIN in 0.668 seconds
[0m21:28:42.672133 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:42.673460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:28:42.733837 [debug] [MainThread]: SQL status: SELECT 3 in 0.059 seconds
[0m21:28:42.738214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c1b930>]}
[0m21:28:42.739151 [debug] [MainThread]: On master: ROLLBACK
[0m21:28:42.782249 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:42.783073 [debug] [MainThread]: On master: BEGIN
[0m21:28:42.868002 [debug] [MainThread]: SQL status: BEGIN in 0.084 seconds
[0m21:28:42.868276 [debug] [MainThread]: On master: COMMIT
[0m21:28:42.868426 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:42.868555 [debug] [MainThread]: On master: COMMIT
[0m21:28:42.929097 [debug] [MainThread]: SQL status: COMMIT in 0.060 seconds
[0m21:28:42.929320 [debug] [MainThread]: On master: Close
[0m21:28:42.932282 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m21:28:42.932660 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m21:28:42.933070 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:28:42.933326 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m21:28:42.933667 [info ] [Thread-3 (]: 3 of 22 START sql table model dbt.trips_geom ................................... [RUN]
[0m21:28:42.934516 [info ] [Thread-4 (]: 4 of 22 START sql view model dbt.trips_prep .................................... [RUN]
[0m21:28:42.934897 [info ] [Thread-1 (]: 1 of 22 START sql incremental model dbt.events_clean ........................... [RUN]
[0m21:28:42.935391 [info ] [Thread-2 (]: 2 of 22 START sql table model dbt.trips_concurrency ............................ [RUN]
[0m21:28:42.936004 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m21:28:42.936335 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_prep'
[0m21:28:42.936642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_o0af_finance, now model.dbt_scooters.events_clean)
[0m21:28:42.936856 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_o0af_dbt, now model.dbt_scooters.trips_concurrency)
[0m21:28:42.937084 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m21:28:42.937279 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m21:28:42.937485 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:28:42.937686 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m21:28:42.942512 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m21:28:42.944632 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m21:28:42.950219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:28:42.952218 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m21:28:42.952756 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:28:42.952949 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m21:28:42.977974 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m21:28:42.978845 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:28:42.984072 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m21:28:42.984247 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m21:28:42.990975 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m21:28:42.991152 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp212842967984"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_o0af"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_o0af"."dbt"."events_clean")
    

  );
  
  
[0m21:28:42.992470 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m21:28:42.992697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:42.993142 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:28:42.993301 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:28:42.993446 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:28:42.993572 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m21:28:42.993702 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m21:28:42.993824 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m21:28:42.993951 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:28:42.994072 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:28:42.994188 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:28:43.723738 [debug] [Thread-3 (]: SQL status: BEGIN in 0.729 seconds
[0m21:28:43.724973 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:28:43.725851 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  
    

  create  table "dev_o0af"."dbt"."trips_geom__dbt_tmp"
  
  
    as
  
  (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_o0af"."scooters_raw"."trips"
  );
  
[0m21:28:43.766258 [debug] [Thread-2 (]: SQL status: BEGIN in 0.772 seconds
[0m21:28:43.767839 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:28:43.769243 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

  
    

  create  table "dev_o0af"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_o0af"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
[0m21:28:43.813148 [debug] [Thread-4 (]: SQL status: BEGIN in 0.819 seconds
[0m21:28:43.814754 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:28:43.816031 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_o0af"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,

    date(started_at at time zone 'Europe/Moscow')
 as "date" 
from
"dev_o0af"."scooters_raw"."trips"
  );
[0m21:28:44.063138 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.246 seconds
[0m21:28:44.077244 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:28:44.078033 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_o0af"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m21:28:44.163759 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.085 seconds
[0m21:28:44.171981 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:28:44.172749 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_o0af"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m21:28:44.261231 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m21:28:44.285635 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:28:44.286179 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:28:44.286488 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m21:28:44.461945 [debug] [Thread-4 (]: SQL status: COMMIT in 0.175 seconds
[0m21:28:44.471949 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."trips_prep__dbt_backup"
[0m21:28:44.477965 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m21:28:44.478712 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_o0af"."dbt"."trips_prep__dbt_backup" cascade
[0m21:28:44.662733 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.183 seconds
[0m21:28:44.667677 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m21:28:44.672757 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a31090>]}
[0m21:28:44.673851 [info ] [Thread-4 (]: 4 of 22 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 1.73s]
[0m21:28:44.674710 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m21:28:44.675246 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m21:28:44.675926 [info ] [Thread-4 (]: 5 of 22 START sql table model dbt.trips_stat_daily ............................. [RUN]
[0m21:28:44.676714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.trips_stat_daily)
[0m21:28:44.677108 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m21:28:44.680548 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m21:28:44.681600 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m21:28:44.684566 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m21:28:44.685303 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:28:44.685670 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m21:28:44.685952 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:28:45.781848 [debug] [Thread-2 (]: SQL status: SELECT 10 in 2.012 seconds
[0m21:28:45.797183 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:28:45.797878 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_o0af"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m21:28:45.860957 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.062 seconds
[0m21:28:45.867193 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:28:45.867927 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_o0af"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m21:28:45.963305 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m21:28:45.966618 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:28:45.967431 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:28:45.968117 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m21:28:46.163078 [debug] [Thread-2 (]: SQL status: COMMIT in 0.194 seconds
[0m21:28:46.169220 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."trips_concurrency__dbt_backup"
[0m21:28:46.175473 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m21:28:46.176033 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_o0af"."dbt"."trips_concurrency__dbt_backup" cascade
[0m21:28:46.365049 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.188 seconds
[0m21:28:46.368648 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m21:28:46.370366 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c0a2d0>]}
[0m21:28:46.371445 [info ] [Thread-2 (]: 2 of 22 OK created sql table model dbt.trips_concurrency ....................... [[32mSELECT 10[0m in 3.43s]
[0m21:28:46.372515 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m21:28:46.373121 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m21:28:46.373836 [info ] [Thread-2 (]: 6 of 22 START seed file dbt.age_groups ......................................... [RUN]
[0m21:28:46.374597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now seed.dbt_scooters.age_groups)
[0m21:28:46.375070 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m21:28:46.375506 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m21:28:46.399658 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:28:46.400019 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m21:28:46.400238 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:28:46.564224 [debug] [Thread-4 (]: SQL status: BEGIN in 1.878 seconds
[0m21:28:46.565705 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:28:46.567572 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_o0af"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
  
[0m21:28:47.964830 [debug] [Thread-3 (]: SQL status: SELECT 105901 in 4.238 seconds
[0m21:28:47.972811 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:28:47.973637 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_o0af"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m21:28:48.063856 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.089 seconds
[0m21:28:48.070954 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:28:48.071659 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_o0af"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m21:28:48.114872 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.042 seconds
[0m21:28:48.118804 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m21:28:48.119455 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:28:48.120011 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m21:28:48.164247 [debug] [Thread-2 (]: SQL status: BEGIN in 1.764 seconds
[0m21:28:48.165380 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:28:48.166271 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_o0af"."dbt"."age_groups"
[0m21:28:48.166822 [debug] [Thread-3 (]: SQL status: COMMIT in 0.046 seconds
[0m21:28:48.170972 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_geom__dbt_backup"
[0m21:28:48.171705 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m21:28:48.172138 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop table if exists "dev_o0af"."dbt"."trips_geom__dbt_backup" cascade
[0m21:28:48.266442 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.099 seconds
[0m21:28:48.285992 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:28:48.286460 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_o0af"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m21:28:48.371576 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.085 seconds
[0m21:28:48.384143 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m21:28:48.388298 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:28:48.388917 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m21:28:48.389326 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m21:28:48.464805 [debug] [Thread-1 (]: SQL status: SELECT 0 in 5.471 seconds
[0m21:28:48.476374 [debug] [Thread-2 (]: SQL status: COMMIT in 0.087 seconds
[0m21:28:48.484107 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m21:28:48.492598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:28:48.493156 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:28:48.493715 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c6d2e0>]}
[0m21:28:48.494266 [info ] [Thread-2 (]: 6 of 22 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 2.12s]
[0m21:28:48.494718 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m21:28:48.495044 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.event_types
[0m21:28:48.495569 [info ] [Thread-2 (]: 7 of 22 START seed file dbt.event_types ........................................ [RUN]
[0m21:28:48.495953 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now seed.dbt_scooters.event_types)
[0m21:28:48.496227 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.event_types
[0m21:28:48.496479 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.event_types
[0m21:28:48.500513 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m21:28:48.500806 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: BEGIN
[0m21:28:48.501378 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:28:48.561379 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.389 seconds
[0m21:28:48.561661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m21:28:48.562392 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m21:28:48.562572 [debug] [Thread-4 (]: SQL status: SELECT 91 in 1.994 seconds
[0m21:28:48.562727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:28:48.564189 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:28:48.564471 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a1b610>]}
[0m21:28:48.564639 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp212842967984'
        
      order by ordinal_position

  
[0m21:28:48.564806 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_o0af"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m21:28:48.565105 [info ] [Thread-3 (]: 3 of 22 OK created sql table model dbt.trips_geom .............................. [[32mSELECT 105901[0m in 5.63s]
[0m21:28:48.565449 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m21:28:48.565643 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.scooters
[0m21:28:48.565901 [info ] [Thread-3 (]: 8 of 22 START seed file dbt.scooters ........................................... [RUN]
[0m21:28:48.566162 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now seed.dbt_scooters.scooters)
[0m21:28:48.566323 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.scooters
[0m21:28:48.566463 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.scooters
[0m21:28:48.569144 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m21:28:48.569301 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: BEGIN
[0m21:28:48.569432 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:28:48.661952 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.097 seconds
[0m21:28:48.664089 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:28:48.664403 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_o0af"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m21:28:48.865737 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.300 seconds
[0m21:28:48.876031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:28:48.876676 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:28:48.908596 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.244 seconds
[0m21:28:48.912489 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m21:28:48.913021 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:28:48.913480 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m21:28:48.964243 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.086 seconds
[0m21:28:48.965355 [debug] [Thread-4 (]: SQL status: COMMIT in 0.051 seconds
[0m21:28:48.986040 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."trips_stat_daily__dbt_backup"
[0m21:28:48.987137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:28:48.987669 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m21:28:48.988042 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp212842967984'
        
      order by ordinal_position

  
[0m21:28:48.988387 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_o0af"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m21:28:49.062942 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.074 seconds
[0m21:28:49.066989 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m21:28:49.068533 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158ecf50>]}
[0m21:28:49.069525 [info ] [Thread-4 (]: 5 of 22 OK created sql table model dbt.trips_stat_daily ........................ [[32mSELECT 91[0m in 4.39s]
[0m21:28:49.070532 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m21:28:49.071111 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m21:28:49.071689 [info ] [Thread-4 (]: 9 of 22 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m21:28:49.072267 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m21:28:49.072750 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m21:28:49.088090 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m21:28:49.089044 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m21:28:49.102328 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m21:28:49.102817 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m21:28:49.103035 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m21:28:49.103232 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:28:49.162954 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.174 seconds
[0m21:28:49.166534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:28:49.166886 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:28:49.262304 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.095 seconds
[0m21:28:49.276575 [debug] [Thread-1 (]: 
    In "dev_o0af"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:28:49.291424 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:28:49.292172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:28:49.292481 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        delete from "dev_o0af"."dbt"."events_clean" as DBT_INTERNAL_DEST
        where (user_id, timestamp, type_id) in (
            select distinct user_id, timestamp, type_id
            from "events_clean__dbt_tmp212842967984" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_o0af"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp212842967984"
    )
  
[0m21:28:49.361898 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.069 seconds
[0m21:28:49.365106 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:28:49.365736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:28:49.366203 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:28:49.413538 [debug] [Thread-1 (]: SQL status: COMMIT in 0.047 seconds
[0m21:28:49.414827 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:28:49.416834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d46890>]}
[0m21:28:49.417854 [info ] [Thread-1 (]: 1 of 22 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 6.48s]
[0m21:28:49.418619 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:28:49.419224 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m21:28:49.419957 [info ] [Thread-1 (]: 10 of 22 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m21:28:49.420746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m21:28:49.421185 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m21:28:49.431747 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m21:28:49.432822 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m21:28:49.435437 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m21:28:49.436312 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m21:28:49.436638 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m21:28:49.436929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:49.467219 [debug] [Thread-3 (]: SQL status: BEGIN in 0.898 seconds
[0m21:28:49.467695 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m21:28:49.468101 [debug] [Thread-2 (]: SQL status: BEGIN in 0.967 seconds
[0m21:28:49.468507 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_o0af"."dbt"."scooters"
[0m21:28:49.468898 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m21:28:49.469411 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_o0af"."dbt"."event_types"
[0m21:28:49.518851 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.049 seconds
[0m21:28:49.519894 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.050 seconds
[0m21:28:49.523493 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m21:28:49.528546 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m21:28:49.529018 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_o0af"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m21:28:49.529393 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_o0af"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m21:28:49.574352 [debug] [Thread-2 (]: SQL status: INSERT 0 4 in 0.045 seconds
[0m21:28:49.574979 [debug] [Thread-3 (]: SQL status: INSERT 0 10 in 0.045 seconds
[0m21:28:49.576008 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m21:28:49.576933 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m21:28:49.582365 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: COMMIT
[0m21:28:49.583903 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: COMMIT
[0m21:28:49.584373 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m21:28:49.584871 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m21:28:49.585326 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: COMMIT
[0m21:28:49.585744 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: COMMIT
[0m21:28:49.634628 [debug] [Thread-3 (]: SQL status: COMMIT in 0.048 seconds
[0m21:28:49.637425 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: Close
[0m21:28:49.638146 [debug] [Thread-2 (]: SQL status: COMMIT in 0.052 seconds
[0m21:28:49.639506 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: Close
[0m21:28:49.640459 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a796d0>]}
[0m21:28:49.642184 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159d3350>]}
[0m21:28:49.641521 [info ] [Thread-3 (]: 8 of 22 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 1.07s]
[0m21:28:49.643106 [info ] [Thread-2 (]: 7 of 22 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 1.15s]
[0m21:28:49.643965 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.scooters
[0m21:28:49.644572 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.event_types
[0m21:28:49.645105 [debug] [Thread-3 (]: Began running node model.dbt_scooters.revenue_daily
[0m21:28:49.645694 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m21:28:49.646565 [info ] [Thread-3 (]: 11 of 22 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m21:28:49.647221 [info ] [Thread-2 (]: 12 of 22 START sql table model dbt.trips_stat .................................. [RUN]
[0m21:28:49.647821 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now model.dbt_scooters.revenue_daily)
[0m21:28:49.648383 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now model.dbt_scooters.trips_stat)
[0m21:28:49.648871 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m21:28:49.649308 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m21:28:49.654187 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m21:28:49.658525 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m21:28:49.659439 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m21:28:49.662086 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m21:28:49.662508 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.revenue_daily
[0m21:28:49.665415 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:28:49.665772 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp212849664344"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_o0af"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_o0af"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m21:28:49.666074 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:28:49.666358 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:28:49.666707 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m21:28:49.666937 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:28:49.715934 [debug] [Thread-4 (]: SQL status: BEGIN in 0.613 seconds
[0m21:28:49.716359 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m21:28:49.716746 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_o0af"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



  
  
      
    ) dbt_internal_test
[0m21:28:49.764757 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.048 seconds
[0m21:28:49.768497 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m21:28:49.812872 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m21:28:49.814203 [info ] [Thread-4 (]: 9 of 22 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 0.74s]
[0m21:28:49.814781 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m21:28:49.815345 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m21:28:49.816253 [info ] [Thread-4 (]: 13 of 22 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m21:28:49.816756 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now model.dbt_scooters.parking_finish_stat)
[0m21:28:49.817161 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m21:28:49.822390 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m21:28:49.823811 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m21:28:49.828599 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m21:28:49.829908 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:28:49.830382 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m21:28:49.830764 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:28:50.056027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.619 seconds
[0m21:28:50.057427 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m21:28:50.058313 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sex
from "dev_o0af"."scooters_raw"."users"
where sex is null



  
  
      
    ) dbt_internal_test
[0m21:28:50.103572 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.045 seconds
[0m21:28:50.105518 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m21:28:50.168256 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m21:28:50.169548 [warn ] [Thread-1 (]: 10 of 22 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 0.75s]
[0m21:28:50.170543 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m21:28:50.170976 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m21:28:50.171597 [info ] [Thread-1 (]: 14 of 22 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m21:28:50.172345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now model.dbt_scooters.parking_start_stat)
[0m21:28:50.172811 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m21:28:50.177007 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m21:28:50.178253 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m21:28:50.182642 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m21:28:50.183739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:28:50.184233 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m21:28:50.184574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:50.455531 [debug] [Thread-4 (]: SQL status: BEGIN in 0.624 seconds
[0m21:28:50.456027 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:28:50.456351 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_o0af"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_o0af"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)
-- group by
--     1


select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_o0af"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m21:28:51.187848 [debug] [Thread-1 (]: SQL status: BEGIN in 1.003 seconds
[0m21:28:51.189395 [debug] [Thread-3 (]: SQL status: SELECT 3 in 1.523 seconds
[0m21:28:51.190424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:28:51.196456 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:28:51.197477 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_o0af"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_o0af"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.start_point, 3857), hex.geom)
-- group by
--     1

select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_o0af"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m21:28:51.198249 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m21:28:51.287903 [debug] [Thread-3 (]: SQL status: BEGIN in 0.088 seconds
[0m21:28:51.289474 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:28:51.290290 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp212849664344'
        
      order by ordinal_position

  
[0m21:28:51.484049 [debug] [Thread-2 (]: SQL status: BEGIN in 1.817 seconds
[0m21:28:51.484930 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.194 seconds
[0m21:28:51.485540 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:28:51.489890 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:28:51.490493 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_o0af"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_o0af"."dbt"."trips_prep"
  );
  
[0m21:28:51.490960 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m21:28:51.892727 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.401 seconds
[0m21:28:51.907920 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:28:51.908487 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp212849664344'
        
      order by ordinal_position

  
[0m21:28:51.977343 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.068 seconds
[0m21:28:51.983702 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:28:51.984192 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m21:28:52.093418 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.108 seconds
[0m21:28:52.097401 [debug] [Thread-3 (]: 
    In "dev_o0af"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:28:52.099082 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m21:28:52.101404 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:28:52.102216 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_o0af"."finance"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp212849664344" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_o0af"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp212849664344"
    )
  
[0m21:28:52.174338 [debug] [Thread-3 (]: SQL status: INSERT 0 3 in 0.071 seconds
[0m21:28:52.183199 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:28:52.183937 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_o0af".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m21:28:52.291688 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.107 seconds
[0m21:28:52.296382 [debug] [Thread-3 (]: On "dev_o0af"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m21:28:52.298247 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:28:52.299376 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m21:28:52.300401 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m21:28:52.374230 [debug] [Thread-3 (]: SQL status: COMMIT in 0.073 seconds
[0m21:28:52.377137 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: Close
[0m21:28:52.379277 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a7a810>]}
[0m21:28:52.380246 [info ] [Thread-3 (]: 11 of 22 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 2.73s]
[0m21:28:52.380985 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.revenue_daily
[0m21:28:52.381507 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies
[0m21:28:52.382130 [info ] [Thread-3 (]: 15 of 22 START sql table model dbt.companies ................................... [RUN]
[0m21:28:52.382760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.companies)
[0m21:28:52.383215 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies
[0m21:28:52.386824 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m21:28:52.389600 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies
[0m21:28:52.394287 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m21:28:52.395252 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:28:52.395606 [debug] [Thread-3 (]: On model.dbt_scooters.companies: BEGIN
[0m21:28:52.395910 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:28:53.253100 [debug] [Thread-3 (]: SQL status: BEGIN in 0.857 seconds
[0m21:28:53.253690 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:28:53.254096 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_o0af"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_o0af"."dbt"."scooters"
group by
    1
  );
  
[0m21:28:53.366567 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.112 seconds
[0m21:28:53.372198 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:28:53.372940 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_o0af"."dbt"."companies" rename to "companies__dbt_backup"
[0m21:28:53.417678 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.044 seconds
[0m21:28:53.424668 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:28:53.425696 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_o0af"."dbt"."companies__dbt_tmp" rename to "companies"
[0m21:28:53.474194 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m21:28:53.477680 [debug] [Thread-3 (]: On model.dbt_scooters.companies: COMMIT
[0m21:28:53.478525 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:28:53.479184 [debug] [Thread-3 (]: On model.dbt_scooters.companies: COMMIT
[0m21:28:53.564400 [debug] [Thread-3 (]: SQL status: COMMIT in 0.085 seconds
[0m21:28:53.565982 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."companies__dbt_backup"
[0m21:28:53.566323 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m21:28:53.566519 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_o0af"."dbt"."companies__dbt_backup" cascade
[0m21:28:53.613761 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.047 seconds
[0m21:28:53.614753 [debug] [Thread-3 (]: On model.dbt_scooters.companies: Close
[0m21:28:53.615256 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a7a3f0>]}
[0m21:28:53.615639 [info ] [Thread-3 (]: 15 of 22 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 1.23s]
[0m21:28:53.615957 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies
[0m21:28:53.616179 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_full
[0m21:28:53.616563 [info ] [Thread-3 (]: 16 of 22 START sql view model dbt.events_full .................................. [RUN]
[0m21:28:53.616887 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.events_full)
[0m21:28:53.617111 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_full
[0m21:28:53.618768 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m21:28:53.619611 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_full
[0m21:28:53.621656 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m21:28:53.622036 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:28:53.622212 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: BEGIN
[0m21:28:53.622366 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:28:54.167160 [debug] [Thread-2 (]: SQL status: SELECT 1 in 2.676 seconds
[0m21:28:54.172757 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:28:54.173702 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_o0af"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m21:28:54.266132 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m21:28:54.272215 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:28:54.273094 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_o0af"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m21:28:54.363141 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.089 seconds
[0m21:28:54.366022 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:28:54.366649 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:28:54.367120 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m21:28:54.464302 [debug] [Thread-3 (]: SQL status: BEGIN in 0.842 seconds
[0m21:28:54.465021 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:28:54.466066 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_o0af"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_o0af"."dbt"."events_clean"
    left join "dev_o0af"."dbt"."event_types"
        using (type_id)
  );
[0m21:28:54.466505 [debug] [Thread-2 (]: SQL status: COMMIT in 0.099 seconds
[0m21:28:54.469260 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."trips_stat__dbt_backup"
[0m21:28:54.470035 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m21:28:54.470385 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_o0af"."dbt"."trips_stat__dbt_backup" cascade
[0m21:28:54.567197 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.100 seconds
[0m21:28:54.572059 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:28:54.572608 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_o0af"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m21:28:54.664534 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m21:28:54.670715 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:28:54.671295 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_o0af"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m21:28:54.676675 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.206 seconds
[0m21:28:54.679239 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m21:28:54.681138 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158b6a50>]}
[0m21:28:54.682278 [info ] [Thread-2 (]: 12 of 22 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 5.03s]
[0m21:28:54.683090 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m21:28:54.683673 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_users
[0m21:28:54.684365 [info ] [Thread-2 (]: 17 of 22 START sql incremental model dbt.trips_users ........................... [RUN]
[0m21:28:54.684960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m21:28:54.685397 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_users
[0m21:28:54.690904 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m21:28:54.692074 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_users
[0m21:28:54.696217 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:28:54.696604 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp212854694226"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_o0af"."dbt"."trips_prep" as t
left join
    "dev_o0af"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_o0af"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m21:28:54.696939 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:28:54.764584 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m21:28:54.767107 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m21:28:54.767750 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:28:54.768139 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m21:28:54.864703 [debug] [Thread-3 (]: SQL status: COMMIT in 0.096 seconds
[0m21:28:54.870223 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."events_full__dbt_backup"
[0m21:28:54.871327 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:28:54.872059 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_o0af"."dbt"."events_full__dbt_backup" cascade
[0m21:28:54.964489 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.092 seconds
[0m21:28:54.967960 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: Close
[0m21:28:54.969878 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a78290>]}
[0m21:28:54.971033 [info ] [Thread-3 (]: 16 of 22 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 1.35s]
[0m21:28:54.971903 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_full
[0m21:28:54.972499 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies_trips
[0m21:28:54.973229 [info ] [Thread-3 (]: 18 of 22 START sql table model dbt.companies_trips ............................. [RUN]
[0m21:28:54.974018 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.companies_trips)
[0m21:28:54.974460 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies_trips
[0m21:28:54.979647 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m21:28:54.981678 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies_trips
[0m21:28:54.986531 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m21:28:54.987629 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:28:54.987977 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m21:28:54.988275 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:28:57.066145 [debug] [Thread-3 (]: SQL status: BEGIN in 2.077 seconds
[0m21:28:57.067521 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:28:57.068820 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_o0af"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_o0af"."dbt"."trips_prep" as t
        join "dev_o0af"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_o0af"."dbt"."companies" as c
        using (company)
  );
  
[0m21:28:58.067418 [debug] [Thread-2 (]: SQL status: SELECT 0 in 3.370 seconds
[0m21:28:58.071168 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:28:58.071857 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: BEGIN
[0m21:28:58.162844 [debug] [Thread-2 (]: SQL status: BEGIN in 0.090 seconds
[0m21:28:58.163474 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:28:58.163887 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp212854694226'
        
      order by ordinal_position

  
[0m21:28:59.167571 [debug] [Thread-2 (]: SQL status: SELECT 17 in 1.003 seconds
[0m21:28:59.170687 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:28:59.171047 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:28:59.564253 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.393 seconds
[0m21:28:59.571460 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:28:59.572348 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp212854694226'
        
      order by ordinal_position

  
[0m21:28:59.965083 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.392 seconds
[0m21:28:59.972557 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:28:59.973320 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:29:00.367521 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.393 seconds
[0m21:29:00.374413 [debug] [Thread-2 (]: 
    In "dev_o0af"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:29:00.383160 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m21:29:00.385305 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:29:00.385682 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_o0af"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp212854694226"
    )


  
[0m21:29:00.465751 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.079 seconds
[0m21:29:00.468460 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:29:00.469023 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m21:29:01.065863 [debug] [Thread-3 (]: SQL status: SELECT 6 in 3.995 seconds
[0m21:29:01.071687 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:29:01.072221 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_o0af"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m21:29:01.167403 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m21:29:01.174896 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:29:01.175529 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_o0af"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m21:29:01.264203 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m21:29:01.268719 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:29:01.269908 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:29:01.270626 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m21:29:01.365978 [debug] [Thread-3 (]: SQL status: COMMIT in 0.095 seconds
[0m21:29:01.372555 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."companies_trips__dbt_backup"
[0m21:29:01.373258 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m21:29:01.373672 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_o0af"."dbt"."companies_trips__dbt_backup" cascade
[0m21:29:01.565205 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.191 seconds
[0m21:29:01.568487 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: Close
[0m21:29:01.570190 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158b71d0>]}
[0m21:29:01.571444 [info ] [Thread-3 (]: 18 of 22 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 6.60s]
[0m21:29:01.572424 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies_trips
[0m21:29:01.573111 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_stat
[0m21:29:01.573874 [info ] [Thread-3 (]: 19 of 22 START sql table model dbt.events_stat ................................. [RUN]
[0m21:29:01.574541 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.events_stat)
[0m21:29:01.575014 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_stat
[0m21:29:01.579328 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m21:29:01.582319 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_stat
[0m21:29:01.586617 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m21:29:01.587407 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:29:01.587751 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: BEGIN
[0m21:29:01.588053 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:02.866718 [debug] [Thread-3 (]: SQL status: BEGIN in 1.278 seconds
[0m21:29:02.867894 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:29:02.868490 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_o0af"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_o0af"."dbt"."events_full"
  );
  
[0m21:29:08.378504 [debug] [Thread-3 (]: SQL status: SELECT 1 in 5.509 seconds
[0m21:29:08.386611 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:29:08.387528 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_o0af"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m21:29:08.475380 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.087 seconds
[0m21:29:08.481812 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:29:08.482582 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_o0af"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m21:29:08.566352 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.083 seconds
[0m21:29:08.569870 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: COMMIT
[0m21:29:08.570732 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:29:08.571299 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: COMMIT
[0m21:29:08.763236 [debug] [Thread-3 (]: SQL status: COMMIT in 0.191 seconds
[0m21:29:08.773314 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."events_stat__dbt_backup"
[0m21:29:08.774118 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m21:29:08.774447 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_o0af"."dbt"."events_stat__dbt_backup" cascade
[0m21:29:08.864357 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.089 seconds
[0m21:29:08.867641 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: Close
[0m21:29:08.869395 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a7a090>]}
[0m21:29:08.870675 [info ] [Thread-3 (]: 19 of 22 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 7.29s]
[0m21:29:08.871588 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_stat
[0m21:29:10.765533 [debug] [Thread-2 (]: SQL status: ANALYZE in 10.296 seconds
[0m21:29:10.768495 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:29:10.769251 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:29:10.769902 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m21:29:10.866088 [debug] [Thread-2 (]: SQL status: COMMIT in 0.095 seconds
[0m21:29:10.868157 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:29:10.868843 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m21:29:10.964022 [debug] [Thread-2 (]: SQL status: COMMIT in 0.094 seconds
[0m21:29:10.967246 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m21:29:10.968031 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m21:29:11.066015 [debug] [Thread-2 (]: SQL status: VACUUM in 0.097 seconds
[0m21:29:11.069339 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: Close
[0m21:29:11.070944 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159d29f0>]}
[0m21:29:11.072178 [info ] [Thread-2 (]: 17 of 22 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 16.39s]
[0m21:29:11.073228 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_users
[0m21:29:11.074133 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m21:29:11.074747 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m21:29:11.075464 [info ] [Thread-3 (]: 20 of 22 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m21:29:11.076061 [info ] [Thread-2 (]: 21 of 22 START sql table model dbt.trips_age_group ............................. [RUN]
[0m21:29:11.076840 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now model.dbt_scooters.trips_age_daily)
[0m21:29:11.077452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_group)
[0m21:29:11.078023 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m21:29:11.078473 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m21:29:11.081925 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m21:29:11.084802 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m21:29:11.085782 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m21:29:11.086012 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m21:29:11.088646 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m21:29:11.090301 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m21:29:11.091381 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:29:11.091608 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:29:11.091780 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m21:29:11.091932 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m21:29:11.092072 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:11.092202 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:29:13.164006 [debug] [Thread-3 (]: SQL status: BEGIN in 2.071 seconds
[0m21:29:13.165556 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:29:13.166395 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_o0af"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m21:29:13.270409 [debug] [Thread-2 (]: SQL status: BEGIN in 2.178 seconds
[0m21:29:13.271551 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:29:13.272367 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_o0af"."dbt"."trips_users" as tu
    cross join "dev_o0af"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m21:29:18.164983 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 4.998 seconds
[0m21:29:18.173089 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:29:18.173592 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_o0af"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m21:29:18.263960 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m21:29:18.270789 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:29:18.271761 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_o0af"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m21:29:18.367465 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m21:29:18.371243 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:29:18.372087 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:29:18.372514 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m21:29:18.463105 [debug] [Thread-3 (]: SQL status: COMMIT in 0.090 seconds
[0m21:29:18.467818 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_daily__dbt_backup"
[0m21:29:18.469120 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m21:29:18.469871 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_o0af"."dbt"."trips_age_daily__dbt_backup" cascade
[0m21:29:18.767228 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.296 seconds
[0m21:29:18.770789 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m21:29:18.771862 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159d28d0>]}
[0m21:29:18.772737 [info ] [Thread-3 (]: 20 of 22 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 7.70s]
[0m21:29:18.773579 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m21:29:18.774457 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m21:29:18.775076 [info ] [Thread-3 (]: 22 of 22 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m21:29:18.775749 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now model.dbt_scooters.trips_age_daily_stat)
[0m21:29:18.776188 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m21:29:18.779756 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:29:18.781231 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m21:29:18.786021 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m21:29:18.787263 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:29:18.787475 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m21:29:18.787645 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:29:20.463152 [debug] [Thread-3 (]: SQL status: BEGIN in 1.675 seconds
[0m21:29:20.464262 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:29:20.465130 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_o0af"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m21:29:21.066822 [debug] [Thread-3 (]: SQL status: SELECT 83 in 0.601 seconds
[0m21:29:21.075229 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:29:21.076038 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_o0af"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m21:29:21.163182 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.086 seconds
[0m21:29:21.169645 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:29:21.170487 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_o0af"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m21:29:21.275198 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.104 seconds
[0m21:29:21.279225 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:29:21.280076 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:29:21.280617 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m21:29:21.365968 [debug] [Thread-3 (]: SQL status: COMMIT in 0.085 seconds
[0m21:29:21.371387 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_daily_stat__dbt_backup"
[0m21:29:21.373512 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m21:29:21.374485 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_o0af"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m21:29:21.563895 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.188 seconds
[0m21:29:21.567119 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m21:29:21.568615 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159d28d0>]}
[0m21:29:21.569857 [info ] [Thread-3 (]: 22 of 22 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 2.79s]
[0m21:29:21.570709 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m21:29:31.969812 [debug] [Thread-1 (]: SQL status: SELECT 142 in 40.770 seconds
[0m21:29:31.976902 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:31.977867 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_o0af"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m21:29:32.066735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.088 seconds
[0m21:29:32.073180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:32.073870 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_o0af"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m21:29:32.166288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m21:29:32.170360 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:29:32.170981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:32.171534 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m21:29:32.266662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.094 seconds
[0m21:29:32.272525 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."parking_start_stat__dbt_backup"
[0m21:29:32.273508 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m21:29:32.273870 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_o0af"."dbt"."parking_start_stat__dbt_backup" cascade
[0m21:29:32.371160 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.097 seconds
[0m21:29:32.375607 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m21:29:32.376909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136b7c50>]}
[0m21:29:32.377909 [info ] [Thread-1 (]: 14 of 22 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 42.20s]
[0m21:29:32.378777 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m21:29:38.566531 [debug] [Thread-4 (]: SQL status: SELECT 464 in 48.109 seconds
[0m21:29:38.572711 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:29:38.573194 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_o0af"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m21:29:38.668658 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m21:29:38.675406 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:29:38.676018 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_o0af"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m21:29:38.763456 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.087 seconds
[0m21:29:38.768047 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m21:29:38.768714 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:29:38.769256 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m21:29:38.880033 [debug] [Thread-4 (]: SQL status: COMMIT in 0.110 seconds
[0m21:29:38.886714 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."parking_finish_stat__dbt_backup"
[0m21:29:38.887684 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m21:29:38.888266 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_o0af"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m21:29:39.065084 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.176 seconds
[0m21:29:39.068512 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m21:29:39.070066 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a7adb0>]}
[0m21:29:39.071239 [info ] [Thread-4 (]: 13 of 22 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 49.25s]
[0m21:29:39.071976 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m21:29:43.870099 [debug] [Thread-2 (]: SQL status: SELECT 7 in 30.596 seconds
[0m21:29:43.876644 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:29:43.877537 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_o0af"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m21:29:43.923090 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m21:29:43.930292 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:29:43.931215 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_o0af"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m21:29:43.977449 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m21:29:43.980405 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:29:43.981124 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:29:43.981614 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m21:29:44.027611 [debug] [Thread-2 (]: SQL status: COMMIT in 0.045 seconds
[0m21:29:44.033872 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_group__dbt_backup"
[0m21:29:44.035060 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m21:29:44.035763 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_o0af"."dbt"."trips_age_group__dbt_backup" cascade
[0m21:29:44.084135 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.047 seconds
[0m21:29:44.088180 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m21:29:44.089635 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecaf0f9-32aa-4f85-bbf1-60311dc1a567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a7ae10>]}
[0m21:29:44.090689 [info ] [Thread-2 (]: 21 of 22 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 33.01s]
[0m21:29:44.091596 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m21:29:44.094146 [info ] [MainThread]: 
[0m21:29:44.094882 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:44.095335 [debug] [MainThread]: On master: BEGIN
[0m21:29:44.095687 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:44.744308 [debug] [MainThread]: SQL status: BEGIN in 0.648 seconds
[0m21:29:44.745394 [debug] [MainThread]: On master: COMMIT
[0m21:29:44.746030 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:44.746756 [debug] [MainThread]: On master: COMMIT
[0m21:29:44.792043 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m21:29:44.796296 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m21:29:44.803683 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m21:29:44.804720 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:44.805657 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m21:29:44.852827 [debug] [MainThread]: SQL status: GRANT in 0.046 seconds
[0m21:29:44.854690 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.06s]
[0m21:29:44.855622 [debug] [MainThread]: On master: Close
[0m21:29:44.856519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:44.856799 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m21:29:44.857024 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m21:29:44.857228 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m21:29:44.857428 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m21:29:44.857844 [info ] [MainThread]: 
[0m21:29:44.858169 [info ] [MainThread]: Finished running 3 incremental models, 1 project hook, 3 seeds, 12 table models, 2 data tests, 2 view models in 0 hours 1 minutes and 5.52 seconds (65.52s).
[0m21:29:44.860045 [debug] [MainThread]: Command end result
[0m21:29:44.876791 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:29:44.878581 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:29:44.883158 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:29:44.883378 [info ] [MainThread]: 
[0m21:29:44.883551 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m21:29:44.883678 [info ] [MainThread]: 
[0m21:29:44.883852 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models/properties.yml)[0m
[0m21:29:44.884002 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m21:29:44.884103 [info ] [MainThread]: 
[0m21:29:44.884231 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/source_not_null_scooters_raw_users_sex.sql
[0m21:29:44.884362 [info ] [MainThread]: 
[0m21:29:44.884507 [info ] [MainThread]: Done. PASS=22 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m21:29:44.886562 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 65.876625, "process_in_blocks": "0", "process_kernel_time": 0.284174, "process_mem_max_rss": "142360576", "process_out_blocks": "0", "process_user_time": 2.230805}
[0m21:29:44.886805 [debug] [MainThread]: Command `dbt build` succeeded at 21:29:44.886762 after 65.88 seconds
[0m21:29:44.886987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107062e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b181d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b192b0>]}
[0m21:29:44.887154 [debug] [MainThread]: Flushing usage events
[0m21:29:45.860854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:01:45.912568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036134d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0fb10>]}


============================== 22:01:45.914551 | 222629ef-dfc2-4a61-9ff3-e88fc9edfdba ==============================
[0m22:01:45.914551 [info ] [MainThread]: Running with dbt=1.10.6
[0m22:01:45.914847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:01:45.979367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '222629ef-dfc2-4a61-9ff3-e88fc9edfdba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e13490>]}
[0m22:01:45.999827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '222629ef-dfc2-4a61-9ff3-e88fc9edfdba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a5f20>]}
[0m22:01:46.000156 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:01:46.036558 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m22:01:46.095583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:01:46.095773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:01:46.121311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '222629ef-dfc2-4a61-9ff3-e88fc9edfdba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105790d50>]}
[0m22:01:46.166235 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:01:46.168262 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:01:46.180110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '222629ef-dfc2-4a61-9ff3-e88fc9edfdba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac32f0>]}
[0m22:01:46.180320 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 3 data tests, 17 sources, 439 macros
[0m22:01:46.180466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '222629ef-dfc2-4a61-9ff3-e88fc9edfdba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abeeb0>]}
[0m22:01:46.181404 [info ] [MainThread]: 
[0m22:01:46.181546 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:01:46.181653 [info ] [MainThread]: 
[0m22:01:46.181846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:01:46.183667 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af_finance'
[0m22:01:46.188472 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af_dbt'
[0m22:01:46.204929 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m22:01:46.205129 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m22:01:46.205257 [debug] [ThreadPool]: On list_dev_o0af_finance: BEGIN
[0m22:01:46.205372 [debug] [ThreadPool]: On list_dev_o0af_dbt: BEGIN
[0m22:01:46.205476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:46.205577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:48.914124 [debug] [ThreadPool]: SQL status: BEGIN in 2.708 seconds
[0m22:01:48.915068 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m22:01:48.916141 [debug] [ThreadPool]: On list_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_finance"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m22:01:48.985293 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.068 seconds
[0m22:01:48.989602 [debug] [ThreadPool]: On list_dev_o0af_finance: ROLLBACK
[0m22:01:49.084866 [debug] [ThreadPool]: On list_dev_o0af_finance: Close
[0m22:01:49.429319 [debug] [ThreadPool]: SQL status: BEGIN in 3.223 seconds
[0m22:01:49.430747 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m22:01:49.431801 [debug] [ThreadPool]: On list_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_dbt"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m22:01:49.509497 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.077 seconds
[0m22:01:49.514148 [debug] [ThreadPool]: On list_dev_o0af_dbt: ROLLBACK
[0m22:01:49.557291 [debug] [ThreadPool]: On list_dev_o0af_dbt: Close
[0m22:01:49.570244 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:49.570750 [debug] [MainThread]: On master: BEGIN
[0m22:01:49.571053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:01:50.322255 [debug] [MainThread]: SQL status: BEGIN in 0.751 seconds
[0m22:01:50.323850 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:50.325182 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:01:50.380208 [debug] [MainThread]: SQL status: SELECT 3 in 0.054 seconds
[0m22:01:50.381350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '222629ef-dfc2-4a61-9ff3-e88fc9edfdba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb8120>]}
[0m22:01:50.381613 [debug] [MainThread]: On master: ROLLBACK
[0m22:01:50.427341 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:50.427568 [debug] [MainThread]: On master: BEGIN
[0m22:01:50.520616 [debug] [MainThread]: SQL status: BEGIN in 0.093 seconds
[0m22:01:50.521659 [debug] [MainThread]: On master: COMMIT
[0m22:01:50.522228 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:50.522676 [debug] [MainThread]: On master: COMMIT
[0m22:01:50.566633 [debug] [MainThread]: SQL status: COMMIT in 0.044 seconds
[0m22:01:50.567348 [debug] [MainThread]: On master: Close
[0m22:01:50.576142 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:01:50.576754 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c
[0m22:01:50.577238 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:01:50.577842 [info ] [Thread-1 (]: 1 of 3 START test source_accepted_values_scooters_raw_users_sex__M__F .......... [RUN]
[0m22:01:50.578444 [info ] [Thread-3 (]: 3 of 3 START test source_unique_scooters_raw_companies_trips_company ........... [RUN]
[0m22:01:50.578977 [info ] [Thread-2 (]: 2 of 3 START test source_not_null_scooters_raw_users_sex ....................... [RUN]
[0m22:01:50.579610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_o0af_finance, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m22:01:50.580268 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c'
[0m22:01:50.580752 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_o0af_dbt, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m22:01:50.581296 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:01:50.581743 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c
[0m22:01:50.582109 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:01:50.633542 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c"
[0m22:01:50.637263 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:01:50.641245 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:01:50.642790 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c
[0m22:01:50.650375 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c"
[0m22:01:50.650715 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:01:50.650888 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:01:50.652034 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:01:50.652919 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:01:50.653226 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c"
[0m22:01:50.653421 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c: BEGIN
[0m22:01:50.653587 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:01:50.653835 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:01:50.654005 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:01:50.654148 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m22:01:50.654283 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m22:01:50.654410 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:01:50.654541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:51.331522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.676 seconds
[0m22:01:51.332883 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:01:51.333923 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_o0af"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



  
  
      
    ) dbt_internal_test
[0m22:01:51.380710 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.046 seconds
[0m22:01:51.387502 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m22:01:51.431762 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m22:01:51.433801 [info ] [Thread-1 (]: 1 of 3 PASS source_accepted_values_scooters_raw_users_sex__M__F ................ [[32mPASS[0m in 0.85s]
[0m22:01:51.434951 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:01:51.576889 [debug] [Thread-2 (]: SQL status: BEGIN in 0.922 seconds
[0m22:01:51.578534 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:01:51.579577 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sex
from "dev_o0af"."scooters_raw"."users"
where sex is null



  
  
      
    ) dbt_internal_test
[0m22:01:51.660153 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.080 seconds
[0m22:01:51.664900 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m22:01:51.781740 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m22:01:51.785068 [warn ] [Thread-2 (]: 2 of 3 WARN 216 source_not_null_scooters_raw_users_sex ......................... [[33mWARN 216[0m in 1.20s]
[0m22:01:51.786104 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:01:51.986245 [debug] [Thread-3 (]: SQL status: BEGIN in 1.332 seconds
[0m22:01:51.987056 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c"
[0m22:01:51.987550 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_o0af"."scooters_raw"."companies_trips"
where company is not null
group by company
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:01:52.089020 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "scooters_raw.companies_trips" does not exist
LINE 18: from "dev_o0af"."scooters_raw"."companies_trips"
              ^

[0m22:01:52.090729 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c: ROLLBACK
[0m22:01:52.191523 [debug] [Thread-3 (]: On test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c: Close
[0m22:01:52.206387 [debug] [Thread-3 (]: Database Error in test source_unique_scooters_raw_companies_trips_company (models/properties.yml)
  relation "scooters_raw.companies_trips" does not exist
  LINE 18: from "dev_o0af"."scooters_raw"."companies_trips"
                ^
  compiled code at target/run/dbt_scooters/models/properties.yml/source_unique_scooters_raw_companies_trips_company.sql
[0m22:01:52.207142 [error] [Thread-3 (]: 3 of 3 ERROR source_unique_scooters_raw_companies_trips_company ................ [[31mERROR[0m in 1.63s]
[0m22:01:52.207791 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c
[0m22:01:52.208301 [debug] [Thread-7 (]: Marking all children of 'test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c' to be skipped because of status 'error'.  Reason: Database Error in test source_unique_scooters_raw_companies_trips_company (models/properties.yml)
  relation "scooters_raw.companies_trips" does not exist
  LINE 18: from "dev_o0af"."scooters_raw"."companies_trips"
                ^
  compiled code at target/run/dbt_scooters/models/properties.yml/source_unique_scooters_raw_companies_trips_company.sql.
[0m22:01:52.210146 [info ] [MainThread]: 
[0m22:01:52.210516 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:52.210764 [debug] [MainThread]: On master: BEGIN
[0m22:01:52.210998 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:01:53.317372 [debug] [MainThread]: SQL status: BEGIN in 1.106 seconds
[0m22:01:53.318945 [debug] [MainThread]: On master: COMMIT
[0m22:01:53.319869 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:53.320387 [debug] [MainThread]: On master: COMMIT
[0m22:01:53.419832 [debug] [MainThread]: SQL status: COMMIT in 0.099 seconds
[0m22:01:53.423739 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m22:01:53.432748 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m22:01:53.433390 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:53.434194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m22:01:53.524766 [debug] [MainThread]: SQL status: GRANT in 0.090 seconds
[0m22:01:53.526015 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.10s]
[0m22:01:53.526453 [debug] [MainThread]: On master: Close
[0m22:01:53.527116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:53.527407 [debug] [MainThread]: Connection 'test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b' was properly closed.
[0m22:01:53.527663 [debug] [MainThread]: Connection 'test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee' was properly closed.
[0m22:01:53.527910 [debug] [MainThread]: Connection 'test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c' was properly closed.
[0m22:01:53.528215 [info ] [MainThread]: 
[0m22:01:53.528512 [info ] [MainThread]: Finished running 1 project hook, 3 data tests in 0 hours 0 minutes and 7.35 seconds (7.35s).
[0m22:01:53.529546 [debug] [MainThread]: Command end result
[0m22:01:53.557688 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:01:53.559143 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:01:53.564409 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m22:01:53.564628 [info ] [MainThread]: 
[0m22:01:53.564831 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 1 warning:[0m
[0m22:01:53.565000 [info ] [MainThread]: 
[0m22:01:53.565218 [error] [MainThread]: [31mFailure in test source_unique_scooters_raw_companies_trips_company (models/properties.yml)[0m
[0m22:01:53.565436 [error] [MainThread]:   Database Error in test source_unique_scooters_raw_companies_trips_company (models/properties.yml)
  relation "scooters_raw.companies_trips" does not exist
  LINE 18: from "dev_o0af"."scooters_raw"."companies_trips"
                ^
  compiled code at target/run/dbt_scooters/models/properties.yml/source_unique_scooters_raw_companies_trips_company.sql
[0m22:01:53.565592 [info ] [MainThread]: 
[0m22:01:53.565806 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/source_unique_scooters_raw_companies_trips_company.sql
[0m22:01:53.565960 [info ] [MainThread]: 
[0m22:01:53.566152 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models/properties.yml)[0m
[0m22:01:53.566343 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m22:01:53.566483 [info ] [MainThread]: 
[0m22:01:53.566659 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/source_not_null_scooters_raw_users_sex.sql
[0m22:01:53.566806 [info ] [MainThread]: 
[0m22:01:53.566979 [info ] [MainThread]: Done. PASS=2 WARN=1 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m22:01:53.629934 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 7.74703, "process_in_blocks": "0", "process_kernel_time": 0.148414, "process_mem_max_rss": "137936896", "process_out_blocks": "0", "process_user_time": 0.989882}
[0m22:01:53.630346 [debug] [MainThread]: Command `dbt test` failed at 22:01:53.630281 after 7.75 seconds
[0m22:01:53.630618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b37280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b371d0>]}
[0m22:01:53.630862 [debug] [MainThread]: Flushing usage events
[0m22:01:55.981501 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:02:24.227631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10355b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a579d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a57b10>]}


============================== 22:02:24.230057 | 1cb1d86c-08ed-4598-8684-2986cfa18301 ==============================
[0m22:02:24.230057 [info ] [MainThread]: Running with dbt=1.10.6
[0m22:02:24.230322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:02:24.297045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d5b490>]}
[0m22:02:24.317713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048edf20>]}
[0m22:02:24.318762 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:02:24.355381 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m22:02:24.422889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:02:24.423065 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:02:24.448184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d8450>]}
[0m22:02:24.491526 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:02:24.492595 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:02:24.509897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a23e30>]}
[0m22:02:24.510159 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 3 data tests, 17 sources, 439 macros
[0m22:02:24.511562 [info ] [MainThread]: 
[0m22:02:24.511713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:02:24.511825 [info ] [MainThread]: 
[0m22:02:24.512061 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:02:24.513959 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af'
[0m22:02:24.518882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af'
[0m22:02:24.537275 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af"
[0m22:02:24.537473 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af"
[0m22:02:24.537607 [debug] [ThreadPool]: On list_dev_o0af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af"} */

    select distinct nspname from pg_namespace
  
[0m22:02:24.537731 [debug] [ThreadPool]: On list_dev_o0af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af"} */

    select distinct nspname from pg_namespace
  
[0m22:02:24.537849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:24.537948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:25.675899 [debug] [ThreadPool]: SQL status: SELECT 21 in 1.138 seconds
[0m22:02:25.676953 [debug] [ThreadPool]: On list_dev_o0af: Close
[0m22:02:25.779954 [debug] [ThreadPool]: SQL status: SELECT 21 in 1.242 seconds
[0m22:02:25.782673 [debug] [ThreadPool]: On list_dev_o0af: Close
[0m22:02:25.786780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_o0af, now list_dev_o0af_finance)
[0m22:02:25.793242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_o0af, now list_dev_o0af_dbt)
[0m22:02:25.795130 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m22:02:25.796911 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m22:02:25.797241 [debug] [ThreadPool]: On list_dev_o0af_finance: BEGIN
[0m22:02:25.797515 [debug] [ThreadPool]: On list_dev_o0af_dbt: BEGIN
[0m22:02:25.797765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:25.797994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:28.850794 [debug] [ThreadPool]: SQL status: BEGIN in 3.053 seconds
[0m22:02:28.852318 [debug] [ThreadPool]: SQL status: BEGIN in 3.054 seconds
[0m22:02:28.853399 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m22:02:28.854359 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m22:02:28.854953 [debug] [ThreadPool]: On list_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_finance"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m22:02:28.855531 [debug] [ThreadPool]: On list_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_dbt"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m22:02:28.952852 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.097 seconds
[0m22:02:28.956749 [debug] [ThreadPool]: On list_dev_o0af_finance: ROLLBACK
[0m22:02:29.055172 [debug] [ThreadPool]: On list_dev_o0af_finance: Close
[0m22:02:29.259941 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.404 seconds
[0m22:02:29.262745 [debug] [ThreadPool]: On list_dev_o0af_dbt: ROLLBACK
[0m22:02:29.365854 [debug] [ThreadPool]: On list_dev_o0af_dbt: Close
[0m22:02:29.431474 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:29.431730 [debug] [MainThread]: On master: BEGIN
[0m22:02:29.431880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:30.796013 [debug] [MainThread]: SQL status: BEGIN in 1.364 seconds
[0m22:02:30.797118 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:30.797869 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:02:30.898379 [debug] [MainThread]: SQL status: SELECT 3 in 0.100 seconds
[0m22:02:30.902810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059fb930>]}
[0m22:02:30.903680 [debug] [MainThread]: On master: ROLLBACK
[0m22:02:31.003111 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:31.003850 [debug] [MainThread]: On master: BEGIN
[0m22:02:31.205875 [debug] [MainThread]: SQL status: BEGIN in 0.201 seconds
[0m22:02:31.207336 [debug] [MainThread]: On master: COMMIT
[0m22:02:31.208382 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:31.209280 [debug] [MainThread]: On master: COMMIT
[0m22:02:31.308044 [debug] [MainThread]: SQL status: COMMIT in 0.098 seconds
[0m22:02:31.309138 [debug] [MainThread]: On master: Close
[0m22:02:31.318296 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m22:02:31.318996 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m22:02:31.319469 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m22:02:31.319908 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m22:02:31.320729 [info ] [Thread-1 (]: 1 of 23 START sql incremental model dbt.events_clean ........................... [RUN]
[0m22:02:31.321347 [info ] [Thread-3 (]: 3 of 23 START sql table model dbt.trips_geom ................................... [RUN]
[0m22:02:31.321875 [info ] [Thread-4 (]: 4 of 23 START sql view model dbt.trips_prep .................................... [RUN]
[0m22:02:31.322462 [info ] [Thread-2 (]: 2 of 23 START sql table model dbt.trips_concurrency ............................ [RUN]
[0m22:02:31.323125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_o0af_finance, now model.dbt_scooters.events_clean)
[0m22:02:31.323707 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m22:02:31.324223 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_prep'
[0m22:02:31.324934 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_o0af_dbt, now model.dbt_scooters.trips_concurrency)
[0m22:02:31.325588 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m22:02:31.326014 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m22:02:31.326377 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m22:02:31.326720 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m22:02:31.342044 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m22:02:31.343860 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m22:02:31.346410 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m22:02:31.348839 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m22:02:31.349623 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m22:02:31.349889 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m22:02:31.350147 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m22:02:31.350341 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m22:02:31.374960 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m22:02:31.386724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:02:31.392149 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m22:02:31.393320 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m22:02:31.393542 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp220231380176"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_o0af"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_o0af"."dbt"."events_clean")
    

  );
  
  
[0m22:02:31.393824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:31.394146 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:02:31.394309 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:02:31.394447 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:02:31.394569 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m22:02:31.394698 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m22:02:31.394818 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m22:02:31.394941 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:02:31.395063 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:02:31.395180 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:02:32.845707 [debug] [Thread-4 (]: SQL status: BEGIN in 1.450 seconds
[0m22:02:32.846765 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:02:32.847238 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_o0af"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,

    date(started_at at time zone 'Europe/Moscow')
 as "date" 
from
"dev_o0af"."scooters_raw"."trips"
  );
[0m22:02:32.948812 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.101 seconds
[0m22:02:32.960224 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:02:32.960713 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_o0af"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m22:02:33.051025 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m22:02:33.057891 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:02:33.058338 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_o0af"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m22:02:33.153127 [debug] [Thread-3 (]: SQL status: BEGIN in 1.757 seconds
[0m22:02:33.154294 [debug] [Thread-2 (]: SQL status: BEGIN in 1.759 seconds
[0m22:02:33.154978 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.096 seconds
[0m22:02:33.155577 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:02:33.156238 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:02:33.169709 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  
    

  create  table "dev_o0af"."dbt"."trips_geom__dbt_tmp"
  
  
    as
  
  (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_o0af"."scooters_raw"."trips"
  );
  
[0m22:02:33.178159 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m22:02:33.178670 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

  
    

  create  table "dev_o0af"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_o0af"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
[0m22:02:33.179127 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:02:33.179531 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m22:02:33.357988 [debug] [Thread-4 (]: SQL status: COMMIT in 0.178 seconds
[0m22:02:33.368292 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."trips_prep__dbt_backup"
[0m22:02:33.373222 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:02:33.373553 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_o0af"."dbt"."trips_prep__dbt_backup" cascade
[0m22:02:33.561483 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.187 seconds
[0m22:02:33.568442 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m22:02:33.573248 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f08ef0>]}
[0m22:02:33.574245 [info ] [Thread-4 (]: 4 of 23 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 2.25s]
[0m22:02:33.574949 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m22:02:33.575441 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m22:02:33.576021 [info ] [Thread-4 (]: 5 of 23 START sql table model dbt.trips_stat_daily ............................. [RUN]
[0m22:02:33.576754 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.trips_stat_daily)
[0m22:02:33.577147 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m22:02:33.578980 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m22:02:33.579727 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m22:02:33.582524 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m22:02:33.583154 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:02:33.583441 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m22:02:33.583716 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:02:35.609183 [debug] [Thread-4 (]: SQL status: BEGIN in 2.025 seconds
[0m22:02:35.610738 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:02:35.611943 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_o0af"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
  
[0m22:02:37.247597 [debug] [Thread-2 (]: SQL status: SELECT 10 in 4.068 seconds
[0m22:02:37.261249 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:02:37.262059 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_o0af"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m22:02:37.264743 [debug] [Thread-4 (]: SQL status: SELECT 91 in 1.652 seconds
[0m22:02:37.268479 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:02:37.268914 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_o0af"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m22:02:37.450494 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.188 seconds
[0m22:02:37.454028 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:02:37.454374 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_o0af"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m22:02:37.557979 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.103 seconds
[0m22:02:37.563207 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m22:02:37.564528 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:02:37.565056 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m22:02:37.655066 [debug] [Thread-1 (]: SQL status: SELECT 0 in 6.261 seconds
[0m22:02:37.655520 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.386 seconds
[0m22:02:37.665368 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:02:37.666998 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:02:37.667225 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m22:02:37.667437 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_o0af"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m22:02:37.669925 [debug] [Thread-2 (]: SQL status: COMMIT in 0.105 seconds
[0m22:02:37.671458 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."trips_concurrency__dbt_backup"
[0m22:02:37.673204 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:02:37.673435 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_o0af"."dbt"."trips_concurrency__dbt_backup" cascade
[0m22:02:37.760914 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m22:02:37.763400 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m22:02:37.763943 [debug] [Thread-3 (]: SQL status: SELECT 105901 in 4.585 seconds
[0m22:02:37.764387 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:02:37.768257 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:02:37.768828 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m22:02:37.769256 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_o0af"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m22:02:37.863822 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m22:02:37.865568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.198 seconds
[0m22:02:37.872492 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:02:37.873120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:02:37.873649 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_o0af"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m22:02:37.874172 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp220231380176'
        
      order by ordinal_position

  
[0m22:02:38.066855 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.192 seconds
[0m22:02:38.068426 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.193 seconds
[0m22:02:38.071807 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m22:02:38.080170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:02:38.080628 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:02:38.081158 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:02:38.081565 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m22:02:38.169104 [debug] [Thread-3 (]: SQL status: COMMIT in 0.087 seconds
[0m22:02:38.170600 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.088 seconds
[0m22:02:38.175496 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_geom__dbt_backup"
[0m22:02:38.189320 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:02:38.194476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:02:38.194825 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop table if exists "dev_o0af"."dbt"."trips_geom__dbt_backup" cascade
[0m22:02:38.195140 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp220231380176'
        
      order by ordinal_position

  
[0m22:02:38.271532 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.076 seconds
[0m22:02:38.272984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:02:38.273178 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:02:38.374112 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.100 seconds
[0m22:02:38.375638 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.702 seconds
[0m22:02:38.390777 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m22:02:38.393114 [debug] [Thread-1 (]: 
    In "dev_o0af"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:02:38.400219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ea990>]}
[0m22:02:38.406901 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m22:02:38.407368 [info ] [Thread-2 (]: 2 of 23 OK created sql table model dbt.trips_concurrency ....................... [[32mSELECT 10[0m in 7.08s]
[0m22:02:38.407939 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m22:02:38.408292 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m22:02:38.408659 [info ] [Thread-2 (]: 6 of 23 START seed file dbt.age_groups ......................................... [RUN]
[0m22:02:38.408957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:02:38.409214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now seed.dbt_scooters.age_groups)
[0m22:02:38.409474 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        delete from "dev_o0af"."dbt"."events_clean" as DBT_INTERNAL_DEST
        where (user_id, timestamp, type_id) in (
            select distinct user_id, timestamp, type_id
            from "events_clean__dbt_tmp220231380176" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_o0af"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp220231380176"
    )
  
[0m22:02:38.409719 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m22:02:38.409980 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m22:02:38.424582 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:02:38.424865 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m22:02:38.425044 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:02:38.477515 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.068 seconds
[0m22:02:38.478756 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m22:02:38.478934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:02:38.479106 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m22:02:38.565440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.086 seconds
[0m22:02:38.567758 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m22:02:38.569755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a53540>]}
[0m22:02:38.571006 [info ] [Thread-1 (]: 1 of 23 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 7.25s]
[0m22:02:38.571963 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m22:02:38.572685 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.event_types
[0m22:02:38.573588 [info ] [Thread-1 (]: 7 of 23 START seed file dbt.event_types ........................................ [RUN]
[0m22:02:38.574356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now seed.dbt_scooters.event_types)
[0m22:02:38.575027 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.event_types
[0m22:02:38.575587 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.event_types
[0m22:02:38.582379 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:02:38.583071 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: BEGIN
[0m22:02:38.583445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:38.881276 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.685 seconds
[0m22:02:38.885091 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m22:02:38.886798 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1fcf0>]}
[0m22:02:38.888010 [info ] [Thread-3 (]: 3 of 23 OK created sql table model dbt.trips_geom .............................. [[32mSELECT 105901[0m in 7.56s]
[0m22:02:38.889009 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m22:02:38.889708 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.scooters
[0m22:02:38.890632 [info ] [Thread-3 (]: 8 of 23 START seed file dbt.scooters ........................................... [RUN]
[0m22:02:38.891599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now seed.dbt_scooters.scooters)
[0m22:02:38.891978 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.scooters
[0m22:02:38.892319 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.scooters
[0m22:02:38.899825 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:02:38.900195 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: BEGIN
[0m22:02:38.900339 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:02:38.990316 [debug] [Thread-4 (]: SQL status: COMMIT in 1.220 seconds
[0m22:02:38.996461 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."trips_stat_daily__dbt_backup"
[0m22:02:38.998369 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:02:38.999004 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_o0af"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m22:02:39.091413 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.091 seconds
[0m22:02:39.095850 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m22:02:39.097392 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050be350>]}
[0m22:02:39.098546 [info ] [Thread-4 (]: 5 of 23 OK created sql table model dbt.trips_stat_daily ........................ [[32mSELECT 91[0m in 5.52s]
[0m22:02:39.099497 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m22:02:39.100177 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:02:39.100892 [info ] [Thread-4 (]: 9 of 23 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m22:02:39.101706 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m22:02:39.102315 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:02:39.117495 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:02:39.118484 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:02:39.131681 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:02:39.132221 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:02:39.132442 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m22:02:39.132634 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:02:40.217867 [debug] [Thread-1 (]: SQL status: BEGIN in 1.633 seconds
[0m22:02:40.219232 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:02:40.219823 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_o0af"."dbt"."event_types"
[0m22:02:40.319048 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.099 seconds
[0m22:02:40.331864 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:02:40.332246 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_o0af"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m22:02:40.421687 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.089 seconds
[0m22:02:40.426122 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m22:02:40.428393 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: COMMIT
[0m22:02:40.428676 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:02:40.428885 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: COMMIT
[0m22:02:40.524164 [debug] [Thread-1 (]: SQL status: COMMIT in 0.095 seconds
[0m22:02:40.525723 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: Close
[0m22:02:40.527287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b11da0>]}
[0m22:02:40.527970 [info ] [Thread-1 (]: 7 of 23 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 1.95s]
[0m22:02:40.528555 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.event_types
[0m22:02:40.528978 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:02:40.529492 [info ] [Thread-1 (]: 10 of 23 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m22:02:40.530139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m22:02:40.530496 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:02:40.537161 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:02:40.537811 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:02:40.539844 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:02:40.540370 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:02:40.540621 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m22:02:40.540855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:41.038906 [debug] [Thread-4 (]: SQL status: BEGIN in 1.906 seconds
[0m22:02:41.040741 [debug] [Thread-3 (]: SQL status: BEGIN in 2.140 seconds
[0m22:02:41.041862 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:02:41.042506 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:02:41.043077 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_o0af"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



  
  
      
    ) dbt_internal_test
[0m22:02:41.043583 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_o0af"."dbt"."scooters"
[0m22:02:41.139356 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.095 seconds
[0m22:02:41.140943 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.097 seconds
[0m22:02:41.149736 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:02:41.154392 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m22:02:41.154954 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_o0af"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m22:02:41.241288 [debug] [Thread-3 (]: SQL status: INSERT 0 10 in 0.085 seconds
[0m22:02:41.243999 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m22:02:41.244683 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m22:02:41.246580 [info ] [Thread-4 (]: 9 of 23 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 2.14s]
[0m22:02:41.247642 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:02:41.248246 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c
[0m22:02:41.250295 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: COMMIT
[0m22:02:41.250791 [info ] [Thread-4 (]: 11 of 23 START test source_unique_scooters_raw_companies_trips_company ......... [RUN]
[0m22:02:41.251336 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:02:41.251863 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c)
[0m22:02:41.252283 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: COMMIT
[0m22:02:41.252677 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c
[0m22:02:41.261248 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c"
[0m22:02:41.262564 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c
[0m22:02:41.264608 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c"
[0m22:02:41.265521 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c"
[0m22:02:41.265858 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c: BEGIN
[0m22:02:41.266115 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:02:41.345232 [debug] [Thread-3 (]: SQL status: COMMIT in 0.092 seconds
[0m22:02:41.347113 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: Close
[0m22:02:41.348558 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6e6f0>]}
[0m22:02:41.349582 [info ] [Thread-3 (]: 8 of 23 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 2.46s]
[0m22:02:41.350626 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.scooters
[0m22:02:41.351377 [debug] [Thread-3 (]: Began running node model.dbt_scooters.revenue_daily
[0m22:02:41.352369 [info ] [Thread-3 (]: 12 of 23 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m22:02:41.353193 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now model.dbt_scooters.revenue_daily)
[0m22:02:41.353633 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m22:02:41.359695 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m22:02:41.360797 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.revenue_daily
[0m22:02:41.364401 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:02:41.364809 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp220241362950"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_o0af"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_o0af"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m22:02:41.365134 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:02:41.753653 [debug] [Thread-1 (]: SQL status: BEGIN in 1.212 seconds
[0m22:02:41.755481 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:02:41.756725 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sex
from "dev_o0af"."scooters_raw"."users"
where sex is null



  
  
      
    ) dbt_internal_test
[0m22:02:41.835508 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.077 seconds
[0m22:02:41.837046 [debug] [Thread-2 (]: SQL status: BEGIN in 3.412 seconds
[0m22:02:41.840684 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m22:02:41.841501 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:02:41.842514 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_o0af"."dbt"."age_groups"
[0m22:02:41.950154 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m22:02:41.951641 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.108 seconds
[0m22:02:41.958805 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:02:41.960266 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_o0af"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m22:02:41.959826 [warn ] [Thread-1 (]: 10 of 23 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 1.43s]
[0m22:02:41.961253 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:02:41.961781 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_stat
[0m22:02:41.962606 [info ] [Thread-1 (]: 13 of 23 START sql table model dbt.trips_stat .................................. [RUN]
[0m22:02:41.963359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now model.dbt_scooters.trips_stat)
[0m22:02:41.963764 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_stat
[0m22:02:41.967589 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m22:02:41.968624 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_stat
[0m22:02:41.973004 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m22:02:41.973829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:02:41.974124 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m22:02:41.974376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:42.024440 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.063 seconds
[0m22:02:42.025966 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m22:02:42.030145 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m22:02:42.030554 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:02:42.031045 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m22:02:42.471137 [debug] [Thread-2 (]: SQL status: COMMIT in 0.440 seconds
[0m22:02:42.472125 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m22:02:42.472938 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b804f50>]}
[0m22:02:42.473523 [info ] [Thread-2 (]: 6 of 23 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 4.06s]
[0m22:02:42.474087 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m22:02:42.474488 [debug] [Thread-2 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m22:02:42.475100 [info ] [Thread-2 (]: 14 of 23 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m22:02:42.475675 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now model.dbt_scooters.parking_finish_stat)
[0m22:02:42.476100 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m22:02:42.480584 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m22:02:42.481577 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m22:02:42.485052 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m22:02:42.485744 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:02:42.486016 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m22:02:42.486256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:02:43.187332 [debug] [Thread-1 (]: SQL status: BEGIN in 1.212 seconds
[0m22:02:43.189026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:02:43.190280 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_o0af"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_o0af"."dbt"."trips_prep"
  );
  
[0m22:02:43.801319 [debug] [Thread-3 (]: SQL status: SELECT 3 in 2.436 seconds
[0m22:02:43.807716 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:02:43.808596 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m22:02:43.905161 [debug] [Thread-3 (]: SQL status: BEGIN in 0.096 seconds
[0m22:02:43.906604 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:02:43.907786 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp220241362950'
        
      order by ordinal_position

  
[0m22:02:44.007720 [debug] [Thread-4 (]: SQL status: BEGIN in 2.741 seconds
[0m22:02:44.009119 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c"
[0m22:02:44.010077 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_o0af"."scooters_raw"."companies_trips"
where company is not null
group by company
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:02:44.108639 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.200 seconds
[0m22:02:44.115228 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:02:44.115724 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m22:02:44.211041 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "scooters_raw.companies_trips" does not exist
LINE 18: from "dev_o0af"."scooters_raw"."companies_trips"
              ^

[0m22:02:44.212405 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c: ROLLBACK
[0m22:02:44.270221 [debug] [Thread-4 (]: On test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c: Close
[0m22:02:44.271533 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.155 seconds
[0m22:02:44.283826 [debug] [Thread-2 (]: SQL status: BEGIN in 1.797 seconds
[0m22:02:44.286289 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:02:44.286912 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:02:44.287516 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp220241362950'
        
      order by ordinal_position

  
[0m22:02:44.287994 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_o0af"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_o0af"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)
-- group by
--     1


select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_o0af"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m22:02:44.296111 [debug] [Thread-4 (]: Database Error in test source_unique_scooters_raw_companies_trips_company (models/properties.yml)
  relation "scooters_raw.companies_trips" does not exist
  LINE 18: from "dev_o0af"."scooters_raw"."companies_trips"
                ^
  compiled code at target/run/dbt_scooters/models/properties.yml/source_unique_scooters_raw_companies_trips_company.sql
[0m22:02:44.296646 [error] [Thread-4 (]: 11 of 23 ERROR source_unique_scooters_raw_companies_trips_company .............. [[31mERROR[0m in 3.04s]
[0m22:02:44.297134 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c
[0m22:02:44.297453 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_start_stat
[0m22:02:44.297888 [debug] [Thread-7 (]: Marking all children of 'test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c' to be skipped because of status 'error'.  Reason: Database Error in test source_unique_scooters_raw_companies_trips_company (models/properties.yml)
  relation "scooters_raw.companies_trips" does not exist
  LINE 18: from "dev_o0af"."scooters_raw"."companies_trips"
                ^
  compiled code at target/run/dbt_scooters/models/properties.yml/source_unique_scooters_raw_companies_trips_company.sql.
[0m22:02:44.298368 [info ] [Thread-4 (]: 15 of 23 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m22:02:44.299121 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_unique_scooters_raw_companies_trips_company.5d2b1a0d2c, now model.dbt_scooters.parking_start_stat)
[0m22:02:44.299428 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m22:02:44.302104 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m22:02:44.302708 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m22:02:44.305380 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m22:02:44.306124 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:02:44.306368 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m22:02:44.306583 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:02:44.739647 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.450 seconds
[0m22:02:44.747180 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:02:44.747757 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m22:02:44.929332 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.181 seconds
[0m22:02:44.933889 [debug] [Thread-3 (]: 
    In "dev_o0af"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:02:44.935645 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m22:02:44.938762 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:02:44.939458 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_o0af"."finance"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp220241362950" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_o0af"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp220241362950"
    )
  
[0m22:02:45.132448 [debug] [Thread-3 (]: SQL status: INSERT 0 3 in 0.192 seconds
[0m22:02:45.140795 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:02:45.141468 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_o0af".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m22:02:45.337106 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.195 seconds
[0m22:02:45.341981 [debug] [Thread-3 (]: On "dev_o0af"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m22:02:45.342853 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:02:45.343335 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:02:45.343721 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:02:45.541869 [debug] [Thread-3 (]: SQL status: COMMIT in 0.197 seconds
[0m22:02:45.544174 [debug] [Thread-3 (]: On model.dbt_scooters.revenue_daily: Close
[0m22:02:45.545749 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b805610>]}
[0m22:02:45.546992 [info ] [Thread-3 (]: 12 of 23 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 4.19s]
[0m22:02:45.547968 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.revenue_daily
[0m22:02:45.548645 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_full
[0m22:02:45.549499 [info ] [Thread-3 (]: 16 of 23 START sql view model dbt.events_full .................................. [RUN]
[0m22:02:45.550322 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.events_full)
[0m22:02:45.550940 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_full
[0m22:02:45.555576 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m22:02:45.558991 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_full
[0m22:02:45.563651 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m22:02:45.564464 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:02:45.564779 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: BEGIN
[0m22:02:45.565073 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:02:45.943706 [debug] [Thread-1 (]: SQL status: SELECT 1 in 2.752 seconds
[0m22:02:45.948156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:02:45.948574 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_o0af"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m22:02:46.054773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.106 seconds
[0m22:02:46.061125 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:02:46.061732 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_o0af"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m22:02:46.361400 [debug] [Thread-4 (]: SQL status: BEGIN in 2.054 seconds
[0m22:02:46.363061 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:02:46.364388 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_o0af"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_o0af"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.start_point, 3857), hex.geom)
-- group by
--     1

select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_o0af"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m22:02:46.465147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.402 seconds
[0m22:02:46.468914 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m22:02:46.469711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:02:46.470302 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m22:02:46.565943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.095 seconds
[0m22:02:46.571793 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."trips_stat__dbt_backup"
[0m22:02:46.572629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:02:46.573067 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_o0af"."dbt"."trips_stat__dbt_backup" cascade
[0m22:02:46.668301 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.094 seconds
[0m22:02:46.671445 [debug] [Thread-1 (]: On model.dbt_scooters.trips_stat: Close
[0m22:02:46.672866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b806e10>]}
[0m22:02:46.673754 [info ] [Thread-1 (]: 13 of 23 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 4.71s]
[0m22:02:46.674436 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_stat
[0m22:02:46.674917 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m22:02:46.675477 [info ] [Thread-1 (]: 17 of 23 START sql table model dbt.companies ................................... [RUN]
[0m22:02:46.676019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.companies)
[0m22:02:46.676390 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m22:02:46.679688 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m22:02:46.682261 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m22:02:46.685770 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m22:02:46.686331 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:02:46.686663 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m22:02:46.687143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:46.975829 [debug] [Thread-3 (]: SQL status: BEGIN in 1.410 seconds
[0m22:02:46.976802 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:02:46.977324 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_o0af"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_o0af"."dbt"."events_clean"
    left join "dev_o0af"."dbt"."event_types"
        using (type_id)
  );
[0m22:02:47.079464 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.101 seconds
[0m22:02:47.085515 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:02:47.086373 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_o0af"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m22:02:47.183297 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.096 seconds
[0m22:02:47.186537 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:02:47.186893 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_o0af"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m22:02:47.280344 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m22:02:47.285256 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m22:02:47.285735 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:02:47.286126 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m22:02:47.355984 [debug] [Thread-3 (]: SQL status: COMMIT in 0.069 seconds
[0m22:02:47.358255 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."events_full__dbt_backup"
[0m22:02:47.358799 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:02:47.359064 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_o0af"."dbt"."events_full__dbt_backup" cascade
[0m22:02:47.551651 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.192 seconds
[0m22:02:47.554856 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: Close
[0m22:02:47.556100 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4dcd0>]}
[0m22:02:47.557154 [info ] [Thread-3 (]: 16 of 23 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 2.01s]
[0m22:02:47.558115 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_full
[0m22:02:47.558803 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_users
[0m22:02:47.559643 [info ] [Thread-3 (]: 18 of 23 START sql incremental model dbt.trips_users ........................... [RUN]
[0m22:02:47.560542 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_users)
[0m22:02:47.561098 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_users
[0m22:02:47.566857 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m22:02:47.567759 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_users
[0m22:02:47.572672 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:02:47.573137 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp220247570882"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_o0af"."dbt"."trips_prep" as t
left join
    "dev_o0af"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_o0af"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m22:02:47.573491 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:02:49.740798 [debug] [Thread-1 (]: SQL status: BEGIN in 3.053 seconds
[0m22:02:49.743182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:02:49.744191 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_o0af"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_o0af"."dbt"."scooters"
group by
    1
  );
  
[0m22:02:50.044401 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.299 seconds
[0m22:02:50.052317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:02:50.053066 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_o0af"."dbt"."companies" rename to "companies__dbt_backup"
[0m22:02:50.258077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.204 seconds
[0m22:02:50.265792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:02:50.266514 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_o0af"."dbt"."companies__dbt_tmp" rename to "companies"
[0m22:02:50.356337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.089 seconds
[0m22:02:50.360770 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m22:02:50.361330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:02:50.361757 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m22:02:50.457294 [debug] [Thread-1 (]: SQL status: COMMIT in 0.095 seconds
[0m22:02:50.462824 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."companies__dbt_backup"
[0m22:02:50.463817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:02:50.464400 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_o0af"."dbt"."companies__dbt_backup" cascade
[0m22:02:50.662045 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.197 seconds
[0m22:02:50.666165 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m22:02:50.667636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d93890>]}
[0m22:02:50.668802 [info ] [Thread-1 (]: 17 of 23 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 3.99s]
[0m22:02:50.669694 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m22:02:50.670231 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_stat
[0m22:02:50.670916 [info ] [Thread-1 (]: 19 of 23 START sql table model dbt.events_stat ................................. [RUN]
[0m22:02:50.671693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.events_stat)
[0m22:02:50.672114 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_stat
[0m22:02:50.675908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m22:02:50.678995 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_stat
[0m22:02:50.683297 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m22:02:50.684030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:02:50.684349 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: BEGIN
[0m22:02:50.684630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:50.765970 [debug] [Thread-3 (]: SQL status: SELECT 0 in 3.192 seconds
[0m22:02:50.771785 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:02:50.772453 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: BEGIN
[0m22:02:50.871881 [debug] [Thread-3 (]: SQL status: BEGIN in 0.099 seconds
[0m22:02:50.872466 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:02:50.872882 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp220247570882'
        
      order by ordinal_position

  
[0m22:02:51.481386 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.608 seconds
[0m22:02:51.487229 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:02:51.487774 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:02:51.780112 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.291 seconds
[0m22:02:51.787606 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:02:51.788169 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp220247570882'
        
      order by ordinal_position

  
[0m22:02:51.894252 [debug] [Thread-1 (]: SQL status: BEGIN in 1.209 seconds
[0m22:02:51.895566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:02:51.896563 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_o0af"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_o0af"."dbt"."events_full"
  );
  
[0m22:02:51.958275 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.169 seconds
[0m22:02:51.967025 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:02:51.967452 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:02:52.198701 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.230 seconds
[0m22:02:52.205851 [debug] [Thread-3 (]: 
    In "dev_o0af"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:02:52.213702 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m22:02:52.214700 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:02:52.215047 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_o0af"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp220247570882"
    )


  
[0m22:02:52.402329 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.187 seconds
[0m22:02:52.403796 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:02:52.404024 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m22:03:02.542719 [debug] [Thread-1 (]: SQL status: SELECT 1 in 10.645 seconds
[0m22:03:02.550461 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:03:02.551102 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_o0af"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m22:03:03.257733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.706 seconds
[0m22:03:03.263805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:03:03.264459 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_o0af"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m22:03:03.668980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.404 seconds
[0m22:03:03.673903 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: COMMIT
[0m22:03:03.674421 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:03:03.674801 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: COMMIT
[0m22:03:03.769377 [debug] [Thread-1 (]: SQL status: COMMIT in 0.094 seconds
[0m22:03:03.775967 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."events_stat__dbt_backup"
[0m22:03:03.776661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:03:03.777030 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_o0af"."dbt"."events_stat__dbt_backup" cascade
[0m22:03:03.871904 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.094 seconds
[0m22:03:03.875145 [debug] [Thread-1 (]: On model.dbt_scooters.events_stat: Close
[0m22:03:03.876594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8977d0>]}
[0m22:03:03.877710 [info ] [Thread-1 (]: 19 of 23 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 13.20s]
[0m22:03:03.878638 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_stat
[0m22:03:03.879280 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies_trips
[0m22:03:03.880093 [info ] [Thread-1 (]: 20 of 23 START sql table model dbt.companies_trips ............................. [RUN]
[0m22:03:03.880881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now model.dbt_scooters.companies_trips)
[0m22:03:03.881349 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies_trips
[0m22:03:03.885757 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m22:03:03.888073 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies_trips
[0m22:03:03.892107 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m22:03:03.893363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:03:03.894173 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m22:03:03.894597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:05.305620 [debug] [Thread-1 (]: SQL status: BEGIN in 1.411 seconds
[0m22:03:05.306592 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:03:05.307188 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_o0af"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_o0af"."dbt"."trips_prep" as t
        join "dev_o0af"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_o0af"."dbt"."companies" as c
        using (company)
  );
  
[0m22:03:06.431938 [debug] [Thread-3 (]: SQL status: ANALYZE in 14.027 seconds
[0m22:03:06.440488 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m22:03:06.441129 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:03:06.441565 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: COMMIT
[0m22:03:06.636907 [debug] [Thread-3 (]: SQL status: COMMIT in 0.194 seconds
[0m22:03:06.638081 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:03:06.638514 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m22:03:06.944038 [debug] [Thread-3 (]: SQL status: COMMIT in 0.305 seconds
[0m22:03:06.946744 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:03:06.947455 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m22:03:07.148779 [debug] [Thread-3 (]: SQL status: VACUUM in 0.200 seconds
[0m22:03:07.152974 [debug] [Thread-3 (]: On model.dbt_scooters.trips_users: Close
[0m22:03:07.154455 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4dd90>]}
[0m22:03:07.155340 [info ] [Thread-3 (]: 18 of 23 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 19.59s]
[0m22:03:07.156051 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_users
[0m22:03:07.156831 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m22:03:07.157380 [info ] [Thread-3 (]: 21 of 23 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m22:03:07.157926 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily)
[0m22:03:07.158333 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m22:03:07.161725 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m22:03:07.162958 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m22:03:07.166945 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m22:03:07.167814 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:03:07.168158 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m22:03:07.168450 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:03:08.993144 [debug] [Thread-1 (]: SQL status: SELECT 6 in 3.685 seconds
[0m22:03:08.997003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:03:08.997382 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_o0af"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m22:03:09.095077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.097 seconds
[0m22:03:09.095428 [debug] [Thread-3 (]: SQL status: BEGIN in 1.927 seconds
[0m22:03:09.098310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:03:09.098682 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:03:09.099004 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_o0af"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m22:03:09.099329 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_o0af"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m22:03:09.196494 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.097 seconds
[0m22:03:09.198966 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m22:03:09.199536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:03:09.199887 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m22:03:09.302376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.102 seconds
[0m22:03:09.308006 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."companies_trips__dbt_backup"
[0m22:03:09.309640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:03:09.310066 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_o0af"."dbt"."companies_trips__dbt_backup" cascade
[0m22:03:09.503812 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.193 seconds
[0m22:03:09.506235 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: Close
[0m22:03:09.507491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d92f30>]}
[0m22:03:09.508335 [info ] [Thread-1 (]: 20 of 23 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 5.63s]
[0m22:03:09.508996 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies_trips
[0m22:03:09.509443 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_group
[0m22:03:09.509991 [info ] [Thread-1 (]: 22 of 23 START sql table model dbt.trips_age_group ............................. [RUN]
[0m22:03:09.510547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_group)
[0m22:03:09.510953 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m22:03:09.515106 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m22:03:09.516708 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_group
[0m22:03:09.520843 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m22:03:09.521898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:03:09.522304 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m22:03:09.522634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:12.475160 [debug] [Thread-1 (]: SQL status: BEGIN in 2.952 seconds
[0m22:03:12.476806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:03:12.478134 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_o0af"."dbt"."trips_users" as tu
    cross join "dev_o0af"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m22:03:13.497646 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 4.397 seconds
[0m22:03:13.505887 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:03:13.506493 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_o0af"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m22:03:13.600002 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m22:03:13.607641 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:03:13.608242 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_o0af"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m22:03:13.702436 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m22:03:13.706858 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m22:03:13.707452 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:03:13.707901 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m22:03:13.805118 [debug] [Thread-3 (]: SQL status: COMMIT in 0.096 seconds
[0m22:03:13.810175 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_daily__dbt_backup"
[0m22:03:13.812275 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:03:13.812798 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_o0af"."dbt"."trips_age_daily__dbt_backup" cascade
[0m22:03:14.009934 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.196 seconds
[0m22:03:14.014562 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m22:03:14.015950 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b805850>]}
[0m22:03:14.016885 [info ] [Thread-3 (]: 21 of 23 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 6.86s]
[0m22:03:14.017595 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m22:03:14.018364 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m22:03:14.018889 [info ] [Thread-3 (]: 23 of 23 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m22:03:14.019377 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now model.dbt_scooters.trips_age_daily_stat)
[0m22:03:14.019825 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m22:03:14.023333 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m22:03:14.025272 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m22:03:14.028635 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m22:03:14.029638 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:03:14.030003 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m22:03:14.030302 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:03:16.979549 [debug] [Thread-3 (]: SQL status: BEGIN in 2.949 seconds
[0m22:03:16.981158 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:03:16.982322 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_o0af"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m22:03:18.004677 [debug] [Thread-3 (]: SQL status: SELECT 83 in 1.021 seconds
[0m22:03:18.009185 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:03:18.009533 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_o0af"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m22:03:18.107294 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.097 seconds
[0m22:03:18.113126 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:03:18.113679 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_o0af"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m22:03:18.282591 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.168 seconds
[0m22:03:18.287398 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m22:03:18.288428 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:03:18.289273 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m22:03:18.412997 [debug] [Thread-3 (]: SQL status: COMMIT in 0.123 seconds
[0m22:03:18.418644 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_daily_stat__dbt_backup"
[0m22:03:18.420168 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:03:18.420642 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_o0af"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m22:03:18.720234 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.299 seconds
[0m22:03:18.724607 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m22:03:18.726203 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b805cd0>]}
[0m22:03:18.727352 [info ] [Thread-3 (]: 23 of 23 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 4.71s]
[0m22:03:18.728309 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m22:03:25.478718 [debug] [Thread-2 (]: SQL status: SELECT 464 in 41.190 seconds
[0m22:03:25.485510 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:03:25.486247 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_o0af"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m22:03:25.581066 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m22:03:25.587789 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:03:25.588513 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_o0af"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m22:03:25.686677 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.097 seconds
[0m22:03:25.690886 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m22:03:25.691368 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:03:25.691760 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m22:03:25.785562 [debug] [Thread-2 (]: SQL status: COMMIT in 0.093 seconds
[0m22:03:25.792467 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."parking_finish_stat__dbt_backup"
[0m22:03:25.793578 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:03:25.794207 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_o0af"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m22:03:25.888089 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.093 seconds
[0m22:03:25.892342 [debug] [Thread-2 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m22:03:25.893870 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b806450>]}
[0m22:03:25.894821 [info ] [Thread-2 (]: 14 of 23 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 43.42s]
[0m22:03:25.895546 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m22:03:34.184734 [debug] [Thread-4 (]: SQL status: SELECT 142 in 47.819 seconds
[0m22:03:34.192238 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:03:34.192827 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_o0af"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m22:03:34.285105 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m22:03:34.291897 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:03:34.292385 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_o0af"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m22:03:34.693716 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.400 seconds
[0m22:03:34.697972 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m22:03:34.698661 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:03:34.699229 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m22:03:36.950329 [debug] [Thread-4 (]: SQL status: COMMIT in 2.251 seconds
[0m22:03:36.954065 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."parking_start_stat__dbt_backup"
[0m22:03:36.954720 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:03:36.955062 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_o0af"."dbt"."parking_start_stat__dbt_backup" cascade
[0m22:03:37.257174 [debug] [Thread-1 (]: SQL status: SELECT 7 in 24.778 seconds
[0m22:03:37.264944 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:03:37.265763 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_o0af"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m22:03:37.338315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.072 seconds
[0m22:03:37.344120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:03:37.344731 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_o0af"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m22:03:37.459552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.114 seconds
[0m22:03:37.464236 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m22:03:37.465034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:03:37.465702 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m22:03:37.664516 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.709 seconds
[0m22:03:37.669725 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: Close
[0m22:03:37.671688 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b896bd0>]}
[0m22:03:37.672713 [info ] [Thread-4 (]: 15 of 23 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 53.37s]
[0m22:03:37.673500 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m22:03:37.817598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.351 seconds
[0m22:03:37.822502 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_group__dbt_backup"
[0m22:03:37.823603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:03:37.824245 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_o0af"."dbt"."trips_age_group__dbt_backup" cascade
[0m22:03:37.974416 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.150 seconds
[0m22:03:37.976150 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: Close
[0m22:03:37.976972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb1d86c-08ed-4598-8684-2986cfa18301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b897e90>]}
[0m22:03:37.977681 [info ] [Thread-1 (]: 22 of 23 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 28.47s]
[0m22:03:37.978195 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_group
[0m22:03:37.979929 [info ] [MainThread]: 
[0m22:03:37.980335 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:37.980611 [debug] [MainThread]: On master: BEGIN
[0m22:03:37.980850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:03:40.121964 [debug] [MainThread]: SQL status: BEGIN in 2.141 seconds
[0m22:03:40.123527 [debug] [MainThread]: On master: COMMIT
[0m22:03:40.124606 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:40.125444 [debug] [MainThread]: On master: COMMIT
[0m22:03:40.223780 [debug] [MainThread]: SQL status: COMMIT in 0.098 seconds
[0m22:03:40.227826 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m22:03:40.234912 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m22:03:40.235726 [debug] [MainThread]: Using postgres connection "master"
[0m22:03:40.236165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m22:03:40.314240 [debug] [MainThread]: SQL status: GRANT in 0.077 seconds
[0m22:03:40.316718 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.09s]
[0m22:03:40.317531 [debug] [MainThread]: On master: Close
[0m22:03:40.318726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:40.319108 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m22:03:40.319451 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m22:03:40.319768 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m22:03:40.320089 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m22:03:40.320681 [info ] [MainThread]: 
[0m22:03:40.321271 [info ] [MainThread]: Finished running 3 incremental models, 1 project hook, 3 seeds, 12 table models, 3 data tests, 2 view models in 0 hours 1 minutes and 15.81 seconds (75.81s).
[0m22:03:40.325610 [debug] [MainThread]: Command end result
[0m22:03:40.351442 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:03:40.353314 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:03:40.357983 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m22:03:40.358181 [info ] [MainThread]: 
[0m22:03:40.358365 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 1 warning:[0m
[0m22:03:40.358526 [info ] [MainThread]: 
[0m22:03:40.358734 [error] [MainThread]: [31mFailure in test source_unique_scooters_raw_companies_trips_company (models/properties.yml)[0m
[0m22:03:40.358942 [error] [MainThread]:   Database Error in test source_unique_scooters_raw_companies_trips_company (models/properties.yml)
  relation "scooters_raw.companies_trips" does not exist
  LINE 18: from "dev_o0af"."scooters_raw"."companies_trips"
                ^
  compiled code at target/run/dbt_scooters/models/properties.yml/source_unique_scooters_raw_companies_trips_company.sql
[0m22:03:40.359091 [info ] [MainThread]: 
[0m22:03:40.359270 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/source_unique_scooters_raw_companies_trips_company.sql
[0m22:03:40.359412 [info ] [MainThread]: 
[0m22:03:40.359589 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models/properties.yml)[0m
[0m22:03:40.359767 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m22:03:40.359909 [info ] [MainThread]: 
[0m22:03:40.360077 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/source_not_null_scooters_raw_users_sex.sql
[0m22:03:40.360221 [info ] [MainThread]: 
[0m22:03:40.360383 [info ] [MainThread]: Done. PASS=22 WARN=1 ERROR=1 SKIP=0 NO-OP=0 TOTAL=24
[0m22:03:40.361965 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 76.1623, "process_in_blocks": "0", "process_kernel_time": 0.283498, "process_mem_max_rss": "142229504", "process_out_blocks": "0", "process_user_time": 2.274326}
[0m22:03:40.362196 [debug] [MainThread]: Command `dbt build` failed at 22:03:40.362150 after 76.16 seconds
[0m22:03:40.362389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029f2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a55130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599fb90>]}
[0m22:03:40.362566 [debug] [MainThread]: Flushing usage events
[0m22:03:42.274582 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:08:27.354662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be274d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d62b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d62bb10>]}


============================== 22:08:27.357350 | d13c35a2-bc27-4f3c-8189-20216a180cd6 ==============================
[0m22:08:27.357350 [info ] [MainThread]: Running with dbt=1.10.6
[0m22:08:27.357624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:27.427329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd13c35a2-bc27-4f3c-8189-20216a180cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c533490>]}
[0m22:08:27.448436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd13c35a2-bc27-4f3c-8189-20216a180cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3c2f10>]}
[0m22:08:27.449002 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:08:27.487839 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m22:08:27.538616 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:08:27.538855 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m22:08:27.539006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd13c35a2-bc27-4f3c-8189-20216a180cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1e4850>]}
[0m22:08:28.039475 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `freshness` as a top-level property of `trips` in file
`models/properties.yml`. The `freshness` top-level property should be moved into
the `config` of `trips`.
[0m22:08:28.039742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd13c35a2-bc27-4f3c-8189-20216a180cd6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e36da90>]}
[0m22:08:28.128209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd13c35a2-bc27-4f3c-8189-20216a180cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e361390>]}
[0m22:08:28.170867 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:08:28.172381 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:08:28.191423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd13c35a2-bc27-4f3c-8189-20216a180cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e642c30>]}
[0m22:08:28.191670 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 3 data tests, 17 sources, 439 macros
[0m22:08:28.192565 [info ] [MainThread]: 
[0m22:08:28.192754 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:08:28.193107 [info ] [MainThread]: 
[0m22:08:28.193353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:08:28.193750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af'
[0m22:08:28.213163 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af"
[0m22:08:28.213346 [debug] [ThreadPool]: On list_dev_o0af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af"} */

    select distinct nspname from pg_namespace
  
[0m22:08:28.213449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:30.510918 [debug] [ThreadPool]: SQL status: SELECT 27 in 2.297 seconds
[0m22:08:30.513706 [debug] [ThreadPool]: On list_dev_o0af: Close
[0m22:08:30.520829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_o0af, now list_dev_o0af_dbt)
[0m22:08:30.526487 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m22:08:30.526914 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af_finance'
[0m22:08:30.527184 [debug] [ThreadPool]: On list_dev_o0af_dbt: BEGIN
[0m22:08:30.528472 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m22:08:30.528706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:30.528916 [debug] [ThreadPool]: On list_dev_o0af_finance: BEGIN
[0m22:08:30.529228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:31.476897 [debug] [ThreadPool]: SQL status: BEGIN in 0.947 seconds
[0m22:08:31.478273 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m22:08:31.479068 [debug] [ThreadPool]: On list_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_finance"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m22:08:31.535280 [debug] [ThreadPool]: SQL status: BEGIN in 1.006 seconds
[0m22:08:31.536382 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.057 seconds
[0m22:08:31.537070 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m22:08:31.539964 [debug] [ThreadPool]: On list_dev_o0af_finance: ROLLBACK
[0m22:08:31.540699 [debug] [ThreadPool]: On list_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_dbt"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m22:08:31.636929 [debug] [ThreadPool]: On list_dev_o0af_finance: Close
[0m22:08:31.637966 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.096 seconds
[0m22:08:31.641416 [debug] [ThreadPool]: On list_dev_o0af_dbt: ROLLBACK
[0m22:08:31.741270 [debug] [ThreadPool]: On list_dev_o0af_dbt: Close
[0m22:08:31.757027 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:31.757703 [debug] [MainThread]: On master: BEGIN
[0m22:08:31.758090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:33.070842 [debug] [MainThread]: SQL status: BEGIN in 1.312 seconds
[0m22:08:33.072024 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:33.072742 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:08:33.176964 [debug] [MainThread]: SQL status: SELECT 3 in 0.103 seconds
[0m22:08:33.179953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd13c35a2-bc27-4f3c-8189-20216a180cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e767110>]}
[0m22:08:33.180705 [debug] [MainThread]: On master: ROLLBACK
[0m22:08:33.275855 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:33.277376 [debug] [MainThread]: On master: BEGIN
[0m22:08:33.481777 [debug] [MainThread]: SQL status: BEGIN in 0.204 seconds
[0m22:08:33.483001 [debug] [MainThread]: On master: COMMIT
[0m22:08:33.483765 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:33.484117 [debug] [MainThread]: On master: COMMIT
[0m22:08:33.582396 [debug] [MainThread]: SQL status: COMMIT in 0.098 seconds
[0m22:08:33.583033 [debug] [MainThread]: On master: Close
[0m22:08:33.588374 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies_trips
[0m22:08:33.589166 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.companies_trips ............................... [RUN]
[0m22:08:33.589734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_o0af_dbt, now model.dbt_scooters.companies_trips)
[0m22:08:33.590269 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies_trips
[0m22:08:33.599860 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m22:08:33.601608 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies_trips
[0m22:08:33.629893 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m22:08:33.630881 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:08:33.631127 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m22:08:33.631313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:36.040771 [debug] [Thread-1 (]: SQL status: BEGIN in 2.409 seconds
[0m22:08:36.042273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:08:36.043497 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_o0af"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_o0af"."dbt"."trips_prep" as t
        join "dev_o0af"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_o0af"."dbt"."companies" as c
        using (company)
  );
  
[0m22:08:36.656531 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.611 seconds
[0m22:08:36.675571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:08:36.676202 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_o0af"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m22:08:36.757301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.080 seconds
[0m22:08:36.764367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:08:36.765136 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_o0af"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m22:08:36.859851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m22:08:36.884281 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m22:08:36.884753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:08:36.885074 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m22:08:36.965545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.080 seconds
[0m22:08:36.976430 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."companies_trips__dbt_backup"
[0m22:08:36.980995 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:08:36.981318 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_o0af"."dbt"."companies_trips__dbt_backup" cascade
[0m22:08:37.064710 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.083 seconds
[0m22:08:37.070842 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: Close
[0m22:08:37.075829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd13c35a2-bc27-4f3c-8189-20216a180cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecd0310>]}
[0m22:08:37.076959 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.companies_trips .......................... [[32mSELECT 6[0m in 3.48s]
[0m22:08:37.077894 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies_trips
[0m22:08:37.079674 [info ] [MainThread]: 
[0m22:08:37.080206 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:37.080550 [debug] [MainThread]: On master: BEGIN
[0m22:08:37.080840 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:08:38.088678 [debug] [MainThread]: SQL status: BEGIN in 1.007 seconds
[0m22:08:38.090370 [debug] [MainThread]: On master: COMMIT
[0m22:08:38.091533 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:38.092283 [debug] [MainThread]: On master: COMMIT
[0m22:08:38.190894 [debug] [MainThread]: SQL status: COMMIT in 0.098 seconds
[0m22:08:38.196594 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m22:08:38.205511 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m22:08:38.206294 [debug] [MainThread]: Using postgres connection "master"
[0m22:08:38.206770 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m22:08:38.293296 [debug] [MainThread]: SQL status: GRANT in 0.086 seconds
[0m22:08:38.295667 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.10s]
[0m22:08:38.296404 [debug] [MainThread]: On master: Close
[0m22:08:38.297680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:38.298097 [debug] [MainThread]: Connection 'model.dbt_scooters.companies_trips' was properly closed.
[0m22:08:38.298441 [debug] [MainThread]: Connection 'list_dev_o0af_finance' was properly closed.
[0m22:08:38.298831 [info ] [MainThread]: 
[0m22:08:38.299247 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 10.11 seconds (10.11s).
[0m22:08:38.300742 [debug] [MainThread]: Command end result
[0m22:08:38.328243 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:08:38.329589 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:08:38.333958 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m22:08:38.334157 [info ] [MainThread]: 
[0m22:08:38.334378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:08:38.334530 [info ] [MainThread]: 
[0m22:08:38.334746 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m22:08:38.335144 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PropertyMovedToConfigDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:08:38.336863 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.01431, "process_in_blocks": "0", "process_kernel_time": 0.168895, "process_mem_max_rss": "150683648", "process_out_blocks": "0", "process_user_time": 1.583867}
[0m22:08:38.337117 [debug] [MainThread]: Command `cli build` succeeded at 22:08:38.337067 after 11.01 seconds
[0m22:08:38.337325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebe7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7729f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e60a650>]}
[0m22:08:38.337521 [debug] [MainThread]: Flushing usage events
[0m22:08:40.136330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:11:52.399462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111bf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11292b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11292bb10>]}


============================== 22:11:52.401882 | 2a3c915f-ccb4-4026-9dfd-4d0de7ba371f ==============================
[0m22:11:52.401882 [info ] [MainThread]: Running with dbt=1.10.6
[0m22:11:52.402142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:11:52.485942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11182f490>]}
[0m22:11:52.507278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127c1f20>]}
[0m22:11:52.507778 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:11:52.544622 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m22:11:52.614721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:11:52.614924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:11:52.641165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113900b50>]}
[0m22:11:52.683901 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:11:52.685699 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:11:52.703236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bdbe30>]}
[0m22:11:52.703459 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 3 data tests, 16 sources, 439 macros
[0m22:11:52.704795 [info ] [MainThread]: 
[0m22:11:52.704945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:11:52.705054 [info ] [MainThread]: 
[0m22:11:52.705256 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:11:52.707120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af'
[0m22:11:52.707344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af'
[0m22:11:52.730401 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af"
[0m22:11:52.730592 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af"
[0m22:11:52.730724 [debug] [ThreadPool]: On list_dev_o0af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af"} */

    select distinct nspname from pg_namespace
  
[0m22:11:52.730850 [debug] [ThreadPool]: On list_dev_o0af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af"} */

    select distinct nspname from pg_namespace
  
[0m22:11:52.730963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:52.731065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:54.083786 [debug] [ThreadPool]: SQL status: SELECT 27 in 1.352 seconds
[0m22:11:54.085342 [debug] [ThreadPool]: SQL status: SELECT 27 in 1.354 seconds
[0m22:11:54.089708 [debug] [ThreadPool]: On list_dev_o0af: Close
[0m22:11:54.090981 [debug] [ThreadPool]: On list_dev_o0af: Close
[0m22:11:54.094517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_o0af, now list_dev_o0af_finance)
[0m22:11:54.100706 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m22:11:54.101172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_o0af, now list_dev_o0af_dbt)
[0m22:11:54.101559 [debug] [ThreadPool]: On list_dev_o0af_finance: BEGIN
[0m22:11:54.102979 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m22:11:54.103275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:54.103502 [debug] [ThreadPool]: On list_dev_o0af_dbt: BEGIN
[0m22:11:54.103849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:57.462709 [debug] [ThreadPool]: SQL status: BEGIN in 3.359 seconds
[0m22:11:57.464169 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m22:11:57.465259 [debug] [ThreadPool]: On list_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_finance"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m22:11:57.872252 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.406 seconds
[0m22:11:57.876536 [debug] [ThreadPool]: On list_dev_o0af_finance: ROLLBACK
[0m22:11:57.974283 [debug] [ThreadPool]: On list_dev_o0af_finance: Close
[0m22:11:59.427065 [debug] [ThreadPool]: SQL status: BEGIN in 5.323 seconds
[0m22:11:59.428617 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m22:11:59.429756 [debug] [ThreadPool]: On list_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_dbt"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m22:11:59.510623 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.080 seconds
[0m22:11:59.515851 [debug] [ThreadPool]: On list_dev_o0af_dbt: ROLLBACK
[0m22:11:59.612931 [debug] [ThreadPool]: On list_dev_o0af_dbt: Close
[0m22:11:59.630880 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:59.631293 [debug] [MainThread]: On master: BEGIN
[0m22:11:59.631545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:12:01.149171 [debug] [MainThread]: SQL status: BEGIN in 1.517 seconds
[0m22:12:01.150717 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:01.152050 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:12:01.251403 [debug] [MainThread]: SQL status: SELECT 3 in 0.098 seconds
[0m22:12:01.256325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ba18d0>]}
[0m22:12:01.257218 [debug] [MainThread]: On master: ROLLBACK
[0m22:12:01.354461 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:01.355704 [debug] [MainThread]: On master: BEGIN
[0m22:12:01.661996 [debug] [MainThread]: SQL status: BEGIN in 0.305 seconds
[0m22:12:01.662365 [debug] [MainThread]: On master: COMMIT
[0m22:12:01.662576 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:01.662758 [debug] [MainThread]: On master: COMMIT
[0m22:12:01.767872 [debug] [MainThread]: SQL status: COMMIT in 0.105 seconds
[0m22:12:01.768435 [debug] [MainThread]: On master: Close
[0m22:12:01.772596 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m22:12:01.773019 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m22:12:01.773480 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m22:12:01.773870 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m22:12:01.774366 [info ] [Thread-2 (]: 2 of 23 START sql table model dbt.trips_concurrency ............................ [RUN]
[0m22:12:01.774865 [info ] [Thread-4 (]: 4 of 23 START sql view model dbt.trips_prep .................................... [RUN]
[0m22:12:01.775273 [info ] [Thread-1 (]: 1 of 23 START sql incremental model dbt.events_clean ........................... [RUN]
[0m22:12:01.775663 [info ] [Thread-3 (]: 3 of 23 START sql table model dbt.trips_geom ................................... [RUN]
[0m22:12:01.776064 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_o0af_dbt, now model.dbt_scooters.trips_concurrency)
[0m22:12:01.776471 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_prep'
[0m22:12:01.776777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_o0af_finance, now model.dbt_scooters.events_clean)
[0m22:12:01.777142 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m22:12:01.777438 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m22:12:01.777719 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m22:12:01.777985 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m22:12:01.778246 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m22:12:01.834141 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m22:12:01.835943 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m22:12:01.838466 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m22:12:01.839688 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m22:12:01.841359 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m22:12:01.854180 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m22:12:01.854379 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m22:12:01.863787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:12:01.868541 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m22:12:01.869772 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m22:12:01.869928 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m22:12:01.870080 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp221201853956"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_o0af"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_o0af"."dbt"."events_clean")
    

  );
  
  
[0m22:12:01.877421 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m22:12:01.877593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:01.877898 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:12:01.878069 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:12:01.878223 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m22:12:01.878366 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m22:12:01.878537 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:12:01.878695 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:12:01.878822 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:12:01.878962 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m22:12:01.879199 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:12:02.891804 [debug] [Thread-2 (]: SQL status: BEGIN in 1.012 seconds
[0m22:12:02.894167 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:12:02.895112 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

  
    

  create  table "dev_o0af"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_o0af"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
[0m22:12:03.095921 [debug] [Thread-3 (]: SQL status: BEGIN in 1.217 seconds
[0m22:12:03.096359 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:12:03.096663 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  
    

  create  table "dev_o0af"."dbt"."trips_geom__dbt_tmp"
  
  
    as
  
  (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_o0af"."scooters_raw"."trips"
  );
  
[0m22:12:03.197543 [debug] [Thread-4 (]: SQL status: BEGIN in 1.318 seconds
[0m22:12:03.199037 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:12:03.199844 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_o0af"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,

    date(started_at at time zone 'Europe/Moscow')
 as "date" 
from
"dev_o0af"."scooters_raw"."trips"
  );
[0m22:12:03.504388 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.303 seconds
[0m22:12:03.517308 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:12:03.517892 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_o0af"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m22:12:03.709174 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.191 seconds
[0m22:12:03.713806 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:12:03.714338 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_o0af"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m22:12:03.852892 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.138 seconds
[0m22:12:03.875946 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m22:12:03.876480 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:12:03.876763 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m22:12:04.118920 [debug] [Thread-4 (]: SQL status: COMMIT in 0.241 seconds
[0m22:12:04.132258 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."trips_prep__dbt_backup"
[0m22:12:04.136481 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m22:12:04.136821 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_o0af"."dbt"."trips_prep__dbt_backup" cascade
[0m22:12:04.323869 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.186 seconds
[0m22:12:04.330421 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m22:12:04.335287 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143e7790>]}
[0m22:12:04.336360 [info ] [Thread-4 (]: 4 of 23 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 2.56s]
[0m22:12:04.337158 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m22:12:04.337686 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m22:12:04.338408 [info ] [Thread-4 (]: 5 of 23 START sql table model dbt.trips_stat_daily ............................. [RUN]
[0m22:12:04.339122 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.trips_stat_daily)
[0m22:12:04.339530 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m22:12:04.341907 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m22:12:04.343393 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m22:12:04.347413 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m22:12:04.348165 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:12:04.348480 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m22:12:04.348774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:12:04.839016 [debug] [Thread-2 (]: SQL status: SELECT 10 in 1.943 seconds
[0m22:12:04.851159 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:12:04.851769 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_o0af"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m22:12:04.938123 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.085 seconds
[0m22:12:04.945806 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:12:04.946361 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_o0af"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m22:12:05.143037 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.196 seconds
[0m22:12:05.147828 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m22:12:05.148482 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:12:05.148941 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m22:12:05.347711 [debug] [Thread-2 (]: SQL status: COMMIT in 0.198 seconds
[0m22:12:05.353141 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."trips_concurrency__dbt_backup"
[0m22:12:05.358051 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m22:12:05.358549 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_o0af"."dbt"."trips_concurrency__dbt_backup" cascade
[0m22:12:05.552739 [debug] [Thread-4 (]: SQL status: BEGIN in 1.203 seconds
[0m22:12:05.554530 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.195 seconds
[0m22:12:05.555571 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:12:05.558766 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m22:12:05.559574 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_o0af"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
  
[0m22:12:05.561548 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bf7590>]}
[0m22:12:05.562827 [info ] [Thread-2 (]: 2 of 23 OK created sql table model dbt.trips_concurrency ....................... [[32mSELECT 10[0m in 3.79s]
[0m22:12:05.563669 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m22:12:05.564281 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m22:12:05.565007 [info ] [Thread-2 (]: 6 of 23 START seed file dbt.age_groups ......................................... [RUN]
[0m22:12:05.565650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now seed.dbt_scooters.age_groups)
[0m22:12:05.566108 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m22:12:05.566530 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m22:12:05.589185 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:12:05.589508 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m22:12:05.589728 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:12:07.190889 [debug] [Thread-2 (]: SQL status: BEGIN in 1.601 seconds
[0m22:12:07.192194 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:12:07.192853 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_o0af"."dbt"."age_groups"
[0m22:12:07.255875 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.062 seconds
[0m22:12:07.275995 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:12:07.276495 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_o0af"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m22:12:07.397238 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.120 seconds
[0m22:12:07.408212 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m22:12:07.411572 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m22:12:07.411923 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m22:12:07.412208 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m22:12:07.703101 [debug] [Thread-2 (]: SQL status: COMMIT in 0.290 seconds
[0m22:12:07.706361 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m22:12:07.708080 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11402fd80>]}
[0m22:12:07.709219 [info ] [Thread-2 (]: 6 of 23 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 2.14s]
[0m22:12:07.710194 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m22:12:07.710746 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.event_types
[0m22:12:07.711535 [info ] [Thread-2 (]: 7 of 23 START seed file dbt.event_types ........................................ [RUN]
[0m22:12:07.712175 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now seed.dbt_scooters.event_types)
[0m22:12:07.712586 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.event_types
[0m22:12:07.712975 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.event_types
[0m22:12:07.719846 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:12:07.720312 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: BEGIN
[0m22:12:07.720663 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:12:08.214795 [debug] [Thread-1 (]: SQL status: SELECT 0 in 6.337 seconds
[0m22:12:08.234641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:12:08.235220 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m22:12:08.422128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.186 seconds
[0m22:12:08.422922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:12:08.424217 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp221201853956'
        
      order by ordinal_position

  
[0m22:12:08.934815 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.509 seconds
[0m22:12:08.944109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:12:08.944569 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:12:09.240254 [debug] [Thread-4 (]: SQL status: SELECT 91 in 3.679 seconds
[0m22:12:09.241815 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.297 seconds
[0m22:12:09.248898 [debug] [Thread-3 (]: SQL status: SELECT 105901 in 6.152 seconds
[0m22:12:09.249684 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:12:09.266145 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:12:09.270199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:12:09.270543 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_o0af"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m22:12:09.270834 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_o0af"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m22:12:09.271102 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp221201853956'
        
      order by ordinal_position

  
[0m22:12:09.342483 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.071 seconds
[0m22:12:09.343235 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.072 seconds
[0m22:12:09.347224 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:12:09.350600 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:12:09.351094 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_o0af"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m22:12:09.351502 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_o0af"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m22:12:09.441759 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.170 seconds
[0m22:12:09.443370 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m22:12:09.444563 [debug] [Thread-2 (]: SQL status: BEGIN in 1.724 seconds
[0m22:12:09.451852 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.100 seconds
[0m22:12:09.452711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:12:09.454679 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m22:12:09.455233 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:12:09.456803 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m22:12:09.457291 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:12:09.457774 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:12:09.458183 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_o0af"."dbt"."event_types"
[0m22:12:09.458596 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:12:09.459054 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m22:12:09.459486 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m22:12:09.547418 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.088 seconds
[0m22:12:09.548618 [debug] [Thread-3 (]: SQL status: COMMIT in 0.088 seconds
[0m22:12:09.549467 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.090 seconds
[0m22:12:09.556180 [debug] [Thread-4 (]: SQL status: COMMIT in 0.096 seconds
[0m22:12:09.561981 [debug] [Thread-1 (]: 
    In "dev_o0af"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:12:09.564272 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_geom__dbt_backup"
[0m22:12:09.565946 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:12:09.568007 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."trips_stat_daily__dbt_backup"
[0m22:12:09.578507 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m22:12:09.578891 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m22:12:09.579135 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_o0af"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m22:12:09.579478 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m22:12:09.579764 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop table if exists "dev_o0af"."dbt"."trips_geom__dbt_backup" cascade
[0m22:12:09.580099 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_o0af"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m22:12:09.581766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:12:09.582006 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        delete from "dev_o0af"."dbt"."events_clean" as DBT_INTERNAL_DEST
        where (user_id, timestamp, type_id) in (
            select distinct user_id, timestamp, type_id
            from "events_clean__dbt_tmp221201853956" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_o0af"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp221201853956"
    )
  
[0m22:12:09.753915 [debug] [Thread-2 (]: SQL status: INSERT 0 4 in 0.173 seconds
[0m22:12:09.755602 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.175 seconds
[0m22:12:09.756775 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.174 seconds
[0m22:12:09.757996 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m22:12:09.758572 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.178 seconds
[0m22:12:09.761291 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m22:12:09.763425 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m22:12:09.765559 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m22:12:09.766227 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m22:12:09.767072 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116561310>]}
[0m22:12:09.767586 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m22:12:09.768118 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144e52e0>]}
[0m22:12:09.768937 [info ] [Thread-4 (]: 5 of 23 OK created sql table model dbt.trips_stat_daily ........................ [[32mSELECT 91[0m in 5.43s]
[0m22:12:09.770322 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m22:12:09.771992 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: COMMIT
[0m22:12:09.769790 [info ] [Thread-3 (]: 3 of 23 OK created sql table model dbt.trips_geom .............................. [[32mSELECT 105901[0m in 7.99s]
[0m22:12:09.772562 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.scooters
[0m22:12:09.772969 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m22:12:09.773491 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m22:12:09.773989 [info ] [Thread-4 (]: 8 of 23 START seed file dbt.scooters ........................................... [RUN]
[0m22:12:09.774420 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: COMMIT
[0m22:12:09.774854 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:12:09.775408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now seed.dbt_scooters.scooters)
[0m22:12:09.776153 [info ] [Thread-3 (]: 9 of 23 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m22:12:09.776551 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.scooters
[0m22:12:09.776904 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m22:12:09.777223 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.scooters
[0m22:12:09.777511 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:12:09.789882 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:12:09.792620 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:12:09.792920 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: BEGIN
[0m22:12:09.793147 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:12:09.793816 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:12:09.805303 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:12:09.805815 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:12:09.806021 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m22:12:09.806200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:12:09.855561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.086 seconds
[0m22:12:09.856210 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m22:12:09.856546 [debug] [Thread-2 (]: SQL status: COMMIT in 0.080 seconds
[0m22:12:09.857004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140e4f30>]}
[0m22:12:09.857561 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: Close
[0m22:12:09.858055 [info ] [Thread-1 (]: 1 of 23 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 8.08s]
[0m22:12:09.858654 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m22:12:09.859039 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114482630>]}
[0m22:12:09.859347 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:12:09.859782 [info ] [Thread-2 (]: 7 of 23 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 2.15s]
[0m22:12:09.860145 [info ] [Thread-1 (]: 10 of 23 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m22:12:09.860567 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.event_types
[0m22:12:09.860832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m22:12:09.861098 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m22:12:09.861372 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:12:09.861771 [info ] [Thread-2 (]: 11 of 23 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m22:12:09.866524 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:12:09.866856 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now model.dbt_scooters.revenue_daily)
[0m22:12:09.867154 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m22:12:09.869624 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m22:12:09.869993 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:12:09.871259 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:12:09.871780 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m22:12:09.872048 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:12:09.874004 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:12:09.874208 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m22:12:09.874434 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp221209873084"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_o0af"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_o0af"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m22:12:09.874641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:09.874816 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:12:10.877204 [debug] [Thread-3 (]: SQL status: BEGIN in 1.071 seconds
[0m22:12:10.878280 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:12:10.878942 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_o0af"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



  
  
      
    ) dbt_internal_test
[0m22:12:11.083166 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.204 seconds
[0m22:12:11.087665 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m22:12:11.185467 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m22:12:11.186494 [info ] [Thread-3 (]: 9 of 23 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 1.41s]
[0m22:12:11.187124 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:12:11.187532 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat
[0m22:12:11.188107 [info ] [Thread-3 (]: 12 of 23 START sql table model dbt.trips_stat .................................. [RUN]
[0m22:12:11.188624 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now model.dbt_scooters.trips_stat)
[0m22:12:11.189010 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat
[0m22:12:11.191722 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m22:12:11.192534 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat
[0m22:12:11.195675 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m22:12:11.196338 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:12:11.196669 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m22:12:11.196984 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:12:11.389107 [debug] [Thread-4 (]: SQL status: BEGIN in 1.596 seconds
[0m22:12:11.389641 [debug] [Thread-1 (]: SQL status: BEGIN in 1.515 seconds
[0m22:12:11.390011 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:12:11.390516 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:12:11.391005 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_o0af"."dbt"."scooters"
[0m22:12:11.391415 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sex
from "dev_o0af"."scooters_raw"."users"
where sex is null



  
  
      
    ) dbt_internal_test
[0m22:12:11.493203 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.101 seconds
[0m22:12:11.498941 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m22:12:11.577786 [debug] [Thread-4 (]: SQL status: TRUNCATE TABLE in 0.185 seconds
[0m22:12:11.585171 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:12:11.585829 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_o0af"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m22:12:11.698346 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.112 seconds
[0m22:12:11.700774 [debug] [Thread-1 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m22:12:11.702280 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m22:12:11.704129 [warn ] [Thread-1 (]: 10 of 23 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 1.84s]
[0m22:12:11.705444 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:12:11.707962 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m22:12:11.708650 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m22:12:11.709405 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m22:12:11.710231 [info ] [Thread-1 (]: 13 of 23 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m22:12:11.710845 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m22:12:11.711416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now model.dbt_scooters.parking_finish_stat)
[0m22:12:11.712014 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m22:12:11.718826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m22:12:11.719827 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m22:12:11.723041 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m22:12:11.723685 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:12:11.723993 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m22:12:11.724268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:11.901181 [debug] [Thread-4 (]: SQL status: COMMIT in 0.189 seconds
[0m22:12:11.903342 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: Close
[0m22:12:11.904867 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11651a150>]}
[0m22:12:11.905742 [info ] [Thread-4 (]: 8 of 23 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 2.13s]
[0m22:12:11.906474 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.scooters
[0m22:12:11.907006 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_start_stat
[0m22:12:11.907755 [info ] [Thread-4 (]: 14 of 23 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m22:12:11.908518 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now model.dbt_scooters.parking_start_stat)
[0m22:12:11.908972 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m22:12:11.914515 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m22:12:11.916507 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m22:12:11.920352 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m22:12:11.921148 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:12:11.921502 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m22:12:11.921818 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:12:12.618381 [debug] [Thread-2 (]: SQL status: SELECT 3 in 2.743 seconds
[0m22:12:12.625903 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:12:12.626664 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m22:12:12.825444 [debug] [Thread-2 (]: SQL status: BEGIN in 0.198 seconds
[0m22:12:12.827095 [debug] [Thread-3 (]: SQL status: BEGIN in 1.630 seconds
[0m22:12:12.828376 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:12:12.829448 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:12:12.829997 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp221209873084'
        
      order by ordinal_position

  
[0m22:12:12.830564 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_o0af"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_o0af"."dbt"."trips_prep"
  );
  
[0m22:12:13.129404 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.298 seconds
[0m22:12:13.131821 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:12:13.132122 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m22:12:13.233750 [debug] [Thread-1 (]: SQL status: BEGIN in 1.509 seconds
[0m22:12:13.234637 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.102 seconds
[0m22:12:13.235182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:12:13.239649 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:12:13.240256 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_o0af"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_o0af"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)
-- group by
--     1


select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_o0af"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m22:12:13.240708 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp221209873084'
        
      order by ordinal_position

  
[0m22:12:13.436858 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.196 seconds
[0m22:12:13.439986 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:12:13.440185 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m22:12:13.642259 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.201 seconds
[0m22:12:13.647580 [debug] [Thread-2 (]: 
    In "dev_o0af"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:12:13.648935 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m22:12:13.651649 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:12:13.652111 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_o0af"."finance"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp221209873084" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_o0af"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp221209873084"
    )
  
[0m22:12:13.745924 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.093 seconds
[0m22:12:13.753107 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:12:13.753639 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_o0af".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m22:12:14.154450 [debug] [Thread-4 (]: SQL status: BEGIN in 2.232 seconds
[0m22:12:14.156040 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.402 seconds
[0m22:12:14.157214 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:12:14.159742 [debug] [Thread-2 (]: On "dev_o0af"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m22:12:14.160379 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_o0af"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_o0af"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.start_point, 3857), hex.geom)
-- group by
--     1

select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_o0af"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m22:12:14.161352 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:12:14.162029 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m22:12:14.162406 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m22:12:14.358682 [debug] [Thread-2 (]: SQL status: COMMIT in 0.195 seconds
[0m22:12:14.361706 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m22:12:14.363623 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11651bb90>]}
[0m22:12:14.364596 [info ] [Thread-2 (]: 11 of 23 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 4.50s]
[0m22:12:14.365303 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m22:12:14.365780 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_full
[0m22:12:14.366348 [info ] [Thread-2 (]: 15 of 23 START sql view model dbt.events_full .................................. [RUN]
[0m22:12:14.366893 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.events_full)
[0m22:12:14.367252 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_full
[0m22:12:14.371287 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m22:12:14.373720 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_full
[0m22:12:14.381267 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m22:12:14.382578 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:12:14.382846 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: BEGIN
[0m22:12:14.383098 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:12:15.895096 [debug] [Thread-2 (]: SQL status: BEGIN in 1.511 seconds
[0m22:12:15.896840 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:12:15.898044 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_o0af"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_o0af"."dbt"."events_clean"
    left join "dev_o0af"."dbt"."event_types"
        using (type_id)
  );
[0m22:12:16.103106 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.204 seconds
[0m22:12:16.111435 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:12:16.112144 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_o0af"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m22:12:16.237082 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.124 seconds
[0m22:12:16.242973 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:12:16.243471 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_o0af"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m22:12:16.408274 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.164 seconds
[0m22:12:16.410860 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m22:12:16.411472 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:12:16.411960 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m22:12:16.613208 [debug] [Thread-2 (]: SQL status: COMMIT in 0.200 seconds
[0m22:12:16.617832 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."events_full__dbt_backup"
[0m22:12:16.618583 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m22:12:16.619010 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_o0af"."dbt"."events_full__dbt_backup" cascade
[0m22:12:16.920380 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.301 seconds
[0m22:12:16.924024 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: Close
[0m22:12:16.925676 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cbe090>]}
[0m22:12:16.926965 [info ] [Thread-2 (]: 15 of 23 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 2.56s]
[0m22:12:16.927960 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_full
[0m22:12:16.928642 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_users
[0m22:12:16.929537 [info ] [Thread-2 (]: 16 of 23 START sql incremental model dbt.trips_users ........................... [RUN]
[0m22:12:16.930498 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.trips_users)
[0m22:12:16.931002 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_users
[0m22:12:16.936673 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m22:12:16.939165 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_users
[0m22:12:16.943754 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:12:16.944189 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp221216941459"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_o0af"."dbt"."trips_prep" as t
left join
    "dev_o0af"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_o0af"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m22:12:16.944509 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:12:19.376681 [debug] [Thread-3 (]: SQL status: SELECT 1 in 6.545 seconds
[0m22:12:19.383526 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:12:19.384119 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_o0af"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m22:12:19.478909 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m22:12:19.485444 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:12:19.485874 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_o0af"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m22:12:19.581241 [debug] [Thread-2 (]: SQL status: SELECT 0 in 2.636 seconds
[0m22:12:19.582587 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.096 seconds
[0m22:12:19.589695 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:12:19.591096 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m22:12:19.591504 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: BEGIN
[0m22:12:19.591829 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:12:19.592273 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m22:12:19.786151 [debug] [Thread-3 (]: SQL status: COMMIT in 0.193 seconds
[0m22:12:19.792278 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_stat__dbt_backup"
[0m22:12:19.793152 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m22:12:19.793596 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_o0af"."dbt"."trips_stat__dbt_backup" cascade
[0m22:12:19.888666 [debug] [Thread-2 (]: SQL status: BEGIN in 0.296 seconds
[0m22:12:19.889598 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:12:19.889923 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp221216941459'
        
      order by ordinal_position

  
[0m22:12:19.942336 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.148 seconds
[0m22:12:19.944831 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: Close
[0m22:12:19.946110 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11434aed0>]}
[0m22:12:19.946949 [info ] [Thread-3 (]: 12 of 23 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 8.76s]
[0m22:12:19.947601 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat
[0m22:12:19.948060 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies
[0m22:12:19.948766 [info ] [Thread-3 (]: 17 of 23 START sql table model dbt.companies ................................... [RUN]
[0m22:12:19.949530 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.companies)
[0m22:12:19.950013 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies
[0m22:12:19.954149 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m22:12:19.956433 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies
[0m22:12:19.960816 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m22:12:19.961632 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:12:19.961950 [debug] [Thread-3 (]: On model.dbt_scooters.companies: BEGIN
[0m22:12:19.962223 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:12:20.912817 [debug] [Thread-2 (]: SQL status: SELECT 17 in 1.022 seconds
[0m22:12:20.919527 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:12:20.920301 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:12:21.117214 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.196 seconds
[0m22:12:21.125543 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:12:21.126432 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp221216941459'
        
      order by ordinal_position

  
[0m22:12:21.530842 [debug] [Thread-3 (]: SQL status: BEGIN in 1.568 seconds
[0m22:12:21.532448 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:12:21.533659 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_o0af"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_o0af"."dbt"."scooters"
group by
    1
  );
  
[0m22:12:21.537103 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.410 seconds
[0m22:12:21.541981 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:12:21.542470 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_o0af".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m22:12:21.736107 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.201 seconds
[0m22:12:21.743311 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:12:21.743887 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_o0af"."dbt"."companies" rename to "companies__dbt_backup"
[0m22:12:21.834077 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.089 seconds
[0m22:12:21.835480 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.292 seconds
[0m22:12:21.842198 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:12:21.846552 [debug] [Thread-2 (]: 
    In "dev_o0af"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m22:12:21.847106 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_o0af"."dbt"."companies__dbt_tmp" rename to "companies"
[0m22:12:21.854335 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m22:12:21.855392 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:12:21.855864 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_o0af"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp221216941459"
    )


  
[0m22:12:21.937718 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.083 seconds
[0m22:12:21.938617 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.082 seconds
[0m22:12:21.941434 [debug] [Thread-3 (]: On model.dbt_scooters.companies: COMMIT
[0m22:12:21.943825 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:12:21.944567 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:12:21.945280 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m22:12:21.945950 [debug] [Thread-3 (]: On model.dbt_scooters.companies: COMMIT
[0m22:12:22.040420 [debug] [Thread-3 (]: SQL status: COMMIT in 0.093 seconds
[0m22:12:22.046226 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."companies__dbt_backup"
[0m22:12:22.047240 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies"
[0m22:12:22.047853 [debug] [Thread-3 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_o0af"."dbt"."companies__dbt_backup" cascade
[0m22:12:22.246830 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.198 seconds
[0m22:12:22.251676 [debug] [Thread-3 (]: On model.dbt_scooters.companies: Close
[0m22:12:22.252954 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11651b9b0>]}
[0m22:12:22.253864 [info ] [Thread-3 (]: 17 of 23 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 2.30s]
[0m22:12:22.254551 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies
[0m22:12:22.255024 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_stat
[0m22:12:22.255712 [info ] [Thread-3 (]: 18 of 23 START sql table model dbt.events_stat ................................. [RUN]
[0m22:12:22.256344 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.events_stat)
[0m22:12:22.256740 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_stat
[0m22:12:22.260373 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m22:12:22.262473 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_stat
[0m22:12:22.265536 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m22:12:22.266529 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:12:22.266861 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: BEGIN
[0m22:12:22.267142 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:12:23.985065 [debug] [Thread-3 (]: SQL status: BEGIN in 1.717 seconds
[0m22:12:23.986701 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:12:23.987905 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_o0af"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_o0af"."dbt"."events_full"
  );
  
[0m22:12:33.304507 [debug] [Thread-3 (]: SQL status: SELECT 1 in 9.315 seconds
[0m22:12:33.311879 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:12:33.312623 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_o0af"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m22:12:33.510863 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.197 seconds
[0m22:12:33.516958 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:12:33.517677 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_o0af"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m22:12:33.713157 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.194 seconds
[0m22:12:33.717611 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: COMMIT
[0m22:12:33.718403 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:12:33.718973 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: COMMIT
[0m22:12:33.917380 [debug] [Thread-3 (]: SQL status: COMMIT in 0.198 seconds
[0m22:12:33.922167 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."events_stat__dbt_backup"
[0m22:12:33.923276 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m22:12:33.923967 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_o0af"."dbt"."events_stat__dbt_backup" cascade
[0m22:12:34.145370 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.220 seconds
[0m22:12:34.148713 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: Close
[0m22:12:34.150157 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114482690>]}
[0m22:12:34.151300 [info ] [Thread-3 (]: 18 of 23 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 11.89s]
[0m22:12:34.152175 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_stat
[0m22:12:34.152685 [debug] [Thread-3 (]: Began running node model.dbt_scooters.companies_trips
[0m22:12:34.153413 [info ] [Thread-3 (]: 19 of 23 START sql table model dbt.companies_trips ............................. [RUN]
[0m22:12:34.154173 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now model.dbt_scooters.companies_trips)
[0m22:12:34.154645 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.companies_trips
[0m22:12:34.160382 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m22:12:34.162764 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.companies_trips
[0m22:12:34.167067 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m22:12:34.168091 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:12:34.168435 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m22:12:34.168723 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:12:34.839112 [debug] [Thread-2 (]: SQL status: ANALYZE in 12.892 seconds
[0m22:12:34.840860 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m22:12:34.841438 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:12:34.841872 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m22:12:35.043365 [debug] [Thread-2 (]: SQL status: COMMIT in 0.201 seconds
[0m22:12:35.044494 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:12:35.044996 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m22:12:35.147827 [debug] [Thread-2 (]: SQL status: COMMIT in 0.102 seconds
[0m22:12:35.151153 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m22:12:35.151861 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m22:12:35.248279 [debug] [Thread-2 (]: SQL status: VACUUM in 0.096 seconds
[0m22:12:35.249760 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: Close
[0m22:12:35.250480 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112812ab0>]}
[0m22:12:35.251001 [info ] [Thread-2 (]: 16 of 23 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 18.32s]
[0m22:12:35.251400 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_users
[0m22:12:35.251868 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_daily
[0m22:12:35.252270 [info ] [Thread-2 (]: 20 of 23 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m22:12:35.252596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_daily)
[0m22:12:35.252844 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m22:12:35.255370 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m22:12:35.256779 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m22:12:35.258994 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m22:12:35.259591 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:12:35.259821 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m22:12:35.260015 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:12:35.560077 [debug] [Thread-3 (]: SQL status: BEGIN in 1.391 seconds
[0m22:12:35.560927 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:12:35.561482 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_o0af"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_o0af"."dbt"."trips_prep" as t
        join "dev_o0af"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_o0af"."dbt"."companies" as c
        using (company)
  );
  
[0m22:12:38.320787 [debug] [Thread-2 (]: SQL status: BEGIN in 3.060 seconds
[0m22:12:38.322443 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:12:38.323697 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_o0af"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m22:12:39.038789 [debug] [Thread-3 (]: SQL status: SELECT 6 in 3.477 seconds
[0m22:12:39.044316 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:12:39.044947 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_o0af"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m22:12:39.139562 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m22:12:39.146186 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:12:39.147035 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_o0af"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m22:12:39.242435 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m22:12:39.245794 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m22:12:39.246521 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:12:39.247110 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m22:12:39.344587 [debug] [Thread-3 (]: SQL status: COMMIT in 0.097 seconds
[0m22:12:39.350022 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."companies_trips__dbt_backup"
[0m22:12:39.350660 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m22:12:39.350960 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_o0af"."dbt"."companies_trips__dbt_backup" cascade
[0m22:12:39.450054 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.098 seconds
[0m22:12:39.453952 [debug] [Thread-3 (]: On model.dbt_scooters.companies_trips: Close
[0m22:12:39.455424 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114482690>]}
[0m22:12:39.456542 [info ] [Thread-3 (]: 19 of 23 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 5.30s]
[0m22:12:39.457476 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.companies_trips
[0m22:12:39.458138 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_group
[0m22:12:39.458968 [info ] [Thread-3 (]: 21 of 23 START sql table model dbt.trips_age_group ............................. [RUN]
[0m22:12:39.459699 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_age_group)
[0m22:12:39.460137 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m22:12:39.472245 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m22:12:39.474654 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_group
[0m22:12:39.477419 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m22:12:39.478222 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:12:39.478577 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m22:12:39.478850 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:12:41.388064 [debug] [Thread-3 (]: SQL status: BEGIN in 1.909 seconds
[0m22:12:41.388994 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:12:41.389636 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_o0af"."dbt"."trips_users" as tu
    cross join "dev_o0af"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m22:12:44.775142 [debug] [Thread-2 (]: SQL status: SELECT 7049 in 6.450 seconds
[0m22:12:44.782197 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:12:44.782884 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_o0af"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m22:12:44.977172 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.194 seconds
[0m22:12:44.981725 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:12:44.982186 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_o0af"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m22:12:45.386406 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.404 seconds
[0m22:12:45.389861 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m22:12:45.390536 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:12:45.391054 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m22:12:45.591173 [debug] [Thread-2 (]: SQL status: COMMIT in 0.199 seconds
[0m22:12:45.596463 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_daily__dbt_backup"
[0m22:12:45.597599 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m22:12:45.598256 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_o0af"."dbt"."trips_age_daily__dbt_backup" cascade
[0m22:12:46.105252 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.506 seconds
[0m22:12:46.109171 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: Close
[0m22:12:46.110749 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11434b590>]}
[0m22:12:46.111774 [info ] [Thread-2 (]: 20 of 23 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 10.86s]
[0m22:12:46.112484 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m22:12:46.113024 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:12:46.113603 [info ] [Thread-2 (]: 22 of 23 START test unique_companies_trips_company ............................. [RUN]
[0m22:12:46.114274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m22:12:46.114662 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:12:46.122532 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:12:46.123676 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:12:46.125836 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:12:46.126546 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:12:46.126836 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m22:12:46.127084 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:12:47.538099 [debug] [Thread-2 (]: SQL status: BEGIN in 1.411 seconds
[0m22:12:47.539755 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:12:47.540630 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_o0af"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:12:47.641132 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.100 seconds
[0m22:12:47.644527 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m22:12:47.741314 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m22:12:47.744056 [info ] [Thread-2 (]: 22 of 23 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 1.63s]
[0m22:12:47.745161 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:12:47.745921 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m22:12:47.746842 [info ] [Thread-2 (]: 23 of 23 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m22:12:47.747763 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now model.dbt_scooters.trips_age_daily_stat)
[0m22:12:47.748460 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m22:12:47.753516 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m22:12:47.754892 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m22:12:47.760481 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m22:12:47.762323 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:12:47.762747 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m22:12:47.763106 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:12:49.790143 [debug] [Thread-2 (]: SQL status: BEGIN in 2.027 seconds
[0m22:12:49.791772 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:12:49.792977 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_o0af"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_o0af"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m22:12:50.506564 [debug] [Thread-2 (]: SQL status: SELECT 83 in 0.712 seconds
[0m22:12:50.514612 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:12:50.515340 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_o0af"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m22:12:50.711255 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.195 seconds
[0m22:12:50.718976 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:12:50.719616 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_o0af"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m22:12:50.919052 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.199 seconds
[0m22:12:50.923465 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m22:12:50.924052 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:12:50.924521 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m22:12:51.120801 [debug] [Thread-2 (]: SQL status: COMMIT in 0.195 seconds
[0m22:12:51.128075 [debug] [Thread-2 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_daily_stat__dbt_backup"
[0m22:12:51.128980 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m22:12:51.129427 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_o0af"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m22:12:51.304311 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.174 seconds
[0m22:12:51.309175 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m22:12:51.310645 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110012030>]}
[0m22:12:51.311620 [info ] [Thread-2 (]: 23 of 23 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 3.56s]
[0m22:12:51.312387 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m22:12:54.911236 [debug] [Thread-1 (]: SQL status: SELECT 464 in 41.670 seconds
[0m22:12:54.916641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:12:54.917206 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_o0af"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m22:12:55.015371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.097 seconds
[0m22:12:55.020832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:12:55.021384 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_o0af"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m22:12:55.114391 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m22:12:55.119576 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m22:12:55.120301 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:12:55.120883 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m22:12:55.216304 [debug] [Thread-1 (]: SQL status: COMMIT in 0.095 seconds
[0m22:12:55.218241 [debug] [Thread-1 (]: Applying DROP to: "dev_o0af"."dbt"."parking_finish_stat__dbt_backup"
[0m22:12:55.218619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m22:12:55.218843 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_o0af"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m22:12:55.422597 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.202 seconds
[0m22:12:55.427691 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m22:12:55.429192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11434b230>]}
[0m22:12:55.430449 [info ] [Thread-1 (]: 13 of 23 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 43.72s]
[0m22:12:55.431434 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m22:13:00.541578 [debug] [Thread-4 (]: SQL status: SELECT 142 in 46.380 seconds
[0m22:13:00.548997 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:13:00.549876 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_o0af"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m22:13:00.643986 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m22:13:00.651646 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:13:00.652561 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_o0af"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m22:13:00.746527 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m22:13:00.749967 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m22:13:00.750851 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:13:00.751420 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m22:13:00.849373 [debug] [Thread-4 (]: SQL status: COMMIT in 0.097 seconds
[0m22:13:00.852996 [debug] [Thread-4 (]: Applying DROP to: "dev_o0af"."dbt"."parking_start_stat__dbt_backup"
[0m22:13:00.853799 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m22:13:00.854230 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_o0af"."dbt"."parking_start_stat__dbt_backup" cascade
[0m22:13:00.951171 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.096 seconds
[0m22:13:00.954616 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: Close
[0m22:13:00.956365 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11434a030>]}
[0m22:13:00.957629 [info ] [Thread-4 (]: 14 of 23 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 49.05s]
[0m22:13:00.959020 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m22:13:05.559443 [debug] [Thread-3 (]: SQL status: SELECT 7 in 24.169 seconds
[0m22:13:05.566013 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:13:05.566620 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_o0af"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m22:13:05.663291 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.096 seconds
[0m22:13:05.670894 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:13:05.671450 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_o0af"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m22:13:05.763997 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m22:13:05.768145 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m22:13:05.768603 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:13:05.769088 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m22:13:05.866495 [debug] [Thread-3 (]: SQL status: COMMIT in 0.097 seconds
[0m22:13:05.871973 [debug] [Thread-3 (]: Applying DROP to: "dev_o0af"."dbt"."trips_age_group__dbt_backup"
[0m22:13:05.872741 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m22:13:05.873190 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_o0af"."dbt"."trips_age_group__dbt_backup" cascade
[0m22:13:05.968392 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.095 seconds
[0m22:13:05.970845 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_group: Close
[0m22:13:05.972249 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c915f-ccb4-4026-9dfd-4d0de7ba371f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114481790>]}
[0m22:13:05.973349 [info ] [Thread-3 (]: 21 of 23 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 26.51s]
[0m22:13:05.974286 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_group
[0m22:13:05.977110 [info ] [MainThread]: 
[0m22:13:05.977774 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:05.978149 [debug] [MainThread]: On master: BEGIN
[0m22:13:05.978510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:13:07.811923 [debug] [MainThread]: SQL status: BEGIN in 1.833 seconds
[0m22:13:07.813506 [debug] [MainThread]: On master: COMMIT
[0m22:13:07.814578 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:07.815460 [debug] [MainThread]: On master: COMMIT
[0m22:13:07.914156 [debug] [MainThread]: SQL status: COMMIT in 0.098 seconds
[0m22:13:07.918569 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m22:13:07.926786 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m22:13:07.927426 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:07.927843 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m22:13:08.291411 [debug] [MainThread]: SQL status: GRANT in 0.363 seconds
[0m22:13:08.295306 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.38s]
[0m22:13:08.296393 [debug] [MainThread]: On master: Close
[0m22:13:08.297576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:08.297975 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m22:13:08.298340 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m22:13:08.298688 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m22:13:08.299008 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m22:13:08.299622 [info ] [MainThread]: 
[0m22:13:08.300110 [info ] [MainThread]: Finished running 3 incremental models, 1 project hook, 3 seeds, 12 table models, 3 data tests, 2 view models in 0 hours 1 minutes and 15.59 seconds (75.59s).
[0m22:13:08.304116 [debug] [MainThread]: Command end result
[0m22:13:08.328292 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:13:08.330311 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:13:08.335365 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m22:13:08.335593 [info ] [MainThread]: 
[0m22:13:08.335814 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m22:13:08.335983 [info ] [MainThread]: 
[0m22:13:08.336191 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models/properties.yml)[0m
[0m22:13:08.336378 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m22:13:08.336514 [info ] [MainThread]: 
[0m22:13:08.336691 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/source_not_null_scooters_raw_users_sex.sql
[0m22:13:08.336845 [info ] [MainThread]: 
[0m22:13:08.337010 [info ] [MainThread]: Done. PASS=23 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m22:13:08.338607 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 75.97082, "process_in_blocks": "0", "process_kernel_time": 0.302974, "process_mem_max_rss": "141082624", "process_out_blocks": "0", "process_user_time": 2.247274}
[0m22:13:08.338860 [debug] [MainThread]: Command `dbt build` succeeded at 22:13:08.338812 after 75.97 seconds
[0m22:13:08.339065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11209df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11661fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11661fb90>]}
[0m22:13:08.339259 [debug] [MainThread]: Flushing usage events
[0m22:13:09.651130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:13:13.465153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d1f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521bb10>]}


============================== 22:13:13.467388 | 432ba6ae-33de-4193-a8f0-13030fae7f96 ==============================
[0m22:13:13.467388 [info ] [MainThread]: Running with dbt=1.10.6
[0m22:13:13.467643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:13:13.536070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '432ba6ae-33de-4193-a8f0-13030fae7f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451f490>]}
[0m22:13:13.557320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '432ba6ae-33de-4193-a8f0-13030fae7f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b1f20>]}
[0m22:13:13.557742 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:13:13.594046 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m22:13:13.657235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:13:13.657400 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:13:13.684785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '432ba6ae-33de-4193-a8f0-13030fae7f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9cd50>]}
[0m22:13:13.728277 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:13:13.729435 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:13:13.743641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '432ba6ae-33de-4193-a8f0-13030fae7f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615f2f0>]}
[0m22:13:13.743859 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 3 data tests, 16 sources, 439 macros
[0m22:13:13.744005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '432ba6ae-33de-4193-a8f0-13030fae7f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106142510>]}
[0m22:13:13.744976 [info ] [MainThread]: 
[0m22:13:13.745128 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:13:13.745239 [info ] [MainThread]: 
[0m22:13:13.745448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:13:13.747462 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af_finance'
[0m22:13:13.752712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af_dbt'
[0m22:13:13.771790 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m22:13:13.771975 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m22:13:13.772101 [debug] [ThreadPool]: On list_dev_o0af_finance: BEGIN
[0m22:13:13.772215 [debug] [ThreadPool]: On list_dev_o0af_dbt: BEGIN
[0m22:13:13.772324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:13.772425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:14.777182 [debug] [ThreadPool]: SQL status: BEGIN in 1.004 seconds
[0m22:13:14.778947 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m22:13:14.779998 [debug] [ThreadPool]: On list_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_dbt"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m22:13:14.877705 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.097 seconds
[0m22:13:14.883550 [debug] [ThreadPool]: On list_dev_o0af_dbt: ROLLBACK
[0m22:13:14.979761 [debug] [ThreadPool]: SQL status: BEGIN in 1.207 seconds
[0m22:13:14.980979 [debug] [ThreadPool]: On list_dev_o0af_dbt: Close
[0m22:13:14.981827 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m22:13:14.982894 [debug] [ThreadPool]: On list_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_finance"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m22:13:15.083803 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.100 seconds
[0m22:13:15.088156 [debug] [ThreadPool]: On list_dev_o0af_finance: ROLLBACK
[0m22:13:15.184424 [debug] [ThreadPool]: On list_dev_o0af_finance: Close
[0m22:13:15.195440 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:15.195882 [debug] [MainThread]: On master: BEGIN
[0m22:13:15.196251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:13:17.029554 [debug] [MainThread]: SQL status: BEGIN in 1.833 seconds
[0m22:13:17.031155 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:17.032614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:13:17.130039 [debug] [MainThread]: SQL status: SELECT 3 in 0.096 seconds
[0m22:13:17.134054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '432ba6ae-33de-4193-a8f0-13030fae7f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063aaf70>]}
[0m22:13:17.134763 [debug] [MainThread]: On master: ROLLBACK
[0m22:13:17.229217 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:17.230669 [debug] [MainThread]: On master: BEGIN
[0m22:13:17.336714 [debug] [MainThread]: SQL status: BEGIN in 0.105 seconds
[0m22:13:17.338314 [debug] [MainThread]: On master: COMMIT
[0m22:13:17.339301 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:17.340183 [debug] [MainThread]: On master: COMMIT
[0m22:13:17.434023 [debug] [MainThread]: SQL status: COMMIT in 0.093 seconds
[0m22:13:17.435453 [debug] [MainThread]: On master: Close
[0m22:13:17.441777 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:13:17.442227 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:13:17.442559 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:13:17.442945 [info ] [Thread-1 (]: 1 of 3 START test source_accepted_values_scooters_raw_users_sex__M__F .......... [RUN]
[0m22:13:17.443341 [info ] [Thread-3 (]: 3 of 3 START test unique_companies_trips_company ............................... [RUN]
[0m22:13:17.443736 [info ] [Thread-2 (]: 2 of 3 START test source_not_null_scooters_raw_users_sex ....................... [RUN]
[0m22:13:17.444211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_o0af_finance, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m22:13:17.445289 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0'
[0m22:13:17.445885 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_o0af_dbt, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m22:13:17.446353 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:13:17.446748 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:13:17.447092 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:13:17.465306 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:13:17.469133 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:13:17.505463 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:13:17.507295 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:13:17.507511 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:13:17.507671 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:13:17.515129 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:13:17.516128 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:13:17.516878 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:13:17.517256 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:13:17.517425 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m22:13:17.517564 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:13:17.517810 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:13:17.517981 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:13:17.518135 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m22:13:17.518276 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m22:13:17.518405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:17.518529 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:13:18.668208 [debug] [Thread-2 (]: SQL status: BEGIN in 1.150 seconds
[0m22:13:18.668634 [debug] [Thread-3 (]: SQL status: BEGIN in 1.151 seconds
[0m22:13:18.668907 [debug] [Thread-1 (]: SQL status: BEGIN in 1.150 seconds
[0m22:13:18.669153 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:13:18.669412 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:13:18.669657 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:13:18.669927 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sex
from "dev_o0af"."scooters_raw"."users"
where sex is null



  
  
      
    ) dbt_internal_test
[0m22:13:18.670207 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_o0af"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:13:18.670499 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_o0af"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



  
  
      
    ) dbt_internal_test
[0m22:13:18.768824 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.098 seconds
[0m22:13:18.769971 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.099 seconds
[0m22:13:18.770774 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.100 seconds
[0m22:13:18.778711 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m22:13:18.781064 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m22:13:18.783245 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m22:13:18.870840 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m22:13:18.871771 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m22:13:18.872579 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m22:13:18.874103 [info ] [Thread-3 (]: 3 of 3 PASS unique_companies_trips_company ..................................... [[32mPASS[0m in 1.43s]
[0m22:13:18.874975 [warn ] [Thread-2 (]: 2 of 3 WARN 216 source_not_null_scooters_raw_users_sex ......................... [[33mWARN 216[0m in 1.43s]
[0m22:13:18.876956 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:13:18.875709 [info ] [Thread-1 (]: 1 of 3 PASS source_accepted_values_scooters_raw_users_sex__M__F ................ [[32mPASS[0m in 1.43s]
[0m22:13:18.877963 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:13:18.878935 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:13:18.880906 [info ] [MainThread]: 
[0m22:13:18.881445 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:18.881799 [debug] [MainThread]: On master: BEGIN
[0m22:13:18.882127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:13:20.407205 [debug] [MainThread]: SQL status: BEGIN in 1.525 seconds
[0m22:13:20.408765 [debug] [MainThread]: On master: COMMIT
[0m22:13:20.409786 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:20.410689 [debug] [MainThread]: On master: COMMIT
[0m22:13:20.509476 [debug] [MainThread]: SQL status: COMMIT in 0.098 seconds
[0m22:13:20.514236 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m22:13:20.519921 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m22:13:20.520586 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:20.520958 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m22:13:20.615139 [debug] [MainThread]: SQL status: GRANT in 0.094 seconds
[0m22:13:20.616972 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.11s]
[0m22:13:20.617530 [debug] [MainThread]: On master: Close
[0m22:13:20.618281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:20.618550 [debug] [MainThread]: Connection 'test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b' was properly closed.
[0m22:13:20.618790 [debug] [MainThread]: Connection 'test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee' was properly closed.
[0m22:13:20.619018 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0' was properly closed.
[0m22:13:20.619362 [info ] [MainThread]: 
[0m22:13:20.619641 [info ] [MainThread]: Finished running 1 project hook, 3 data tests in 0 hours 0 minutes and 6.87 seconds (6.87s).
[0m22:13:20.620664 [debug] [MainThread]: Command end result
[0m22:13:20.641309 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:13:20.642950 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:13:20.647923 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m22:13:20.648165 [info ] [MainThread]: 
[0m22:13:20.648409 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m22:13:20.648593 [info ] [MainThread]: 
[0m22:13:20.648812 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models/properties.yml)[0m
[0m22:13:20.649015 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m22:13:20.649165 [info ] [MainThread]: 
[0m22:13:20.649353 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/source_not_null_scooters_raw_users_sex.sql
[0m22:13:20.649508 [info ] [MainThread]: 
[0m22:13:20.649680 [info ] [MainThread]: Done. PASS=3 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m22:13:20.651425 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.2127595, "process_in_blocks": "0", "process_kernel_time": 0.159111, "process_mem_max_rss": "136019968", "process_out_blocks": "0", "process_user_time": 0.991126}
[0m22:13:20.651667 [debug] [MainThread]: Command `dbt test` succeeded at 22:13:20.651618 after 7.21 seconds
[0m22:13:20.651869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061db070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061db1d0>]}
[0m22:13:20.652059 [debug] [MainThread]: Flushing usage events
[0m22:13:21.705660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:24.856508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094bf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094bfb10>]}


============================== 22:18:24.858991 | e42f6594-c500-4ebb-a88e-99e228233e68 ==============================
[0m22:18:24.858991 [info ] [MainThread]: Running with dbt=1.10.6
[0m22:18:24.859279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m22:18:24.941567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e42f6594-c500-4ebb-a88e-99e228233e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087bf490>]}
[0m22:18:24.962151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e42f6594-c500-4ebb-a88e-99e228233e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109355f20>]}
[0m22:18:24.962629 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:18:24.999603 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m22:18:25.059290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:25.059468 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:25.085556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e42f6594-c500-4ebb-a88e-99e228233e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a140d50>]}
[0m22:18:25.130906 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:18:25.132242 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:18:25.151512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e42f6594-c500-4ebb-a88e-99e228233e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a47b2f0>]}
[0m22:18:25.151739 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 4 data tests, 15 sources, 439 macros
[0m22:18:25.151888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e42f6594-c500-4ebb-a88e-99e228233e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a46acf0>]}
[0m22:18:25.152867 [info ] [MainThread]: 
[0m22:18:25.153019 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:18:25.153128 [info ] [MainThread]: 
[0m22:18:25.153338 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:18:25.155226 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af_finance'
[0m22:18:25.160103 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_o0af_dbt'
[0m22:18:25.180157 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m22:18:25.180375 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m22:18:25.180533 [debug] [ThreadPool]: On list_dev_o0af_finance: BEGIN
[0m22:18:25.180658 [debug] [ThreadPool]: On list_dev_o0af_dbt: BEGIN
[0m22:18:25.180771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:25.180876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:26.380627 [debug] [ThreadPool]: SQL status: BEGIN in 1.199 seconds
[0m22:18:26.381996 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_dbt"
[0m22:18:26.382781 [debug] [ThreadPool]: On list_dev_o0af_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_dbt"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m22:18:26.482618 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.099 seconds
[0m22:18:26.484965 [debug] [ThreadPool]: On list_dev_o0af_dbt: ROLLBACK
[0m22:18:26.548471 [debug] [ThreadPool]: On list_dev_o0af_dbt: Close
[0m22:18:26.793167 [debug] [ThreadPool]: SQL status: BEGIN in 1.612 seconds
[0m22:18:26.794133 [debug] [ThreadPool]: Using postgres connection "list_dev_o0af_finance"
[0m22:18:26.794572 [debug] [ThreadPool]: On list_dev_o0af_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_o0af_finance"} */
select
      'dev_o0af' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_o0af' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m22:18:26.892220 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.097 seconds
[0m22:18:26.895137 [debug] [ThreadPool]: On list_dev_o0af_finance: ROLLBACK
[0m22:18:26.968471 [debug] [ThreadPool]: On list_dev_o0af_finance: Close
[0m22:18:26.979632 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:26.980234 [debug] [MainThread]: On master: BEGIN
[0m22:18:26.980629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:28.019740 [debug] [MainThread]: SQL status: BEGIN in 1.039 seconds
[0m22:18:28.021164 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:28.022050 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:18:28.121305 [debug] [MainThread]: SQL status: SELECT 3 in 0.098 seconds
[0m22:18:28.125447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e42f6594-c500-4ebb-a88e-99e228233e68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a56ba00>]}
[0m22:18:28.126393 [debug] [MainThread]: On master: ROLLBACK
[0m22:18:28.223859 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:28.224894 [debug] [MainThread]: On master: BEGIN
[0m22:18:28.428533 [debug] [MainThread]: SQL status: BEGIN in 0.203 seconds
[0m22:18:28.429577 [debug] [MainThread]: On master: COMMIT
[0m22:18:28.430248 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:28.430758 [debug] [MainThread]: On master: COMMIT
[0m22:18:28.524280 [debug] [MainThread]: SQL status: COMMIT in 0.093 seconds
[0m22:18:28.525416 [debug] [MainThread]: On master: Close
[0m22:18:28.532797 [debug] [Thread-1 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:18:28.533530 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:18:28.534149 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:18:28.534716 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:18:28.535310 [info ] [Thread-1 (]: 1 of 4 START test source_accepted_values_scooters_raw_users_sex__M__F .......... [RUN]
[0m22:18:28.535834 [info ] [Thread-3 (]: 3 of 4 START test unique_companies_trips_company ............................... [RUN]
[0m22:18:28.536293 [info ] [Thread-4 (]: 4 of 4 START test unique_trips_age_daily_date_text_age_text .................... [RUN]
[0m22:18:28.536769 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_scooters_raw_users_sex ....................... [RUN]
[0m22:18:28.537408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_o0af_finance, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m22:18:28.538044 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0'
[0m22:18:28.538598 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e'
[0m22:18:28.539096 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_o0af_dbt, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m22:18:28.539517 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:18:28.539904 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:18:28.540278 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:18:28.540639 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:18:28.593563 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:18:28.597158 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:18:28.598927 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:18:28.602417 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:18:28.604542 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:18:28.604759 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:18:28.611229 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:18:28.611410 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:18:28.612774 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:18:28.613594 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:18:28.614467 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:18:28.615188 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:18:28.615604 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:18:28.615783 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m22:18:28.615955 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:18:28.616136 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:18:28.616285 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:18:28.616436 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:18:28.616574 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m22:18:28.616718 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m22:18:28.616915 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m22:18:28.617041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:28.617167 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:18:28.617302 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:18:29.867284 [debug] [Thread-1 (]: SQL status: BEGIN in 1.250 seconds
[0m22:18:29.868672 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m22:18:29.869552 [debug] [Thread-3 (]: SQL status: BEGIN in 1.253 seconds
[0m22:18:29.870289 [debug] [Thread-4 (]: SQL status: BEGIN in 1.253 seconds
[0m22:18:29.871333 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_o0af"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



  
  
      
    ) dbt_internal_test
[0m22:18:29.872134 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m22:18:29.872684 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m22:18:29.873394 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_o0af"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:18:29.873977 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_o0af"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:18:29.966395 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.091 seconds
[0m22:18:29.967728 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.094 seconds
[0m22:18:29.968457 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.094 seconds
[0m22:18:29.976748 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m22:18:29.978549 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m22:18:29.980129 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m22:18:30.068325 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m22:18:30.069669 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m22:18:30.070935 [debug] [Thread-1 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m22:18:30.073207 [info ] [Thread-4 (]: 4 of 4 PASS unique_trips_age_daily_date_text_age_text .......................... [[32mPASS[0m in 1.53s]
[0m22:18:30.074129 [info ] [Thread-3 (]: 3 of 4 PASS unique_companies_trips_company ..................................... [[32mPASS[0m in 1.54s]
[0m22:18:30.076086 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m22:18:30.074872 [info ] [Thread-1 (]: 1 of 4 PASS source_accepted_values_scooters_raw_users_sex__M__F ................ [[32mPASS[0m in 1.54s]
[0m22:18:30.077102 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m22:18:30.078192 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m22:18:30.170950 [debug] [Thread-2 (]: SQL status: BEGIN in 1.553 seconds
[0m22:18:30.171994 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m22:18:30.172573 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sex
from "dev_o0af"."scooters_raw"."users"
where sex is null



  
  
      
    ) dbt_internal_test
[0m22:18:30.272267 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.099 seconds
[0m22:18:30.275842 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m22:18:30.331615 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m22:18:30.333990 [warn ] [Thread-2 (]: 2 of 4 WARN 216 source_not_null_scooters_raw_users_sex ......................... [[33mWARN 216[0m in 1.79s]
[0m22:18:30.335087 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m22:18:30.337689 [info ] [MainThread]: 
[0m22:18:30.338451 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:30.338936 [debug] [MainThread]: On master: BEGIN
[0m22:18:30.339312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:18:31.397970 [debug] [MainThread]: SQL status: BEGIN in 1.059 seconds
[0m22:18:31.398644 [debug] [MainThread]: On master: COMMIT
[0m22:18:31.399001 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:31.399290 [debug] [MainThread]: On master: COMMIT
[0m22:18:31.500951 [debug] [MainThread]: SQL status: COMMIT in 0.101 seconds
[0m22:18:31.504224 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m22:18:31.512309 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m22:18:31.513151 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:31.513602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m22:18:31.576717 [debug] [MainThread]: SQL status: GRANT in 0.062 seconds
[0m22:18:31.579275 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.08s]
[0m22:18:31.580120 [debug] [MainThread]: On master: Close
[0m22:18:31.581486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:31.582012 [debug] [MainThread]: Connection 'test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b' was properly closed.
[0m22:18:31.582438 [debug] [MainThread]: Connection 'test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee' was properly closed.
[0m22:18:31.582913 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0' was properly closed.
[0m22:18:31.583619 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m22:18:31.584333 [info ] [MainThread]: 
[0m22:18:31.585072 [info ] [MainThread]: Finished running 1 project hook, 4 data tests in 0 hours 0 minutes and 6.43 seconds (6.43s).
[0m22:18:31.587048 [debug] [MainThread]: Command end result
[0m22:18:31.614978 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m22:18:31.616404 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m22:18:31.621401 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m22:18:31.621634 [info ] [MainThread]: 
[0m22:18:31.621862 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m22:18:31.622033 [info ] [MainThread]: 
[0m22:18:31.622242 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models/properties.yml)[0m
[0m22:18:31.622435 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m22:18:31.622574 [info ] [MainThread]: 
[0m22:18:31.622758 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/source_not_null_scooters_raw_users_sex.sql
[0m22:18:31.622905 [info ] [MainThread]: 
[0m22:18:31.623072 [info ] [MainThread]: Done. PASS=4 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m22:18:31.624679 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.7976785, "process_in_blocks": "0", "process_kernel_time": 0.18594, "process_mem_max_rss": "137216000", "process_out_blocks": "0", "process_user_time": 1.018061}
[0m22:18:31.624936 [debug] [MainThread]: Command `dbt test` succeeded at 22:18:31.624884 after 6.80 seconds
[0m22:18:31.625145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10939cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4df280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4df120>]}
[0m22:18:31.625344 [debug] [MainThread]: Flushing usage events
[0m22:18:32.732258 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:24.176078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103faf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1fb10>]}


============================== 18:06:24.178470 | 61595c92-8e35-46cb-94ce-9dd7081755ef ==============================
[0m18:06:24.178470 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:06:24.178791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m18:06:24.230908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61595c92-8e35-46cb-94ce-9dd7081755ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2f490>]}
[0m18:06:24.238251 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:06:24.238861 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:06:24.250551 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.10612183, "process_in_blocks": "0", "process_kernel_time": 0.078352, "process_mem_max_rss": "112099328", "process_out_blocks": "0", "process_user_time": 0.652766}
[0m18:06:24.250837 [debug] [MainThread]: Command `cli deps` succeeded at 18:06:24.250787 after 0.11 seconds
[0m18:06:24.250995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c18c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058abb50>]}
[0m18:06:24.251154 [debug] [MainThread]: Flushing usage events
[0m18:06:25.009343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:16:46.060839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d627b10>]}


============================== 18:16:46.063357 | 6628b3b1-6aef-4e19-a8bc-bb8082071b3b ==============================
[0m18:16:46.063357 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:16:46.063634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:16:46.134596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6628b3b1-6aef-4e19-a8bc-bb8082071b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c533490>]}
[0m18:16:46.155573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6628b3b1-6aef-4e19-a8bc-bb8082071b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4c2f10>]}
[0m18:16:46.156196 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:16:46.195036 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:16:46.250048 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:16:46.250293 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m18:16:46.250453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6628b3b1-6aef-4e19-a8bc-bb8082071b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5ac950>]}
[0m18:16:46.776266 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `freshness` as a top-level property of `trips` in file
`models/properties.yml`. The `freshness` top-level property should be moved into
the `config` of `trips`.
[0m18:16:46.776533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6628b3b1-6aef-4e19-a8bc-bb8082071b3b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99e990>]}
[0m18:16:46.833364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6628b3b1-6aef-4e19-a8bc-bb8082071b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9849f0>]}
[0m18:16:46.874995 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:16:46.876346 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:16:46.886934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6628b3b1-6aef-4e19-a8bc-bb8082071b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee37110>]}
[0m18:16:46.887158 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 4 data tests, 15 sources, 439 macros
[0m18:16:46.887295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6628b3b1-6aef-4e19-a8bc-bb8082071b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec79d90>]}
[0m18:16:46.888027 [info ] [MainThread]: 
[0m18:16:46.888154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:16:46.888296 [info ] [MainThread]: 
[0m18:16:46.888542 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:16:46.888926 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m18:16:46.920464 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m18:16:46.920643 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m18:16:46.920749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:48.064244 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.143 seconds
[0m18:16:48.065603 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m18:16:48.066615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now create_dev_h8qz_dbt)
[0m18:16:48.067014 [debug] [ThreadPool]: Creating schema "database: "dev_h8qz"
schema: "dbt"
"
[0m18:16:48.071039 [debug] [ThreadPool]: Using postgres connection "create_dev_h8qz_dbt"
[0m18:16:48.071259 [debug] [ThreadPool]: On create_dev_h8qz_dbt: BEGIN
[0m18:16:48.071432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:52.815794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602bb10>]}


============================== 18:16:52.817731 | ca4a37e7-8d32-4f7c-b0cc-e8da64fb56ea ==============================
[0m18:16:52.817731 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:16:52.817991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:16:52.881511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca4a37e7-8d32-4f7c-b0cc-e8da64fb56ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104733490>]}
[0m18:16:52.902708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca4a37e7-8d32-4f7c-b0cc-e8da64fb56ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c2f10>]}
[0m18:16:52.903098 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:16:52.937792 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:16:52.997553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:16:52.997758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:16:53.028710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca4a37e7-8d32-4f7c-b0cc-e8da64fb56ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dcd50>]}
[0m18:16:53.074435 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:16:53.075634 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:16:53.082511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca4a37e7-8d32-4f7c-b0cc-e8da64fb56ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a99a0>]}
[0m18:16:53.082785 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 4 data tests, 15 sources, 439 macros
[0m18:16:53.082988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca4a37e7-8d32-4f7c-b0cc-e8da64fb56ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106389710>]}
[0m18:16:53.083840 [info ] [MainThread]: 
[0m18:16:53.084012 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:16:53.084121 [info ] [MainThread]: 
[0m18:16:53.084337 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:16:53.084706 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m18:16:53.103118 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m18:16:53.103329 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m18:16:53.103441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:54.412014 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.308 seconds
[0m18:16:54.414747 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m18:16:54.416299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now create_dev_h8qz_dbt)
[0m18:16:54.417065 [debug] [ThreadPool]: Creating schema "database: "dev_h8qz"
schema: "dbt"
"
[0m18:16:54.423743 [debug] [ThreadPool]: Using postgres connection "create_dev_h8qz_dbt"
[0m18:16:54.424357 [debug] [ThreadPool]: On create_dev_h8qz_dbt: BEGIN
[0m18:16:54.424682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:56.254773 [debug] [ThreadPool]: SQL status: BEGIN in 1.830 seconds
[0m18:16:56.255112 [debug] [ThreadPool]: Using postgres connection "create_dev_h8qz_dbt"
[0m18:16:56.255291 [debug] [ThreadPool]: On create_dev_h8qz_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "create_dev_h8qz_dbt"} */
create schema if not exists "dbt"
[0m18:16:56.357506 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.102 seconds
[0m18:16:56.359746 [debug] [ThreadPool]: On create_dev_h8qz_dbt: COMMIT
[0m18:16:56.360491 [debug] [ThreadPool]: Using postgres connection "create_dev_h8qz_dbt"
[0m18:16:56.360892 [debug] [ThreadPool]: On create_dev_h8qz_dbt: COMMIT
[0m18:16:56.459366 [debug] [ThreadPool]: SQL status: COMMIT in 0.098 seconds
[0m18:16:56.460107 [debug] [ThreadPool]: On create_dev_h8qz_dbt: Close
[0m18:16:56.467697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_h8qz_dbt, now list_dev_h8qz_finance)
[0m18:16:56.468413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz_dbt'
[0m18:16:56.472727 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m18:16:56.474521 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m18:16:56.474875 [debug] [ThreadPool]: On list_dev_h8qz_finance: BEGIN
[0m18:16:56.475092 [debug] [ThreadPool]: On list_dev_h8qz_dbt: BEGIN
[0m18:16:56.475265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:56.475432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:57.642542 [debug] [ThreadPool]: SQL status: BEGIN in 1.167 seconds
[0m18:16:57.643561 [debug] [ThreadPool]: SQL status: BEGIN in 1.168 seconds
[0m18:16:57.644146 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m18:16:57.644678 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m18:16:57.645155 [debug] [ThreadPool]: On list_dev_h8qz_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_finance"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m18:16:57.645637 [debug] [ThreadPool]: On list_dev_h8qz_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_dbt"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m18:16:57.791403 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.145 seconds
[0m18:16:57.792250 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.146 seconds
[0m18:16:57.793954 [debug] [ThreadPool]: On list_dev_h8qz_dbt: ROLLBACK
[0m18:16:57.795382 [debug] [ThreadPool]: On list_dev_h8qz_finance: ROLLBACK
[0m18:16:57.846363 [debug] [ThreadPool]: On list_dev_h8qz_dbt: Close
[0m18:16:57.847214 [debug] [ThreadPool]: On list_dev_h8qz_finance: Close
[0m18:16:57.855946 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:57.856582 [debug] [MainThread]: On master: BEGIN
[0m18:16:57.856997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:58.916761 [debug] [MainThread]: SQL status: BEGIN in 1.060 seconds
[0m18:16:58.917666 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:58.918137 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:16:59.022917 [debug] [MainThread]: SQL status: SELECT 0 in 0.104 seconds
[0m18:16:59.026033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca4a37e7-8d32-4f7c-b0cc-e8da64fb56ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704b930>]}
[0m18:16:59.026899 [debug] [MainThread]: On master: ROLLBACK
[0m18:16:59.121997 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:59.122737 [debug] [MainThread]: On master: BEGIN
[0m18:16:59.327305 [debug] [MainThread]: SQL status: BEGIN in 0.204 seconds
[0m18:16:59.328488 [debug] [MainThread]: On master: COMMIT
[0m18:16:59.329446 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:59.329875 [debug] [MainThread]: On master: COMMIT
[0m18:16:59.429632 [debug] [MainThread]: SQL status: COMMIT in 0.099 seconds
[0m18:16:59.430802 [debug] [MainThread]: On master: Close
[0m18:16:59.439195 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies_trips
[0m18:16:59.440507 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.companies_trips ............................... [RUN]
[0m18:16:59.442038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_finance, now model.dbt_scooters.companies_trips)
[0m18:16:59.442645 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies_trips
[0m18:16:59.453089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m18:16:59.454054 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies_trips
[0m18:16:59.480894 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m18:16:59.481518 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:16:59.481703 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m18:16:59.481865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:00.453720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.971 seconds
[0m18:17:00.454730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:17:00.455584 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_h8qz"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_h8qz"."dbt"."trips_prep" as t
        join "dev_h8qz"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_h8qz"."dbt"."companies" as c
        using (company)
  );
  
[0m18:17:00.556498 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt.trips_prep" does not exist
LINE 17:         "dev_h8qz"."dbt"."trips_prep" as t
                 ^

[0m18:17:00.558006 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: ROLLBACK
[0m18:17:00.610244 [debug] [Thread-1 (]: On model.dbt_scooters.companies_trips: Close
[0m18:17:00.628764 [debug] [Thread-1 (]: Database Error in model companies_trips (models/companies_trips.sql)
  relation "dbt.trips_prep" does not exist
  LINE 17:         "dev_h8qz"."dbt"."trips_prep" as t
                   ^
  compiled code at target/run/dbt_scooters/models/companies_trips.sql
[0m18:17:00.631309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca4a37e7-8d32-4f7c-b0cc-e8da64fb56ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107118950>]}
[0m18:17:00.632147 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt.companies_trips ...................... [[31mERROR[0m in 1.19s]
[0m18:17:00.632962 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies_trips
[0m18:17:00.633618 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.companies_trips' to be skipped because of status 'error'.  Reason: Database Error in model companies_trips (models/companies_trips.sql)
  relation "dbt.trips_prep" does not exist
  LINE 17:         "dev_h8qz"."dbt"."trips_prep" as t
                   ^
  compiled code at target/run/dbt_scooters/models/companies_trips.sql.
[0m18:17:00.635498 [info ] [MainThread]: 
[0m18:17:00.635856 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:00.636106 [debug] [MainThread]: On master: BEGIN
[0m18:17:00.636321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:01.556205 [debug] [MainThread]: SQL status: BEGIN in 0.920 seconds
[0m18:17:01.557269 [debug] [MainThread]: On master: COMMIT
[0m18:17:01.559377 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:01.559907 [debug] [MainThread]: On master: COMMIT
[0m18:17:01.623164 [debug] [MainThread]: SQL status: COMMIT in 0.063 seconds
[0m18:17:01.627561 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m18:17:01.636130 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m18:17:01.636973 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:01.637365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m18:17:01.758151 [debug] [MainThread]: Postgres adapter: Postgres error: schema "finance" does not exist

[0m18:17:01.759911 [info ] [MainThread]: 1 of 1 ERROR hook: dbt_scooters.on-run-end.0 ................................... [[31mERROR[0m in 0.14s]
[0m18:17:01.760687 [debug] [MainThread]: On master: Close
[0m18:17:01.761902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:01.762419 [debug] [MainThread]: Connection 'model.dbt_scooters.companies_trips' was properly closed.
[0m18:17:01.762797 [debug] [MainThread]: Connection 'list_dev_h8qz_dbt' was properly closed.
[0m18:17:01.763269 [info ] [MainThread]: 
[0m18:17:01.763736 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 8.68 seconds (8.68s).
[0m18:17:01.765011 [debug] [MainThread]: Command end result
[0m18:17:01.848498 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:17:01.850362 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:17:01.853295 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m18:17:01.853446 [info ] [MainThread]: 
[0m18:17:01.853635 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:17:01.853758 [info ] [MainThread]: 
[0m18:17:01.853918 [error] [MainThread]: [31mFailure in model companies_trips (models/companies_trips.sql)[0m
[0m18:17:01.854057 [error] [MainThread]:   Database Error in model companies_trips (models/companies_trips.sql)
  relation "dbt.trips_prep" does not exist
  LINE 17:         "dev_h8qz"."dbt"."trips_prep" as t
                   ^
  compiled code at target/run/dbt_scooters/models/companies_trips.sql
[0m18:17:01.854208 [info ] [MainThread]: 
[0m18:17:01.854441 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/companies_trips.sql
[0m18:17:01.854632 [info ] [MainThread]: 
[0m18:17:01.854802 [error] [MainThread]: [31mFailure in operation dbt_scooters-on-run-end-0 (./dbt_project.yml)[0m
[0m18:17:01.854947 [error] [MainThread]:   dbt_scooters.on-run-end.0 failed, error:
 schema "finance" does not exist
[0m18:17:01.855046 [info ] [MainThread]: 
[0m18:17:01.855171 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/./dbt_project.yml/hooks/dbt_scooters-on-run-end-0.sql
[0m18:17:01.855281 [info ] [MainThread]: 
[0m18:17:01.855495 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m18:17:01.857297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.066859, "process_in_blocks": "0", "process_kernel_time": 0.144602, "process_mem_max_rss": "139165696", "process_out_blocks": "0", "process_user_time": 1.029709}
[0m18:17:01.857598 [debug] [MainThread]: Command `cli run` failed at 18:17:01.857539 after 9.07 seconds
[0m18:17:01.857813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e676a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064096d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106409590>]}
[0m18:17:01.857989 [debug] [MainThread]: Flushing usage events
[0m18:17:02.604948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:28:45.630861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b974d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508f9d0>]}


============================== 18:28:45.632940 | d2f574f4-a4cb-4cd9-9d7b-005941e8c222 ==============================
[0m18:28:45.632940 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:28:45.633218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:28:45.639085 [info ] [MainThread]: dbt version: 1.10.6
[0m18:28:45.639247 [info ] [MainThread]: python version: 3.13.5
[0m18:28:45.639372 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m18:28:45.639493 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit-Mach-O
[0m18:28:45.660354 [info ] [MainThread]: Using profiles dir at /Users/flerinvs/.dbt
[0m18:28:45.660566 [info ] [MainThread]: Using profiles.yml file at /Users/flerinvs/.dbt/profiles.yml
[0m18:28:45.660688 [info ] [MainThread]: Using dbt_project.yml file at /Users/flerinvs/dbt_scooters/dbt_project.yml
[0m18:28:45.660876 [info ] [MainThread]: adapter type: postgres
[0m18:28:45.660978 [info ] [MainThread]: adapter version: 1.9.0
[0m18:28:45.698339 [info ] [MainThread]: Configuration:
[0m18:28:45.698623 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:28:45.698753 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:28:45.698982 [info ] [MainThread]: Required dependencies:
[0m18:28:45.699209 [debug] [MainThread]: Executing "git --help"
[0m18:28:45.708704 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:28:45.709117 [debug] [MainThread]: STDERR: "b''"
[0m18:28:45.709249 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:28:45.709384 [info ] [MainThread]: Connection:
[0m18:28:45.709530 [info ] [MainThread]:   host: dpg-d3gjbph5pdvs73eilg50-a.frankfurt-postgres.render.com
[0m18:28:45.709634 [info ] [MainThread]:   port: 5432
[0m18:28:45.709739 [info ] [MainThread]:   user: admin
[0m18:28:45.709840 [info ] [MainThread]:   database: dev_h8qz
[0m18:28:45.709945 [info ] [MainThread]:   schema: dbt
[0m18:28:45.710057 [info ] [MainThread]:   connect_timeout: 10
[0m18:28:45.710153 [info ] [MainThread]:   role: None
[0m18:28:45.710246 [info ] [MainThread]:   search_path: None
[0m18:28:45.710344 [info ] [MainThread]:   keepalives_idle: 0
[0m18:28:45.710492 [info ] [MainThread]:   sslmode: None
[0m18:28:45.710651 [info ] [MainThread]:   sslcert: None
[0m18:28:45.710755 [info ] [MainThread]:   sslkey: None
[0m18:28:45.710852 [info ] [MainThread]:   sslrootcert: None
[0m18:28:45.710950 [info ] [MainThread]:   application_name: dbt
[0m18:28:45.711052 [info ] [MainThread]:   retries: 1
[0m18:28:45.711303 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:28:45.742264 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:28:45.755626 [debug] [MainThread]: Using postgres connection "debug"
[0m18:28:45.755798 [debug] [MainThread]: On debug: select 1 as id
[0m18:28:45.755922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:47.020103 [debug] [MainThread]: SQL status: SELECT 1 in 1.264 seconds
[0m18:28:47.023928 [debug] [MainThread]: On debug: Close
[0m18:28:47.025531 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:28:47.026091 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:28:47.028833 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.4226685, "process_in_blocks": "0", "process_kernel_time": 0.102952, "process_mem_max_rss": "128237568", "process_out_blocks": "0", "process_user_time": 0.610052}
[0m18:28:47.029540 [debug] [MainThread]: Command `dbt debug` succeeded at 18:28:47.029426 after 1.42 seconds
[0m18:28:47.030046 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:28:47.030479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105749ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105261eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051687c0>]}
[0m18:28:47.031209 [debug] [MainThread]: Flushing usage events
[0m18:28:47.943722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:18.805048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107417b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074179d0>]}


============================== 18:30:18.806806 | 2d997b05-eafa-4a9d-b6a4-5700f464fcba ==============================
[0m18:30:18.806806 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:30:18.807072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m18:30:18.882577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671b490>]}
[0m18:30:18.903023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072adf20>]}
[0m18:30:18.903397 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:30:18.937582 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:30:18.988287 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:30:18.988485 [debug] [MainThread]: previous checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, current checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7
[0m18:30:18.988622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114bc450>]}
[0m18:30:19.509561 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `freshness` as a top-level property of `trips` in file
`models/properties.yml`. The `freshness` top-level property should be moved into
the `config` of `trips`.
[0m18:30:19.509839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a35e50>]}
[0m18:30:19.567329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111882350>]}
[0m18:30:19.611001 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:30:19.612233 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:30:19.627005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c7ec30>]}
[0m18:30:19.627309 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 4 data tests, 15 sources, 439 macros
[0m18:30:19.628780 [info ] [MainThread]: 
[0m18:30:19.628950 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:30:19.629063 [info ] [MainThread]: 
[0m18:30:19.629266 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:30:19.631238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m18:30:19.635545 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m18:30:19.649882 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m18:30:19.650090 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m18:30:19.650226 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m18:30:19.650354 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m18:30:19.650470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:19.650583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:20.821569 [debug] [ThreadPool]: SQL status: SELECT 6 in 1.171 seconds
[0m18:30:20.822554 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m18:30:20.922835 [debug] [ThreadPool]: SQL status: SELECT 6 in 1.272 seconds
[0m18:30:20.924823 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m18:30:20.925933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now create_dev_h8qz_finance)
[0m18:30:20.926479 [debug] [ThreadPool]: Creating schema "database: "dev_h8qz"
schema: "finance"
"
[0m18:30:20.932689 [debug] [ThreadPool]: Using postgres connection "create_dev_h8qz_finance"
[0m18:30:20.933144 [debug] [ThreadPool]: On create_dev_h8qz_finance: BEGIN
[0m18:30:20.933406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:22.048023 [debug] [ThreadPool]: SQL status: BEGIN in 1.114 seconds
[0m18:30:22.049545 [debug] [ThreadPool]: Using postgres connection "create_dev_h8qz_finance"
[0m18:30:22.050536 [debug] [ThreadPool]: On create_dev_h8qz_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "create_dev_h8qz_finance"} */
create schema if not exists "finance"
[0m18:30:22.150210 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.099 seconds
[0m18:30:22.153643 [debug] [ThreadPool]: On create_dev_h8qz_finance: COMMIT
[0m18:30:22.154654 [debug] [ThreadPool]: Using postgres connection "create_dev_h8qz_finance"
[0m18:30:22.155503 [debug] [ThreadPool]: On create_dev_h8qz_finance: COMMIT
[0m18:30:22.252548 [debug] [ThreadPool]: SQL status: COMMIT in 0.096 seconds
[0m18:30:22.253821 [debug] [ThreadPool]: On create_dev_h8qz_finance: Close
[0m18:30:22.259576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now list_dev_h8qz_finance)
[0m18:30:22.266585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_h8qz_finance, now list_dev_h8qz_dbt)
[0m18:30:22.269048 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m18:30:22.272129 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m18:30:22.272668 [debug] [ThreadPool]: On list_dev_h8qz_finance: BEGIN
[0m18:30:22.272977 [debug] [ThreadPool]: On list_dev_h8qz_dbt: BEGIN
[0m18:30:22.273253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:22.273529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:23.790207 [debug] [ThreadPool]: SQL status: BEGIN in 1.517 seconds
[0m18:30:23.790566 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m18:30:23.790774 [debug] [ThreadPool]: On list_dev_h8qz_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_finance"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m18:30:23.894475 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.103 seconds
[0m18:30:23.895433 [debug] [ThreadPool]: SQL status: BEGIN in 1.622 seconds
[0m18:30:23.897796 [debug] [ThreadPool]: On list_dev_h8qz_finance: ROLLBACK
[0m18:30:23.898373 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m18:30:23.898986 [debug] [ThreadPool]: On list_dev_h8qz_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_dbt"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m18:30:23.993460 [debug] [ThreadPool]: On list_dev_h8qz_finance: Close
[0m18:30:23.994593 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.095 seconds
[0m18:30:23.997342 [debug] [ThreadPool]: On list_dev_h8qz_dbt: ROLLBACK
[0m18:30:24.097138 [debug] [ThreadPool]: On list_dev_h8qz_dbt: Close
[0m18:30:24.103977 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:24.104386 [debug] [MainThread]: On master: BEGIN
[0m18:30:24.104632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:30:25.222514 [debug] [MainThread]: SQL status: BEGIN in 1.117 seconds
[0m18:30:25.224288 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:25.225713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:30:25.324789 [debug] [MainThread]: SQL status: SELECT 0 in 0.098 seconds
[0m18:30:25.329330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d73050>]}
[0m18:30:25.331027 [debug] [MainThread]: On master: ROLLBACK
[0m18:30:25.427246 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:25.428755 [debug] [MainThread]: On master: BEGIN
[0m18:30:25.629241 [debug] [MainThread]: SQL status: BEGIN in 0.199 seconds
[0m18:30:25.630723 [debug] [MainThread]: On master: COMMIT
[0m18:30:25.631366 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:25.631892 [debug] [MainThread]: On master: COMMIT
[0m18:30:25.730228 [debug] [MainThread]: SQL status: COMMIT in 0.098 seconds
[0m18:30:25.731624 [debug] [MainThread]: On master: Close
[0m18:30:25.740209 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m18:30:25.740956 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m18:30:25.741510 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m18:30:25.742028 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m18:30:25.742817 [info ] [Thread-1 (]: 1 of 24 START sql incremental model dbt.events_clean ........................... [RUN]
[0m18:30:25.743609 [info ] [Thread-3 (]: 3 of 24 START sql table model dbt.trips_geom ................................... [RUN]
[0m18:30:25.744297 [info ] [Thread-4 (]: 4 of 24 START sql view model dbt.trips_prep .................................... [RUN]
[0m18:30:25.744909 [info ] [Thread-2 (]: 2 of 24 START sql table model dbt.trips_concurrency ............................ [RUN]
[0m18:30:25.745539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_finance, now model.dbt_scooters.events_clean)
[0m18:30:25.746124 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m18:30:25.746636 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_prep'
[0m18:30:25.747057 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_dbt, now model.dbt_scooters.trips_concurrency)
[0m18:30:25.747464 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m18:30:25.747842 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m18:30:25.748192 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m18:30:25.748808 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m18:30:25.759569 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m18:30:25.761763 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m18:30:25.763778 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m18:30:25.767989 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m18:30:25.768866 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m18:30:25.769168 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m18:30:25.769427 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m18:30:25.769629 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m18:30:25.821549 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m18:30:25.823638 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m18:30:25.828810 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m18:30:25.832534 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m18:30:25.833228 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:30:25.833420 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m18:30:25.833600 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:30:25.833780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:25.833924 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:30:25.834065 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:30:25.834199 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m18:30:25.834384 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m18:30:25.834512 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m18:30:25.834642 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:30:25.834780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:25.834903 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:30:26.968400 [debug] [Thread-2 (]: SQL status: BEGIN in 1.133 seconds
[0m18:30:26.970117 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:30:26.971170 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_h8qz"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
[0m18:30:27.144910 [debug] [Thread-3 (]: SQL status: BEGIN in 1.310 seconds
[0m18:30:27.146027 [debug] [Thread-4 (]: SQL status: BEGIN in 1.311 seconds
[0m18:30:27.146758 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:30:27.147345 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:30:27.147937 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_geom__dbt_tmp"
  
  
    as
  
  (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_h8qz"."scooters_raw"."trips"
  );
  
[0m18:30:27.148534 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_h8qz"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,

    date(started_at at time zone 'Europe/Moscow')
 as "date" 
from
"dev_h8qz"."scooters_raw"."trips"
  );
[0m18:30:27.257082 [debug] [Thread-1 (]: SQL status: BEGIN in 1.423 seconds
[0m18:30:27.258031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:30:27.258555 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
  
    

  create  table "dev_h8qz"."dbt"."events_clean"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_h8qz"."scooters_raw"."events"
where

    "timestamp" < timestamp '2023-08-01'

  );
  
  
[0m18:30:27.372827 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.224 seconds
[0m18:30:27.384647 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:30:27.385215 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_h8qz"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m18:30:27.577971 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.192 seconds
[0m18:30:27.600316 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m18:30:27.600913 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:30:27.601231 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m18:30:27.782450 [debug] [Thread-4 (]: SQL status: COMMIT in 0.181 seconds
[0m18:30:27.794143 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_prep__dbt_backup"
[0m18:30:27.802116 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:30:27.802531 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_h8qz"."dbt"."trips_prep__dbt_backup" cascade
[0m18:30:27.990713 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.187 seconds
[0m18:30:27.995477 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m18:30:27.999338 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112718890>]}
[0m18:30:28.000552 [info ] [Thread-4 (]: 4 of 24 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 2.25s]
[0m18:30:28.001144 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m18:30:28.001514 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m18:30:28.002083 [info ] [Thread-4 (]: 5 of 24 START sql table model dbt.trips_stat_daily ............................. [RUN]
[0m18:30:28.002794 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.trips_stat_daily)
[0m18:30:28.003236 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m18:30:28.005266 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m18:30:28.006079 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m18:30:28.008972 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m18:30:28.009588 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:30:28.009804 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m18:30:28.010007 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:28.964426 [debug] [Thread-2 (]: SQL status: SELECT 10 in 1.992 seconds
[0m18:30:28.977735 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:30:28.978229 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_h8qz"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m18:30:29.270370 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.291 seconds
[0m18:30:29.273436 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m18:30:29.274182 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:30:29.274825 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m18:30:29.421139 [debug] [Thread-2 (]: SQL status: COMMIT in 0.145 seconds
[0m18:30:29.427147 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_concurrency__dbt_backup"
[0m18:30:29.431931 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:30:29.432480 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_h8qz"."dbt"."trips_concurrency__dbt_backup" cascade
[0m18:30:29.625901 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.193 seconds
[0m18:30:29.630732 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m18:30:29.632632 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e5cff0>]}
[0m18:30:29.633652 [info ] [Thread-2 (]: 2 of 24 OK created sql table model dbt.trips_concurrency ....................... [[32mSELECT 10[0m in 3.89s]
[0m18:30:29.634425 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m18:30:29.634942 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m18:30:29.635622 [info ] [Thread-2 (]: 6 of 24 START seed file dbt.age_groups ......................................... [RUN]
[0m18:30:29.636253 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now seed.dbt_scooters.age_groups)
[0m18:30:29.636679 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m18:30:29.637057 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m18:30:29.659100 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:30:29.659488 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m18:30:29.659722 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:29.729311 [debug] [Thread-4 (]: SQL status: BEGIN in 1.719 seconds
[0m18:30:29.729894 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:30:29.730377 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
  
[0m18:30:31.059209 [debug] [Thread-2 (]: SQL status: BEGIN in 1.399 seconds
[0m18:30:31.060288 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:30:31.060955 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */

    create table "dev_h8qz"."dbt"."age_groups" ("group" text,"age_start" integer,"age_end" integer)
  
[0m18:30:31.366334 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.305 seconds
[0m18:30:31.391299 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:30:31.391827 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_h8qz"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m18:30:31.571314 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.179 seconds
[0m18:30:31.584170 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m18:30:31.589107 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m18:30:31.589634 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:30:31.590163 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m18:30:31.776317 [debug] [Thread-2 (]: SQL status: COMMIT in 0.185 seconds
[0m18:30:31.778738 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m18:30:31.780487 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d83d0>]}
[0m18:30:31.781579 [info ] [Thread-2 (]: 6 of 24 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 2.14s]
[0m18:30:31.782600 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m18:30:31.783303 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.event_types
[0m18:30:31.784263 [info ] [Thread-2 (]: 7 of 24 START seed file dbt.event_types ........................................ [RUN]
[0m18:30:31.785112 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now seed.dbt_scooters.event_types)
[0m18:30:31.785720 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.event_types
[0m18:30:31.786200 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.event_types
[0m18:30:31.792272 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:30:31.792852 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: BEGIN
[0m18:30:31.793224 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:33.110314 [debug] [Thread-4 (]: SQL status: SELECT 91 in 3.379 seconds
[0m18:30:33.116228 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:30:33.117041 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_h8qz"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m18:30:33.312385 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.194 seconds
[0m18:30:33.316240 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m18:30:33.317134 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:30:33.317562 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m18:30:33.516753 [debug] [Thread-4 (]: SQL status: COMMIT in 0.199 seconds
[0m18:30:33.519534 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_stat_daily__dbt_backup"
[0m18:30:33.520001 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:30:33.520270 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_h8qz"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m18:30:33.620437 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.100 seconds
[0m18:30:33.622009 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m18:30:33.622702 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127288a0>]}
[0m18:30:33.623289 [info ] [Thread-4 (]: 5 of 24 OK created sql table model dbt.trips_stat_daily ........................ [[32mSELECT 91[0m in 5.62s]
[0m18:30:33.623787 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m18:30:33.624118 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.scooters
[0m18:30:33.624560 [info ] [Thread-4 (]: 8 of 24 START seed file dbt.scooters ........................................... [RUN]
[0m18:30:33.624958 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now seed.dbt_scooters.scooters)
[0m18:30:33.625264 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.scooters
[0m18:30:33.625553 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.scooters
[0m18:30:33.629417 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:30:33.629848 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: BEGIN
[0m18:30:33.630145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:33.927976 [debug] [Thread-3 (]: SQL status: SELECT 105901 in 6.779 seconds
[0m18:30:33.934507 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:30:33.935367 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_h8qz"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m18:30:34.030195 [debug] [Thread-2 (]: SQL status: BEGIN in 2.237 seconds
[0m18:30:34.030978 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:30:34.031427 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */

    create table "dev_h8qz"."dbt"."event_types" ("type_id" integer,"type" text)
  
[0m18:30:34.034047 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.098 seconds
[0m18:30:34.037076 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m18:30:34.037712 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:30:34.038221 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m18:30:34.233756 [debug] [Thread-3 (]: SQL status: COMMIT in 0.195 seconds
[0m18:30:34.234769 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.203 seconds
[0m18:30:34.239030 [debug] [Thread-3 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_geom__dbt_backup"
[0m18:30:34.241345 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:30:34.242280 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:30:34.242909 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_h8qz"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m18:30:34.243462 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop table if exists "dev_h8qz"."dbt"."trips_geom__dbt_backup" cascade
[0m18:30:34.336424 [debug] [Thread-2 (]: SQL status: INSERT 0 4 in 0.092 seconds
[0m18:30:34.337375 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.093 seconds
[0m18:30:34.338513 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m18:30:34.340510 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m18:30:34.341839 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121eb2f0>]}
[0m18:30:34.343027 [info ] [Thread-3 (]: 3 of 24 OK created sql table model dbt.trips_geom .............................. [[32mSELECT 105901[0m in 8.60s]
[0m18:30:34.344147 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m18:30:34.346281 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: COMMIT
[0m18:30:34.346768 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m18:30:34.347363 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:30:34.347784 [info ] [Thread-3 (]: 9 of 24 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m18:30:34.348129 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: COMMIT
[0m18:30:34.348561 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m18:30:34.348929 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m18:30:34.355315 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m18:30:34.357611 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m18:30:34.373058 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m18:30:34.374058 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m18:30:34.374287 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m18:30:34.374481 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:30:34.950581 [debug] [Thread-2 (]: SQL status: COMMIT in 0.601 seconds
[0m18:30:34.953204 [debug] [Thread-2 (]: On seed.dbt_scooters.event_types: Close
[0m18:30:34.954914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121eb710>]}
[0m18:30:34.955990 [info ] [Thread-2 (]: 7 of 24 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 3.17s]
[0m18:30:34.957037 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.event_types
[0m18:30:34.957745 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m18:30:34.958473 [info ] [Thread-2 (]: 10 of 24 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m18:30:34.959301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m18:30:34.959953 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m18:30:34.971214 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m18:30:34.973583 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m18:30:34.975797 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m18:30:34.976441 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m18:30:34.976760 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m18:30:34.977032 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:35.054466 [debug] [Thread-4 (]: SQL status: BEGIN in 1.424 seconds
[0m18:30:35.055619 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:30:35.056266 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */

    create table "dev_h8qz"."dbt"."scooters" ("company" text,"model" text,"hardware_id" text,"scooters" integer)
  
[0m18:30:35.159801 [debug] [Thread-4 (]: SQL status: CREATE TABLE in 0.103 seconds
[0m18:30:35.166967 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:30:35.167719 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_h8qz"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m18:30:35.259232 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.090 seconds
[0m18:30:35.261206 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m18:30:35.264732 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m18:30:35.265553 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:30:35.266077 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: COMMIT
[0m18:30:35.359829 [debug] [Thread-4 (]: SQL status: COMMIT in 0.093 seconds
[0m18:30:35.361640 [debug] [Thread-4 (]: On seed.dbt_scooters.scooters: Close
[0m18:30:35.363132 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112736450>]}
[0m18:30:35.363918 [info ] [Thread-4 (]: 8 of 24 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 1.74s]
[0m18:30:35.364645 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.scooters
[0m18:30:35.365216 [debug] [Thread-4 (]: Began running node model.dbt_scooters.revenue_daily
[0m18:30:35.366272 [info ] [Thread-4 (]: 11 of 24 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m18:30:35.367029 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now model.dbt_scooters.revenue_daily)
[0m18:30:35.367466 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m18:30:35.372808 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m18:30:35.374389 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.revenue_daily
[0m18:30:35.380133 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m18:30:35.381284 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:30:35.381684 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m18:30:35.382028 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:36.182388 [debug] [Thread-2 (]: SQL status: BEGIN in 1.205 seconds
[0m18:30:36.183199 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m18:30:36.183672 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sex
from "dev_h8qz"."scooters_raw"."users"
where sex is null



  
  
      
    ) dbt_internal_test
[0m18:30:36.281605 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.097 seconds
[0m18:30:36.287369 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m18:30:36.385337 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m18:30:36.386818 [debug] [Thread-3 (]: SQL status: BEGIN in 2.012 seconds
[0m18:30:36.387760 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m18:30:36.389232 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_h8qz"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



  
  
      
    ) dbt_internal_test
[0m18:30:36.388728 [warn ] [Thread-2 (]: 10 of 24 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 1.43s]
[0m18:30:36.389991 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m18:30:36.390380 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m18:30:36.390961 [info ] [Thread-2 (]: 12 of 24 START sql table model dbt.trips_stat .................................. [RUN]
[0m18:30:36.391427 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now model.dbt_scooters.trips_stat)
[0m18:30:36.391741 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m18:30:36.395437 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m18:30:36.396606 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m18:30:36.400448 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m18:30:36.401433 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:30:36.401865 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m18:30:36.402366 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:36.590332 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.200 seconds
[0m18:30:36.594438 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m18:30:36.692983 [debug] [Thread-4 (]: SQL status: BEGIN in 1.310 seconds
[0m18:30:36.694728 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:30:36.695727 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
  
    

  create  table "dev_h8qz"."finance"."revenue_daily"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_h8qz"."dbt"."trips_prep"

group by
    2,
    3
order by
    2
  );
  
  
[0m18:30:36.793498 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m18:30:36.796190 [info ] [Thread-3 (]: 9 of 24 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 2.45s]
[0m18:30:36.797374 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m18:30:36.798143 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m18:30:36.799183 [info ] [Thread-3 (]: 13 of 24 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m18:30:36.800296 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now model.dbt_scooters.parking_finish_stat)
[0m18:30:36.800957 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m18:30:36.806724 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m18:30:36.808403 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m18:30:36.812759 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m18:30:36.813881 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:30:36.814274 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m18:30:36.814607 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:30:37.208695 [debug] [Thread-1 (]: SQL status: SELECT 221370 in 9.949 seconds
[0m18:30:37.219507 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m18:30:37.220033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:30:37.220397 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m18:30:37.409348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.188 seconds
[0m18:30:37.412023 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m18:30:37.413809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127364b0>]}
[0m18:30:37.415187 [info ] [Thread-1 (]: 1 of 24 OK created sql incremental model dbt.events_clean ...................... [[32mSELECT 221370[0m in 11.67s]
[0m18:30:37.416226 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m18:30:37.416809 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m18:30:37.417516 [info ] [Thread-1 (]: 14 of 24 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m18:30:37.418445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.parking_start_stat)
[0m18:30:37.418928 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m18:30:37.423622 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m18:30:37.424495 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m18:30:37.427605 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m18:30:37.428338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:30:37.428652 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m18:30:37.428930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:38.024258 [debug] [Thread-2 (]: SQL status: BEGIN in 1.621 seconds
[0m18:30:38.025735 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:30:38.026413 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_h8qz"."dbt"."trips_prep"
  );
  
[0m18:30:38.843865 [debug] [Thread-1 (]: SQL status: BEGIN in 1.414 seconds
[0m18:30:38.845610 [debug] [Thread-3 (]: SQL status: BEGIN in 2.031 seconds
[0m18:30:38.846722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:30:38.847323 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:30:38.847880 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_h8qz"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.start_point, 3857), hex.geom)
-- group by
--     1

select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_h8qz"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:30:38.848437 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_h8qz"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)
-- group by
--     1


select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_h8qz"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:30:40.251081 [debug] [Thread-4 (]: SQL status: SELECT 91 in 3.554 seconds
[0m18:30:40.272819 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:30:40.273344 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

        
            grant select on "dev_h8qz"."finance"."revenue_daily" to finance;
        
    
[0m18:30:40.378021 [debug] [Thread-4 (]: SQL status: GRANT in 0.104 seconds
[0m18:30:40.382684 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:30:40.383883 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:30:40.384438 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:30:40.480327 [debug] [Thread-4 (]: SQL status: COMMIT in 0.095 seconds
[0m18:30:40.483330 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: Close
[0m18:30:40.485860 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112734c50>]}
[0m18:30:40.487195 [info ] [Thread-4 (]: 11 of 24 OK created sql incremental model finance.revenue_daily ................ [[32mSELECT 91[0m in 5.12s]
[0m18:30:40.488195 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.revenue_daily
[0m18:30:40.488904 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies
[0m18:30:40.489781 [info ] [Thread-4 (]: 15 of 24 START sql table model dbt.companies ................................... [RUN]
[0m18:30:40.490616 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.companies)
[0m18:30:40.491235 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies
[0m18:30:40.496163 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m18:30:40.498491 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies
[0m18:30:40.503598 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m18:30:40.504519 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:30:40.504876 [debug] [Thread-4 (]: On model.dbt_scooters.companies: BEGIN
[0m18:30:40.505199 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:40.992465 [debug] [Thread-2 (]: SQL status: SELECT 1 in 2.965 seconds
[0m18:30:41.000874 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:30:41.001673 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_h8qz"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m18:30:41.094487 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m18:30:41.098192 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m18:30:41.098904 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:30:41.099480 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m18:30:41.196913 [debug] [Thread-2 (]: SQL status: COMMIT in 0.096 seconds
[0m18:30:41.202293 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_stat__dbt_backup"
[0m18:30:41.203449 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:30:41.204109 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_h8qz"."dbt"."trips_stat__dbt_backup" cascade
[0m18:30:41.302715 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.098 seconds
[0m18:30:41.306002 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m18:30:41.307358 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121e9970>]}
[0m18:30:41.308281 [info ] [Thread-2 (]: 12 of 24 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 4.92s]
[0m18:30:41.308928 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m18:30:41.309375 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_users
[0m18:30:41.309958 [info ] [Thread-2 (]: 16 of 24 START sql incremental model dbt.trips_users ........................... [RUN]
[0m18:30:41.310654 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_users)
[0m18:30:41.311147 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_users
[0m18:30:41.315834 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m18:30:41.316586 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_users
[0m18:30:41.319435 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m18:30:41.320069 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:30:41.320343 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: BEGIN
[0m18:30:41.320577 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:42.016552 [debug] [Thread-4 (]: SQL status: BEGIN in 1.511 seconds
[0m18:30:42.018411 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:30:42.019678 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_h8qz"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_h8qz"."dbt"."scooters"
group by
    1
  );
  
[0m18:30:42.221153 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.200 seconds
[0m18:30:42.230159 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:30:42.230665 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_h8qz"."dbt"."companies__dbt_tmp" rename to "companies"
[0m18:30:42.426142 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.195 seconds
[0m18:30:42.430683 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m18:30:42.431581 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:30:42.432234 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m18:30:42.630660 [debug] [Thread-4 (]: SQL status: COMMIT in 0.198 seconds
[0m18:30:42.634825 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."companies__dbt_backup"
[0m18:30:42.635577 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:30:42.635989 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_h8qz"."dbt"."companies__dbt_backup" cascade
[0m18:30:42.734339 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.097 seconds
[0m18:30:42.738627 [debug] [Thread-4 (]: On model.dbt_scooters.companies: Close
[0m18:30:42.740215 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112737c50>]}
[0m18:30:42.741380 [info ] [Thread-4 (]: 15 of 24 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 2.25s]
[0m18:30:42.742156 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies
[0m18:30:42.742691 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_full
[0m18:30:42.743332 [info ] [Thread-4 (]: 17 of 24 START sql view model dbt.events_full .................................. [RUN]
[0m18:30:42.744028 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.events_full)
[0m18:30:42.744454 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_full
[0m18:30:42.748665 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m18:30:42.750821 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_full
[0m18:30:42.755083 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m18:30:42.755906 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:30:42.756220 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: BEGIN
[0m18:30:42.756497 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:42.835552 [debug] [Thread-2 (]: SQL status: BEGIN in 1.515 seconds
[0m18:30:42.836594 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:30:42.837297 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_h8qz"."dbt"."trips_users"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_h8qz"."dbt"."trips_prep" as t
left join
    "dev_h8qz"."scooters_raw"."users" as u
    on t.user_id = u.id

      where
          t.id <= 75000

  );
  
  
[0m18:30:43.962189 [debug] [Thread-4 (]: SQL status: BEGIN in 1.205 seconds
[0m18:30:43.963455 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:30:43.964140 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_h8qz"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_h8qz"."dbt"."events_clean"
    left join "dev_h8qz"."dbt"."event_types"
        using (type_id)
  );
[0m18:30:44.064463 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.099 seconds
[0m18:30:44.071657 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:30:44.072374 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_h8qz"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m18:30:44.269079 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.196 seconds
[0m18:30:44.273040 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:30:44.273651 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:30:44.274113 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:30:44.374622 [debug] [Thread-4 (]: SQL status: COMMIT in 0.100 seconds
[0m18:30:44.381357 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."events_full__dbt_backup"
[0m18:30:44.382317 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:30:44.382902 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_h8qz"."dbt"."events_full__dbt_backup" cascade
[0m18:30:44.473701 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.090 seconds
[0m18:30:44.478102 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: Close
[0m18:30:44.479878 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112737c50>]}
[0m18:30:44.480842 [info ] [Thread-4 (]: 17 of 24 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 1.74s]
[0m18:30:44.481477 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_full
[0m18:30:44.481882 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies_trips
[0m18:30:44.482489 [info ] [Thread-4 (]: 18 of 24 START sql table model dbt.companies_trips ............................. [RUN]
[0m18:30:44.483183 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.companies_trips)
[0m18:30:44.483624 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies_trips
[0m18:30:44.486731 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m18:30:44.487438 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies_trips
[0m18:30:44.490020 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m18:30:44.490535 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:30:44.490786 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m18:30:44.491015 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:46.829168 [debug] [Thread-4 (]: SQL status: BEGIN in 2.338 seconds
[0m18:30:46.830806 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:30:46.832088 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_h8qz"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_h8qz"."dbt"."trips_prep" as t
        join "dev_h8qz"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_h8qz"."dbt"."companies" as c
        using (company)
  );
  
[0m18:30:49.902086 [debug] [Thread-4 (]: SQL status: SELECT 6 in 3.069 seconds
[0m18:30:49.910551 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:30:49.911280 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_h8qz"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m18:30:50.003401 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m18:30:50.006704 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:30:50.007475 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:30:50.008093 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:30:50.208125 [debug] [Thread-4 (]: SQL status: COMMIT in 0.199 seconds
[0m18:30:50.213223 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."companies_trips__dbt_backup"
[0m18:30:50.214274 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:30:50.214875 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_h8qz"."dbt"."companies_trips__dbt_backup" cascade
[0m18:30:50.310952 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.095 seconds
[0m18:30:50.315292 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: Close
[0m18:30:50.316875 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113366f0>]}
[0m18:30:50.317761 [info ] [Thread-4 (]: 18 of 24 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 5.83s]
[0m18:30:50.318438 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies_trips
[0m18:30:50.318916 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m18:30:50.319487 [info ] [Thread-4 (]: 19 of 24 START sql table model dbt.events_stat ................................. [RUN]
[0m18:30:50.320167 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.events_stat)
[0m18:30:50.320549 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m18:30:50.324048 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m18:30:50.326454 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m18:30:50.330240 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m18:30:50.331280 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:30:50.331953 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m18:30:50.332326 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:51.949474 [debug] [Thread-4 (]: SQL status: BEGIN in 1.617 seconds
[0m18:30:51.951275 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:30:51.952557 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_h8qz"."dbt"."events_full"
  );
  
[0m18:30:53.486720 [debug] [Thread-2 (]: SQL status: SELECT 75000 in 10.648 seconds
[0m18:30:53.490645 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:30:53.491604 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m18:30:55.845210 [debug] [Thread-2 (]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m18:30:55.846904 [debug] [Thread-4 (]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m18:30:55.847576 [debug] [Thread-3 (]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m18:30:55.848193 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: ROLLBACK
[0m18:30:55.848745 [debug] [Thread-1 (]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m18:30:55.849369 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: ROLLBACK
[0m18:30:55.849958 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: ROLLBACK
[0m18:30:55.850860 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: ROLLBACK
[0m18:30:55.856663 [debug] [Thread-2 (]: Failed to rollback 'model.dbt_scooters.trips_users'
[0m18:30:55.857617 [debug] [Thread-3 (]: Failed to rollback 'model.dbt_scooters.parking_finish_stat'
[0m18:30:55.858372 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: Close
[0m18:30:55.859194 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_scooters.parking_start_stat'
[0m18:30:55.859918 [debug] [Thread-4 (]: Failed to rollback 'model.dbt_scooters.events_stat'
[0m18:30:55.860471 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m18:30:55.863323 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m18:30:55.863888 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m18:30:55.876398 [debug] [Thread-3 (]: Database Error in model parking_finish_stat (models/parking_finish_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/parking_finish_stat.sql
[0m18:30:55.879950 [debug] [Thread-4 (]: Database Error in model events_stat (models/events_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/events_stat.sql
[0m18:30:55.880568 [debug] [Thread-2 (]: Database Error in model trips_users (models/trips_users.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/trips_users.sql
[0m18:30:55.880918 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112737110>]}
[0m18:30:55.881530 [debug] [Thread-1 (]: Database Error in model parking_start_stat (models/parking_start_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/parking_start_stat.sql
[0m18:30:55.881786 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113366f0>]}
[0m18:30:55.882020 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112735af0>]}
[0m18:30:55.882736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d997b05-eafa-4a9d-b6a4-5700f464fcba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112737110>]}
[0m18:30:55.882518 [error] [Thread-3 (]: 13 of 24 ERROR creating sql table model dbt.parking_finish_stat ................ [[31mERROR[0m in 19.08s]
[0m18:30:55.883208 [error] [Thread-4 (]: 19 of 24 ERROR creating sql table model dbt.events_stat ........................ [[31mERROR[0m in 5.56s]
[0m18:30:55.883639 [error] [Thread-2 (]: 16 of 24 ERROR creating sql incremental model dbt.trips_users .................. [[31mERROR[0m in 14.57s]
[0m18:30:55.884355 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m18:30:55.883977 [error] [Thread-1 (]: 14 of 24 ERROR creating sql table model dbt.parking_start_stat ................. [[31mERROR[0m in 18.46s]
[0m18:30:55.884698 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m18:30:55.884983 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_users
[0m18:30:55.885220 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m18:30:55.885475 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.parking_finish_stat' to be skipped because of status 'error'.  Reason: Database Error in model parking_finish_stat (models/parking_finish_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/parking_finish_stat.sql.
[0m18:30:55.885757 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m18:30:55.886023 [info ] [Thread-3 (]: 20 of 24 START test unique_companies_trips_company ............................. [RUN]
[0m18:30:55.886517 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.events_stat' to be skipped because of status 'error'.  Reason: Database Error in model events_stat (models/events_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/events_stat.sql.
[0m18:30:55.886792 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_finish_stat, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m18:30:55.887066 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_users' to be skipped because of status 'error'.  Reason: Database Error in model trips_users (models/trips_users.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/trips_users.sql.
[0m18:30:55.887271 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m18:30:55.887537 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.parking_start_stat' to be skipped because of status 'error'.  Reason: Database Error in model parking_start_stat (models/parking_start_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/parking_start_stat.sql.
[0m18:30:55.891715 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m18:30:55.892057 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_daily
[0m18:30:55.892291 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m18:30:55.892662 [info ] [Thread-4 (]: 21 of 24 SKIP relation dbt.trips_age_daily ..................................... [[33mSKIP[0m]
[0m18:30:55.892902 [info ] [Thread-2 (]: 22 of 24 SKIP relation dbt.trips_age_group ..................................... [[33mSKIP[0m]
[0m18:30:55.893170 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m18:30:55.893397 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m18:30:55.893653 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_age_daily' to be skipped because of status 'skipped'. 
[0m18:30:55.893830 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m18:30:55.894048 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_age_group' to be skipped because of status 'skipped'. 
[0m18:30:55.895258 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m18:30:55.895459 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m18:30:55.895769 [info ] [Thread-1 (]: 23 of 24 SKIP test unique_trips_age_daily_date_text_age_text ................... [[33mSKIP[0m]
[0m18:30:55.895982 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m18:30:55.896181 [debug] [Thread-7 (]: Marking all children of 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' to be skipped because of status 'skipped'. 
[0m18:30:55.896505 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m18:30:55.896689 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m18:30:55.896850 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m18:30:55.897166 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:30:55.897026 [info ] [Thread-4 (]: 24 of 24 SKIP relation dbt.trips_age_daily_stat ................................ [[33mSKIP[0m]
[0m18:30:55.897475 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m18:30:55.897650 [debug] [Thread-7 (]: Marking all children of 'model.dbt_scooters.trips_age_daily_stat' to be skipped because of status 'skipped'. 
[0m18:30:56.762810 [debug] [Thread-3 (]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dpg-d3gjbph5pdvs73eilg50-a.frankfurt-postgres.render.com" (3.65.142.85), port 5432 failed: SSL connection has been closed unexpectedly

[0m18:30:57.581803 [debug] [Thread-3 (]: Postgres adapter: Error running SQL: BEGIN
[0m18:30:57.582930 [debug] [Thread-3 (]: Postgres adapter: Rolling back transaction.
[0m18:30:57.583771 [debug] [Thread-3 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: No close available on handle
[0m18:30:57.594362 [debug] [Thread-3 (]: Database Error in test unique_companies_trips_company (models/properties.yml)
  connection to server at "dpg-d3gjbph5pdvs73eilg50-a.frankfurt-postgres.render.com" (3.65.142.85), port 5432 failed: SSL connection has been closed unexpectedly
  
  compiled code at target/run/dbt_scooters/models/properties.yml/unique_companies_trips_company.sql
[0m18:30:57.595084 [error] [Thread-3 (]: 20 of 24 ERROR unique_companies_trips_company .................................. [[31mERROR[0m in 1.71s]
[0m18:30:57.595751 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m18:30:57.596353 [debug] [Thread-7 (]: Marking all children of 'test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0' to be skipped because of status 'error'.  Reason: Database Error in test unique_companies_trips_company (models/properties.yml)
  connection to server at "dpg-d3gjbph5pdvs73eilg50-a.frankfurt-postgres.render.com" (3.65.142.85), port 5432 failed: SSL connection has been closed unexpectedly
  
  compiled code at target/run/dbt_scooters/models/properties.yml/unique_companies_trips_company.sql.
[0m18:30:57.598316 [info ] [MainThread]: 
[0m18:30:57.598960 [debug] [MainThread]: Using postgres connection "master"
[0m18:30:57.599316 [debug] [MainThread]: On master: BEGIN
[0m18:30:57.599599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:30:58.401446 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dpg-d3gjbph5pdvs73eilg50-a.frankfurt-postgres.render.com" (3.65.142.85), port 5432 failed: SSL connection has been closed unexpectedly

[0m18:30:59.424785 [debug] [MainThread]: Postgres adapter: Error running SQL: BEGIN
[0m18:30:59.425977 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m18:30:59.426735 [debug] [MainThread]: On master: No close available on handle
[0m18:30:59.440262 [info ] [MainThread]: 
[0m18:30:59.440870 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m18:30:59.441237 [info ] [MainThread]: 
[0m18:30:59.441650 [error] [MainThread]: [31mFailure in model parking_finish_stat (models/parking_finish_stat.sql)[0m
[0m18:30:59.442026 [error] [MainThread]:   Database Error in model parking_finish_stat (models/parking_finish_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/parking_finish_stat.sql
[0m18:30:59.442306 [info ] [MainThread]: 
[0m18:30:59.442636 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/parking_finish_stat.sql
[0m18:30:59.442908 [info ] [MainThread]: 
[0m18:30:59.443253 [error] [MainThread]: [31mFailure in model events_stat (models/events_stat.sql)[0m
[0m18:30:59.443589 [error] [MainThread]:   Database Error in model events_stat (models/events_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/events_stat.sql
[0m18:30:59.443848 [info ] [MainThread]: 
[0m18:30:59.444165 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/events_stat.sql
[0m18:30:59.444419 [info ] [MainThread]: 
[0m18:30:59.444739 [error] [MainThread]: [31mFailure in model trips_users (models/trips_users.sql)[0m
[0m18:30:59.445062 [error] [MainThread]:   Database Error in model trips_users (models/trips_users.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/trips_users.sql
[0m18:30:59.445310 [info ] [MainThread]: 
[0m18:30:59.445588 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/trips_users.sql
[0m18:30:59.445813 [info ] [MainThread]: 
[0m18:30:59.446078 [error] [MainThread]: [31mFailure in model parking_start_stat (models/parking_start_stat.sql)[0m
[0m18:30:59.446533 [error] [MainThread]:   Database Error in model parking_start_stat (models/parking_start_stat.sql)
  SSL connection has been closed unexpectedly
  compiled code at target/run/dbt_scooters/models/parking_start_stat.sql
[0m18:30:59.446892 [info ] [MainThread]: 
[0m18:30:59.447233 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/parking_start_stat.sql
[0m18:30:59.447642 [info ] [MainThread]: 
[0m18:30:59.448078 [error] [MainThread]: [31mFailure in test unique_companies_trips_company (models/properties.yml)[0m
[0m18:30:59.448600 [error] [MainThread]:   Database Error in test unique_companies_trips_company (models/properties.yml)
  connection to server at "dpg-d3gjbph5pdvs73eilg50-a.frankfurt-postgres.render.com" (3.65.142.85), port 5432 failed: SSL connection has been closed unexpectedly
  
  compiled code at target/run/dbt_scooters/models/properties.yml/unique_companies_trips_company.sql
[0m18:30:59.449084 [info ] [MainThread]: 
[0m18:30:59.449504 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/unique_companies_trips_company.sql
[0m18:30:59.449866 [info ] [MainThread]: 
[0m18:30:59.450249 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models/properties.yml)[0m
[0m18:30:59.450556 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m18:30:59.450949 [info ] [MainThread]: 
[0m18:30:59.451451 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/source_not_null_scooters_raw_users_sex.sql
[0m18:30:59.451747 [info ] [MainThread]: 
[0m18:30:59.452031 [info ] [MainThread]: Done. PASS=14 WARN=1 ERROR=5 SKIP=4 NO-OP=0 TOTAL=24
[0m18:30:59.452296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:59.452496 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m18:30:59.452722 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_users' was properly closed.
[0m18:30:59.452989 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0' was properly closed.
[0m18:30:59.453188 [debug] [MainThread]: Connection 'model.dbt_scooters.events_stat' was properly closed.
[0m18:30:59.453486 [info ] [MainThread]: 
[0m18:30:59.453731 [info ] [MainThread]: Finished running 3 incremental models, 3 seeds, 12 table models, 4 data tests, 2 view models in 0 hours 0 minutes and 39.82 seconds (39.82s).
[0m18:30:59.454093 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "dpg-d3gjbph5pdvs73eilg50-a.frankfurt-postgres.render.com" (3.65.142.85), port 5432 failed: SSL connection has been closed unexpectedly
  
[0m18:30:59.454474 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PropertyMovedToConfigDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:30:59.455842 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 40.675488, "process_in_blocks": "0", "process_kernel_time": 0.277521, "process_mem_max_rss": "154435584", "process_out_blocks": "0", "process_user_time": 2.36103}
[0m18:30:59.456268 [debug] [MainThread]: Command `dbt build` failed at 18:30:59.456186 after 40.68 seconds
[0m18:30:59.456557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d12270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158524b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127342f0>]}
[0m18:30:59.456833 [debug] [MainThread]: Flushing usage events
[0m18:31:00.730408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:58.131162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058274d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782b9d0>]}


============================== 18:32:58.132940 | 41f93cef-dbe5-4e4f-b802-50a4e539355f ==============================
[0m18:32:58.132940 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:32:58.133197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:32:58.198076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2f490>]}
[0m18:32:58.219728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c1f20>]}
[0m18:32:58.220074 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:32:58.252448 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:32:58.310008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:32:58.310187 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:32:58.336746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e58b50>]}
[0m18:32:58.378932 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:32:58.379786 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:32:58.390393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105e7e30>]}
[0m18:32:58.390586 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 4 data tests, 15 sources, 439 macros
[0m18:32:58.391928 [info ] [MainThread]: 
[0m18:32:58.392082 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:32:58.392197 [info ] [MainThread]: 
[0m18:32:58.392407 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:32:58.394234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m18:32:58.394466 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m18:32:58.414262 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m18:32:58.414455 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m18:32:58.414586 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m18:32:58.414707 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m18:32:58.414817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:58.414935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:59.542912 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.128 seconds
[0m18:32:59.543863 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m18:32:59.848031 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.433 seconds
[0m18:32:59.850162 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m18:32:59.853581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now list_dev_h8qz_finance)
[0m18:32:59.859851 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m18:32:59.860368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now list_dev_h8qz_dbt)
[0m18:32:59.860731 [debug] [ThreadPool]: On list_dev_h8qz_finance: BEGIN
[0m18:32:59.862147 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m18:32:59.862409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:59.862618 [debug] [ThreadPool]: On list_dev_h8qz_dbt: BEGIN
[0m18:32:59.862947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:01.383825 [debug] [ThreadPool]: SQL status: BEGIN in 1.521 seconds
[0m18:33:01.385358 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m18:33:01.386410 [debug] [ThreadPool]: On list_dev_h8qz_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_dbt"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m18:33:01.485798 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.098 seconds
[0m18:33:01.489930 [debug] [ThreadPool]: On list_dev_h8qz_dbt: ROLLBACK
[0m18:33:01.591345 [debug] [ThreadPool]: On list_dev_h8qz_dbt: Close
[0m18:33:01.793172 [debug] [ThreadPool]: SQL status: BEGIN in 1.930 seconds
[0m18:33:01.794557 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m18:33:01.795574 [debug] [ThreadPool]: On list_dev_h8qz_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_finance"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m18:33:01.895472 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.099 seconds
[0m18:33:01.899670 [debug] [ThreadPool]: On list_dev_h8qz_finance: ROLLBACK
[0m18:33:01.997860 [debug] [ThreadPool]: On list_dev_h8qz_finance: Close
[0m18:33:02.015766 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:02.016259 [debug] [MainThread]: On master: BEGIN
[0m18:33:02.016519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:03.639629 [debug] [MainThread]: SQL status: BEGIN in 1.623 seconds
[0m18:33:03.640674 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:03.641433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:03.738764 [debug] [MainThread]: SQL status: SELECT 3 in 0.096 seconds
[0m18:33:03.742868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105fa350>]}
[0m18:33:03.743813 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:03.841890 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:03.843055 [debug] [MainThread]: On master: BEGIN
[0m18:33:04.045990 [debug] [MainThread]: SQL status: BEGIN in 0.202 seconds
[0m18:33:04.046940 [debug] [MainThread]: On master: COMMIT
[0m18:33:04.047629 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:04.047999 [debug] [MainThread]: On master: COMMIT
[0m18:33:04.149096 [debug] [MainThread]: SQL status: COMMIT in 0.100 seconds
[0m18:33:04.150407 [debug] [MainThread]: On master: Close
[0m18:33:04.156970 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m18:33:04.157654 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m18:33:04.158173 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m18:33:04.158610 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m18:33:04.159322 [info ] [Thread-1 (]: 1 of 24 START sql incremental model dbt.events_clean ........................... [RUN]
[0m18:33:04.159947 [info ] [Thread-3 (]: 3 of 24 START sql table model dbt.trips_geom ................................... [RUN]
[0m18:33:04.160523 [info ] [Thread-4 (]: 4 of 24 START sql view model dbt.trips_prep .................................... [RUN]
[0m18:33:04.161100 [info ] [Thread-2 (]: 2 of 24 START sql table model dbt.trips_concurrency ............................ [RUN]
[0m18:33:04.161797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_finance, now model.dbt_scooters.events_clean)
[0m18:33:04.162429 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m18:33:04.163022 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_prep'
[0m18:33:04.163709 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_dbt, now model.dbt_scooters.trips_concurrency)
[0m18:33:04.164315 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m18:33:04.164750 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m18:33:04.165107 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m18:33:04.165527 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m18:33:04.213944 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m18:33:04.216273 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m18:33:04.217823 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m18:33:04.219766 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m18:33:04.220298 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m18:33:04.220513 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m18:33:04.220696 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m18:33:04.220840 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m18:33:04.249023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:33:04.250659 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m18:33:04.257217 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m18:33:04.258402 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m18:33:04.258574 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp183304240209"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_h8qz"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_h8qz"."dbt"."events_clean")
    

  );
  
  
[0m18:33:04.258956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:04.259153 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:33:04.259380 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:33:04.259519 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m18:33:04.259675 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:33:04.259801 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m18:33:04.259919 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:33:04.260037 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m18:33:04.260145 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:33:04.260318 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:33:05.449093 [debug] [Thread-4 (]: SQL status: BEGIN in 1.189 seconds
[0m18:33:05.449464 [debug] [Thread-2 (]: SQL status: BEGIN in 1.189 seconds
[0m18:33:05.449774 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:33:05.450034 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:33:05.450262 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_h8qz"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,

    date(started_at at time zone 'Europe/Moscow')
 as "date" 
from
"dev_h8qz"."scooters_raw"."trips"
  );
[0m18:33:05.450510 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_h8qz"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
[0m18:33:05.583345 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.132 seconds
[0m18:33:05.584176 [debug] [Thread-3 (]: SQL status: BEGIN in 1.324 seconds
[0m18:33:05.593623 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:33:05.594107 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:33:05.594482 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_h8qz"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m18:33:05.594852 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_geom__dbt_tmp"
  
  
    as
  
  (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_h8qz"."scooters_raw"."trips"
  );
  
[0m18:33:05.689447 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:33:05.695909 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:33:05.696470 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_h8qz"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m18:33:05.787061 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m18:33:05.807224 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m18:33:05.807671 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:33:05.807928 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m18:33:05.889400 [debug] [Thread-4 (]: SQL status: COMMIT in 0.081 seconds
[0m18:33:05.899311 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_prep__dbt_backup"
[0m18:33:05.904224 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:33:05.904554 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_h8qz"."dbt"."trips_prep__dbt_backup" cascade
[0m18:33:05.992534 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.087 seconds
[0m18:33:05.999103 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m18:33:06.002538 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c47ad0>]}
[0m18:33:06.003556 [info ] [Thread-4 (]: 4 of 24 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 1.84s]
[0m18:33:06.004232 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m18:33:06.004667 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m18:33:06.005337 [info ] [Thread-4 (]: 5 of 24 START sql table model dbt.trips_stat_daily ............................. [RUN]
[0m18:33:06.006068 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.trips_stat_daily)
[0m18:33:06.006537 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m18:33:06.008426 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m18:33:06.009165 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m18:33:06.012811 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m18:33:06.013652 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:33:06.013954 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m18:33:06.014228 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:33:07.528292 [debug] [Thread-4 (]: SQL status: BEGIN in 1.513 seconds
[0m18:33:07.529965 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:33:07.531227 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
  
[0m18:33:08.325190 [debug] [Thread-2 (]: SQL status: SELECT 10 in 2.874 seconds
[0m18:33:08.339102 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:33:08.339671 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_h8qz"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m18:33:08.551937 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.211 seconds
[0m18:33:08.559604 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:33:08.560268 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_h8qz"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m18:33:08.760164 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.199 seconds
[0m18:33:08.765209 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m18:33:08.765745 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:33:08.766145 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m18:33:08.971927 [debug] [Thread-2 (]: SQL status: COMMIT in 0.205 seconds
[0m18:33:08.977958 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_concurrency__dbt_backup"
[0m18:33:08.983153 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:33:08.983668 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_h8qz"."dbt"."trips_concurrency__dbt_backup" cascade
[0m18:33:09.270675 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.286 seconds
[0m18:33:09.274692 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m18:33:09.276086 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110606990>]}
[0m18:33:09.277080 [info ] [Thread-2 (]: 2 of 24 OK created sql table model dbt.trips_concurrency ....................... [[32mSELECT 10[0m in 5.11s]
[0m18:33:09.277805 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m18:33:09.278313 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m18:33:09.279037 [info ] [Thread-2 (]: 6 of 24 START seed file dbt.age_groups ......................................... [RUN]
[0m18:33:09.279609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now seed.dbt_scooters.age_groups)
[0m18:33:09.279988 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m18:33:09.280343 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m18:33:09.301860 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:33:09.302189 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m18:33:09.302412 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:33:09.577457 [debug] [Thread-4 (]: SQL status: SELECT 91 in 2.045 seconds
[0m18:33:09.585721 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:33:09.586460 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_h8qz"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m18:33:09.678366 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m18:33:09.685161 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:33:09.685702 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_h8qz"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m18:33:09.783828 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.097 seconds
[0m18:33:09.787225 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m18:33:09.787998 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:33:09.788597 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m18:33:09.882772 [debug] [Thread-4 (]: SQL status: COMMIT in 0.094 seconds
[0m18:33:09.885183 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_stat_daily__dbt_backup"
[0m18:33:09.885763 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:33:09.886121 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_h8qz"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m18:33:09.985512 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.099 seconds
[0m18:33:09.988845 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m18:33:09.989910 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110627ee0>]}
[0m18:33:09.990645 [info ] [Thread-4 (]: 5 of 24 OK created sql table model dbt.trips_stat_daily ........................ [[32mSELECT 91[0m in 3.98s]
[0m18:33:09.991244 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m18:33:09.991653 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.event_types
[0m18:33:09.992539 [info ] [Thread-4 (]: 7 of 24 START seed file dbt.event_types ........................................ [RUN]
[0m18:33:09.993562 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now seed.dbt_scooters.event_types)
[0m18:33:09.994097 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.event_types
[0m18:33:09.994471 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.event_types
[0m18:33:10.000017 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:33:10.000420 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: BEGIN
[0m18:33:10.000739 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:33:10.807805 [debug] [Thread-2 (]: SQL status: BEGIN in 1.505 seconds
[0m18:33:10.808815 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:33:10.809527 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_h8qz"."dbt"."age_groups"
[0m18:33:10.907059 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.097 seconds
[0m18:33:10.929015 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:33:10.929477 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_h8qz"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m18:33:11.009619 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.080 seconds
[0m18:33:11.014118 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m18:33:11.015484 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m18:33:11.015743 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:33:11.015947 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m18:33:11.214463 [debug] [Thread-2 (]: SQL status: COMMIT in 0.198 seconds
[0m18:33:11.217411 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m18:33:11.219056 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123216d0>]}
[0m18:33:11.219794 [info ] [Thread-2 (]: 6 of 24 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 1.94s]
[0m18:33:11.220468 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m18:33:11.220917 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.scooters
[0m18:33:11.221539 [info ] [Thread-2 (]: 8 of 24 START seed file dbt.scooters ........................................... [RUN]
[0m18:33:11.222081 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now seed.dbt_scooters.scooters)
[0m18:33:11.222469 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.scooters
[0m18:33:11.222819 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.scooters
[0m18:33:11.234263 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:33:11.234654 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: BEGIN
[0m18:33:11.234925 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:33:11.420872 [debug] [Thread-4 (]: SQL status: BEGIN in 1.420 seconds
[0m18:33:11.422644 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:33:11.423639 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_h8qz"."dbt"."event_types"
[0m18:33:11.522781 [debug] [Thread-4 (]: SQL status: TRUNCATE TABLE in 0.098 seconds
[0m18:33:11.526457 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:33:11.527018 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_h8qz"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m18:33:11.623601 [debug] [Thread-4 (]: SQL status: INSERT 0 4 in 0.096 seconds
[0m18:33:11.625135 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m18:33:11.628174 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: COMMIT
[0m18:33:11.628732 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:33:11.629168 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: COMMIT
[0m18:33:11.725849 [debug] [Thread-3 (]: SQL status: SELECT 105901 in 6.130 seconds
[0m18:33:11.726991 [debug] [Thread-4 (]: SQL status: COMMIT in 0.097 seconds
[0m18:33:11.731888 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:33:11.733029 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: Close
[0m18:33:11.733585 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_h8qz"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m18:33:11.734469 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b7d650>]}
[0m18:33:11.735056 [info ] [Thread-4 (]: 7 of 24 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 1.74s]
[0m18:33:11.735732 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.event_types
[0m18:33:11.736177 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m18:33:11.736655 [info ] [Thread-4 (]: 9 of 24 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m18:33:11.737157 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m18:33:11.737573 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m18:33:11.749572 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m18:33:11.750029 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m18:33:11.758668 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m18:33:11.759143 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m18:33:11.759277 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m18:33:11.759415 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:33:11.832786 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.099 seconds
[0m18:33:11.836327 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:33:11.836697 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_h8qz"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m18:33:11.930924 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:33:11.934766 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m18:33:11.935155 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:33:11.935445 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m18:33:12.238028 [debug] [Thread-3 (]: SQL status: COMMIT in 0.302 seconds
[0m18:33:12.242922 [debug] [Thread-3 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_geom__dbt_backup"
[0m18:33:12.243730 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:33:12.244232 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop table if exists "dev_h8qz"."dbt"."trips_geom__dbt_backup" cascade
[0m18:33:12.442724 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.198 seconds
[0m18:33:12.444280 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m18:33:12.444862 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bb5cc0>]}
[0m18:33:12.445396 [info ] [Thread-3 (]: 3 of 24 OK created sql table model dbt.trips_geom .............................. [[32mSELECT 105901[0m in 8.28s]
[0m18:33:12.445918 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m18:33:12.446297 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m18:33:12.446814 [info ] [Thread-3 (]: 10 of 24 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m18:33:12.447617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m18:33:12.448168 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m18:33:12.457054 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m18:33:12.458319 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m18:33:12.461494 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m18:33:12.462209 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m18:33:12.462449 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m18:33:12.462623 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:33:12.857944 [debug] [Thread-2 (]: SQL status: BEGIN in 1.622 seconds
[0m18:33:12.859704 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:33:12.860872 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_h8qz"."dbt"."scooters"
[0m18:33:12.956336 [debug] [Thread-1 (]: SQL status: SELECT 101377 in 8.697 seconds
[0m18:33:12.957478 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.095 seconds
[0m18:33:12.973270 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:33:12.978242 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:33:12.978525 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_h8qz"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m18:33:12.978769 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m18:33:13.058759 [debug] [Thread-2 (]: SQL status: INSERT 0 10 in 0.080 seconds
[0m18:33:13.059413 [debug] [Thread-1 (]: SQL status: BEGIN in 0.080 seconds
[0m18:33:13.060353 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m18:33:13.060888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:33:13.061544 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp183304240209'
        
      order by ordinal_position

  
[0m18:33:13.064219 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: COMMIT
[0m18:33:13.064666 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:33:13.065019 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: COMMIT
[0m18:33:13.161632 [debug] [Thread-2 (]: SQL status: COMMIT in 0.096 seconds
[0m18:33:13.163333 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.101 seconds
[0m18:33:13.165775 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: Close
[0m18:33:13.172883 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:33:13.173461 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:33:13.174122 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c41130>]}
[0m18:33:13.174741 [info ] [Thread-2 (]: 8 of 24 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 1.95s]
[0m18:33:13.175329 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.scooters
[0m18:33:13.175692 [debug] [Thread-2 (]: Began running node model.dbt_scooters.revenue_daily
[0m18:33:13.176202 [info ] [Thread-2 (]: 11 of 24 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m18:33:13.176680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now model.dbt_scooters.revenue_daily)
[0m18:33:13.177010 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m18:33:13.180614 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m18:33:13.181465 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.revenue_daily
[0m18:33:13.184152 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:33:13.184571 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp183313183087"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_h8qz"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_h8qz"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m18:33:13.184853 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:33:13.366382 [debug] [Thread-4 (]: SQL status: BEGIN in 1.606 seconds
[0m18:33:13.368031 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.193 seconds
[0m18:33:13.369202 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m18:33:13.383011 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_h8qz"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



  
  
      
    ) dbt_internal_test
[0m18:33:13.390805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:33:13.391219 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp183304240209'
        
      order by ordinal_position

  
[0m18:33:13.468970 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.079 seconds
[0m18:33:13.470776 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.079 seconds
[0m18:33:13.477775 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m18:33:13.482370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:33:13.482967 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:33:13.570875 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m18:33:13.572086 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.089 seconds
[0m18:33:13.580322 [info ] [Thread-4 (]: 9 of 24 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 1.84s]
[0m18:33:13.590380 [debug] [Thread-1 (]: 
    In "dev_h8qz"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:33:13.590976 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m18:33:13.604207 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat
[0m18:33:13.605334 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m18:33:13.605721 [info ] [Thread-4 (]: 12 of 24 START sql table model dbt.trips_stat .................................. [RUN]
[0m18:33:13.606189 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now model.dbt_scooters.trips_stat)
[0m18:33:13.606498 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat
[0m18:33:13.608764 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m18:33:13.609246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:33:13.609488 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat
[0m18:33:13.609725 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        delete from "dev_h8qz"."dbt"."events_clean" as DBT_INTERNAL_DEST
        where (user_id, timestamp, type_id) in (
            select distinct user_id, timestamp, type_id
            from "events_clean__dbt_tmp183304240209" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_h8qz"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp183304240209"
    )
  
[0m18:33:13.611619 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m18:33:13.612237 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:33:13.612509 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m18:33:13.612723 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:33:13.617793 [debug] [Thread-3 (]: SQL status: BEGIN in 1.155 seconds
[0m18:33:13.618010 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m18:33:13.618226 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sex
from "dev_h8qz"."scooters_raw"."users"
where sex is null



  
  
      
    ) dbt_internal_test
[0m18:33:13.671455 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.053 seconds
[0m18:33:13.673189 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m18:33:13.775950 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m18:33:13.778856 [warn ] [Thread-3 (]: 10 of 24 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 1.33s]
[0m18:33:13.780010 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m18:33:13.780770 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m18:33:13.781813 [info ] [Thread-3 (]: 13 of 24 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m18:33:13.782824 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now model.dbt_scooters.parking_finish_stat)
[0m18:33:13.783450 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m18:33:13.791396 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m18:33:13.792678 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m18:33:13.795820 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m18:33:13.796533 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:33:13.796862 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m18:33:13.797172 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:33:15.208123 [debug] [Thread-3 (]: SQL status: BEGIN in 1.410 seconds
[0m18:33:15.209693 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:33:15.210893 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_h8qz"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)
-- group by
--     1


select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_h8qz"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:33:15.616831 [debug] [Thread-4 (]: SQL status: BEGIN in 2.004 seconds
[0m18:33:15.617191 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:33:15.617447 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_h8qz"."dbt"."trips_prep"
  );
  
[0m18:33:17.155577 [debug] [Thread-2 (]: SQL status: SELECT 3 in 3.970 seconds
[0m18:33:17.165122 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:33:17.165707 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m18:33:17.358213 [debug] [Thread-2 (]: SQL status: BEGIN in 0.192 seconds
[0m18:33:17.359274 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:33:17.360099 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp183313183087'
        
      order by ordinal_position

  
[0m18:33:17.829050 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.468 seconds
[0m18:33:17.836722 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:33:17.837208 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m18:33:18.075125 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.237 seconds
[0m18:33:18.082173 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:33:18.082635 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp183313183087'
        
      order by ordinal_position

  
[0m18:33:18.382208 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.299 seconds
[0m18:33:18.389707 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:33:18.390447 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m18:33:18.897830 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.506 seconds
[0m18:33:18.903291 [debug] [Thread-2 (]: 
    In "dev_h8qz"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:33:18.904498 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m18:33:18.905819 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:33:18.906295 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_h8qz"."finance"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp183313183087" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_h8qz"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp183313183087"
    )
  
[0m18:33:18.999988 [debug] [Thread-2 (]: SQL status: INSERT 0 3 in 0.093 seconds
[0m18:33:19.010870 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:33:19.011296 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_h8qz".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m18:33:19.201595 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.190 seconds
[0m18:33:19.206256 [debug] [Thread-2 (]: On "dev_h8qz"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m18:33:19.207555 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:33:19.207950 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:33:19.208283 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:33:19.303571 [debug] [Thread-2 (]: SQL status: COMMIT in 0.095 seconds
[0m18:33:19.306094 [debug] [Thread-2 (]: On model.dbt_scooters.revenue_daily: Close
[0m18:33:19.308294 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd1d90>]}
[0m18:33:19.310009 [info ] [Thread-2 (]: 11 of 24 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 6.13s]
[0m18:33:19.310707 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.revenue_daily
[0m18:33:19.311201 [debug] [Thread-2 (]: Began running node model.dbt_scooters.parking_start_stat
[0m18:33:19.311823 [info ] [Thread-2 (]: 14 of 24 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m18:33:19.312412 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.parking_start_stat)
[0m18:33:19.312871 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m18:33:19.317356 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m18:33:19.318479 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m18:33:19.323138 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m18:33:19.324110 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:33:19.324454 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m18:33:19.324734 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:33:21.251274 [debug] [Thread-4 (]: SQL status: SELECT 1 in 5.633 seconds
[0m18:33:21.252837 [debug] [Thread-2 (]: SQL status: BEGIN in 1.928 seconds
[0m18:33:21.259696 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:33:21.260268 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:33:21.260695 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_h8qz"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m18:33:21.261110 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_h8qz"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.start_point, 3857), hex.geom)
-- group by
--     1

select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_h8qz"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:33:21.454409 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.192 seconds
[0m18:33:21.462685 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:33:21.463164 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_h8qz"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m18:33:21.598856 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.135 seconds
[0m18:33:21.603883 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m18:33:21.604741 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:33:21.605297 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m18:33:21.863983 [debug] [Thread-4 (]: SQL status: COMMIT in 0.258 seconds
[0m18:33:21.877092 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_stat__dbt_backup"
[0m18:33:21.877766 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:33:21.878126 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_h8qz"."dbt"."trips_stat__dbt_backup" cascade
[0m18:33:22.171551 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.292 seconds
[0m18:33:22.176360 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat: Close
[0m18:33:22.177845 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd35f0>]}
[0m18:33:22.179024 [info ] [Thread-4 (]: 12 of 24 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 8.57s]
[0m18:33:22.179916 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat
[0m18:33:22.180527 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies
[0m18:33:22.181437 [info ] [Thread-4 (]: 15 of 24 START sql table model dbt.companies ................................... [RUN]
[0m18:33:22.182000 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.companies)
[0m18:33:22.182418 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies
[0m18:33:22.186514 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m18:33:22.188075 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies
[0m18:33:22.193394 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m18:33:22.194568 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:33:22.194925 [debug] [Thread-4 (]: On model.dbt_scooters.companies: BEGIN
[0m18:33:22.195238 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:33:22.684217 [debug] [Thread-1 (]: SQL status: INSERT 0 101377 in 9.072 seconds
[0m18:33:22.687764 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m18:33:22.688448 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:33:22.688963 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m18:33:22.785631 [debug] [Thread-1 (]: SQL status: COMMIT in 0.096 seconds
[0m18:33:22.788439 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m18:33:22.789984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd1cd0>]}
[0m18:33:22.791157 [info ] [Thread-1 (]: 1 of 24 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 101377[0m in 18.63s]
[0m18:33:22.792015 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m18:33:22.792627 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_users
[0m18:33:22.793397 [info ] [Thread-1 (]: 16 of 24 START sql incremental model dbt.trips_users ........................... [RUN]
[0m18:33:22.794195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.trips_users)
[0m18:33:22.794709 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_users
[0m18:33:22.800666 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m18:33:22.801847 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_users
[0m18:33:22.806567 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m18:33:22.807493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:33:22.807839 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: BEGIN
[0m18:33:22.808120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:23.914165 [debug] [Thread-4 (]: SQL status: BEGIN in 1.718 seconds
[0m18:33:23.915924 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:33:23.917043 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_h8qz"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_h8qz"."dbt"."scooters"
group by
    1
  );
  
[0m18:33:24.119807 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.201 seconds
[0m18:33:24.129670 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:33:24.130089 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_h8qz"."dbt"."companies" rename to "companies__dbt_backup"
[0m18:33:24.321625 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.191 seconds
[0m18:33:24.330562 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:33:24.331064 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_h8qz"."dbt"."companies__dbt_tmp" rename to "companies"
[0m18:33:24.526710 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.195 seconds
[0m18:33:24.531398 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m18:33:24.532558 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:33:24.533535 [debug] [Thread-4 (]: On model.dbt_scooters.companies: COMMIT
[0m18:33:24.731211 [debug] [Thread-4 (]: SQL status: COMMIT in 0.196 seconds
[0m18:33:24.737848 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."companies__dbt_backup"
[0m18:33:24.738642 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:33:24.739094 [debug] [Thread-4 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_h8qz"."dbt"."companies__dbt_backup" cascade
[0m18:33:24.937374 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.197 seconds
[0m18:33:24.938710 [debug] [Thread-1 (]: SQL status: BEGIN in 2.130 seconds
[0m18:33:24.941494 [debug] [Thread-4 (]: On model.dbt_scooters.companies: Close
[0m18:33:24.941974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:33:24.942511 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      
  
    

  create  table "dev_h8qz"."dbt"."trips_users"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_h8qz"."dbt"."trips_prep" as t
left join
    "dev_h8qz"."scooters_raw"."users" as u
    on t.user_id = u.id

      where
          t.id <= 75000

  );
  
  
[0m18:33:24.943326 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd24b0>]}
[0m18:33:24.944288 [info ] [Thread-4 (]: 15 of 24 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 2.76s]
[0m18:33:24.944999 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies
[0m18:33:24.945480 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_full
[0m18:33:24.946036 [info ] [Thread-4 (]: 17 of 24 START sql view model dbt.events_full .................................. [RUN]
[0m18:33:24.946648 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.events_full)
[0m18:33:24.947036 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_full
[0m18:33:24.951181 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m18:33:24.952303 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_full
[0m18:33:24.956472 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m18:33:24.957242 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:33:24.957554 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: BEGIN
[0m18:33:24.957835 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:33:26.677007 [debug] [Thread-4 (]: SQL status: BEGIN in 1.719 seconds
[0m18:33:26.678419 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:33:26.679037 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_h8qz"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_h8qz"."dbt"."events_clean"
    left join "dev_h8qz"."dbt"."event_types"
        using (type_id)
  );
[0m18:33:26.984057 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.304 seconds
[0m18:33:26.993012 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:33:26.993500 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_h8qz"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m18:33:27.086297 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m18:33:27.095196 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:33:27.096077 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_h8qz"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m18:33:27.192010 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m18:33:27.196602 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:33:27.197740 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:33:27.198721 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:33:27.393426 [debug] [Thread-4 (]: SQL status: COMMIT in 0.194 seconds
[0m18:33:27.402309 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."events_full__dbt_backup"
[0m18:33:27.403131 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:33:27.403452 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_h8qz"."dbt"."events_full__dbt_backup" cascade
[0m18:33:27.598467 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.194 seconds
[0m18:33:27.603523 [debug] [Thread-4 (]: On model.dbt_scooters.events_full: Close
[0m18:33:27.605856 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b3eab0>]}
[0m18:33:27.607573 [info ] [Thread-4 (]: 17 of 24 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 2.66s]
[0m18:33:27.608299 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_full
[0m18:33:27.608807 [debug] [Thread-4 (]: Began running node model.dbt_scooters.companies_trips
[0m18:33:27.609465 [info ] [Thread-4 (]: 18 of 24 START sql table model dbt.companies_trips ............................. [RUN]
[0m18:33:27.610280 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.companies_trips)
[0m18:33:27.610758 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.companies_trips
[0m18:33:27.615202 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m18:33:27.616418 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.companies_trips
[0m18:33:27.620664 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m18:33:27.621482 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:33:27.621811 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m18:33:27.622101 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:33:29.642118 [debug] [Thread-4 (]: SQL status: BEGIN in 2.019 seconds
[0m18:33:29.643985 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:33:29.645271 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_h8qz"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_h8qz"."dbt"."trips_prep" as t
        join "dev_h8qz"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_h8qz"."dbt"."companies" as c
        using (company)
  );
  
[0m18:33:31.796985 [debug] [Thread-4 (]: SQL status: SELECT 6 in 2.150 seconds
[0m18:33:31.806868 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:33:31.807479 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_h8qz"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m18:33:31.899359 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m18:33:31.905569 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:33:31.906246 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_h8qz"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m18:33:32.001653 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:33:32.005492 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:33:32.006125 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:33:32.006644 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:33:32.104146 [debug] [Thread-4 (]: SQL status: COMMIT in 0.097 seconds
[0m18:33:32.111279 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."companies_trips__dbt_backup"
[0m18:33:32.112237 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:33:32.112878 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_h8qz"."dbt"."companies_trips__dbt_backup" cascade
[0m18:33:32.312268 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.198 seconds
[0m18:33:32.316868 [debug] [Thread-4 (]: On model.dbt_scooters.companies_trips: Close
[0m18:33:32.318426 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b3eab0>]}
[0m18:33:32.319604 [info ] [Thread-4 (]: 18 of 24 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 4.71s]
[0m18:33:32.320537 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.companies_trips
[0m18:33:32.321190 [debug] [Thread-4 (]: Began running node model.dbt_scooters.events_stat
[0m18:33:32.322076 [info ] [Thread-4 (]: 19 of 24 START sql table model dbt.events_stat ................................. [RUN]
[0m18:33:32.323019 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.events_stat)
[0m18:33:32.323555 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.events_stat
[0m18:33:32.327610 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m18:33:32.328999 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.events_stat
[0m18:33:32.332839 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m18:33:32.333940 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:33:32.334318 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: BEGIN
[0m18:33:32.334640 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:33:34.875055 [debug] [Thread-4 (]: SQL status: BEGIN in 2.540 seconds
[0m18:33:34.876809 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:33:34.877970 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_h8qz"."dbt"."events_full"
  );
  
[0m18:33:35.483387 [debug] [Thread-1 (]: SQL status: SELECT 75000 in 10.539 seconds
[0m18:33:35.489964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:33:35.490713 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m18:33:43.470096 [debug] [Thread-4 (]: SQL status: SELECT 1 in 8.591 seconds
[0m18:33:43.474983 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:33:43.475389 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_h8qz"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m18:33:43.575612 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.100 seconds
[0m18:33:43.577056 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m18:33:43.577453 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:33:43.577715 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: COMMIT
[0m18:33:43.674851 [debug] [Thread-4 (]: SQL status: COMMIT in 0.097 seconds
[0m18:33:43.679000 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."events_stat__dbt_backup"
[0m18:33:43.679893 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:33:43.680415 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_h8qz"."dbt"."events_stat__dbt_backup" cascade
[0m18:33:43.777663 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.096 seconds
[0m18:33:43.780748 [debug] [Thread-4 (]: On model.dbt_scooters.events_stat: Close
[0m18:33:43.781740 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b3e7b0>]}
[0m18:33:43.782613 [info ] [Thread-4 (]: 19 of 24 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 11.46s]
[0m18:33:43.783412 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.events_stat
[0m18:33:43.783960 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m18:33:43.784555 [info ] [Thread-4 (]: 20 of 24 START test unique_companies_trips_company ............................. [RUN]
[0m18:33:43.785225 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m18:33:43.785764 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m18:33:43.793470 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m18:33:43.794283 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m18:33:43.796265 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m18:33:43.796764 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m18:33:43.796913 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m18:33:43.797031 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:33:45.314041 [debug] [Thread-4 (]: SQL status: BEGIN in 1.516 seconds
[0m18:33:45.315674 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m18:33:45.316858 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_h8qz"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:33:45.518493 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.200 seconds
[0m18:33:45.521775 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m18:33:45.623567 [debug] [Thread-4 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m18:33:45.625048 [info ] [Thread-4 (]: 20 of 24 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 1.84s]
[0m18:33:45.626036 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m18:33:49.819067 [debug] [Thread-1 (]: SQL status: ANALYZE in 14.328 seconds
[0m18:33:49.820416 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m18:33:49.820818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:33:49.821142 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m18:33:49.921519 [debug] [Thread-1 (]: SQL status: COMMIT in 0.100 seconds
[0m18:33:49.922128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:33:49.922439 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m18:33:50.024583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.101 seconds
[0m18:33:50.027636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:33:50.028355 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m18:33:50.744335 [debug] [Thread-1 (]: SQL status: VACUUM in 0.715 seconds
[0m18:33:50.747004 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: Close
[0m18:33:50.748735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd1cd0>]}
[0m18:33:50.749982 [info ] [Thread-1 (]: 16 of 24 OK created sql incremental model dbt.trips_users ...................... [[32mSELECT 75000[0m in 27.95s]
[0m18:33:50.750986 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_users
[0m18:33:50.752087 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_age_group
[0m18:33:50.752749 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_daily
[0m18:33:50.753381 [info ] [Thread-1 (]: 22 of 24 START sql table model dbt.trips_age_group ............................. [RUN]
[0m18:33:50.754035 [info ] [Thread-4 (]: 21 of 24 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m18:33:50.754669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_group)
[0m18:33:50.755195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now model.dbt_scooters.trips_age_daily)
[0m18:33:50.755696 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m18:33:50.756371 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m18:33:50.761203 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m18:33:50.765516 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m18:33:50.766544 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_age_group
[0m18:33:50.766923 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m18:33:50.769704 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m18:33:50.772963 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m18:33:50.773631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:33:50.773961 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:33:50.774254 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m18:33:50.774517 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m18:33:50.774757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:50.775062 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:33:52.072562 [debug] [Thread-1 (]: SQL status: BEGIN in 1.297 seconds
[0m18:33:52.074242 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:33:52.075527 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_h8qz"."dbt"."trips_users" as tu
    cross join "dev_h8qz"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m18:33:52.481456 [debug] [Thread-4 (]: SQL status: BEGIN in 1.706 seconds
[0m18:33:52.482324 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:33:52.482804 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_h8qz"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m18:33:56.066094 [debug] [Thread-4 (]: SQL status: SELECT 4946 in 3.582 seconds
[0m18:33:56.073044 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:33:56.073606 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_h8qz"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m18:33:56.270281 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.196 seconds
[0m18:33:56.272446 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m18:33:56.272956 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:33:56.273300 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m18:33:56.475768 [debug] [Thread-4 (]: SQL status: COMMIT in 0.202 seconds
[0m18:33:56.486576 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_age_daily__dbt_backup"
[0m18:33:56.487429 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:33:56.487874 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_h8qz"."dbt"."trips_age_daily__dbt_backup" cascade
[0m18:33:56.579272 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.091 seconds
[0m18:33:56.583649 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily: Close
[0m18:33:56.585449 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c2e030>]}
[0m18:33:56.586425 [info ] [Thread-4 (]: 21 of 24 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 4946[0m in 5.83s]
[0m18:33:56.587149 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m18:33:56.587860 [debug] [Thread-4 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m18:33:56.588268 [info ] [Thread-4 (]: 23 of 24 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m18:33:56.588758 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m18:33:56.589126 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m18:33:56.594256 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m18:33:56.595427 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m18:33:56.597463 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m18:33:56.598463 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m18:33:56.598900 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m18:33:56.599222 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:33:57.912452 [debug] [Thread-4 (]: SQL status: BEGIN in 1.313 seconds
[0m18:33:57.913649 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m18:33:57.914100 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_h8qz"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:33:58.114187 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.199 seconds
[0m18:33:58.117204 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m18:33:58.217783 [debug] [Thread-4 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m18:33:58.218733 [debug] [Thread-2 (]: SQL status: SELECT 142 in 36.957 seconds
[0m18:33:58.225543 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:33:58.227045 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_h8qz"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m18:33:58.226464 [info ] [Thread-4 (]: 23 of 24 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 1.64s]
[0m18:33:58.228102 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m18:33:58.228956 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m18:33:58.229596 [info ] [Thread-4 (]: 24 of 24 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m18:33:58.230238 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e, now model.dbt_scooters.trips_age_daily_stat)
[0m18:33:58.230654 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m18:33:58.234205 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m18:33:58.235809 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m18:33:58.240221 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m18:33:58.241083 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:33:58.241425 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m18:33:58.241726 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:33:58.320690 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m18:33:58.323649 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m18:33:58.324311 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:33:58.324810 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m18:33:58.421202 [debug] [Thread-2 (]: SQL status: COMMIT in 0.096 seconds
[0m18:33:58.426246 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."parking_start_stat__dbt_backup"
[0m18:33:58.427292 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:33:58.427991 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_h8qz"."dbt"."parking_start_stat__dbt_backup" cascade
[0m18:33:58.524931 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.096 seconds
[0m18:33:58.528853 [debug] [Thread-2 (]: On model.dbt_scooters.parking_start_stat: Close
[0m18:33:58.530260 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c43470>]}
[0m18:33:58.531380 [info ] [Thread-2 (]: 14 of 24 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 39.22s]
[0m18:33:58.532319 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m18:33:59.649988 [debug] [Thread-4 (]: SQL status: BEGIN in 1.408 seconds
[0m18:33:59.651111 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:33:59.651881 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_h8qz"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m18:34:00.045081 [debug] [Thread-4 (]: SQL status: SELECT 83 in 0.392 seconds
[0m18:34:00.049331 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:34:00.049683 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_h8qz"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m18:34:00.264112 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.214 seconds
[0m18:34:00.266091 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m18:34:00.266933 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:34:00.267506 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m18:34:00.468850 [debug] [Thread-4 (]: SQL status: COMMIT in 0.200 seconds
[0m18:34:00.473258 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_age_daily_stat__dbt_backup"
[0m18:34:00.474137 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:34:00.474698 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_h8qz"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m18:34:00.673741 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.198 seconds
[0m18:34:00.676128 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m18:34:00.676963 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058f0b0>]}
[0m18:34:00.677854 [info ] [Thread-4 (]: 24 of 24 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 2.45s]
[0m18:34:00.678684 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m18:34:14.397347 [debug] [Thread-3 (]: SQL status: SELECT 464 in 59.185 seconds
[0m18:34:14.402461 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:34:14.402939 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_h8qz"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m18:34:14.497867 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:34:14.499764 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m18:34:14.500236 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:34:14.500607 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m18:34:14.600144 [debug] [Thread-3 (]: SQL status: COMMIT in 0.099 seconds
[0m18:34:14.602569 [debug] [Thread-3 (]: Applying DROP to: "dev_h8qz"."dbt"."parking_finish_stat__dbt_backup"
[0m18:34:14.603035 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:34:14.603410 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_h8qz"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m18:34:14.702586 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.099 seconds
[0m18:34:14.705855 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m18:34:14.707322 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd3ef0>]}
[0m18:34:14.708470 [info ] [Thread-3 (]: 13 of 24 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 60.92s]
[0m18:34:14.709471 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m18:34:15.727098 [debug] [Thread-1 (]: SQL status: SELECT 7 in 23.650 seconds
[0m18:34:15.733135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:34:15.733750 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_h8qz"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m18:34:15.828890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m18:34:15.830137 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m18:34:15.830466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:34:15.830725 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m18:34:15.932089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.101 seconds
[0m18:34:15.937279 [debug] [Thread-1 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_age_group__dbt_backup"
[0m18:34:15.938473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:34:15.939139 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_h8qz"."dbt"."trips_age_group__dbt_backup" cascade
[0m18:34:16.034368 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.095 seconds
[0m18:34:16.036363 [debug] [Thread-1 (]: On model.dbt_scooters.trips_age_group: Close
[0m18:34:16.037283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f93cef-dbe5-4e4f-b802-50a4e539355f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c40890>]}
[0m18:34:16.038074 [info ] [Thread-1 (]: 22 of 24 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 25.28s]
[0m18:34:16.038643 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_age_group
[0m18:34:16.040131 [info ] [MainThread]: 
[0m18:34:16.040517 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:16.040766 [debug] [MainThread]: On master: BEGIN
[0m18:34:16.040997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:17.472083 [debug] [MainThread]: SQL status: BEGIN in 1.431 seconds
[0m18:34:17.473622 [debug] [MainThread]: On master: COMMIT
[0m18:34:17.474704 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:17.475638 [debug] [MainThread]: On master: COMMIT
[0m18:34:17.571981 [debug] [MainThread]: SQL status: COMMIT in 0.095 seconds
[0m18:34:17.575596 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m18:34:17.582417 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m18:34:17.583252 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:17.583659 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m18:34:17.639965 [debug] [MainThread]: SQL status: GRANT in 0.056 seconds
[0m18:34:17.641934 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.07s]
[0m18:34:17.642501 [debug] [MainThread]: On master: Close
[0m18:34:17.643530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:17.644077 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m18:34:17.644370 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m18:34:17.644616 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m18:34:17.644848 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m18:34:17.645284 [info ] [MainThread]: 
[0m18:34:17.645628 [info ] [MainThread]: Finished running 3 incremental models, 1 project hook, 3 seeds, 12 table models, 4 data tests, 2 view models in 0 hours 1 minutes and 19.25 seconds (79.25s).
[0m18:34:17.649089 [debug] [MainThread]: Command end result
[0m18:34:17.670843 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:34:17.672095 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:34:17.676234 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m18:34:17.676427 [info ] [MainThread]: 
[0m18:34:17.676618 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m18:34:17.676772 [info ] [MainThread]: 
[0m18:34:17.676972 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models/properties.yml)[0m
[0m18:34:17.677160 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m18:34:17.677297 [info ] [MainThread]: 
[0m18:34:17.677469 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/source_not_null_scooters_raw_users_sex.sql
[0m18:34:17.677618 [info ] [MainThread]: 
[0m18:34:17.677779 [info ] [MainThread]: Done. PASS=24 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=25
[0m18:34:17.678716 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 79.57282, "process_in_blocks": "0", "process_kernel_time": 0.257782, "process_mem_max_rss": "142573568", "process_out_blocks": "0", "process_user_time": 2.247098}
[0m18:34:17.678961 [debug] [MainThread]: Command `dbt build` succeeded at 18:34:17.678910 after 79.57 seconds
[0m18:34:17.679144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106749910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b3e6f0>]}
[0m18:34:17.679319 [debug] [MainThread]: Flushing usage events
[0m18:34:18.699745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:42:38.523848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10430f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582b9d0>]}


============================== 18:42:38.526251 | d93b9e33-e9c3-4c75-a0d1-80792de932db ==============================
[0m18:42:38.526251 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:42:38.526530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:42:38.594721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd93b9e33-e9c3-4c75-a0d1-80792de932db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10492f490>]}
[0m18:42:38.616275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd93b9e33-e9c3-4c75-a0d1-80792de932db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c1f20>]}
[0m18:42:38.616796 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:42:38.652296 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:42:38.721381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:42:38.722141 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://models/properties.yml
[0m18:42:38.833046 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'trips' in the 'models' section of file 'models/properties.yml'
[0m18:42:38.866259 [warn ] [MainThread]: [[33mWARNING[0m][ArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found `arguments` property in test definition of `relationships` ({'name':
'every_trip_has_user', 'to': "source('scooters_raw', 'users')", 'field': 'id'})
without usage of `require_generic_test_arguments_property` behavior change flag.
The `arguments` property is deprecated for custom usage and will be used to nest
keyword arguments in future versions of dbt.
[0m18:42:38.866532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd93b9e33-e9c3-4c75-a0d1-80792de932db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106658250>]}
[0m18:42:38.902271 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_trips_every_trip_has_user__source_scooters_raw_users___id__user_id (models/properties.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'arguments'
[0m18:42:38.902640 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:42:38.904208 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.40640765, "process_in_blocks": "0", "process_kernel_time": 0.110042, "process_mem_max_rss": "124518400", "process_out_blocks": "0", "process_user_time": 0.846229}
[0m18:42:38.904417 [debug] [MainThread]: Command `dbt build` failed at 18:42:38.904378 after 0.41 seconds
[0m18:42:38.904565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a36c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a36d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580be70>]}
[0m18:42:38.904699 [debug] [MainThread]: Flushing usage events
[0m18:42:39.845592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:42:45.172785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033734d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486f9d0>]}


============================== 18:42:45.174584 | 685eb23b-77ea-40ad-b766-a885c48d1a73 ==============================
[0m18:42:45.174584 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:42:45.174844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m18:42:45.239499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '685eb23b-77ea-40ad-b766-a885c48d1a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b73490>]}
[0m18:42:45.261263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '685eb23b-77ea-40ad-b766-a885c48d1a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104705f20>]}
[0m18:42:45.261605 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:42:45.295030 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:42:45.357727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:42:45.358536 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://models/properties.yml
[0m18:42:45.473845 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'trips' in the 'models' section of file 'models/properties.yml'
[0m18:42:45.507087 [warn ] [MainThread]: [[33mWARNING[0m][ArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found `arguments` property in test definition of `relationships` ({'name':
'every_trip_has_user', 'to': "source('scooters_raw', 'users')", 'field': 'id'})
without usage of `require_generic_test_arguments_property` behavior change flag.
The `arguments` property is deprecated for custom usage and will be used to nest
keyword arguments in future versions of dbt.
[0m18:42:45.507376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '685eb23b-77ea-40ad-b766-a885c48d1a73', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105700250>]}
[0m18:42:45.543026 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_trips_every_trip_has_user__source_scooters_raw_users___id__user_id (models/properties.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'arguments'
[0m18:42:45.543339 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:42:45.544014 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.39562142, "process_in_blocks": "0", "process_kernel_time": 0.089135, "process_mem_max_rss": "124649472", "process_out_blocks": "0", "process_user_time": 0.841887}
[0m18:42:45.544191 [debug] [MainThread]: Command `dbt build` failed at 18:42:45.544157 after 0.40 seconds
[0m18:42:45.544330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ded50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10484fe70>]}
[0m18:42:45.544459 [debug] [MainThread]: Flushing usage events
[0m18:42:46.503677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:42:55.841947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055674d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2b9d0>]}


============================== 18:42:55.844163 | 7d5d2734-5512-4688-bac6-2a79219114d1 ==============================
[0m18:42:55.844163 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:42:55.844415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:42:55.912134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d5d2734-5512-4688-bac6-2a79219114d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c2f490>]}
[0m18:42:55.933771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d5d2734-5512-4688-bac6-2a79219114d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc1f20>]}
[0m18:42:55.934884 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:42:55.983475 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:42:56.054513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:42:56.055251 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://models/properties.yml
[0m18:42:56.166629 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'trips' in the 'models' section of file 'models/properties.yml'
[0m18:42:56.198823 [warn ] [MainThread]: [[33mWARNING[0m][ArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found `arguments` property in test definition of `relationships` ({'name':
'every_trip_has_user', 'to': "source('scooters_raw', 'users')", 'field': 'id'})
without usage of `require_generic_test_arguments_property` behavior change flag.
The `arguments` property is deprecated for custom usage and will be used to nest
keyword arguments in future versions of dbt.
[0m18:42:56.199107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7d5d2734-5512-4688-bac6-2a79219114d1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108204250>]}
[0m18:42:56.236117 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_trips_every_trip_has_user__source_scooters_raw_users___id__user_id (models/properties.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'arguments'
[0m18:42:56.236479 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:42:56.237430 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.42382643, "process_in_blocks": "0", "process_kernel_time": 0.107403, "process_mem_max_rss": "124829696", "process_out_blocks": "0", "process_user_time": 0.844557}
[0m18:42:56.237616 [debug] [MainThread]: Command `dbt build` failed at 18:42:56.237579 after 0.42 seconds
[0m18:42:56.237766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086dec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ded50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0be70>]}
[0m18:42:56.237899 [debug] [MainThread]: Flushing usage events
[0m18:42:57.050245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:13.519462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5c74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d62b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d62bb10>]}


============================== 18:44:13.521330 | c500ca7a-d59e-4837-b2ad-437106e068b8 ==============================
[0m18:44:13.521330 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:44:13.521591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:44:13.587618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c500ca7a-d59e-4837-b2ad-437106e068b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac33490>]}
[0m18:44:13.609610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c500ca7a-d59e-4837-b2ad-437106e068b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3c2f10>]}
[0m18:44:13.610029 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:44:13.645529 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:44:13.697697 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:44:13.697938 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m18:44:13.698088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c500ca7a-d59e-4837-b2ad-437106e068b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fca8950>]}
[0m18:44:14.150164 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'trips' in the 'models' section of file 'models/properties.yml'
[0m18:44:14.180257 [warn ] [MainThread]: [[33mWARNING[0m][ArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found `arguments` property in test definition of `relationships` ({'name':
'every_trip_has_user', 'to': "source('scooters_raw', 'users')", 'field': 'id'})
without usage of `require_generic_test_arguments_property` behavior change flag.
The `arguments` property is deprecated for custom usage and will be used to nest
keyword arguments in future versions of dbt.
[0m18:44:14.180542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c500ca7a-d59e-4837-b2ad-437106e068b8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ff3ae40>]}
[0m18:44:14.187369 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_trips_every_trip_has_user__source_scooters_raw_users___id__user_id (models/properties.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'arguments'
[0m18:44:14.187655 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:44:14.188402 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.6947722, "process_in_blocks": "0", "process_kernel_time": 0.089591, "process_mem_max_rss": "128794624", "process_out_blocks": "0", "process_user_time": 1.12452}
[0m18:44:14.188572 [debug] [MainThread]: Command `cli build` failed at 18:44:14.188537 after 0.69 seconds
[0m18:44:14.188708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d60be70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140133af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f99dbf0>]}
[0m18:44:14.188841 [debug] [MainThread]: Flushing usage events
[0m18:44:15.181676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:23.525410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249274d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b27b10>]}


============================== 18:44:23.527361 | d421ea85-8a0d-4542-9ce8-29051cf9e9c7 ==============================
[0m18:44:23.527361 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:44:23.527685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:44:23.591768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd421ea85-8a0d-4542-9ce8-29051cf9e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124e33490>]}
[0m18:44:23.613470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd421ea85-8a0d-4542-9ce8-29051cf9e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125dc2f10>]}
[0m18:44:23.613886 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:44:23.649126 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:44:23.700627 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:44:23.700873 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m18:44:23.701027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd421ea85-8a0d-4542-9ce8-29051cf9e9c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310e8950>]}
[0m18:44:24.158199 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'trips' in the 'models' section of file 'models/properties.yml'
[0m18:44:24.188051 [warn ] [MainThread]: [[33mWARNING[0m][ArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found `arguments` property in test definition of `relationships` ({'name':
'every_trip_has_user', 'to': "source('scooters_raw', 'users')", 'field': 'id'})
without usage of `require_generic_test_arguments_property` behavior change flag.
The `arguments` property is deprecated for custom usage and will be used to nest
keyword arguments in future versions of dbt.
[0m18:44:24.188314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd421ea85-8a0d-4542-9ce8-29051cf9e9c7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13143b4d0>]}
[0m18:44:24.195755 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_trips_every_trip_has_user__source_scooters_raw_users___id__user_id (models/properties.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'arguments'
[0m18:44:24.196052 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:44:24.196770 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.6966896, "process_in_blocks": "0", "process_kernel_time": 0.097458, "process_mem_max_rss": "128253952", "process_out_blocks": "0", "process_user_time": 1.156239}
[0m18:44:24.196935 [debug] [MainThread]: Command `cli build` failed at 18:44:24.196903 after 0.70 seconds
[0m18:44:24.197080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b0be70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130be59b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130bdeb60>]}
[0m18:44:24.197211 [debug] [MainThread]: Flushing usage events
[0m18:44:25.217619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:42.515034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2bb10>]}


============================== 18:45:42.517758 | 5d120802-3f69-4269-a05a-08c8eba8a434 ==============================
[0m18:45:42.517758 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:45:42.518165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m18:45:42.588026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d120802-3f69-4269-a05a-08c8eba8a434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2f490>]}
[0m18:45:42.609247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d120802-3f69-4269-a05a-08c8eba8a434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc2f10>]}
[0m18:45:42.610429 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:45:42.647845 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:45:42.701003 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:45:42.701261 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m18:45:42.701422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d120802-3f69-4269-a05a-08c8eba8a434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120bb8950>]}
[0m18:45:43.168013 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'trips' in the 'models' section of file 'models/properties.yml'
[0m18:45:43.199793 [warn ] [MainThread]: [[33mWARNING[0m][ArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found `arguments` property in test definition of `relationships` ({'name':
'every_trip_has_user', 'to': "source('scooters_raw', 'users')", 'field': 'id'})
without usage of `require_generic_test_arguments_property` behavior change flag.
The `arguments` property is deprecated for custom usage and will be used to nest
keyword arguments in future versions of dbt.
[0m18:45:43.200068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5d120802-3f69-4269-a05a-08c8eba8a434', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f3ae40>]}
[0m18:45:43.208186 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_trips_every_trip_has_user__source_scooters_raw_users___id__user_id (models/properties.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'arguments'
[0m18:45:43.208533 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:45:43.210069 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.725717, "process_in_blocks": "0", "process_kernel_time": 0.116425, "process_mem_max_rss": "128843776", "process_out_blocks": "0", "process_user_time": 1.184931}
[0m18:45:43.210258 [debug] [MainThread]: Command `cli build` failed at 18:45:43.210223 after 0.73 seconds
[0m18:45:43.210400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0be70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12188c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a81bf0>]}
[0m18:45:43.210527 [debug] [MainThread]: Flushing usage events
[0m18:45:44.168516 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:46:19.551278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111327b10>]}


============================== 18:46:19.553157 | abc6d655-b2b4-49a4-828d-1d1f7ba63a77 ==============================
[0m18:46:19.553157 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:46:19.553414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:46:19.618742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abc6d655-b2b4-49a4-828d-1d1f7ba63a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110233490>]}
[0m18:46:19.640661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abc6d655-b2b4-49a4-828d-1d1f7ba63a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110c2f10>]}
[0m18:46:19.641062 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:46:19.675878 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:46:19.726937 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:46:19.727170 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m18:46:19.727320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'abc6d655-b2b4-49a4-828d-1d1f7ba63a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133f0950>]}
[0m18:46:19.731392 [error] [MainThread]: Encountered an error:
'NoneType' object is not iterable
[0m18:46:19.734234 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ~~~~~~~~~~~~~~^
        runtime_config, write_perf_info, write, ctx.obj["flags"].write_json
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
        runtime_config,
        write_perf_info=write_perf_info,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/manifest.py", line 362, in load
    file_reader.read_files()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 212, in read_files
    self.read_files_for_project(project, file_types)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 219, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ~~~~~~~~~~~~~~~~~~~~~^
        project,
        ^^^^^^^^
    ...<4 lines>...
        dbt_ignore_spec,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 167, in read_files_for_parser
    source_files = get_source_files(
        project, dirs, extension, parse_ft, saved_files, ignore_spec
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 156, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 89, in load_source_file
    dfy = yaml_from_file(source_file=source_file, validate=True)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/schemas.py", line 164, in yaml_from_file
    for table in source.get("tables", []):
                 ~~~~~~~~~~^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not iterable

[0m18:46:19.735133 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.21044254, "process_in_blocks": "0", "process_kernel_time": 0.0832, "process_mem_max_rss": "118636544", "process_out_blocks": "0", "process_user_time": 0.661432}
[0m18:46:19.735346 [debug] [MainThread]: Command `cli build` failed at 18:46:19.735296 after 0.21 seconds
[0m18:46:19.735637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11093bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130be70>]}
[0m18:46:19.735809 [debug] [MainThread]: Flushing usage events
[0m18:46:20.520833 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:46:45.889608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762bb10>]}


============================== 18:46:45.892192 | 189827c1-47f0-4274-96c6-d7ae4ae8e19b ==============================
[0m18:46:45.892192 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:46:45.892461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:46:45.961738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '189827c1-47f0-4274-96c6-d7ae4ae8e19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106333490>]}
[0m18:46:45.983799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '189827c1-47f0-4274-96c6-d7ae4ae8e19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c2f10>]}
[0m18:46:45.984402 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:46:46.023606 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:46:46.077968 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:46:46.078219 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m18:46:46.078388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '189827c1-47f0-4274-96c6-d7ae4ae8e19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106dc950>]}
[0m18:46:46.087386 [error] [MainThread]: Encountered an error:
'NoneType' object is not iterable
[0m18:46:46.089362 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ~~~~~~~~~~~~~~^
        runtime_config, write_perf_info, write, ctx.obj["flags"].write_json
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
        runtime_config,
        write_perf_info=write_perf_info,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/manifest.py", line 362, in load
    file_reader.read_files()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 212, in read_files
    self.read_files_for_project(project, file_types)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 219, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ~~~~~~~~~~~~~~~~~~~~~^
        project,
        ^^^^^^^^
    ...<4 lines>...
        dbt_ignore_spec,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 167, in read_files_for_parser
    source_files = get_source_files(
        project, dirs, extension, parse_ft, saved_files, ignore_spec
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 156, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 89, in load_source_file
    dfy = yaml_from_file(source_file=source_file, validate=True)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/schemas.py", line 164, in yaml_from_file
    for table in source.get("tables", []):
                 ~~~~~~~~~~^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not iterable

[0m18:46:46.090814 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.22985546, "process_in_blocks": "0", "process_kernel_time": 0.096448, "process_mem_max_rss": "120733696", "process_out_blocks": "0", "process_user_time": 0.681983}
[0m18:46:46.091091 [debug] [MainThread]: Command `cli build` failed at 18:46:46.091045 after 0.23 seconds
[0m18:46:46.091253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760be70>]}
[0m18:46:46.091392 [debug] [MainThread]: Flushing usage events
[0m18:46:46.942161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:49:07.142056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069274d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2bb10>]}


============================== 18:49:07.144537 | cd8d826e-53ea-4f7f-b68e-cd2dbce22419 ==============================
[0m18:49:07.144537 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:49:07.144799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:49:07.215927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd8d826e-53ea-4f7f-b68e-cd2dbce22419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d33490>]}
[0m18:49:07.237193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd8d826e-53ea-4f7f-b68e-cd2dbce22419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc2f10>]}
[0m18:49:07.237776 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:49:07.276048 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:49:07.328612 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:49:07.328859 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m18:49:07.329008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd8d826e-53ea-4f7f-b68e-cd2dbce22419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b4c950>]}
[0m18:49:07.333599 [error] [MainThread]: Encountered an error:
'NoneType' object is not iterable
[0m18:49:07.335593 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ~~~~~~~~~~~~~~^
        runtime_config, write_perf_info, write, ctx.obj["flags"].write_json
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
        runtime_config,
        write_perf_info=write_perf_info,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/manifest.py", line 362, in load
    file_reader.read_files()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 212, in read_files
    self.read_files_for_project(project, file_types)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 219, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ~~~~~~~~~~~~~~~~~~~~~^
        project,
        ^^^^^^^^
    ...<4 lines>...
        dbt_ignore_spec,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 167, in read_files_for_parser
    source_files = get_source_files(
        project, dirs, extension, parse_ft, saved_files, ignore_spec
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 156, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 89, in load_source_file
    dfy = yaml_from_file(source_file=source_file, validate=True)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/schemas.py", line 164, in yaml_from_file
    for table in source.get("tables", []):
                 ~~~~~~~~~~^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not iterable

[0m18:49:07.337022 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.22382988, "process_in_blocks": "0", "process_kernel_time": 0.106867, "process_mem_max_rss": "120078336", "process_out_blocks": "0", "process_user_time": 0.689061}
[0m18:49:07.337221 [debug] [MainThread]: Command `cli build` failed at 18:49:07.337182 after 0.22 seconds
[0m18:49:07.337381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0be70>]}
[0m18:49:07.337505 [debug] [MainThread]: Flushing usage events
[0m18:49:08.359332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:49:12.500643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108174d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e2b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e2bb10>]}


============================== 18:49:12.502516 | d5fddd3d-f6ef-4ef1-bf73-68f83ae73310 ==============================
[0m18:49:12.502516 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:49:12.502913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:49:12.571670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5fddd3d-f6ef-4ef1-bf73-68f83ae73310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2b490>]}
[0m18:49:12.594288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5fddd3d-f6ef-4ef1-bf73-68f83ae73310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bc2f10>]}
[0m18:49:12.594793 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:49:12.631360 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:49:12.684690 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:49:12.684934 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m18:49:12.685090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5fddd3d-f6ef-4ef1-bf73-68f83ae73310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ee0950>]}
[0m18:49:12.689655 [error] [MainThread]: Encountered an error:
'NoneType' object is not iterable
[0m18:49:12.691142 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ~~~~~~~~~~~~~~^
        runtime_config, write_perf_info, write, ctx.obj["flags"].write_json
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
        runtime_config,
        write_perf_info=write_perf_info,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/manifest.py", line 362, in load
    file_reader.read_files()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 212, in read_files
    self.read_files_for_project(project, file_types)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 219, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ~~~~~~~~~~~~~~~~~~~~~^
        project,
        ^^^^^^^^
    ...<4 lines>...
        dbt_ignore_spec,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 167, in read_files_for_parser
    source_files = get_source_files(
        project, dirs, extension, parse_ft, saved_files, ignore_spec
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 156, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/read_files.py", line 89, in load_source_file
    dfy = yaml_from_file(source_file=source_file, validate=True)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/parser/schemas.py", line 164, in yaml_from_file
    for table in source.get("tables", []):
                 ~~~~~~~~~~^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not iterable

[0m18:49:12.691978 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.21909921, "process_in_blocks": "0", "process_kernel_time": 0.084033, "process_mem_max_rss": "119668736", "process_out_blocks": "0", "process_user_time": 0.671861}
[0m18:49:12.692207 [debug] [MainThread]: Command `cli build` failed at 18:49:12.692162 after 0.22 seconds
[0m18:49:12.692386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111437d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eb3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e0be70>]}
[0m18:49:12.692534 [debug] [MainThread]: Flushing usage events
[0m18:49:13.474635 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:23.616685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101234d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d2b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d2bb10>]}


============================== 18:55:23.619356 | a21a1aee-91e9-4ef4-a40b-417cab7738bc ==============================
[0m18:55:23.619356 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:55:23.619671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:55:23.703371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a21a1aee-91e9-4ef4-a40b-417cab7738bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b2f490>]}
[0m18:55:23.725043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a21a1aee-91e9-4ef4-a40b-417cab7738bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bc2f10>]}
[0m18:55:23.725646 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:55:23.763551 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:55:23.816861 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:55:23.817107 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m18:55:23.817269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a21a1aee-91e9-4ef4-a40b-417cab7738bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112960950>]}
[0m18:55:24.344027 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `freshness` as a top-level property of `trips` in file
`models/properties.yml`. The `freshness` top-level property should be moved into
the `config` of `trips`.
[0m18:55:24.344311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a21a1aee-91e9-4ef4-a40b-417cab7738bc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113939e50>]}
[0m18:55:24.401116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a21a1aee-91e9-4ef4-a40b-417cab7738bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f82430>]}
[0m18:55:24.442711 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:55:24.443947 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:55:24.461403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a21a1aee-91e9-4ef4-a40b-417cab7738bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b2ec30>]}
[0m18:55:24.461658 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 4 data tests, 15 sources, 439 macros
[0m18:55:24.462533 [info ] [MainThread]: 
[0m18:55:24.462668 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:55:24.462830 [info ] [MainThread]: 
[0m18:55:24.463074 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:55:24.463441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m18:55:24.484916 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m18:55:24.485127 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m18:55:24.485249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:25.534684 [debug] [ThreadPool]: SQL status: SELECT 11 in 1.049 seconds
[0m18:55:25.538256 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m18:55:25.548048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now list_dev_h8qz_dbt)
[0m18:55:25.555467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz_finance'
[0m18:55:25.555903 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m18:55:25.557413 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m18:55:25.557720 [debug] [ThreadPool]: On list_dev_h8qz_dbt: BEGIN
[0m18:55:25.557969 [debug] [ThreadPool]: On list_dev_h8qz_finance: BEGIN
[0m18:55:25.558206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:25.558429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:26.968391 [debug] [ThreadPool]: SQL status: BEGIN in 1.410 seconds
[0m18:55:26.969596 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m18:55:26.970335 [debug] [ThreadPool]: On list_dev_h8qz_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_dbt"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m18:55:27.175820 [debug] [ThreadPool]: SQL status: BEGIN in 1.617 seconds
[0m18:55:27.176281 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m18:55:27.176550 [debug] [ThreadPool]: On list_dev_h8qz_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_finance"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m18:55:27.275254 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.098 seconds
[0m18:55:27.275772 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.305 seconds
[0m18:55:27.277449 [debug] [ThreadPool]: On list_dev_h8qz_finance: ROLLBACK
[0m18:55:27.280044 [debug] [ThreadPool]: On list_dev_h8qz_dbt: ROLLBACK
[0m18:55:27.378167 [debug] [ThreadPool]: On list_dev_h8qz_finance: Close
[0m18:55:27.481724 [debug] [ThreadPool]: On list_dev_h8qz_dbt: Close
[0m18:55:27.494087 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.494533 [debug] [MainThread]: On master: BEGIN
[0m18:55:27.494777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:28.504313 [debug] [MainThread]: SQL status: BEGIN in 1.009 seconds
[0m18:55:28.505603 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:28.506547 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:55:28.606535 [debug] [MainThread]: SQL status: SELECT 3 in 0.099 seconds
[0m18:55:28.610017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a21a1aee-91e9-4ef4-a40b-417cab7738bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d831d0>]}
[0m18:55:28.611034 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:28.708719 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:28.709072 [debug] [MainThread]: On master: BEGIN
[0m18:55:28.913542 [debug] [MainThread]: SQL status: BEGIN in 0.204 seconds
[0m18:55:28.914007 [debug] [MainThread]: On master: COMMIT
[0m18:55:28.914308 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:28.914549 [debug] [MainThread]: On master: COMMIT
[0m18:55:29.015843 [debug] [MainThread]: SQL status: COMMIT in 0.101 seconds
[0m18:55:29.016343 [debug] [MainThread]: On master: Close
[0m18:55:29.020349 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m18:55:29.020866 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.parking_finish_stat ........................... [RUN]
[0m18:55:29.021277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_dbt, now model.dbt_scooters.parking_finish_stat)
[0m18:55:29.021582 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m18:55:29.028785 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m18:55:29.029740 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m18:55:29.053664 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m18:55:29.054261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:55:29.054451 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m18:55:29.054611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:30.040927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.986 seconds
[0m18:55:30.042141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:55:30.043067 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_h8qz"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)
-- group by
--     1


select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_h8qz"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:55:44.069568 [debug] [Thread-1 (]: SQL status: SELECT 464 in 14.025 seconds
[0m18:55:44.089675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:55:44.090329 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_h8qz"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m18:55:44.171946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.081 seconds
[0m18:55:44.179187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:55:44.180058 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_h8qz"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m18:55:44.274343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m18:55:44.298037 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m18:55:44.298493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:55:44.298788 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m18:55:44.376740 [debug] [Thread-1 (]: SQL status: COMMIT in 0.077 seconds
[0m18:55:44.387914 [debug] [Thread-1 (]: Applying DROP to: "dev_h8qz"."dbt"."parking_finish_stat__dbt_backup"
[0m18:55:44.399957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:55:44.400656 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_h8qz"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m18:55:44.448155 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.047 seconds
[0m18:55:44.451568 [debug] [Thread-1 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m18:55:44.454976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21a1aee-91e9-4ef4-a40b-417cab7738bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141dcd60>]}
[0m18:55:44.455581 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.parking_finish_stat ...................... [[32mSELECT 464[0m in 15.43s]
[0m18:55:44.456225 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m18:55:44.457412 [info ] [MainThread]: 
[0m18:55:44.457650 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:44.457923 [debug] [MainThread]: On master: BEGIN
[0m18:55:44.458169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:45.489386 [debug] [MainThread]: SQL status: BEGIN in 1.031 seconds
[0m18:55:45.490496 [debug] [MainThread]: On master: COMMIT
[0m18:55:45.491153 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:45.491683 [debug] [MainThread]: On master: COMMIT
[0m18:55:45.608480 [debug] [MainThread]: SQL status: COMMIT in 0.116 seconds
[0m18:55:45.613096 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m18:55:45.621756 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m18:55:45.622560 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:45.623046 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m18:55:45.707712 [debug] [MainThread]: SQL status: GRANT in 0.084 seconds
[0m18:55:45.709600 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.10s]
[0m18:55:45.710234 [debug] [MainThread]: On master: Close
[0m18:55:45.711660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:45.712218 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m18:55:45.712518 [debug] [MainThread]: Connection 'list_dev_h8qz_finance' was properly closed.
[0m18:55:45.712841 [info ] [MainThread]: 
[0m18:55:45.713172 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 21.25 seconds (21.25s).
[0m18:55:45.714280 [debug] [MainThread]: Command end result
[0m18:55:45.739321 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:55:45.740595 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:55:45.744172 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m18:55:45.744348 [info ] [MainThread]: 
[0m18:55:45.744545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:45.744687 [info ] [MainThread]: 
[0m18:55:45.744992 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:55:45.745320 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PropertyMovedToConfigDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:55:45.746722 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 22.159103, "process_in_blocks": "0", "process_kernel_time": 0.169325, "process_mem_max_rss": "149929984", "process_out_blocks": "0", "process_user_time": 1.56822}
[0m18:55:45.746966 [debug] [MainThread]: Command `cli build` succeeded at 18:55:45.746918 after 22.16 seconds
[0m18:55:45.747152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e604b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d8bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d2ed0>]}
[0m18:55:45.747337 [debug] [MainThread]: Flushing usage events
[0m18:55:46.733033 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:56:14.163515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a2b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a2bb10>]}


============================== 18:56:14.165535 | 4e0a611b-e4a9-4111-8727-ad7a06222fdc ==============================
[0m18:56:14.165535 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:56:14.165824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:56:14.235341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e0a611b-e4a9-4111-8727-ad7a06222fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107733490>]}
[0m18:56:14.256986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e0a611b-e4a9-4111-8727-ad7a06222fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c2f10>]}
[0m18:56:14.257384 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:56:14.292654 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:56:14.357020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:56:14.357835 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://models/properties.yml
[0m18:56:14.567651 [warn ] [MainThread]: [[33mWARNING[0m][ArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found `arguments` property in test definition of `relationships` ({'name':
'every_trip_has_user', 'to': "source('scooters_raw', 'users')", 'field': 'id'})
without usage of `require_generic_test_arguments_property` behavior change flag.
The `arguments` property is deprecated for custom usage and will be used to nest
keyword arguments in future versions of dbt.
[0m18:56:14.567932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e0a611b-e4a9-4111-8727-ad7a06222fdc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f1a750>]}
[0m18:56:14.575606 [error] [MainThread]: Encountered an error:
Compilation Error in test source_relationships_scooters_raw_trips_every_trip_has_user__source_scooters_raw_users___id__user_id (models/properties.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'arguments'
[0m18:56:14.575908 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:56:14.576624 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.44106686, "process_in_blocks": "0", "process_kernel_time": 0.102793, "process_mem_max_rss": "125517824", "process_out_blocks": "0", "process_user_time": 0.908343}
[0m18:56:14.576798 [debug] [MainThread]: Command `cli build` failed at 18:56:14.576763 after 0.44 seconds
[0m18:56:14.576934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122db6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112694320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0be70>]}
[0m18:56:14.577057 [debug] [MainThread]: Flushing usage events
[0m18:56:15.334439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:56:24.883142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dbb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ab9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052abb10>]}


============================== 18:56:24.885070 | 99f3d4cc-226b-4a40-b1c1-35278f4f089e ==============================
[0m18:56:24.885070 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:56:24.885330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:56:24.951073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99f3d4cc-226b-4a40-b1c1-35278f4f089e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b7490>]}
[0m18:56:24.972247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99f3d4cc-226b-4a40-b1c1-35278f4f089e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105146f10>]}
[0m18:56:24.972656 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:56:25.008366 [debug] [MainThread]: checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, vars: {}, profile: , target: dev, version: 1.10.6
[0m18:56:25.061040 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:56:25.061280 [debug] [MainThread]: previous checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7, current checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c
[0m18:56:25.061431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '99f3d4cc-226b-4a40-b1c1-35278f4f089e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d8950>]}
[0m18:56:25.585516 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `freshness` as a top-level property of `trips` in file
`models/properties.yml`. The `freshness` top-level property should be moved into
the `config` of `trips`.
[0m18:56:25.585787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '99f3d4cc-226b-4a40-b1c1-35278f4f089e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645de50>]}
[0m18:56:25.644339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99f3d4cc-226b-4a40-b1c1-35278f4f089e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ae430>]}
[0m18:56:25.686819 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:56:25.687859 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:56:25.699427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99f3d4cc-226b-4a40-b1c1-35278f4f089e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b6c30>]}
[0m18:56:25.699646 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 4 data tests, 15 sources, 439 macros
[0m18:56:25.700542 [info ] [MainThread]: 
[0m18:56:25.700688 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:56:25.700810 [info ] [MainThread]: 
[0m18:56:25.701064 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:56:25.701447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m18:56:25.719974 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m18:56:25.720178 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m18:56:25.720289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:26.770915 [debug] [ThreadPool]: SQL status: SELECT 11 in 1.050 seconds
[0m18:56:26.774776 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m18:56:26.784947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now list_dev_h8qz_dbt)
[0m18:56:26.792902 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz_finance'
[0m18:56:26.793720 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m18:56:26.795332 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m18:56:26.795656 [debug] [ThreadPool]: On list_dev_h8qz_dbt: BEGIN
[0m18:56:26.795921 [debug] [ThreadPool]: On list_dev_h8qz_finance: BEGIN
[0m18:56:26.796168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:56:26.796394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:27.796393 [debug] [ThreadPool]: SQL status: BEGIN in 1.000 seconds
[0m18:56:27.797674 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m18:56:27.798874 [debug] [ThreadPool]: On list_dev_h8qz_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_finance"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m18:56:27.897101 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.097 seconds
[0m18:56:27.898058 [debug] [ThreadPool]: SQL status: BEGIN in 1.102 seconds
[0m18:56:27.901256 [debug] [ThreadPool]: On list_dev_h8qz_finance: ROLLBACK
[0m18:56:27.902034 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m18:56:27.902870 [debug] [ThreadPool]: On list_dev_h8qz_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_dbt"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m18:56:27.999903 [debug] [ThreadPool]: On list_dev_h8qz_finance: Close
[0m18:56:28.000975 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.098 seconds
[0m18:56:28.004471 [debug] [ThreadPool]: On list_dev_h8qz_dbt: ROLLBACK
[0m18:56:28.103433 [debug] [ThreadPool]: On list_dev_h8qz_dbt: Close
[0m18:56:28.116812 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:28.117429 [debug] [MainThread]: On master: BEGIN
[0m18:56:28.117803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:56:29.945088 [debug] [MainThread]: SQL status: BEGIN in 1.827 seconds
[0m18:56:29.946498 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:29.947384 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:56:30.047818 [debug] [MainThread]: SQL status: SELECT 3 in 0.099 seconds
[0m18:56:30.052620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99f3d4cc-226b-4a40-b1c1-35278f4f089e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066af1d0>]}
[0m18:56:30.053591 [debug] [MainThread]: On master: ROLLBACK
[0m18:56:30.149862 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:30.151128 [debug] [MainThread]: On master: BEGIN
[0m18:56:30.354884 [debug] [MainThread]: SQL status: BEGIN in 0.203 seconds
[0m18:56:30.355936 [debug] [MainThread]: On master: COMMIT
[0m18:56:30.356672 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:30.357673 [debug] [MainThread]: On master: COMMIT
[0m18:56:30.459178 [debug] [MainThread]: SQL status: COMMIT in 0.101 seconds
[0m18:56:30.460307 [debug] [MainThread]: On master: Close
[0m18:56:30.466491 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m18:56:30.467554 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt.parking_start_stat ............................ [RUN]
[0m18:56:30.468295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_dbt, now model.dbt_scooters.parking_start_stat)
[0m18:56:30.468790 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m18:56:30.478183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m18:56:30.479113 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m18:56:30.506257 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m18:56:30.506918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:56:30.507139 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m18:56:30.507309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:56:32.506080 [debug] [Thread-1 (]: SQL status: BEGIN in 1.998 seconds
[0m18:56:32.507683 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:56:32.508587 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_h8qz"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.start_point, 3857), hex.geom)
-- group by
--     1

select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_h8qz"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:56:45.962712 [debug] [Thread-1 (]: SQL status: SELECT 142 in 13.453 seconds
[0m18:56:45.981419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:56:45.982051 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_h8qz"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m18:56:46.125055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.142 seconds
[0m18:56:46.130429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:56:46.131218 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_h8qz"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m18:56:46.227093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m18:56:46.247249 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m18:56:46.247669 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:56:46.247937 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m18:56:46.329867 [debug] [Thread-1 (]: SQL status: COMMIT in 0.081 seconds
[0m18:56:46.341602 [debug] [Thread-1 (]: Applying DROP to: "dev_h8qz"."dbt"."parking_start_stat__dbt_backup"
[0m18:56:46.346931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:56:46.347331 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_h8qz"."dbt"."parking_start_stat__dbt_backup" cascade
[0m18:56:46.432098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.084 seconds
[0m18:56:46.437989 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m18:56:46.442101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f3d4cc-226b-4a40-b1c1-35278f4f089e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b04d60>]}
[0m18:56:46.443394 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt.parking_start_stat ....................... [[32mSELECT 142[0m in 15.97s]
[0m18:56:46.444177 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m18:56:46.446366 [info ] [MainThread]: 
[0m18:56:46.446875 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:46.447238 [debug] [MainThread]: On master: BEGIN
[0m18:56:46.447786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:56:47.763675 [debug] [MainThread]: SQL status: BEGIN in 1.316 seconds
[0m18:56:47.765372 [debug] [MainThread]: On master: COMMIT
[0m18:56:47.766502 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:47.767339 [debug] [MainThread]: On master: COMMIT
[0m18:56:47.865405 [debug] [MainThread]: SQL status: COMMIT in 0.097 seconds
[0m18:56:47.870248 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m18:56:47.877171 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m18:56:47.878028 [debug] [MainThread]: Using postgres connection "master"
[0m18:56:47.878562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m18:56:47.968077 [debug] [MainThread]: SQL status: GRANT in 0.089 seconds
[0m18:56:47.970544 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.10s]
[0m18:56:47.971393 [debug] [MainThread]: On master: Close
[0m18:56:47.972982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:56:47.973559 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m18:56:47.974009 [debug] [MainThread]: Connection 'list_dev_h8qz_finance' was properly closed.
[0m18:56:47.974524 [info ] [MainThread]: 
[0m18:56:47.975059 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 22.27 seconds (22.27s).
[0m18:56:47.976583 [debug] [MainThread]: Command end result
[0m18:56:48.007881 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:56:48.009220 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:56:48.012810 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m18:56:48.012982 [info ] [MainThread]: 
[0m18:56:48.013189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:56:48.013428 [info ] [MainThread]: 
[0m18:56:48.013603 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:56:48.013880 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PropertyMovedToConfigDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:56:48.014899 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 23.157476, "process_in_blocks": "0", "process_kernel_time": 0.146696, "process_mem_max_rss": "149454848", "process_out_blocks": "0", "process_user_time": 1.574319}
[0m18:56:48.015143 [debug] [MainThread]: Command `cli build` succeeded at 18:56:48.015094 after 23.16 seconds
[0m18:56:48.015338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067904b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e0aed0>]}
[0m18:56:48.015528 [debug] [MainThread]: Flushing usage events
[0m18:56:48.788506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:46.916542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043bf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642bb10>]}


============================== 18:57:46.918374 | f20794fb-4156-462d-80a4-9fba5323bf7c ==============================
[0m18:57:46.918374 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:57:46.918638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:46.983806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2f490>]}
[0m18:57:47.005561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c1f20>]}
[0m18:57:47.005895 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:57:47.039498 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:57:47.090755 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:57:47.090985 [debug] [MainThread]: previous checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, current checksum: ddc23158f2553d8aa2ca7e3dd2aad24fb10b13ff796468769157e6c86ddce3e7
[0m18:57:47.091120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110614450>]}
[0m18:57:47.605668 [warn ] [MainThread]: [[33mWARNING[0m][PropertyMovedToConfigDeprecation]: Deprecated functionality
Found `freshness` as a top-level property of `trips` in file
`models/properties.yml`. The `freshness` top-level property should be moved into
the `config` of `trips`.
[0m18:57:47.605944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107a6990>]}
[0m18:57:47.660702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110784910>]}
[0m18:57:47.702507 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:57:47.703383 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:57:47.714853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c76d00>]}
[0m18:57:47.715085 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 4 data tests, 15 sources, 439 macros
[0m18:57:47.716453 [info ] [MainThread]: 
[0m18:57:47.716596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:57:47.716709 [info ] [MainThread]: 
[0m18:57:47.716904 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:57:47.718761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m18:57:47.722689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m18:57:47.737653 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m18:57:47.737893 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m18:57:47.738045 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m18:57:47.738189 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m18:57:47.738301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:47.738415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:48.896596 [debug] [ThreadPool]: SQL status: SELECT 11 in 1.158 seconds
[0m18:57:48.897085 [debug] [ThreadPool]: SQL status: SELECT 11 in 1.159 seconds
[0m18:57:48.898388 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m18:57:48.899405 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m18:57:48.901653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now list_dev_h8qz_finance)
[0m18:57:48.906340 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m18:57:48.906735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now list_dev_h8qz_dbt)
[0m18:57:48.906992 [debug] [ThreadPool]: On list_dev_h8qz_finance: BEGIN
[0m18:57:48.908150 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m18:57:48.908370 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:48.908561 [debug] [ThreadPool]: On list_dev_h8qz_dbt: BEGIN
[0m18:57:48.908838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:49.920838 [debug] [ThreadPool]: SQL status: BEGIN in 1.012 seconds
[0m18:57:49.922302 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m18:57:49.923311 [debug] [ThreadPool]: On list_dev_h8qz_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_dbt"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m18:57:50.023079 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.099 seconds
[0m18:57:50.028434 [debug] [ThreadPool]: On list_dev_h8qz_dbt: ROLLBACK
[0m18:57:50.127965 [debug] [ThreadPool]: On list_dev_h8qz_dbt: Close
[0m18:57:50.829523 [debug] [ThreadPool]: SQL status: BEGIN in 1.921 seconds
[0m18:57:50.831005 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m18:57:50.831944 [debug] [ThreadPool]: On list_dev_h8qz_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_finance"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m18:57:50.946740 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.114 seconds
[0m18:57:50.950487 [debug] [ThreadPool]: On list_dev_h8qz_finance: ROLLBACK
[0m18:57:51.048829 [debug] [ThreadPool]: On list_dev_h8qz_finance: Close
[0m18:57:51.063140 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:51.063808 [debug] [MainThread]: On master: BEGIN
[0m18:57:51.064196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:52.890564 [debug] [MainThread]: SQL status: BEGIN in 1.826 seconds
[0m18:57:52.892060 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:52.893381 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:57:52.992840 [debug] [MainThread]: SQL status: SELECT 3 in 0.098 seconds
[0m18:57:52.998429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110da3050>]}
[0m18:57:52.999822 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:53.095140 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:53.096272 [debug] [MainThread]: On master: BEGIN
[0m18:57:53.299976 [debug] [MainThread]: SQL status: BEGIN in 0.203 seconds
[0m18:57:53.301070 [debug] [MainThread]: On master: COMMIT
[0m18:57:53.301995 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:53.302829 [debug] [MainThread]: On master: COMMIT
[0m18:57:53.402208 [debug] [MainThread]: SQL status: COMMIT in 0.099 seconds
[0m18:57:53.403229 [debug] [MainThread]: On master: Close
[0m18:57:53.410201 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m18:57:53.410912 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m18:57:53.411490 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m18:57:53.411999 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_geom
[0m18:57:53.412650 [info ] [Thread-1 (]: 1 of 24 START sql incremental model dbt.events_clean ........................... [RUN]
[0m18:57:53.413329 [info ] [Thread-4 (]: 4 of 24 START sql view model dbt.trips_prep .................................... [RUN]
[0m18:57:53.413978 [info ] [Thread-2 (]: 2 of 24 START sql table model dbt.trips_concurrency ............................ [RUN]
[0m18:57:53.414628 [info ] [Thread-3 (]: 3 of 24 START sql table model dbt.trips_geom ................................... [RUN]
[0m18:57:53.415274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_finance, now model.dbt_scooters.events_clean)
[0m18:57:53.415913 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_prep'
[0m18:57:53.416377 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_dbt, now model.dbt_scooters.trips_concurrency)
[0m18:57:53.416868 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_scooters.trips_geom'
[0m18:57:53.417277 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m18:57:53.417660 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m18:57:53.418049 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m18:57:53.418411 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_geom
[0m18:57:53.432377 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m18:57:53.433367 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m18:57:53.436348 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m18:57:53.437813 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m18:57:53.438464 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m18:57:53.438743 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m18:57:53.438969 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_geom
[0m18:57:53.439168 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m18:57:53.473634 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m18:57:53.476545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:57:53.481881 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m18:57:53.483091 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m18:57:53.483314 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp185753462130"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_h8qz"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_h8qz"."dbt"."events_clean")
    

  );
  
  
[0m18:57:53.483639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:53.483878 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:57:53.484063 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:57:53.484198 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m18:57:53.484345 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m18:57:53.484504 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:57:53.484643 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:57:53.484775 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:57:53.484909 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m18:57:53.485138 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:57:54.530111 [debug] [Thread-2 (]: SQL status: BEGIN in 1.045 seconds
[0m18:57:54.530441 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:57:54.530670 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_h8qz"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
[0m18:57:54.635658 [debug] [Thread-3 (]: SQL status: BEGIN in 1.151 seconds
[0m18:57:54.636475 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:57:54.637030 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_geom__dbt_tmp"
  
  
    as
  
  (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_h8qz"."scooters_raw"."trips"
  );
  
[0m18:57:55.658862 [debug] [Thread-4 (]: SQL status: BEGIN in 2.174 seconds
[0m18:57:55.660354 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:57:55.661081 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_h8qz"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,

    date(started_at at time zone 'Europe/Moscow')
 as "date" 
from
"dev_h8qz"."scooters_raw"."trips"
  );
[0m18:57:55.964137 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.302 seconds
[0m18:57:55.979913 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:57:55.980422 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_h8qz"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m18:57:56.167521 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.186 seconds
[0m18:57:56.174745 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:57:56.175449 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_h8qz"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m18:57:56.371932 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.196 seconds
[0m18:57:56.394287 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m18:57:56.394777 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:57:56.395091 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m18:57:56.578854 [debug] [Thread-4 (]: SQL status: COMMIT in 0.183 seconds
[0m18:57:56.590798 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_prep__dbt_backup"
[0m18:57:56.595290 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m18:57:56.595661 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_h8qz"."dbt"."trips_prep__dbt_backup" cascade
[0m18:57:56.884476 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.288 seconds
[0m18:57:56.890651 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m18:57:56.893979 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f49f0>]}
[0m18:57:56.895078 [info ] [Thread-4 (]: 4 of 24 OK created sql view model dbt.trips_prep ............................... [[32mCREATE VIEW[0m in 3.48s]
[0m18:57:56.895854 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m18:57:56.896343 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m18:57:56.897055 [info ] [Thread-4 (]: 5 of 24 START sql table model dbt.trips_stat_daily ............................. [RUN]
[0m18:57:56.897758 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.trips_stat_daily)
[0m18:57:56.898206 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m18:57:56.900675 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m18:57:56.901570 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m18:57:56.905748 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m18:57:56.906802 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:57:56.907220 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m18:57:56.907644 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:57:57.556943 [debug] [Thread-2 (]: SQL status: SELECT 10 in 3.026 seconds
[0m18:57:57.561190 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:57:57.561439 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_h8qz"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m18:57:57.708792 [debug] [Thread-1 (]: SQL status: SELECT 0 in 4.225 seconds
[0m18:57:57.710348 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m18:57:57.728896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:57:57.732013 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:57:57.732306 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m18:57:57.732568 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_h8qz"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m18:57:57.807322 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.074 seconds
[0m18:57:57.808169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m18:57:57.810629 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m18:57:57.811150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:57:57.811598 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:57:57.812012 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp185753462130'
        
      order by ordinal_position

  
[0m18:57:57.812384 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m18:57:58.010712 [debug] [Thread-2 (]: SQL status: COMMIT in 0.197 seconds
[0m18:57:58.016519 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_concurrency__dbt_backup"
[0m18:57:58.021492 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m18:57:58.022155 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_h8qz"."dbt"."trips_concurrency__dbt_backup" cascade
[0m18:57:58.114608 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.092 seconds
[0m18:57:58.118048 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m18:57:58.119668 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117c6fd0>]}
[0m18:57:58.120788 [info ] [Thread-2 (]: 2 of 24 OK created sql table model dbt.trips_concurrency ....................... [[32mSELECT 10[0m in 4.70s]
[0m18:57:58.121545 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m18:57:58.122100 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.age_groups
[0m18:57:58.122818 [info ] [Thread-2 (]: 6 of 24 START seed file dbt.age_groups ......................................... [RUN]
[0m18:57:58.123453 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now seed.dbt_scooters.age_groups)
[0m18:57:58.123918 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.age_groups
[0m18:57:58.124338 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.age_groups
[0m18:57:58.147074 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:57:58.147418 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m18:57:58.147643 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:57:58.216886 [debug] [Thread-4 (]: SQL status: BEGIN in 1.309 seconds
[0m18:57:58.217682 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:57:58.218129 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
  
[0m18:57:58.318953 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.506 seconds
[0m18:57:58.322750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:57:58.323056 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:57:58.522863 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.199 seconds
[0m18:57:58.543568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:57:58.544086 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp185753462130'
        
      order by ordinal_position

  
[0m18:57:58.625224 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.080 seconds
[0m18:57:58.633069 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:57:58.633653 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:57:58.730614 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.096 seconds
[0m18:57:58.744854 [debug] [Thread-1 (]: 
    In "dev_h8qz"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:57:58.757129 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m18:57:58.757898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:57:58.758170 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        delete from "dev_h8qz"."dbt"."events_clean" as DBT_INTERNAL_DEST
        where (user_id, timestamp, type_id) in (
            select distinct user_id, timestamp, type_id
            from "events_clean__dbt_tmp185753462130" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_h8qz"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp185753462130"
    )
  
[0m18:57:58.829847 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.071 seconds
[0m18:57:58.832451 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m18:57:58.833002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m18:57:58.833435 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m18:57:58.932164 [debug] [Thread-1 (]: SQL status: COMMIT in 0.098 seconds
[0m18:57:58.934190 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m18:57:58.935682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117f55d0>]}
[0m18:57:58.936877 [info ] [Thread-1 (]: 1 of 24 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 5.52s]
[0m18:57:58.937815 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m18:57:58.938482 [debug] [Thread-1 (]: Began running node seed.dbt_scooters.event_types
[0m18:57:58.939356 [info ] [Thread-1 (]: 7 of 24 START seed file dbt.event_types ........................................ [RUN]
[0m18:57:58.940169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now seed.dbt_scooters.event_types)
[0m18:57:58.940785 [debug] [Thread-1 (]: Began compiling node seed.dbt_scooters.event_types
[0m18:57:58.941392 [debug] [Thread-1 (]: Began executing node seed.dbt_scooters.event_types
[0m18:57:58.948691 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:57:58.949251 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: BEGIN
[0m18:57:58.949618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:59.343560 [debug] [Thread-3 (]: SQL status: SELECT 105901 in 4.705 seconds
[0m18:57:59.345129 [debug] [Thread-2 (]: SQL status: BEGIN in 1.197 seconds
[0m18:57:59.352853 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:57:59.353252 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:57:59.353627 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_h8qz"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m18:57:59.353963 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_h8qz"."dbt"."age_groups"
[0m18:57:59.444148 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m18:57:59.445273 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.091 seconds
[0m18:57:59.451466 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:57:59.464440 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_h8qz"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m18:57:59.468805 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:57:59.469212 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_h8qz"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m18:57:59.546323 [debug] [Thread-2 (]: SQL status: INSERT 0 8 in 0.077 seconds
[0m18:57:59.546653 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.078 seconds
[0m18:57:59.550893 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m18:57:59.551873 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m18:57:59.552187 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:57:59.552402 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m18:57:59.553448 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m18:57:59.553695 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m18:57:59.553902 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m18:57:59.648821 [debug] [Thread-2 (]: SQL status: COMMIT in 0.095 seconds
[0m18:57:59.649500 [debug] [Thread-3 (]: SQL status: COMMIT in 0.097 seconds
[0m18:57:59.650657 [debug] [Thread-2 (]: On seed.dbt_scooters.age_groups: Close
[0m18:57:59.653748 [debug] [Thread-3 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_geom__dbt_backup"
[0m18:57:59.654738 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m18:57:59.655365 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111177150>]}
[0m18:57:59.655746 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop table if exists "dev_h8qz"."dbt"."trips_geom__dbt_backup" cascade
[0m18:57:59.656295 [info ] [Thread-2 (]: 6 of 24 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 1.53s]
[0m18:57:59.657015 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.age_groups
[0m18:57:59.657427 [debug] [Thread-2 (]: Began running node seed.dbt_scooters.scooters
[0m18:57:59.657959 [info ] [Thread-2 (]: 8 of 24 START seed file dbt.scooters ........................................... [RUN]
[0m18:57:59.658385 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now seed.dbt_scooters.scooters)
[0m18:57:59.658714 [debug] [Thread-2 (]: Began compiling node seed.dbt_scooters.scooters
[0m18:57:59.659013 [debug] [Thread-2 (]: Began executing node seed.dbt_scooters.scooters
[0m18:57:59.664960 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:57:59.665373 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: BEGIN
[0m18:57:59.665636 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:57:59.855456 [debug] [Thread-4 (]: SQL status: SELECT 91 in 1.637 seconds
[0m18:57:59.859072 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:57:59.859494 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_h8qz"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m18:57:59.958175 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.098 seconds
[0m18:57:59.959829 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.303 seconds
[0m18:57:59.966870 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:57:59.968705 [debug] [Thread-3 (]: On model.dbt_scooters.trips_geom: Close
[0m18:57:59.969245 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_h8qz"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m18:57:59.970082 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111fb890>]}
[0m18:57:59.970807 [info ] [Thread-3 (]: 3 of 24 OK created sql table model dbt.trips_geom .............................. [[32mSELECT 105901[0m in 6.55s]
[0m18:57:59.971420 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_geom
[0m18:57:59.971820 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m18:57:59.972273 [info ] [Thread-3 (]: 9 of 24 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m18:57:59.972829 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m18:57:59.973187 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m18:57:59.977054 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m18:57:59.979445 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m18:57:59.994074 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m18:57:59.994649 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m18:57:59.994869 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m18:57:59.995059 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:58:00.059621 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m18:58:00.060972 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m18:58:00.061353 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:58:00.061679 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m18:58:00.162795 [debug] [Thread-4 (]: SQL status: COMMIT in 0.100 seconds
[0m18:58:00.164411 [debug] [Thread-1 (]: SQL status: BEGIN in 1.214 seconds
[0m18:58:00.169619 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_stat_daily__dbt_backup"
[0m18:58:00.170169 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:58:00.170866 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m18:58:00.171274 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_h8qz"."dbt"."event_types"
[0m18:58:00.171671 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_h8qz"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m18:58:00.265044 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.093 seconds
[0m18:58:00.266079 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.094 seconds
[0m18:58:00.269151 [debug] [Thread-4 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m18:58:00.272679 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:58:00.273408 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_h8qz"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m18:58:00.274256 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11402f0b0>]}
[0m18:58:00.275405 [info ] [Thread-4 (]: 5 of 24 OK created sql table model dbt.trips_stat_daily ........................ [[32mSELECT 91[0m in 3.38s]
[0m18:58:00.276245 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m18:58:00.276756 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m18:58:00.277284 [info ] [Thread-4 (]: 10 of 24 START test source_not_null_scooters_raw_users_sex ..................... [RUN]
[0m18:58:00.277843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m18:58:00.278249 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m18:58:00.290291 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m18:58:00.291114 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m18:58:00.293023 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m18:58:00.293628 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m18:58:00.293975 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m18:58:00.294525 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:58:00.367635 [debug] [Thread-1 (]: SQL status: INSERT 0 4 in 0.093 seconds
[0m18:58:00.368182 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m18:58:00.371143 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: COMMIT
[0m18:58:00.371394 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m18:58:00.371584 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: COMMIT
[0m18:58:00.469611 [debug] [Thread-1 (]: SQL status: COMMIT in 0.098 seconds
[0m18:58:00.470954 [debug] [Thread-1 (]: On seed.dbt_scooters.event_types: Close
[0m18:58:00.471997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110eb3b0>]}
[0m18:58:00.472883 [info ] [Thread-1 (]: 7 of 24 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 1.53s]
[0m18:58:00.473632 [debug] [Thread-1 (]: Finished running node seed.dbt_scooters.event_types
[0m18:58:00.474075 [debug] [Thread-1 (]: Began running node model.dbt_scooters.revenue_daily
[0m18:58:00.474737 [info ] [Thread-1 (]: 11 of 24 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m18:58:00.475469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now model.dbt_scooters.revenue_daily)
[0m18:58:00.475887 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m18:58:00.479225 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m18:58:00.480920 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.revenue_daily
[0m18:58:00.484132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:58:00.484460 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp185800483103"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_h8qz"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_h8qz"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m18:58:00.484721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:00.674755 [debug] [Thread-2 (]: SQL status: BEGIN in 1.009 seconds
[0m18:58:00.676015 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:58:00.676716 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_h8qz"."dbt"."scooters"
[0m18:58:00.779909 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.102 seconds
[0m18:58:00.784800 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:58:00.785250 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_h8qz"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m18:58:00.877552 [debug] [Thread-2 (]: SQL status: INSERT 0 10 in 0.092 seconds
[0m18:58:00.878031 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m18:58:00.879865 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: COMMIT
[0m18:58:00.880118 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m18:58:00.880304 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: COMMIT
[0m18:58:00.981376 [debug] [Thread-2 (]: SQL status: COMMIT in 0.101 seconds
[0m18:58:00.981789 [debug] [Thread-3 (]: SQL status: BEGIN in 0.987 seconds
[0m18:58:00.982409 [debug] [Thread-2 (]: On seed.dbt_scooters.scooters: Close
[0m18:58:00.982678 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m18:58:00.983008 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_h8qz"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



  
  
      
    ) dbt_internal_test
[0m18:58:00.983440 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11176e570>]}
[0m18:58:00.983848 [info ] [Thread-2 (]: 8 of 24 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 1.33s]
[0m18:58:00.984247 [debug] [Thread-2 (]: Finished running node seed.dbt_scooters.scooters
[0m18:58:00.984504 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat
[0m18:58:00.984887 [info ] [Thread-2 (]: 12 of 24 START sql table model dbt.trips_stat .................................. [RUN]
[0m18:58:00.985268 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now model.dbt_scooters.trips_stat)
[0m18:58:00.985542 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat
[0m18:58:00.987382 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m18:58:00.987893 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat
[0m18:58:00.990267 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m18:58:00.990680 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:58:00.990876 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m18:58:00.991055 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:01.084119 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.100 seconds
[0m18:58:01.087799 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m18:58:01.187134 [debug] [Thread-3 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m18:58:01.190087 [info ] [Thread-3 (]: 9 of 24 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 1.22s]
[0m18:58:01.191359 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m18:58:01.192184 [debug] [Thread-3 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m18:58:01.193284 [info ] [Thread-3 (]: 13 of 24 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m18:58:01.194265 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now model.dbt_scooters.parking_finish_stat)
[0m18:58:01.194980 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m18:58:01.201096 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m18:58:01.202501 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m18:58:01.206924 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m18:58:01.208473 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:58:01.208888 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m18:58:01.209249 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:58:01.289534 [debug] [Thread-4 (]: SQL status: BEGIN in 0.995 seconds
[0m18:58:01.290217 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m18:58:01.290706 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sex
from "dev_h8qz"."scooters_raw"."users"
where sex is null



  
  
      
    ) dbt_internal_test
[0m18:58:01.391179 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.100 seconds
[0m18:58:01.394073 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m18:58:01.493991 [debug] [Thread-4 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m18:58:01.496538 [warn ] [Thread-4 (]: 10 of 24 WARN 216 source_not_null_scooters_raw_users_sex ....................... [[33mWARN 216[0m in 1.22s]
[0m18:58:01.497749 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m18:58:01.498549 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_start_stat
[0m18:58:01.499618 [info ] [Thread-4 (]: 14 of 24 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m18:58:01.500597 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now model.dbt_scooters.parking_start_stat)
[0m18:58:01.501304 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m18:58:01.506946 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m18:58:01.508371 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m18:58:01.512260 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m18:58:01.513296 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:58:01.513877 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m18:58:01.514804 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:58:02.006661 [debug] [Thread-1 (]: SQL status: SELECT 3 in 1.522 seconds
[0m18:58:02.010574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:58:02.011012 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m18:58:02.210615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.199 seconds
[0m18:58:02.211312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:58:02.211735 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp185800483103'
        
      order by ordinal_position

  
[0m18:58:02.313281 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.101 seconds
[0m18:58:02.320637 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:58:02.321476 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m18:58:02.415612 [debug] [Thread-3 (]: SQL status: BEGIN in 1.206 seconds
[0m18:58:02.416821 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.095 seconds
[0m18:58:02.417570 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:58:02.423492 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:58:02.424325 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_h8qz"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)
-- group by
--     1


select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_h8qz"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:58:02.425010 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp185800483103'
        
      order by ordinal_position

  
[0m18:58:02.517504 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.092 seconds
[0m18:58:02.517794 [debug] [Thread-4 (]: SQL status: BEGIN in 1.003 seconds
[0m18:58:02.519506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:58:02.519716 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:58:02.519882 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m18:58:02.520059 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_h8qz"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.start_point, 3857), hex.geom)
-- group by
--     1

select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_h8qz"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m18:58:02.619946 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.100 seconds
[0m18:58:02.621227 [debug] [Thread-1 (]: 
    In "dev_h8qz"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:58:02.621843 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m18:58:02.622419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:58:02.622663 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_h8qz"."finance"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp185800483103" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_h8qz"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp185800483103"
    )
  
[0m18:58:02.722083 [debug] [Thread-1 (]: SQL status: INSERT 0 3 in 0.099 seconds
[0m18:58:02.725675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:58:02.726016 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_h8qz".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m18:58:02.828031 [debug] [Thread-2 (]: SQL status: BEGIN in 1.837 seconds
[0m18:58:02.828984 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:58:02.829493 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_h8qz"."dbt"."trips_prep"
  );
  
[0m18:58:02.926159 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.199 seconds
[0m18:58:02.929660 [debug] [Thread-1 (]: On "dev_h8qz"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m18:58:02.930958 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:58:02.931685 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m18:58:02.932374 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m18:58:03.028576 [debug] [Thread-1 (]: SQL status: COMMIT in 0.095 seconds
[0m18:58:03.030210 [debug] [Thread-1 (]: On model.dbt_scooters.revenue_daily: Close
[0m18:58:03.031587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11176ca70>]}
[0m18:58:03.032757 [info ] [Thread-1 (]: 11 of 24 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 2.56s]
[0m18:58:03.033518 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.revenue_daily
[0m18:58:03.033947 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_full
[0m18:58:03.034580 [info ] [Thread-1 (]: 15 of 24 START sql view model dbt.events_full .................................. [RUN]
[0m18:58:03.035160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.events_full)
[0m18:58:03.035571 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_full
[0m18:58:03.038515 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m18:58:03.040939 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_full
[0m18:58:03.044251 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m18:58:03.045116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:58:03.045389 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: BEGIN
[0m18:58:03.045626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:04.974584 [debug] [Thread-1 (]: SQL status: BEGIN in 1.928 seconds
[0m18:58:04.975638 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:58:04.976282 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_h8qz"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_h8qz"."dbt"."events_clean"
    left join "dev_h8qz"."dbt"."event_types"
        using (type_id)
  );
[0m18:58:05.383608 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.406 seconds
[0m18:58:05.391252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:58:05.392061 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_h8qz"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m18:58:05.587978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.195 seconds
[0m18:58:05.592844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:58:05.593404 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_h8qz"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m18:58:05.793038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.199 seconds
[0m18:58:05.795898 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:58:05.796866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:58:05.797505 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m18:58:05.998335 [debug] [Thread-1 (]: SQL status: COMMIT in 0.200 seconds
[0m18:58:06.003606 [debug] [Thread-1 (]: Applying DROP to: "dev_h8qz"."dbt"."events_full__dbt_backup"
[0m18:58:06.004639 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m18:58:06.005144 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_h8qz"."dbt"."events_full__dbt_backup" cascade
[0m18:58:06.106034 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.100 seconds
[0m18:58:06.110245 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: Close
[0m18:58:06.111580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11176cf50>]}
[0m18:58:06.112547 [info ] [Thread-1 (]: 15 of 24 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 3.08s]
[0m18:58:06.113293 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_full
[0m18:58:06.113783 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m18:58:06.114382 [info ] [Thread-1 (]: 16 of 24 START sql table model dbt.companies ................................... [RUN]
[0m18:58:06.115026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.companies)
[0m18:58:06.115457 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m18:58:06.119446 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m18:58:06.121822 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m18:58:06.126316 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m18:58:06.126979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:58:06.127246 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m18:58:06.127482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:07.535742 [debug] [Thread-1 (]: SQL status: BEGIN in 1.408 seconds
[0m18:58:07.537395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:58:07.538527 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_h8qz"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_h8qz"."dbt"."scooters"
group by
    1
  );
  
[0m18:58:07.946798 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.407 seconds
[0m18:58:07.953174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:58:07.953850 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_h8qz"."dbt"."companies" rename to "companies__dbt_backup"
[0m18:58:08.046010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m18:58:08.052776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:58:08.053699 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_h8qz"."dbt"."companies__dbt_tmp" rename to "companies"
[0m18:58:08.148340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:58:08.153443 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m18:58:08.154113 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:58:08.154592 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m18:58:08.250936 [debug] [Thread-1 (]: SQL status: COMMIT in 0.096 seconds
[0m18:58:08.255189 [debug] [Thread-1 (]: Applying DROP to: "dev_h8qz"."dbt"."companies__dbt_backup"
[0m18:58:08.256323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m18:58:08.256917 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_h8qz"."dbt"."companies__dbt_backup" cascade
[0m18:58:08.456350 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.198 seconds
[0m18:58:08.460203 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m18:58:08.461582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11176fd10>]}
[0m18:58:08.462503 [info ] [Thread-1 (]: 16 of 24 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 2.35s]
[0m18:58:08.463156 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m18:58:08.463578 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_users
[0m18:58:08.464244 [info ] [Thread-1 (]: 17 of 24 START sql incremental model dbt.trips_users ........................... [RUN]
[0m18:58:08.464900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.trips_users)
[0m18:58:08.465294 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_users
[0m18:58:08.469399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m18:58:08.470252 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_users
[0m18:58:08.474037 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:58:08.474521 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp185808472791"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_h8qz"."dbt"."trips_prep" as t
left join
    "dev_h8qz"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_h8qz"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m18:58:08.474840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:11.937617 [debug] [Thread-2 (]: SQL status: SELECT 1 in 9.107 seconds
[0m18:58:11.945047 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:58:11.945512 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_h8qz"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m18:58:12.142441 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.196 seconds
[0m18:58:12.148707 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:58:12.149360 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_h8qz"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m18:58:12.243343 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m18:58:12.255306 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m18:58:12.255873 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:58:12.256271 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m18:58:12.347082 [debug] [Thread-2 (]: SQL status: COMMIT in 0.090 seconds
[0m18:58:12.355028 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_stat__dbt_backup"
[0m18:58:12.356933 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m18:58:12.358129 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_h8qz"."dbt"."trips_stat__dbt_backup" cascade
[0m18:58:12.449455 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.090 seconds
[0m18:58:12.454309 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat: Close
[0m18:58:12.456742 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11402d490>]}
[0m18:58:12.458042 [info ] [Thread-2 (]: 12 of 24 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 11.47s]
[0m18:58:12.459096 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat
[0m18:58:12.459795 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_stat
[0m18:58:12.460603 [info ] [Thread-2 (]: 18 of 24 START sql table model dbt.events_stat ................................. [RUN]
[0m18:58:12.461276 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.events_stat)
[0m18:58:12.461761 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_stat
[0m18:58:12.465920 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m18:58:12.468654 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_stat
[0m18:58:12.473088 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m18:58:12.474593 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:58:12.475044 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: BEGIN
[0m18:58:12.475371 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:14.090888 [debug] [Thread-2 (]: SQL status: BEGIN in 1.615 seconds
[0m18:58:14.092325 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:58:14.093135 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_h8qz"."dbt"."events_full"
  );
  
[0m18:58:16.444884 [debug] [Thread-1 (]: SQL status: SELECT 30901 in 7.970 seconds
[0m18:58:16.451294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:58:16.452130 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: BEGIN
[0m18:58:16.545568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.093 seconds
[0m18:58:16.546375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:58:16.547032 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp185808472791'
        
      order by ordinal_position

  
[0m18:58:16.955772 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.407 seconds
[0m18:58:16.961603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:58:16.962250 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:58:17.263972 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.301 seconds
[0m18:58:17.272993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:58:17.273795 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp185808472791'
        
      order by ordinal_position

  
[0m18:58:17.774685 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.500 seconds
[0m18:58:17.781629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:58:17.782180 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m18:58:18.389045 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.606 seconds
[0m18:58:18.397444 [debug] [Thread-1 (]: 
    In "dev_h8qz"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:58:18.404182 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m18:58:18.405708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:58:18.406260 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_h8qz"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp185808472791"
    )


  
[0m18:58:22.484205 [debug] [Thread-1 (]: SQL status: INSERT 0 30901 in 4.077 seconds
[0m18:58:22.485279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:58:22.485527 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m18:58:28.833691 [debug] [Thread-2 (]: SQL status: SELECT 1 in 14.739 seconds
[0m18:58:28.842554 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:58:28.843325 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_h8qz"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m18:58:28.936199 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m18:58:28.943451 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:58:28.943983 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_h8qz"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m18:58:29.038150 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:58:29.039442 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: COMMIT
[0m18:58:29.039767 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:58:29.040065 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: COMMIT
[0m18:58:29.140971 [debug] [Thread-2 (]: SQL status: COMMIT in 0.100 seconds
[0m18:58:29.148580 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."events_stat__dbt_backup"
[0m18:58:29.149666 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m18:58:29.150271 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_h8qz"."dbt"."events_stat__dbt_backup" cascade
[0m18:58:29.242866 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.092 seconds
[0m18:58:29.244789 [debug] [Thread-2 (]: On model.dbt_scooters.events_stat: Close
[0m18:58:29.245734 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f8590>]}
[0m18:58:29.246453 [info ] [Thread-2 (]: 18 of 24 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 16.78s]
[0m18:58:29.246855 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_stat
[0m18:58:29.247153 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies_trips
[0m18:58:29.247680 [info ] [Thread-2 (]: 19 of 24 START sql table model dbt.companies_trips ............................. [RUN]
[0m18:58:29.248194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now model.dbt_scooters.companies_trips)
[0m18:58:29.248553 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies_trips
[0m18:58:29.251492 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m18:58:29.253167 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies_trips
[0m18:58:29.255527 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m18:58:29.256079 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:58:29.256339 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m18:58:29.256574 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:31.700570 [debug] [Thread-2 (]: SQL status: BEGIN in 2.444 seconds
[0m18:58:31.701044 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:58:31.701367 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_h8qz"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_h8qz"."dbt"."trips_prep" as t
        join "dev_h8qz"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_h8qz"."dbt"."companies" as c
        using (company)
  );
  
[0m18:58:34.111143 [debug] [Thread-2 (]: SQL status: SELECT 6 in 2.409 seconds
[0m18:58:34.115769 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:58:34.116236 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_h8qz"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m18:58:34.260898 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.144 seconds
[0m18:58:34.265930 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:58:34.266473 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_h8qz"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m18:58:34.571476 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.304 seconds
[0m18:58:34.575480 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:58:34.576389 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:58:34.577053 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m18:58:34.772306 [debug] [Thread-2 (]: SQL status: COMMIT in 0.195 seconds
[0m18:58:34.774141 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."companies_trips__dbt_backup"
[0m18:58:34.775078 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m18:58:34.775328 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_h8qz"."dbt"."companies_trips__dbt_backup" cascade
[0m18:58:35.079523 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.304 seconds
[0m18:58:35.080777 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: Close
[0m18:58:35.081347 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f8590>]}
[0m18:58:35.081750 [info ] [Thread-2 (]: 19 of 24 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 5.83s]
[0m18:58:35.082060 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies_trips
[0m18:58:35.082396 [debug] [Thread-2 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m18:58:35.082580 [info ] [Thread-2 (]: 20 of 24 START test unique_companies_trips_company ............................. [RUN]
[0m18:58:35.082793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m18:58:35.082964 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m18:58:35.086959 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m18:58:35.088831 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m18:58:35.089929 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m18:58:35.090323 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m18:58:35.090483 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m18:58:35.090641 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:36.308824 [debug] [Thread-2 (]: SQL status: BEGIN in 1.218 seconds
[0m18:58:36.309417 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m18:58:36.309847 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_h8qz"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:58:36.418061 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.108 seconds
[0m18:58:36.420088 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m18:58:36.515141 [debug] [Thread-2 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m18:58:36.517901 [info ] [Thread-2 (]: 20 of 24 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 1.43s]
[0m18:58:36.519208 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m18:58:39.484749 [debug] [Thread-4 (]: SQL status: SELECT 142 in 36.964 seconds
[0m18:58:39.486378 [debug] [Thread-1 (]: SQL status: ANALYZE in 17.000 seconds
[0m18:58:39.492855 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:58:39.494053 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m18:58:39.494530 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_h8qz"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m18:58:39.494942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:58:39.495689 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: COMMIT
[0m18:58:39.585920 [debug] [Thread-1 (]: SQL status: COMMIT in 0.089 seconds
[0m18:58:39.588182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:58:39.589436 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m18:58:39.653469 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.158 seconds
[0m18:58:39.662769 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:58:39.663480 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_h8qz"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m18:58:39.791835 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.128 seconds
[0m18:58:39.792442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.202 seconds
[0m18:58:39.794606 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m18:58:39.796085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m18:58:39.796633 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:58:39.797095 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m18:58:39.797506 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m18:58:39.893229 [debug] [Thread-4 (]: SQL status: COMMIT in 0.095 seconds
[0m18:58:39.894786 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."parking_start_stat__dbt_backup"
[0m18:58:39.895157 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m18:58:39.895371 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_h8qz"."dbt"."parking_start_stat__dbt_backup" cascade
[0m18:58:40.097276 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.202 seconds
[0m18:58:40.099538 [debug] [Thread-4 (]: On model.dbt_scooters.parking_start_stat: Close
[0m18:58:40.100493 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11176e9f0>]}
[0m18:58:40.101080 [info ] [Thread-4 (]: 14 of 24 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 38.60s]
[0m18:58:40.101441 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m18:58:40.715027 [debug] [Thread-1 (]: SQL status: VACUUM in 0.917 seconds
[0m18:58:40.716195 [debug] [Thread-1 (]: On model.dbt_scooters.trips_users: Close
[0m18:58:40.716791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11176e870>]}
[0m18:58:40.717211 [info ] [Thread-1 (]: 17 of 24 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 30901[0m in 32.25s]
[0m18:58:40.717568 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_users
[0m18:58:40.717953 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_daily
[0m18:58:40.718330 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_age_group
[0m18:58:40.718644 [info ] [Thread-2 (]: 21 of 24 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m18:58:40.718947 [info ] [Thread-4 (]: 22 of 24 START sql table model dbt.trips_age_group ............................. [RUN]
[0m18:58:40.719212 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now model.dbt_scooters.trips_age_daily)
[0m18:58:40.719420 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.parking_start_stat, now model.dbt_scooters.trips_age_group)
[0m18:58:40.719614 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m18:58:40.719790 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m18:58:40.721474 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m18:58:40.723367 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m18:58:40.724048 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_age_group
[0m18:58:40.724311 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m18:58:40.726512 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m18:58:40.728196 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m18:58:40.728717 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:58:40.728940 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:58:40.729123 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m18:58:40.729300 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m18:58:40.729470 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:40.729632 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:58:42.659597 [debug] [Thread-4 (]: SQL status: BEGIN in 1.929 seconds
[0m18:58:42.661448 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:58:42.662715 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_h8qz"."dbt"."trips_users" as tu
    cross join "dev_h8qz"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m18:58:42.763482 [debug] [Thread-2 (]: SQL status: BEGIN in 2.033 seconds
[0m18:58:42.765120 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:58:42.765982 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_h8qz"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m18:58:45.111376 [debug] [Thread-2 (]: SQL status: SELECT 7049 in 2.345 seconds
[0m18:58:45.113694 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:58:45.113920 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_h8qz"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m18:58:45.218984 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.105 seconds
[0m18:58:45.220701 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:58:45.220895 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_h8qz"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m18:58:45.319901 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.099 seconds
[0m18:58:45.320951 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m18:58:45.321153 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:58:45.321295 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m18:58:45.422246 [debug] [Thread-2 (]: SQL status: COMMIT in 0.101 seconds
[0m18:58:45.424023 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_age_daily__dbt_backup"
[0m18:58:45.424404 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m18:58:45.424602 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_h8qz"."dbt"."trips_age_daily__dbt_backup" cascade
[0m18:58:45.524645 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.100 seconds
[0m18:58:45.526037 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily: Close
[0m18:58:45.526789 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11176e8d0>]}
[0m18:58:45.527282 [info ] [Thread-2 (]: 21 of 24 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 4.81s]
[0m18:58:45.527670 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m18:58:45.528125 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m18:58:45.528462 [info ] [Thread-1 (]: 23 of 24 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m18:58:45.528784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m18:58:45.529034 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m18:58:45.532519 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m18:58:45.533192 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m18:58:45.534709 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m18:58:45.535399 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m18:58:45.535661 [debug] [Thread-1 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m18:58:45.535878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:46.958412 [debug] [Thread-1 (]: SQL status: BEGIN in 1.422 seconds
[0m18:58:46.958878 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m18:58:46.959197 [debug] [Thread-1 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_h8qz"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:58:47.471082 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.511 seconds
[0m18:58:47.476635 [debug] [Thread-1 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m18:58:47.675320 [debug] [Thread-1 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m18:58:47.676869 [info ] [Thread-1 (]: 23 of 24 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 2.15s]
[0m18:58:47.677598 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m18:58:47.678347 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m18:58:47.679010 [info ] [Thread-2 (]: 24 of 24 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m18:58:47.679833 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now model.dbt_scooters.trips_age_daily_stat)
[0m18:58:47.680403 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m18:58:47.683604 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m18:58:47.684894 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m18:58:47.692180 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m18:58:47.692925 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:58:47.693213 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m18:58:47.693465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:48.392676 [debug] [Thread-3 (]: SQL status: SELECT 464 in 45.966 seconds
[0m18:58:48.399667 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:58:48.400369 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_h8qz"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m18:58:48.597395 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.196 seconds
[0m18:58:48.604761 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:58:48.605523 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_h8qz"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m18:58:48.702952 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.096 seconds
[0m18:58:48.707718 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m18:58:48.708629 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:58:48.709356 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m18:58:48.802903 [debug] [Thread-3 (]: SQL status: COMMIT in 0.092 seconds
[0m18:58:48.808957 [debug] [Thread-3 (]: Applying DROP to: "dev_h8qz"."dbt"."parking_finish_stat__dbt_backup"
[0m18:58:48.810115 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m18:58:48.810788 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_h8qz"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m18:58:49.006789 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.195 seconds
[0m18:58:49.007879 [debug] [Thread-2 (]: SQL status: BEGIN in 1.314 seconds
[0m18:58:49.010430 [debug] [Thread-3 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m18:58:49.011056 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:58:49.011708 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_h8qz"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m18:58:49.012532 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f9370>]}
[0m18:58:49.013506 [info ] [Thread-3 (]: 13 of 24 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 47.82s]
[0m18:58:49.014302 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m18:58:49.314170 [debug] [Thread-2 (]: SQL status: SELECT 83 in 0.301 seconds
[0m18:58:49.321306 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:58:49.322039 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_h8qz"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m18:58:49.416736 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m18:58:49.423918 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:58:49.424489 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_h8qz"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m18:58:49.518619 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m18:58:49.522327 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m18:58:49.522968 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:58:49.523527 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m18:58:49.620857 [debug] [Thread-2 (]: SQL status: COMMIT in 0.097 seconds
[0m18:58:49.622862 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_age_daily_stat__dbt_backup"
[0m18:58:49.623347 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m18:58:49.623631 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_h8qz"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m18:58:49.826225 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.202 seconds
[0m18:58:49.827845 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m18:58:49.828718 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110eb530>]}
[0m18:58:49.829356 [info ] [Thread-2 (]: 24 of 24 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 2.15s]
[0m18:58:49.829884 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m18:58:57.403336 [debug] [Thread-4 (]: SQL status: SELECT 7 in 14.740 seconds
[0m18:58:57.408391 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:58:57.409097 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_h8qz"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m18:58:57.505963 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.096 seconds
[0m18:58:57.511835 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:58:57.512462 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_h8qz"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m18:58:57.608679 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.095 seconds
[0m18:58:57.612542 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m18:58:57.613335 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:58:57.613844 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m18:58:57.813230 [debug] [Thread-4 (]: SQL status: COMMIT in 0.199 seconds
[0m18:58:57.817723 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_age_group__dbt_backup"
[0m18:58:57.818659 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m18:58:57.819305 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_h8qz"."dbt"."trips_age_group__dbt_backup" cascade
[0m18:58:57.915745 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.096 seconds
[0m18:58:57.918739 [debug] [Thread-4 (]: On model.dbt_scooters.trips_age_group: Close
[0m18:58:57.920243 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f20794fb-4156-462d-80a4-9fba5323bf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11176f350>]}
[0m18:58:57.921366 [info ] [Thread-4 (]: 22 of 24 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 17.20s]
[0m18:58:57.922379 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_age_group
[0m18:58:57.925107 [info ] [MainThread]: 
[0m18:58:57.925810 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:57.926243 [debug] [MainThread]: On master: BEGIN
[0m18:58:57.926599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:59.861814 [debug] [MainThread]: SQL status: BEGIN in 1.935 seconds
[0m18:58:59.862874 [debug] [MainThread]: On master: COMMIT
[0m18:58:59.863596 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:59.864060 [debug] [MainThread]: On master: COMMIT
[0m18:58:59.913939 [debug] [MainThread]: SQL status: COMMIT in 0.049 seconds
[0m18:58:59.918304 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m18:58:59.925634 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m18:58:59.926449 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:59.926929 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m18:59:00.066097 [debug] [MainThread]: SQL status: GRANT in 0.138 seconds
[0m18:59:00.068303 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.15s]
[0m18:59:00.069057 [debug] [MainThread]: On master: Close
[0m18:59:00.070296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:00.070779 [debug] [MainThread]: Connection 'test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e' was properly closed.
[0m18:59:00.071079 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m18:59:00.071372 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m18:59:00.071667 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m18:59:00.072223 [info ] [MainThread]: 
[0m18:59:00.073050 [info ] [MainThread]: Finished running 3 incremental models, 1 project hook, 3 seeds, 12 table models, 4 data tests, 2 view models in 0 hours 1 minutes and 12.36 seconds (72.36s).
[0m18:59:00.076837 [debug] [MainThread]: Command end result
[0m18:59:00.098785 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m18:59:00.100024 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m18:59:00.104275 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m18:59:00.104469 [info ] [MainThread]: 
[0m18:59:00.104667 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m18:59:00.104826 [info ] [MainThread]: 
[0m18:59:00.105020 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models/properties.yml)[0m
[0m18:59:00.105204 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m18:59:00.105336 [info ] [MainThread]: 
[0m18:59:00.105508 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/source_not_null_scooters_raw_users_sex.sql
[0m18:59:00.105685 [info ] [MainThread]: 
[0m18:59:00.105852 [info ] [MainThread]: Done. PASS=24 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=25
[0m18:59:00.106139 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PropertyMovedToConfigDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:59:00.107106 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 73.21584, "process_in_blocks": "0", "process_kernel_time": 0.271355, "process_mem_max_rss": "156778496", "process_out_blocks": "0", "process_user_time": 2.661539}
[0m18:59:00.107351 [debug] [MainThread]: Command `dbt build` succeeded at 18:59:00.107302 after 73.22 seconds
[0m18:59:00.107556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103908770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117abcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117ab710>]}
[0m18:59:00.107745 [debug] [MainThread]: Flushing usage events
[0m18:59:01.297760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:59:17.635202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f934d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a92b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a92bb10>]}


============================== 18:59:17.636951 | bf8159ab-5574-4f5f-9f8d-17c946d39d48 ==============================
[0m18:59:17.636951 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:59:17.637210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:59:17.700634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf8159ab-5574-4f5f-9f8d-17c946d39d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108793490>]}
[0m18:59:17.721499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf8159ab-5574-4f5f-9f8d-17c946d39d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6c1f20>]}
[0m18:59:17.721851 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:59:17.755859 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:59:17.818411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:59:17.819144 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://models/properties.yml
[0m18:59:18.023472 [warn ] [MainThread]: [[33mWARNING[0m][ArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found `arguments` property in test definition of `relationships` ({'name':
'every_trip_has_user', 'to': "source('scooters_raw', 'users')", 'field': 'id'})
without usage of `require_generic_test_arguments_property` behavior change flag.
The `arguments` property is deprecated for custom usage and will be used to nest
keyword arguments in future versions of dbt.
[0m18:59:18.023765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bf8159ab-5574-4f5f-9f8d-17c946d39d48', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b65a350>]}
[0m18:59:18.030838 [error] [MainThread]: Encountered an error:
Compilation Error in test source_relationships_scooters_raw_trips_every_trip_has_user__source_scooters_raw_users___id__user_id (models/properties.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'arguments'
[0m18:59:18.031135 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:59:18.031882 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.42116055, "process_in_blocks": "0", "process_kernel_time": 0.093328, "process_mem_max_rss": "125517824", "process_out_blocks": "0", "process_user_time": 0.85989}
[0m18:59:18.032068 [debug] [MainThread]: Command `dbt build` failed at 18:59:18.032033 after 0.42 seconds
[0m18:59:18.032211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2db6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c794320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a90be70>]}
[0m18:59:18.032347 [debug] [MainThread]: Flushing usage events
[0m18:59:18.807498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:37.881791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d3b10>]}


============================== 19:00:37.883560 | 85e04809-031c-473a-a04f-bb8461dd7d88 ==============================
[0m19:00:37.883560 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:00:37.883822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'profiles_dir': '/Users/flerinvs/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:00:37.946581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d7490>]}
[0m19:00:37.967292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107269f20>]}
[0m19:00:37.967624 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:00:38.000817 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:00:38.060978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:38.061159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:38.086701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216b4950>]}
[0m19:00:38.129545 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m19:00:38.130384 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m19:00:38.141313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219ffe30>]}
[0m19:00:38.141517 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 6 data tests, 15 sources, 439 macros
[0m19:00:38.142904 [info ] [MainThread]: 
[0m19:00:38.143056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:38.143169 [info ] [MainThread]: 
[0m19:00:38.143367 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:38.145239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m19:00:38.145481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m19:00:38.165849 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m19:00:38.166045 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m19:00:38.166191 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m19:00:38.166321 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m19:00:38.166436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:38.166540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:39.395567 [debug] [ThreadPool]: SQL status: SELECT 17 in 1.229 seconds
[0m19:00:39.396554 [debug] [ThreadPool]: SQL status: SELECT 17 in 1.230 seconds
[0m19:00:39.399035 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m19:00:39.400679 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m19:00:39.404783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now list_dev_h8qz_finance)
[0m19:00:39.411690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now list_dev_h8qz_dbt)
[0m19:00:39.412329 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m19:00:39.413870 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m19:00:39.414201 [debug] [ThreadPool]: On list_dev_h8qz_finance: BEGIN
[0m19:00:39.414493 [debug] [ThreadPool]: On list_dev_h8qz_dbt: BEGIN
[0m19:00:39.414738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:39.414966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:40.419797 [debug] [ThreadPool]: SQL status: BEGIN in 1.004 seconds
[0m19:00:40.421625 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m19:00:40.422772 [debug] [ThreadPool]: On list_dev_h8qz_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_dbt"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m19:00:40.525392 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.101 seconds
[0m19:00:40.531458 [debug] [ThreadPool]: On list_dev_h8qz_dbt: ROLLBACK
[0m19:00:40.624507 [debug] [ThreadPool]: On list_dev_h8qz_dbt: Close
[0m19:00:40.831040 [debug] [ThreadPool]: SQL status: BEGIN in 1.416 seconds
[0m19:00:40.832546 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m19:00:40.833657 [debug] [ThreadPool]: On list_dev_h8qz_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_finance"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m19:00:40.931673 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.097 seconds
[0m19:00:40.935871 [debug] [ThreadPool]: On list_dev_h8qz_finance: ROLLBACK
[0m19:00:41.033852 [debug] [ThreadPool]: On list_dev_h8qz_finance: Close
[0m19:00:41.098589 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:41.098867 [debug] [MainThread]: On master: BEGIN
[0m19:00:41.099007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:42.979706 [debug] [MainThread]: SQL status: BEGIN in 1.880 seconds
[0m19:00:42.981322 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:42.982655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:00:43.082040 [debug] [MainThread]: SQL status: SELECT 3 in 0.098 seconds
[0m19:00:43.088027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219bf5b0>]}
[0m19:00:43.089512 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:43.184443 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:43.185303 [debug] [MainThread]: On master: BEGIN
[0m19:00:43.390800 [debug] [MainThread]: SQL status: BEGIN in 0.205 seconds
[0m19:00:43.392238 [debug] [MainThread]: On master: COMMIT
[0m19:00:43.393264 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:43.394168 [debug] [MainThread]: On master: COMMIT
[0m19:00:43.492995 [debug] [MainThread]: SQL status: COMMIT in 0.098 seconds
[0m19:00:43.494239 [debug] [MainThread]: On master: Close
[0m19:00:43.501213 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.age_groups
[0m19:00:43.501965 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_stat_daily
[0m19:00:43.502571 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m19:00:43.503125 [debug] [Thread-4 (]: Began running node seed.dbt_scooters.event_types
[0m19:00:43.503992 [info ] [Thread-3 (]: 3 of 26 START seed file dbt.age_groups ......................................... [RUN]
[0m19:00:43.504854 [info ] [Thread-2 (]: 2 of 26 START sql table model dbt.trips_stat_daily ............................. [RUN]
[0m19:00:43.505708 [info ] [Thread-1 (]: 1 of 26 START sql incremental model dbt.events_clean ........................... [RUN]
[0m19:00:43.506491 [info ] [Thread-4 (]: 4 of 26 START seed file dbt.event_types ........................................ [RUN]
[0m19:00:43.507264 [debug] [Thread-3 (]: Acquiring new postgres connection 'seed.dbt_scooters.age_groups'
[0m19:00:43.507816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_dbt, now model.dbt_scooters.trips_stat_daily)
[0m19:00:43.508308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_finance, now model.dbt_scooters.events_clean)
[0m19:00:43.508847 [debug] [Thread-4 (]: Acquiring new postgres connection 'seed.dbt_scooters.event_types'
[0m19:00:43.509309 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.age_groups
[0m19:00:43.509720 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_stat_daily
[0m19:00:43.510106 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m19:00:43.510573 [debug] [Thread-4 (]: Began compiling node seed.dbt_scooters.event_types
[0m19:00:43.511057 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.age_groups
[0m19:00:43.519575 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat_daily"
[0m19:00:43.529485 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m19:00:43.529853 [debug] [Thread-4 (]: Began executing node seed.dbt_scooters.event_types
[0m19:00:43.546662 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m19:00:43.547014 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m19:00:43.547780 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m19:00:43.547912 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_stat_daily
[0m19:00:43.548057 [debug] [Thread-3 (]: On seed.dbt_scooters.age_groups: BEGIN
[0m19:00:43.567087 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: BEGIN
[0m19:00:43.572550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m19:00:43.577943 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat_daily"
[0m19:00:43.578111 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:00:43.578249 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:00:43.578395 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp190043563275"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_h8qz"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_h8qz"."dbt"."events_clean")
    

  );
  
  
[0m19:00:43.578740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:43.579043 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m19:00:43.579180 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: BEGIN
[0m19:00:43.579300 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:44.573583 [debug] [Thread-2 (]: SQL status: BEGIN in 0.994 seconds
[0m19:00:44.575060 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m19:00:44.575722 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_stat_daily__dbt_tmp"
  
  
    as
  
  (
    select
    date(started_at) as date,
    count(*) as trips,
    max(price) / 100 as max_price_rub,
    avg(distance) / 1000 as avg_distance_km
from
    scooters_raw.trips
group by
    1
order by
    1
  );
  
[0m19:00:44.822652 [debug] [Thread-3 (]: SQL status: BEGIN in 1.244 seconds
[0m19:00:44.823161 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m19:00:44.823503 [debug] [Thread-3 (]: On seed.dbt_scooters.age_groups: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.age_groups"} */
truncate table "dev_h8qz"."dbt"."age_groups"
[0m19:00:44.926010 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.102 seconds
[0m19:00:44.950383 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m19:00:44.950867 [debug] [Thread-3 (]: On seed.dbt_scooters.age_groups: 
          insert into "dev_h8qz"."dbt"."age_groups" ("group", "age_start", "age_end") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m19:00:45.029665 [debug] [Thread-3 (]: SQL status: INSERT 0 8 in 0.078 seconds
[0m19:00:45.042141 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.age_groups"
[0m19:00:45.056043 [debug] [Thread-3 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m19:00:45.056450 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.age_groups"
[0m19:00:45.056703 [debug] [Thread-3 (]: On seed.dbt_scooters.age_groups: COMMIT
[0m19:00:45.130005 [debug] [Thread-3 (]: SQL status: COMMIT in 0.073 seconds
[0m19:00:45.133300 [debug] [Thread-3 (]: On seed.dbt_scooters.age_groups: Close
[0m19:00:45.136074 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122634e20>]}
[0m19:00:45.136805 [info ] [Thread-3 (]: 3 of 26 OK loaded seed file dbt.age_groups ..................................... [[32mINSERT 8[0m in 1.63s]
[0m19:00:45.137452 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.age_groups
[0m19:00:45.137908 [debug] [Thread-3 (]: Began running node seed.dbt_scooters.scooters
[0m19:00:45.138538 [info ] [Thread-3 (]: 5 of 26 START seed file dbt.scooters ........................................... [RUN]
[0m19:00:45.139063 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.age_groups, now seed.dbt_scooters.scooters)
[0m19:00:45.139752 [debug] [Thread-3 (]: Began compiling node seed.dbt_scooters.scooters
[0m19:00:45.140296 [debug] [Thread-3 (]: Began executing node seed.dbt_scooters.scooters
[0m19:00:45.146447 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m19:00:45.146919 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: BEGIN
[0m19:00:45.147217 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:00:45.540170 [debug] [Thread-4 (]: SQL status: BEGIN in 1.961 seconds
[0m19:00:45.542001 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m19:00:45.543238 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.event_types"} */
truncate table "dev_h8qz"."dbt"."event_types"
[0m19:00:45.645205 [debug] [Thread-4 (]: SQL status: TRUNCATE TABLE in 0.101 seconds
[0m19:00:45.652885 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m19:00:45.653401 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: 
          insert into "dev_h8qz"."dbt"."event_types" ("type_id", "type") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
[0m19:00:45.744554 [debug] [Thread-4 (]: SQL status: INSERT 0 4 in 0.090 seconds
[0m19:00:45.746865 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_scooters.event_types"
[0m19:00:45.750722 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: COMMIT
[0m19:00:45.751228 [debug] [Thread-4 (]: Using postgres connection "seed.dbt_scooters.event_types"
[0m19:00:45.751843 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: COMMIT
[0m19:00:45.847486 [debug] [Thread-4 (]: SQL status: COMMIT in 0.095 seconds
[0m19:00:45.850567 [debug] [Thread-4 (]: On seed.dbt_scooters.event_types: Close
[0m19:00:45.852194 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219c6390>]}
[0m19:00:45.853085 [info ] [Thread-4 (]: 4 of 26 OK loaded seed file dbt.event_types .................................... [[32mINSERT 4[0m in 2.34s]
[0m19:00:45.853792 [debug] [Thread-4 (]: Finished running node seed.dbt_scooters.event_types
[0m19:00:45.854343 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m19:00:45.854880 [info ] [Thread-4 (]: 6 of 26 START test source_accepted_values_scooters_raw_users_sex__M__F ......... [RUN]
[0m19:00:45.855461 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.event_types, now test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b)
[0m19:00:45.855862 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m19:00:45.868286 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m19:00:45.869078 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m19:00:45.882442 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m19:00:45.882982 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m19:00:45.883197 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: BEGIN
[0m19:00:45.883384 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:00:46.256791 [debug] [Thread-3 (]: SQL status: BEGIN in 1.109 seconds
[0m19:00:46.258408 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m19:00:46.259533 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "seed.dbt_scooters.scooters"} */
truncate table "dev_h8qz"."dbt"."scooters"
[0m19:00:46.359360 [debug] [Thread-2 (]: SQL status: SELECT 91 in 1.782 seconds
[0m19:00:46.361032 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.100 seconds
[0m19:00:46.377076 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m19:00:46.378418 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m19:00:46.378825 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: 
          insert into "dev_h8qz"."dbt"."scooters" ("company", "model", "hardware_id", "scooters") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)
      ...
[0m19:00:46.379224 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_h8qz"."dbt"."trips_stat_daily" rename to "trips_stat_daily__dbt_backup"
[0m19:00:46.463157 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.083 seconds
[0m19:00:46.464714 [debug] [Thread-3 (]: SQL status: INSERT 0 10 in 0.085 seconds
[0m19:00:46.465664 [debug] [Thread-1 (]: SQL status: SELECT 0 in 2.887 seconds
[0m19:00:46.471033 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m19:00:46.472193 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_scooters.scooters"
[0m19:00:46.488347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m19:00:46.488859 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
alter table "dev_h8qz"."dbt"."trips_stat_daily__dbt_tmp" rename to "trips_stat_daily"
[0m19:00:46.489301 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m19:00:46.490761 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: COMMIT
[0m19:00:46.491060 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_scooters.scooters"
[0m19:00:46.491300 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: COMMIT
[0m19:00:46.565299 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.075 seconds
[0m19:00:46.566308 [debug] [Thread-3 (]: SQL status: COMMIT in 0.075 seconds
[0m19:00:46.566970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m19:00:46.573346 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m19:00:46.574466 [debug] [Thread-3 (]: On seed.dbt_scooters.scooters: Close
[0m19:00:46.574951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m19:00:46.575396 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m19:00:46.575907 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp190043563275'
        
      order by ordinal_position

  
[0m19:00:46.576726 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12267d020>]}
[0m19:00:46.577065 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: COMMIT
[0m19:00:46.577789 [info ] [Thread-3 (]: 5 of 26 OK loaded seed file dbt.scooters ....................................... [[32mINSERT 10[0m in 1.44s]
[0m19:00:46.578471 [debug] [Thread-3 (]: Finished running node seed.dbt_scooters.scooters
[0m19:00:46.578912 [debug] [Thread-3 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m19:00:46.579378 [info ] [Thread-3 (]: 7 of 26 START test source_not_null_scooters_raw_trips_user_id .................. [RUN]
[0m19:00:46.579969 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_scooters.scooters, now test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62)
[0m19:00:46.580308 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m19:00:46.587471 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m19:00:46.588420 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m19:00:46.590869 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m19:00:46.591507 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m19:00:46.591780 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: BEGIN
[0m19:00:46.592025 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:00:46.670846 [debug] [Thread-2 (]: SQL status: COMMIT in 0.092 seconds
[0m19:00:46.680612 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_stat_daily__dbt_backup"
[0m19:00:46.686585 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_stat_daily"
[0m19:00:46.687024 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat_daily"} */
drop table if exists "dev_h8qz"."dbt"."trips_stat_daily__dbt_backup" cascade
[0m19:00:46.770234 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.192 seconds
[0m19:00:46.771720 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.084 seconds
[0m19:00:46.783318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m19:00:46.791608 [debug] [Thread-2 (]: On model.dbt_scooters.trips_stat_daily: Close
[0m19:00:46.792054 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m19:00:46.792815 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226b5d10>]}
[0m19:00:46.793496 [info ] [Thread-2 (]: 2 of 26 OK created sql table model dbt.trips_stat_daily ........................ [[32mSELECT 91[0m in 3.28s]
[0m19:00:46.794073 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_stat_daily
[0m19:00:46.794495 [debug] [Thread-2 (]: Began running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m19:00:46.794936 [info ] [Thread-2 (]: 8 of 26 START test source_not_null_scooters_raw_users_sex ...................... [RUN]
[0m19:00:46.795429 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat_daily, now test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee)
[0m19:00:46.795783 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m19:00:46.799261 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m19:00:46.799884 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m19:00:46.801610 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m19:00:46.802120 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m19:00:46.802384 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: BEGIN
[0m19:00:46.802634 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:46.975238 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.182 seconds
[0m19:00:46.993675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m19:00:46.994125 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp190043563275'
        
      order by ordinal_position

  
[0m19:00:47.161205 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.166 seconds
[0m19:00:47.170977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m19:00:47.171329 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m19:00:47.282531 [debug] [Thread-4 (]: SQL status: BEGIN in 1.399 seconds
[0m19:00:47.284221 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"
[0m19:00:47.285424 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sex as value_field,
        count(*) as n_records

    from "dev_h8qz"."scooters_raw"."users"
    group by sex

)

select *
from all_values
where value_field not in (
    'M','F'
)



  
  
      
    ) dbt_internal_test
[0m19:00:47.383308 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.096 seconds
[0m19:00:47.384892 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.213 seconds
[0m19:00:47.392072 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: ROLLBACK
[0m19:00:47.404709 [debug] [Thread-1 (]: 
    In "dev_h8qz"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:00:47.417118 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m19:00:47.417844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m19:00:47.418122 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        delete from "dev_h8qz"."dbt"."events_clean" as DBT_INTERNAL_DEST
        where (user_id, timestamp, type_id) in (
            select distinct user_id, timestamp, type_id
            from "events_clean__dbt_tmp190043563275" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_h8qz"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp190043563275"
    )
  
[0m19:00:47.487064 [debug] [Thread-4 (]: On test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b: Close
[0m19:00:47.487962 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.069 seconds
[0m19:00:47.490518 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m19:00:47.491725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m19:00:47.491347 [info ] [Thread-4 (]: 6 of 26 PASS source_accepted_values_scooters_raw_users_sex__M__F ............... [[32mPASS[0m in 1.64s]
[0m19:00:47.492232 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m19:00:47.492815 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b
[0m19:00:47.493288 [debug] [Thread-4 (]: Began running node test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691
[0m19:00:47.493761 [info ] [Thread-4 (]: 9 of 26 START test source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_  [RUN]
[0m19:00:47.494394 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b, now test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691)
[0m19:00:47.494867 [debug] [Thread-4 (]: Began compiling node test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691
[0m19:00:47.503878 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691"
[0m19:00:47.504549 [debug] [Thread-4 (]: Began executing node test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691
[0m19:00:47.506377 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691"
[0m19:00:47.507131 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691"
[0m19:00:47.507444 [debug] [Thread-4 (]: On test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691: BEGIN
[0m19:00:47.507700 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:00:47.589185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.096 seconds
[0m19:00:47.590979 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m19:00:47.592219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e5950>]}
[0m19:00:47.593283 [info ] [Thread-1 (]: 1 of 26 OK created sql incremental model dbt.events_clean ...................... [[32mINSERT 0 0[0m in 4.08s]
[0m19:00:47.594207 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m19:00:47.594812 [debug] [Thread-1 (]: Began running node model.dbt_scooters.companies
[0m19:00:47.595606 [info ] [Thread-1 (]: 10 of 26 START sql table model dbt.companies ................................... [RUN]
[0m19:00:47.596398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_clean, now model.dbt_scooters.companies)
[0m19:00:47.596875 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.companies
[0m19:00:47.601570 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.companies"
[0m19:00:47.602503 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.companies
[0m19:00:47.606342 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.companies"
[0m19:00:47.607272 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m19:00:47.607646 [debug] [Thread-1 (]: On model.dbt_scooters.companies: BEGIN
[0m19:00:47.607938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:47.694891 [debug] [Thread-3 (]: SQL status: BEGIN in 1.103 seconds
[0m19:00:47.695844 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"
[0m19:00:47.696566 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "dev_h8qz"."scooters_raw"."trips"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m19:00:47.794028 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.097 seconds
[0m19:00:47.795321 [debug] [Thread-2 (]: SQL status: BEGIN in 0.992 seconds
[0m19:00:47.798099 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: ROLLBACK
[0m19:00:47.798469 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"
[0m19:00:47.799209 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sex
from "dev_h8qz"."scooters_raw"."users"
where sex is null



  
  
      
    ) dbt_internal_test
[0m19:00:47.896259 [debug] [Thread-3 (]: On test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62: Close
[0m19:00:47.897716 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.098 seconds
[0m19:00:47.901619 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: ROLLBACK
[0m19:00:47.902717 [info ] [Thread-3 (]: 7 of 26 PASS source_not_null_scooters_raw_trips_user_id ........................ [[32mPASS[0m in 1.32s]
[0m19:00:47.903843 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62
[0m19:00:47.904496 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_full
[0m19:00:47.905319 [info ] [Thread-3 (]: 11 of 26 START sql view model dbt.events_full .................................. [RUN]
[0m19:00:47.906106 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62, now model.dbt_scooters.events_full)
[0m19:00:47.906581 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_full
[0m19:00:47.910871 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m19:00:47.912335 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_full
[0m19:00:47.929643 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m19:00:47.930294 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m19:00:47.930537 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: BEGIN
[0m19:00:47.930742 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:00:48.000492 [debug] [Thread-2 (]: On test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee: Close
[0m19:00:48.002112 [warn ] [Thread-2 (]: 8 of 26 WARN 216 source_not_null_scooters_raw_users_sex ........................ [[33mWARN 216[0m in 1.21s]
[0m19:00:48.002971 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee
[0m19:00:48.003526 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_concurrency
[0m19:00:48.004151 [info ] [Thread-2 (]: 12 of 26 START sql table model dbt.trips_concurrency ........................... [RUN]
[0m19:00:48.004835 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee, now model.dbt_scooters.trips_concurrency)
[0m19:00:48.005272 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_concurrency
[0m19:00:48.009754 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_concurrency"
[0m19:00:48.010411 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_concurrency
[0m19:00:48.013664 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_concurrency"
[0m19:00:48.014468 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m19:00:48.014806 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: BEGIN
[0m19:00:48.015091 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:48.816965 [debug] [Thread-1 (]: SQL status: BEGIN in 1.208 seconds
[0m19:00:48.818759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m19:00:48.819987 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */

  
    

  create  table "dev_h8qz"."dbt"."companies__dbt_tmp"
  
  
    as
  
  (
    select
    company,
    count(*) as models,
    sum(scooters) as scooters
from
    "dev_h8qz"."dbt"."scooters"
group by
    1
  );
  
[0m19:00:48.919005 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.098 seconds
[0m19:00:48.926333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m19:00:48.926845 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_h8qz"."dbt"."companies" rename to "companies__dbt_backup"
[0m19:00:49.021381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m19:00:49.029281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m19:00:49.029782 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
alter table "dev_h8qz"."dbt"."companies__dbt_tmp" rename to "companies"
[0m19:00:49.123616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m19:00:49.124539 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m19:00:49.124753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m19:00:49.124926 [debug] [Thread-1 (]: On model.dbt_scooters.companies: COMMIT
[0m19:00:49.330331 [debug] [Thread-2 (]: SQL status: BEGIN in 1.315 seconds
[0m19:00:49.331905 [debug] [Thread-1 (]: SQL status: COMMIT in 0.206 seconds
[0m19:00:49.332764 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m19:00:49.337058 [debug] [Thread-1 (]: Applying DROP to: "dev_h8qz"."dbt"."companies__dbt_backup"
[0m19:00:49.337646 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_concurrency__dbt_tmp"
  
  
    as
  
  (
    with
unnest_cte as (
    -- Unnest trip to two rows: start and finish events
    select
        unnest(array[started_at, finished_at]) as "timestamp",
        unnest(array[1, -1]) as increment
    from
        "dev_h8qz"."scooters_raw"."trips"
),
sum_cte as (
    -- Make timestamp unique, group increments, add initial concurrency from history
    select
        "timestamp",
        sum(increment) as increment,
        true as preserve_row
    from
        unnest_cte
    where
    
        "timestamp" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'
    
    group by
        1
    
),
cumsum_cte as (
    -- Integrate increment to get concurrency
    select
        "timestamp",
        sum(increment) over (order by "timestamp") as concurrency,
        preserve_row
    from
        sum_cte
)
select
    "timestamp",
    concurrency,
    
    now() as updated_at

from
    cumsum_cte
where
    preserve_row
order by
    1
  );
  
[0m19:00:49.338436 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.companies"
[0m19:00:49.338924 [debug] [Thread-1 (]: On model.dbt_scooters.companies: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies"} */
drop table if exists "dev_h8qz"."dbt"."companies__dbt_backup" cascade
[0m19:00:49.432436 [debug] [Thread-4 (]: SQL status: BEGIN in 1.924 seconds
[0m19:00:49.433663 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.094 seconds
[0m19:00:49.434689 [debug] [Thread-4 (]: Using postgres connection "test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691"
[0m19:00:49.438953 [debug] [Thread-1 (]: On model.dbt_scooters.companies: Close
[0m19:00:49.439573 [debug] [Thread-4 (]: On test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from "dev_h8qz"."scooters_raw"."trips"
    where user_id is not null
),

parent as (
    select id as to_field
    from "dev_h8qz"."scooters_raw"."users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m19:00:49.440859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226be200>]}
[0m19:00:49.441699 [info ] [Thread-1 (]: 10 of 26 OK created sql table model dbt.companies .............................. [[32mSELECT 6[0m in 1.84s]
[0m19:00:49.442305 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.companies
[0m19:00:49.442734 [debug] [Thread-1 (]: Began running node model.dbt_scooters.trips_geom
[0m19:00:49.443251 [info ] [Thread-1 (]: 13 of 26 START sql table model dbt.trips_geom .................................. [RUN]
[0m19:00:49.443715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies, now model.dbt_scooters.trips_geom)
[0m19:00:49.444066 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.trips_geom
[0m19:00:49.447296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.trips_geom"
[0m19:00:49.448258 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.trips_geom
[0m19:00:49.452043 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.trips_geom"
[0m19:00:49.452725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m19:00:49.453038 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: BEGIN
[0m19:00:49.453339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:49.637345 [debug] [Thread-3 (]: SQL status: BEGIN in 1.706 seconds
[0m19:00:49.638955 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m19:00:49.640097 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_h8qz"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_h8qz"."dbt"."events_clean"
    left join "dev_h8qz"."dbt"."event_types"
        using (type_id)
  );
[0m19:00:49.741242 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.100 seconds
[0m19:00:49.749958 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m19:00:49.750619 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_h8qz"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m19:00:49.840280 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.089 seconds
[0m19:00:49.842808 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m19:00:49.843069 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_h8qz"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m19:00:49.943545 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.100 seconds
[0m19:00:49.945642 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m19:00:49.946169 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m19:00:49.946548 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: COMMIT
[0m19:00:50.045556 [debug] [Thread-3 (]: SQL status: COMMIT in 0.098 seconds
[0m19:00:50.046948 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.607 seconds
[0m19:00:50.051009 [debug] [Thread-3 (]: Applying DROP to: "dev_h8qz"."dbt"."events_full__dbt_backup"
[0m19:00:50.053250 [debug] [Thread-4 (]: On test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691: ROLLBACK
[0m19:00:50.057878 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m19:00:50.058596 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_h8qz"."dbt"."events_full__dbt_backup" cascade
[0m19:00:50.147470 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.088 seconds
[0m19:00:50.148357 [debug] [Thread-4 (]: On test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691: Close
[0m19:00:50.150804 [debug] [Thread-3 (]: On model.dbt_scooters.events_full: Close
[0m19:00:50.152625 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122633590>]}
[0m19:00:50.152048 [info ] [Thread-4 (]: 9 of 26 PASS source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_  [[32mPASS[0m in 2.66s]
[0m19:00:50.154046 [debug] [Thread-4 (]: Finished running node test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691
[0m19:00:50.153550 [info ] [Thread-3 (]: 11 of 26 OK created sql view model dbt.events_full ............................. [[32mCREATE VIEW[0m in 2.25s]
[0m19:00:50.154518 [debug] [Thread-4 (]: Began running node model.dbt_scooters.trips_prep
[0m19:00:50.155121 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_full
[0m19:00:50.155559 [info ] [Thread-4 (]: 14 of 26 START sql view model dbt.trips_prep ................................... [RUN]
[0m19:00:50.156144 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691, now model.dbt_scooters.trips_prep)
[0m19:00:50.156475 [debug] [Thread-3 (]: Began running node model.dbt_scooters.events_stat
[0m19:00:50.156772 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.trips_prep
[0m19:00:50.157169 [info ] [Thread-3 (]: 15 of 26 START sql table model dbt.events_stat ................................. [RUN]
[0m19:00:50.161168 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.trips_prep"
[0m19:00:50.161787 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_full, now model.dbt_scooters.events_stat)
[0m19:00:50.162391 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.events_stat
[0m19:00:50.165591 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.events_stat"
[0m19:00:50.166097 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.trips_prep
[0m19:00:50.168564 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.trips_prep"
[0m19:00:50.169091 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.events_stat
[0m19:00:50.171724 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.events_stat"
[0m19:00:50.172074 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m19:00:50.172434 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: BEGIN
[0m19:00:50.172709 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:00:50.173122 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m19:00:50.173447 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: BEGIN
[0m19:00:50.173695 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:00:50.864981 [debug] [Thread-2 (]: SQL status: SELECT 10 in 1.526 seconds
[0m19:00:50.873327 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m19:00:50.874187 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_h8qz"."dbt"."trips_concurrency" rename to "trips_concurrency__dbt_backup"
[0m19:00:50.968659 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m19:00:50.976168 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m19:00:50.976591 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
alter table "dev_h8qz"."dbt"."trips_concurrency__dbt_tmp" rename to "trips_concurrency"
[0m19:00:51.069478 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m19:00:51.075380 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m19:00:51.075884 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m19:00:51.076273 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: COMMIT
[0m19:00:51.173447 [debug] [Thread-2 (]: SQL status: COMMIT in 0.097 seconds
[0m19:00:51.179286 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_concurrency__dbt_backup"
[0m19:00:51.180049 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_concurrency"
[0m19:00:51.180450 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_concurrency"} */
drop table if exists "dev_h8qz"."dbt"."trips_concurrency__dbt_backup" cascade
[0m19:00:51.278055 [debug] [Thread-1 (]: SQL status: BEGIN in 1.824 seconds
[0m19:00:51.279419 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.098 seconds
[0m19:00:51.280655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m19:00:51.285185 [debug] [Thread-2 (]: On model.dbt_scooters.trips_concurrency: Close
[0m19:00:51.285946 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_geom__dbt_tmp"
  
  
    as
  
  (
    select
    id,
    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,
    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point
from
    "dev_h8qz"."scooters_raw"."trips"
  );
  
[0m19:00:51.287159 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122633d10>]}
[0m19:00:51.288139 [info ] [Thread-2 (]: 12 of 26 OK created sql table model dbt.trips_concurrency ...................... [[32mSELECT 10[0m in 3.28s]
[0m19:00:51.288866 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_concurrency
[0m19:00:51.365040 [debug] [Thread-3 (]: SQL status: BEGIN in 1.191 seconds
[0m19:00:51.366030 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m19:00:51.366663 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."events_stat__dbt_tmp"
  
  
    as
  
  (
    select
    count("type" = 'cancel_search' or null)
      / cast(count("type" = 'start_search' or null) as float)
      * 100 as cancel_pct
from
    "dev_h8qz"."dbt"."events_full"
  );
  
[0m19:00:51.479417 [debug] [Thread-4 (]: SQL status: BEGIN in 1.306 seconds
[0m19:00:51.481027 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m19:00:51.482238 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */

  create view "dev_h8qz"."dbt"."trips_prep__dbt_tmp"
    
    
  as (
    select id,
user_id,
scooter_hw_id,
started_at	,
finished_at	,
start_lat,	
start_lon,
finish_lat,	
finish_lon,	
distance	as distance_m,
cast(price as decimal(20,2))/ 100 as price_rub,
extract(epoch from(finished_at - started_at)) duration_s,
finished_at <> started_at and price = 0 as is_free,

    date(started_at at time zone 'Europe/Moscow')
 as "date" 
from
"dev_h8qz"."scooters_raw"."trips"
  );
[0m19:00:51.789548 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.306 seconds
[0m19:00:51.797802 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m19:00:51.798633 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_h8qz"."dbt"."trips_prep" rename to "trips_prep__dbt_backup"
[0m19:00:51.991166 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.192 seconds
[0m19:00:52.007804 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m19:00:52.008468 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
alter table "dev_h8qz"."dbt"."trips_prep__dbt_tmp" rename to "trips_prep"
[0m19:00:52.196015 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.187 seconds
[0m19:00:52.200053 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m19:00:52.200718 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m19:00:52.201256 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: COMMIT
[0m19:00:52.400831 [debug] [Thread-4 (]: SQL status: COMMIT in 0.199 seconds
[0m19:00:52.406221 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_prep__dbt_backup"
[0m19:00:52.406894 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.trips_prep"
[0m19:00:52.407557 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_prep"} */
drop view if exists "dev_h8qz"."dbt"."trips_prep__dbt_backup" cascade
[0m19:00:52.605597 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.197 seconds
[0m19:00:52.609992 [debug] [Thread-4 (]: On model.dbt_scooters.trips_prep: Close
[0m19:00:52.611573 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226338f0>]}
[0m19:00:52.612750 [info ] [Thread-4 (]: 14 of 26 OK created sql view model dbt.trips_prep .............................. [[32mCREATE VIEW[0m in 2.46s]
[0m19:00:52.613708 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.trips_prep
[0m19:00:52.614791 [debug] [Thread-4 (]: Began running node model.dbt_scooters.revenue_daily
[0m19:00:52.615386 [debug] [Thread-2 (]: Began running node model.dbt_scooters.companies_trips
[0m19:00:52.616067 [info ] [Thread-4 (]: 17 of 26 START sql incremental model finance.revenue_daily ..................... [RUN]
[0m19:00:52.616843 [info ] [Thread-2 (]: 16 of 26 START sql table model dbt.companies_trips ............................. [RUN]
[0m19:00:52.617562 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_prep, now model.dbt_scooters.revenue_daily)
[0m19:00:52.618119 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_concurrency, now model.dbt_scooters.companies_trips)
[0m19:00:52.618574 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.revenue_daily
[0m19:00:52.619015 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.companies_trips
[0m19:00:52.623947 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.revenue_daily"
[0m19:00:52.628426 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.companies_trips"
[0m19:00:52.629500 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.revenue_daily
[0m19:00:52.629839 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.companies_trips
[0m19:00:52.633083 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m19:00:52.636151 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.companies_trips"
[0m19:00:52.636497 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    
  
    

  create temporary table "revenue_daily__dbt_tmp190052631779"
  
  
    as
  
  (
    select
    sum(price_rub) as revenue_rub,
    "date",
    
    now() as updated_at

from
    "dev_h8qz"."dbt"."trips_prep"

where
    "date" >= (select max("date") - interval '2' day from "dev_h8qz"."finance"."revenue_daily")

group by
    2,
    3
order by
    2
  );
  
  
[0m19:00:52.636896 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:00:52.637447 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m19:00:52.637704 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: BEGIN
[0m19:00:52.637935 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:54.449058 [debug] [Thread-3 (]: SQL status: SELECT 1 in 3.081 seconds
[0m19:00:54.455935 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m19:00:54.456480 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_h8qz"."dbt"."events_stat" rename to "events_stat__dbt_backup"
[0m19:00:54.551219 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m19:00:54.557532 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m19:00:54.558081 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
alter table "dev_h8qz"."dbt"."events_stat__dbt_tmp" rename to "events_stat"
[0m19:00:54.653447 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m19:00:54.658173 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: COMMIT
[0m19:00:54.659169 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m19:00:54.659597 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: COMMIT
[0m19:00:54.755985 [debug] [Thread-2 (]: SQL status: BEGIN in 2.118 seconds
[0m19:00:54.757274 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m19:00:54.758412 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */

  
    

  create  table "dev_h8qz"."dbt"."companies_trips__dbt_tmp"
  
  
    as
  
  (
    with trips_cte as (
    select
        company,
        count(*) as trips
    from
        "dev_h8qz"."dbt"."trips_prep" as t
        join "dev_h8qz"."dbt"."scooters" as s
            on t.scooter_hw_id = s.hardware_id
    group by
        1
)
select
    company,
    t.trips,
    c.scooters,
    t.trips / cast(c.scooters as float) as trips_per_scooter
from
    trips_cte as t
    join "dev_h8qz"."dbt"."companies" as c
        using (company)
  );
  
[0m19:00:54.862757 [debug] [Thread-3 (]: SQL status: COMMIT in 0.203 seconds
[0m19:00:54.864889 [debug] [Thread-3 (]: Applying DROP to: "dev_h8qz"."dbt"."events_stat__dbt_backup"
[0m19:00:54.865301 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.events_stat"
[0m19:00:54.865554 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_stat"} */
drop table if exists "dev_h8qz"."dbt"."events_stat__dbt_backup" cascade
[0m19:00:55.268126 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.402 seconds
[0m19:00:55.272730 [debug] [Thread-3 (]: On model.dbt_scooters.events_stat: Close
[0m19:00:55.274113 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122632630>]}
[0m19:00:55.275023 [info ] [Thread-3 (]: 15 of 26 OK created sql table model dbt.events_stat ............................ [[32mSELECT 1[0m in 5.11s]
[0m19:00:55.275757 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.events_stat
[0m19:00:55.276247 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_stat
[0m19:00:55.276840 [info ] [Thread-3 (]: 18 of 26 START sql table model dbt.trips_stat .................................. [RUN]
[0m19:00:55.277422 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.events_stat, now model.dbt_scooters.trips_stat)
[0m19:00:55.277847 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_stat
[0m19:00:55.281254 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_stat"
[0m19:00:55.282442 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_stat
[0m19:00:55.286854 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_stat"
[0m19:00:55.287686 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m19:00:55.288229 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: BEGIN
[0m19:00:55.288584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:00:55.985293 [debug] [Thread-4 (]: SQL status: SELECT 3 in 3.348 seconds
[0m19:00:55.995052 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m19:00:55.995573 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: BEGIN
[0m19:00:56.189841 [debug] [Thread-4 (]: SQL status: BEGIN in 0.193 seconds
[0m19:00:56.191774 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m19:00:56.193004 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp190052631779'
        
      order by ordinal_position

  
[0m19:00:56.394709 [debug] [Thread-2 (]: SQL status: SELECT 6 in 1.635 seconds
[0m19:00:56.402026 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m19:00:56.402371 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_h8qz"."dbt"."companies_trips" rename to "companies_trips__dbt_backup"
[0m19:00:56.474609 [debug] [Thread-1 (]: SQL status: SELECT 105901 in 5.188 seconds
[0m19:00:56.476257 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.282 seconds
[0m19:00:56.477197 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.074 seconds
[0m19:00:56.482465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m19:00:56.486161 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m19:00:56.488820 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m19:00:56.489208 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_h8qz"."dbt"."trips_geom" rename to "trips_geom__dbt_backup"
[0m19:00:56.489569 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m19:00:56.489900 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
alter table "dev_h8qz"."dbt"."companies_trips__dbt_tmp" rename to "companies_trips"
[0m19:00:56.600938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.110 seconds
[0m19:00:56.602472 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.112 seconds
[0m19:00:56.603780 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.113 seconds
[0m19:00:56.608056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m19:00:56.610995 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m19:00:56.612143 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m19:00:56.612483 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
alter table "dev_h8qz"."dbt"."trips_geom__dbt_tmp" rename to "trips_geom"
[0m19:00:56.612816 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily__dbt_tmp190052631779'
        
      order by ordinal_position

  
[0m19:00:56.613134 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m19:00:56.613516 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: COMMIT
[0m19:00:56.702827 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.089 seconds
[0m19:00:56.703717 [debug] [Thread-2 (]: SQL status: COMMIT in 0.090 seconds
[0m19:00:56.704318 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.091 seconds
[0m19:00:56.707455 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m19:00:56.712631 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."companies_trips__dbt_backup"
[0m19:00:56.717122 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m19:00:56.717623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m19:00:56.718273 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.companies_trips"
[0m19:00:56.718707 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'revenue_daily'
        
        and table_schema = 'finance'
        
      order by ordinal_position

  
[0m19:00:56.719120 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: COMMIT
[0m19:00:56.719526 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.companies_trips"} */
drop table if exists "dev_h8qz"."dbt"."companies_trips__dbt_backup" cascade
[0m19:00:56.784014 [debug] [Thread-1 (]: SQL status: COMMIT in 0.064 seconds
[0m19:00:56.785215 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.065 seconds
[0m19:00:56.785736 [debug] [Thread-3 (]: SQL status: BEGIN in 1.497 seconds
[0m19:00:56.789187 [debug] [Thread-1 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_geom__dbt_backup"
[0m19:00:56.789720 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.070 seconds
[0m19:00:56.792526 [debug] [Thread-4 (]: 
    In "dev_h8qz"."finance"."revenue_daily":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:00:56.793113 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m19:00:56.793720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.trips_geom"
[0m19:00:56.795375 [debug] [Thread-2 (]: On model.dbt_scooters.companies_trips: Close
[0m19:00:56.797136 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.revenue_daily"
[0m19:00:56.797578 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_stat__dbt_tmp"
  
  
    as
  
  (
    select count(id) trips, count(distinct user_id) users
, avg(duration_s) / 60 avg_duration_m
, sum(distance_m) / 1000 as sum_distance_km
, sum(price_rub) revenue_rub
, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct
from "dev_h8qz"."dbt"."trips_prep"
  );
  
[0m19:00:56.797916 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_geom"} */
drop table if exists "dev_h8qz"."dbt"."trips_geom__dbt_backup" cascade
[0m19:00:56.798899 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122632db0>]}
[0m19:00:56.799978 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m19:00:56.799637 [info ] [Thread-2 (]: 16 of 26 OK created sql table model dbt.companies_trips ........................ [[32mSELECT 6[0m in 4.18s]
[0m19:00:56.800412 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

      
        delete from "dev_h8qz"."finance"."revenue_daily" as DBT_INTERNAL_DEST
        where (date) in (
            select distinct date
            from "revenue_daily__dbt_tmp190052631779" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_h8qz"."finance"."revenue_daily" ("revenue_rub", "date", "updated_at")
    (
        select "revenue_rub", "date", "updated_at"
        from "revenue_daily__dbt_tmp190052631779"
    )
  
[0m19:00:56.801024 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.companies_trips
[0m19:00:56.801629 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_users
[0m19:00:56.802227 [info ] [Thread-2 (]: 19 of 26 START sql incremental model dbt.trips_users ........................... [RUN]
[0m19:00:56.802810 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.companies_trips, now model.dbt_scooters.trips_users)
[0m19:00:56.803219 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_users
[0m19:00:56.807073 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_users"
[0m19:00:56.807832 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_users
[0m19:00:56.811231 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m19:00:56.811622 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

    
  
    

  create temporary table "trips_users__dbt_tmp190056809527"
  
  
    as
  
  (
    select
    t.*,
    u.sex,
    extract(year from t.started_at) - extract(year from u.birth_date) as age,
    
    now() as updated_at

from
    "dev_h8qz"."dbt"."trips_prep" as t
left join
    "dev_h8qz"."scooters_raw"."users" as u
    on t.user_id = u.id

    where
        t.id > (select max(id) from "dev_h8qz"."dbt"."trips_users")
    order by
        t.id
    limit
        75000

  );
  
  
[0m19:00:56.811905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:00:56.909726 [debug] [Thread-4 (]: SQL status: INSERT 0 3 in 0.108 seconds
[0m19:00:56.918607 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m19:00:56.919203 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.121 seconds
[0m19:00:56.919633 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.revenue_daily"} */

    select grantee, privilege_type
  from "dev_h8qz".INFORMATION_SCHEMA.role_table_grants
      where grantor = current_role
        and grantee != current_role
        and table_schema = 'finance'
        and table_name = 'revenue_daily'
  
[0m19:00:56.921205 [debug] [Thread-1 (]: On model.dbt_scooters.trips_geom: Close
[0m19:00:56.922270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226fc110>]}
[0m19:00:56.923063 [info ] [Thread-1 (]: 13 of 26 OK created sql table model dbt.trips_geom ............................. [[32mSELECT 105901[0m in 7.48s]
[0m19:00:56.923638 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.trips_geom
[0m19:00:56.924026 [debug] [Thread-1 (]: Began running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m19:00:56.924481 [info ] [Thread-1 (]: 20 of 26 START test unique_companies_trips_company ............................. [RUN]
[0m19:00:56.925178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_geom, now test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0)
[0m19:00:56.925724 [debug] [Thread-1 (]: Began compiling node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m19:00:56.932467 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m19:00:56.933243 [debug] [Thread-1 (]: Began executing node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m19:00:56.935170 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m19:00:56.935721 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m19:00:56.936010 [debug] [Thread-1 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: BEGIN
[0m19:00:56.936307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:57.112892 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.191 seconds
[0m19:00:57.117970 [debug] [Thread-4 (]: On "dev_h8qz"."finance"."revenue_daily": All grants are in place, no revocation or granting needed.
[0m19:00:57.119990 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m19:00:57.121169 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.revenue_daily"
[0m19:00:57.121551 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: COMMIT
[0m19:00:57.215104 [debug] [Thread-4 (]: SQL status: COMMIT in 0.093 seconds
[0m19:00:57.217974 [debug] [Thread-4 (]: On model.dbt_scooters.revenue_daily: Close
[0m19:00:57.219810 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121eba330>]}
[0m19:00:57.221047 [info ] [Thread-4 (]: 17 of 26 OK created sql incremental model finance.revenue_daily ................ [[32mINSERT 0 3[0m in 4.60s]
[0m19:00:57.221986 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.revenue_daily
[0m19:00:57.222634 [debug] [Thread-4 (]: Began running node model.dbt_scooters.parking_finish_stat
[0m19:00:57.223311 [info ] [Thread-4 (]: 21 of 26 START sql table model dbt.parking_finish_stat ......................... [RUN]
[0m19:00:57.223954 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.revenue_daily, now model.dbt_scooters.parking_finish_stat)
[0m19:00:57.224427 [debug] [Thread-4 (]: Began compiling node model.dbt_scooters.parking_finish_stat
[0m19:00:57.231841 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_scooters.parking_finish_stat"
[0m19:00:57.232777 [debug] [Thread-4 (]: Began executing node model.dbt_scooters.parking_finish_stat
[0m19:00:57.236429 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_scooters.parking_finish_stat"
[0m19:00:57.237180 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m19:00:57.237512 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: BEGIN
[0m19:00:57.237795 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:00:58.033054 [debug] [Thread-1 (]: SQL status: BEGIN in 1.096 seconds
[0m19:00:58.034821 [debug] [Thread-1 (]: Using postgres connection "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"
[0m19:00:58.036034 [debug] [Thread-1 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    company as unique_field,
    count(*) as n_records

from "dev_h8qz"."dbt"."companies_trips"
where company is not null
group by company
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:00:58.134923 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.098 seconds
[0m19:00:58.139548 [debug] [Thread-1 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: ROLLBACK
[0m19:00:58.237547 [debug] [Thread-1 (]: On test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0: Close
[0m19:00:58.240291 [info ] [Thread-1 (]: 20 of 26 PASS unique_companies_trips_company ................................... [[32mPASS[0m in 1.31s]
[0m19:00:58.242103 [debug] [Thread-1 (]: Finished running node test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0
[0m19:00:58.243131 [debug] [Thread-1 (]: Began running node model.dbt_scooters.parking_start_stat
[0m19:00:58.243909 [info ] [Thread-1 (]: 22 of 26 START sql table model dbt.parking_start_stat .......................... [RUN]
[0m19:00:58.244535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0, now model.dbt_scooters.parking_start_stat)
[0m19:00:58.245013 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.parking_start_stat
[0m19:00:58.250423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.parking_start_stat"
[0m19:00:58.251626 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.parking_start_stat
[0m19:00:58.254678 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.parking_start_stat"
[0m19:00:58.255317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m19:00:58.255699 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: BEGIN
[0m19:00:58.256023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:59.369164 [debug] [Thread-3 (]: SQL status: SELECT 1 in 2.570 seconds
[0m19:00:59.370850 [debug] [Thread-4 (]: SQL status: BEGIN in 2.133 seconds
[0m19:00:59.377230 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m19:00:59.385173 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m19:00:59.385525 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_h8qz"."dbt"."trips_stat" rename to "trips_stat__dbt_backup"
[0m19:00:59.385890 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."parking_finish_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_h8qz"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)
-- group by
--     1


select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_h8qz"."dbt"."trips_geom"
cross join
    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex
where
    st_intersects(st_transform(finish_point, 3857), hex.geom)
group by
    1

  );
  
[0m19:00:59.467989 [debug] [Thread-2 (]: SQL status: SELECT 0 in 2.656 seconds
[0m19:00:59.469237 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.083 seconds
[0m19:00:59.475072 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m19:00:59.479484 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m19:00:59.480033 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: BEGIN
[0m19:00:59.480522 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
alter table "dev_h8qz"."dbt"."trips_stat__dbt_tmp" rename to "trips_stat"
[0m19:00:59.570191 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.089 seconds
[0m19:00:59.571430 [debug] [Thread-1 (]: SQL status: BEGIN in 1.315 seconds
[0m19:00:59.575664 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m19:00:59.576694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m19:00:59.577275 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m19:00:59.577877 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."parking_start_stat__dbt_tmp"
  
  
    as
  
  (
    -- select
--     st_transform(hex.geom, 4326) as geom,
--     count(*) as trips
-- from
--     "dev_h8qz"."dbt"."trips_geom" as t
-- cross join
--     st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex
-- where
--     st_intersects(st_transform(t.start_point, 3857), hex.geom)
-- group by
--     1

select
    st_transform(hex.geom, 4326) as geom,
    count(*) as trips
from
    "dev_h8qz"."dbt"."trips_geom"
cross join
    st_hexagongrid(500, st_transform(start_point, 3857)) as hex
where
    st_intersects(st_transform(start_point, 3857), hex.geom)
group by
    1

  );
  
[0m19:00:59.578493 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: COMMIT
[0m19:00:59.672478 [debug] [Thread-2 (]: SQL status: BEGIN in 0.191 seconds
[0m19:00:59.673596 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m19:00:59.674725 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp190056809527'
        
      order by ordinal_position

  
[0m19:00:59.773405 [debug] [Thread-3 (]: SQL status: COMMIT in 0.194 seconds
[0m19:00:59.781800 [debug] [Thread-3 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_stat__dbt_backup"
[0m19:00:59.783214 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_stat"
[0m19:00:59.783729 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_stat"} */
drop table if exists "dev_h8qz"."dbt"."trips_stat__dbt_backup" cascade
[0m19:00:59.981306 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.306 seconds
[0m19:00:59.981925 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.198 seconds
[0m19:00:59.985504 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m19:00:59.986896 [debug] [Thread-3 (]: On model.dbt_scooters.trips_stat: Close
[0m19:00:59.987245 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m19:00:59.987934 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226fca10>]}
[0m19:00:59.988492 [info ] [Thread-3 (]: 18 of 26 OK created sql table model dbt.trips_stat ............................. [[32mSELECT 1[0m in 4.71s]
[0m19:00:59.988980 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_stat
[0m19:01:00.285361 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.298 seconds
[0m19:01:00.288502 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m19:01:00.288855 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'trips_users__dbt_tmp190056809527'
        
      order by ordinal_position

  
[0m19:01:00.593048 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.303 seconds
[0m19:01:00.601989 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m19:01:00.602732 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'trips_users'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m19:01:00.911417 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.308 seconds
[0m19:01:00.919663 [debug] [Thread-2 (]: 
    In "dev_h8qz"."dbt"."trips_users":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:01:00.927086 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_users"
[0m19:01:00.928016 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m19:01:00.928364 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

      insert into "dev_h8qz"."dbt"."trips_users" ("id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at")
    (
        select "id", "user_id", "scooter_hw_id", "started_at", "finished_at", "start_lat", "start_lon", "finish_lat", "finish_lon", "distance_m", "price_rub", "duration_s", "is_free", "date", "sex", "age", "updated_at"
        from "trips_users__dbt_tmp190056809527"
    )


  
[0m19:01:01.105420 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.176 seconds
[0m19:01:01.110567 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m19:01:01.111020 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        analyze dbt.trips_users
      
[0m19:01:12.062334 [debug] [Thread-2 (]: SQL status: ANALYZE in 10.950 seconds
[0m19:01:12.066288 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m19:01:12.067504 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m19:01:12.068549 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: COMMIT
[0m19:01:12.128888 [debug] [Thread-2 (]: SQL status: COMMIT in 0.059 seconds
[0m19:01:12.130756 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m19:01:12.131832 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        commit;
      
[0m19:01:12.270335 [debug] [Thread-2 (]: SQL status: COMMIT in 0.137 seconds
[0m19:01:12.274299 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_users"
[0m19:01:12.275497 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_users"} */

        vacuum dbt.trips_users
      
[0m19:01:13.188491 [debug] [Thread-2 (]: SQL status: VACUUM in 0.912 seconds
[0m19:01:13.192991 [debug] [Thread-2 (]: On model.dbt_scooters.trips_users: Close
[0m19:01:13.194225 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226fc650>]}
[0m19:01:13.195021 [info ] [Thread-2 (]: 19 of 26 OK created sql incremental model dbt.trips_users ...................... [[32mINSERT 0 0[0m in 16.39s]
[0m19:01:13.195648 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_users
[0m19:01:13.196378 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily
[0m19:01:13.196864 [debug] [Thread-2 (]: Began running node model.dbt_scooters.trips_age_group
[0m19:01:13.197371 [info ] [Thread-3 (]: 23 of 26 START sql table model dbt.trips_age_daily ............................. [RUN]
[0m19:01:13.197901 [info ] [Thread-2 (]: 24 of 26 START sql table model dbt.trips_age_group ............................. [RUN]
[0m19:01:13.198358 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_stat, now model.dbt_scooters.trips_age_daily)
[0m19:01:13.198711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_users, now model.dbt_scooters.trips_age_group)
[0m19:01:13.199037 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily
[0m19:01:13.199344 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.trips_age_group
[0m19:01:13.202214 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily"
[0m19:01:13.205054 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_group"
[0m19:01:13.205959 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.trips_age_group
[0m19:01:13.206299 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily
[0m19:01:13.208558 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_group"
[0m19:01:13.210680 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily"
[0m19:01:13.211185 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m19:01:13.211426 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: BEGIN
[0m19:01:13.211693 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m19:01:13.211939 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:01:13.212175 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: BEGIN
[0m19:01:13.212497 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:01:15.646115 [debug] [Thread-2 (]: SQL status: BEGIN in 2.434 seconds
[0m19:01:15.647610 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m19:01:15.648285 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_age_group__dbt_tmp"
  
  
    as
  
  (
    select
    ag."group" as age_group,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_h8qz"."dbt"."trips_users" as tu
    cross join "dev_h8qz"."dbt"."age_groups" as ag
where
    tu.age >= ag.age_start
    and tu.age <= ag.age_end
group by
    1
  );
  
[0m19:01:15.748141 [debug] [Thread-3 (]: SQL status: BEGIN in 2.535 seconds
[0m19:01:15.749030 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m19:01:15.749674 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_age_daily__dbt_tmp"
  
  
    as
  
  (
    select
    "date",
    age,
    count(*) as trips,
    sum(price_rub) as revenue_rub
from
    "dev_h8qz"."dbt"."trips_users"
group by
    1,
    2
  );
  
[0m19:01:20.358406 [debug] [Thread-3 (]: SQL status: SELECT 7049 in 4.608 seconds
[0m19:01:20.365639 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m19:01:20.366186 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_h8qz"."dbt"."trips_age_daily" rename to "trips_age_daily__dbt_backup"
[0m19:01:20.561349 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.194 seconds
[0m19:01:20.569995 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m19:01:20.570633 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
alter table "dev_h8qz"."dbt"."trips_age_daily__dbt_tmp" rename to "trips_age_daily"
[0m19:01:20.766055 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.195 seconds
[0m19:01:20.771221 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m19:01:20.772521 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m19:01:20.773062 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: COMMIT
[0m19:01:20.970892 [debug] [Thread-3 (]: SQL status: COMMIT in 0.197 seconds
[0m19:01:20.980522 [debug] [Thread-3 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_age_daily__dbt_backup"
[0m19:01:20.981223 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily"
[0m19:01:20.981623 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily"} */
drop table if exists "dev_h8qz"."dbt"."trips_age_daily__dbt_backup" cascade
[0m19:01:21.175802 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.193 seconds
[0m19:01:21.181138 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily: Close
[0m19:01:21.182324 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12148a150>]}
[0m19:01:21.183124 [info ] [Thread-3 (]: 23 of 26 OK created sql table model dbt.trips_age_daily ........................ [[32mSELECT 7049[0m in 7.98s]
[0m19:01:21.183760 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily
[0m19:01:21.184410 [debug] [Thread-3 (]: Began running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m19:01:21.184961 [info ] [Thread-3 (]: 25 of 26 START test unique_trips_age_daily_date_text_age_text .................. [RUN]
[0m19:01:21.185464 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_scooters.trips_age_daily, now test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e)
[0m19:01:21.185878 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m19:01:21.189964 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m19:01:21.190813 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m19:01:21.192504 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m19:01:21.193056 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m19:01:21.193337 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: BEGIN
[0m19:01:21.193576 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:01:22.916394 [debug] [Thread-3 (]: SQL status: BEGIN in 1.722 seconds
[0m19:01:22.917430 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"
[0m19:01:22.918153 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date::text || age::text as unique_field,
    count(*) as n_records

from "dev_h8qz"."dbt"."trips_age_daily"
where date::text || age::text is not null
group by date::text || age::text
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m19:01:23.840094 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.921 seconds
[0m19:01:23.844622 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: ROLLBACK
[0m19:01:23.940417 [debug] [Thread-3 (]: On test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e: Close
[0m19:01:23.942966 [info ] [Thread-3 (]: 25 of 26 PASS unique_trips_age_daily_date_text_age_text ........................ [[32mPASS[0m in 2.76s]
[0m19:01:23.944820 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e
[0m19:01:23.946220 [debug] [Thread-3 (]: Began running node model.dbt_scooters.trips_age_daily_stat
[0m19:01:23.947130 [info ] [Thread-3 (]: 26 of 26 START sql table model dbt.trips_age_daily_stat ........................ [RUN]
[0m19:01:23.947880 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e, now model.dbt_scooters.trips_age_daily_stat)
[0m19:01:23.948336 [debug] [Thread-3 (]: Began compiling node model.dbt_scooters.trips_age_daily_stat
[0m19:01:23.953397 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_scooters.trips_age_daily_stat"
[0m19:01:23.954669 [debug] [Thread-3 (]: Began executing node model.dbt_scooters.trips_age_daily_stat
[0m19:01:23.958784 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_scooters.trips_age_daily_stat"
[0m19:01:23.959919 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m19:01:23.960293 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: BEGIN
[0m19:01:23.960611 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:01:25.988605 [debug] [Thread-3 (]: SQL status: BEGIN in 2.027 seconds
[0m19:01:25.990271 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m19:01:25.991454 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */

  
    

  create  table "dev_h8qz"."dbt"."trips_age_daily_stat__dbt_tmp"
  
  
    as
  
  (
    select
    age,
    avg(trips) as avg_trips,
    avg(revenue_rub) as avg_revenue_rub
from
    "dev_h8qz"."dbt"."trips_age_daily"
group by
    1
order by
    1
  );
  
[0m19:01:26.606159 [debug] [Thread-3 (]: SQL status: SELECT 83 in 0.613 seconds
[0m19:01:26.613672 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m19:01:26.614131 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_h8qz"."dbt"."trips_age_daily_stat" rename to "trips_age_daily_stat__dbt_backup"
[0m19:01:26.706531 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m19:01:26.712311 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m19:01:26.713044 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
alter table "dev_h8qz"."dbt"."trips_age_daily_stat__dbt_tmp" rename to "trips_age_daily_stat"
[0m19:01:26.807868 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m19:01:26.811854 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m19:01:26.812506 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m19:01:26.812955 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: COMMIT
[0m19:01:26.909973 [debug] [Thread-3 (]: SQL status: COMMIT in 0.096 seconds
[0m19:01:26.915370 [debug] [Thread-3 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_age_daily_stat__dbt_backup"
[0m19:01:26.916308 [debug] [Thread-3 (]: Using postgres connection "model.dbt_scooters.trips_age_daily_stat"
[0m19:01:26.916880 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_daily_stat"} */
drop table if exists "dev_h8qz"."dbt"."trips_age_daily_stat__dbt_backup" cascade
[0m19:01:27.114656 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.197 seconds
[0m19:01:27.119096 [debug] [Thread-3 (]: On model.dbt_scooters.trips_age_daily_stat: Close
[0m19:01:27.121358 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12148a150>]}
[0m19:01:27.123063 [info ] [Thread-3 (]: 26 of 26 OK created sql table model dbt.trips_age_daily_stat ................... [[32mSELECT 83[0m in 3.17s]
[0m19:01:27.123785 [debug] [Thread-3 (]: Finished running node model.dbt_scooters.trips_age_daily_stat
[0m19:01:39.403346 [debug] [Thread-4 (]: SQL status: SELECT 464 in 40.016 seconds
[0m19:01:39.411569 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m19:01:39.412070 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_h8qz"."dbt"."parking_finish_stat" rename to "parking_finish_stat__dbt_backup"
[0m19:01:39.505941 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.093 seconds
[0m19:01:39.513517 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m19:01:39.513953 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
alter table "dev_h8qz"."dbt"."parking_finish_stat__dbt_tmp" rename to "parking_finish_stat"
[0m19:01:39.632892 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.118 seconds
[0m19:01:39.637181 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m19:01:39.638322 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m19:01:39.639313 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: COMMIT
[0m19:01:39.710209 [debug] [Thread-4 (]: SQL status: COMMIT in 0.070 seconds
[0m19:01:39.718601 [debug] [Thread-4 (]: Applying DROP to: "dev_h8qz"."dbt"."parking_finish_stat__dbt_backup"
[0m19:01:39.720113 [debug] [Thread-4 (]: Using postgres connection "model.dbt_scooters.parking_finish_stat"
[0m19:01:39.720655 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_finish_stat"} */
drop table if exists "dev_h8qz"."dbt"."parking_finish_stat__dbt_backup" cascade
[0m19:01:39.918205 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.197 seconds
[0m19:01:39.923160 [debug] [Thread-4 (]: On model.dbt_scooters.parking_finish_stat: Close
[0m19:01:39.924514 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226ff470>]}
[0m19:01:39.925447 [info ] [Thread-4 (]: 21 of 26 OK created sql table model dbt.parking_finish_stat .................... [[32mSELECT 464[0m in 42.70s]
[0m19:01:39.926067 [debug] [Thread-4 (]: Finished running node model.dbt_scooters.parking_finish_stat
[0m19:01:43.705957 [debug] [Thread-1 (]: SQL status: SELECT 142 in 44.126 seconds
[0m19:01:43.714929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m19:01:43.715398 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_h8qz"."dbt"."parking_start_stat" rename to "parking_start_stat__dbt_backup"
[0m19:01:43.806381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m19:01:43.812865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m19:01:43.813517 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
alter table "dev_h8qz"."dbt"."parking_start_stat__dbt_tmp" rename to "parking_start_stat"
[0m19:01:43.908583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m19:01:43.912653 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m19:01:43.913805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m19:01:43.914834 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: COMMIT
[0m19:01:43.990784 [debug] [Thread-1 (]: SQL status: COMMIT in 0.075 seconds
[0m19:01:43.998057 [debug] [Thread-1 (]: Applying DROP to: "dev_h8qz"."dbt"."parking_start_stat__dbt_backup"
[0m19:01:43.998822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.parking_start_stat"
[0m19:01:43.999228 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.parking_start_stat"} */
drop table if exists "dev_h8qz"."dbt"."parking_start_stat__dbt_backup" cascade
[0m19:01:44.113659 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.114 seconds
[0m19:01:44.118434 [debug] [Thread-1 (]: On model.dbt_scooters.parking_start_stat: Close
[0m19:01:44.120267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122633a10>]}
[0m19:01:44.121122 [info ] [Thread-1 (]: 22 of 26 OK created sql table model dbt.parking_start_stat ..................... [[32mSELECT 142[0m in 45.88s]
[0m19:01:44.121925 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.parking_start_stat
[0m19:01:47.390652 [debug] [Thread-2 (]: SQL status: SELECT 7 in 31.741 seconds
[0m19:01:47.400440 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m19:01:47.400974 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_h8qz"."dbt"."trips_age_group" rename to "trips_age_group__dbt_backup"
[0m19:01:47.492726 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.091 seconds
[0m19:01:47.499505 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m19:01:47.499964 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
alter table "dev_h8qz"."dbt"."trips_age_group__dbt_tmp" rename to "trips_age_group"
[0m19:01:47.595111 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m19:01:47.599881 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m19:01:47.601059 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m19:01:47.602077 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: COMMIT
[0m19:01:47.648586 [debug] [Thread-2 (]: SQL status: COMMIT in 0.046 seconds
[0m19:01:47.655158 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."trips_age_group__dbt_backup"
[0m19:01:47.656073 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.trips_age_group"
[0m19:01:47.656598 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.trips_age_group"} */
drop table if exists "dev_h8qz"."dbt"."trips_age_group__dbt_backup" cascade
[0m19:01:47.800086 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.143 seconds
[0m19:01:47.804988 [debug] [Thread-2 (]: On model.dbt_scooters.trips_age_group: Close
[0m19:01:47.806619 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85e04809-031c-473a-a04f-bb8461dd7d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226fdfd0>]}
[0m19:01:47.807583 [info ] [Thread-2 (]: 24 of 26 OK created sql table model dbt.trips_age_group ........................ [[32mSELECT 7[0m in 34.61s]
[0m19:01:47.808255 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.trips_age_group
[0m19:01:47.809864 [info ] [MainThread]: 
[0m19:01:47.810260 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:47.810522 [debug] [MainThread]: On master: BEGIN
[0m19:01:47.810771 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:01:48.824058 [debug] [MainThread]: SQL status: BEGIN in 1.013 seconds
[0m19:01:48.825573 [debug] [MainThread]: On master: COMMIT
[0m19:01:48.826571 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:48.827467 [debug] [MainThread]: On master: COMMIT
[0m19:01:48.926274 [debug] [MainThread]: SQL status: COMMIT in 0.098 seconds
[0m19:01:48.932479 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m19:01:48.937804 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m19:01:48.938325 [debug] [MainThread]: Using postgres connection "master"
[0m19:01:48.938667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m19:01:49.028744 [debug] [MainThread]: SQL status: GRANT in 0.090 seconds
[0m19:01:49.030842 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.10s]
[0m19:01:49.031614 [debug] [MainThread]: On master: Close
[0m19:01:49.032693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:49.033213 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_start_stat' was properly closed.
[0m19:01:49.033660 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_group' was properly closed.
[0m19:01:49.034064 [debug] [MainThread]: Connection 'model.dbt_scooters.trips_age_daily_stat' was properly closed.
[0m19:01:49.034457 [debug] [MainThread]: Connection 'model.dbt_scooters.parking_finish_stat' was properly closed.
[0m19:01:49.035197 [info ] [MainThread]: 
[0m19:01:49.035738 [info ] [MainThread]: Finished running 3 incremental models, 1 project hook, 3 seeds, 12 table models, 6 data tests, 2 view models in 0 hours 1 minutes and 10.89 seconds (70.89s).
[0m19:01:49.040972 [debug] [MainThread]: Command end result
[0m19:01:49.063413 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m19:01:49.064842 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m19:01:49.069092 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m19:01:49.069325 [info ] [MainThread]: 
[0m19:01:49.069547 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m19:01:49.069728 [info ] [MainThread]: 
[0m19:01:49.069948 [warn ] [MainThread]: [33mWarning in test source_not_null_scooters_raw_users_sex (models/properties.yml)[0m
[0m19:01:49.070156 [warn ] [MainThread]: Got 216 results, configured to warn if != 0
[0m19:01:49.070303 [info ] [MainThread]: 
[0m19:01:49.070481 [info ] [MainThread]:   compiled code at target/compiled/dbt_scooters/models/properties.yml/source_not_null_scooters_raw_users_sex.sql
[0m19:01:49.070595 [info ] [MainThread]: 
[0m19:01:49.070716 [info ] [MainThread]: Done. PASS=26 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=27
[0m19:01:49.071417 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 71.21378, "process_in_blocks": "0", "process_kernel_time": 0.269003, "process_mem_max_rss": "143097856", "process_out_blocks": "0", "process_user_time": 2.444601}
[0m19:01:49.071607 [debug] [MainThread]: Command `dbt build` succeeded at 19:01:49.071570 after 71.21 seconds
[0m19:01:49.071749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a68830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121519250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121963d70>]}
[0m19:01:49.071877 [debug] [MainThread]: Flushing usage events
[0m19:01:50.161441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:59:27.688950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213bf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12572b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12572bb10>]}


============================== 20:59:27.690839 | 39a5ee0c-77a9-4f94-a43a-708da45ecc41 ==============================
[0m20:59:27.690839 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:59:27.691126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -s events_full', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:59:27.753720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39a5ee0c-77a9-4f94-a43a-708da45ecc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b2f490>]}
[0m20:59:27.774153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39a5ee0c-77a9-4f94-a43a-708da45ecc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1254c1f20>]}
[0m20:59:27.774472 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:59:27.809702 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:59:27.873374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:59:27.873690 [debug] [MainThread]: Partial parsing: updated file: dbt_scooters://tests/events_full_is_complete.sql
[0m20:59:27.949252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39a5ee0c-77a9-4f94-a43a-708da45ecc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1263d0750>]}
[0m20:59:27.995396 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m20:59:27.996497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m20:59:28.042263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39a5ee0c-77a9-4f94-a43a-708da45ecc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1265275c0>]}
[0m20:59:28.042507 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 7 data tests, 15 sources, 439 macros
[0m20:59:28.043408 [info ] [MainThread]: 
[0m20:59:28.043551 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:59:28.043663 [info ] [MainThread]: 
[0m20:59:28.043858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:59:28.044200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m20:59:28.061602 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m20:59:28.061811 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m20:59:28.061925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:29.111791 [debug] [ThreadPool]: SQL status: SELECT 23 in 1.050 seconds
[0m20:59:29.115310 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m20:59:29.125158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now list_dev_h8qz_finance)
[0m20:59:29.132730 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz_dbt'
[0m20:59:29.133631 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m20:59:29.135356 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m20:59:29.135699 [debug] [ThreadPool]: On list_dev_h8qz_finance: BEGIN
[0m20:59:29.135964 [debug] [ThreadPool]: On list_dev_h8qz_dbt: BEGIN
[0m20:59:29.136213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:29.137035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:30.955520 [debug] [ThreadPool]: SQL status: BEGIN in 1.819 seconds
[0m20:59:30.957176 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m20:59:30.958361 [debug] [ThreadPool]: On list_dev_h8qz_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_finance"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m20:59:31.057827 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.098 seconds
[0m20:59:31.059353 [debug] [ThreadPool]: SQL status: BEGIN in 1.922 seconds
[0m20:59:31.062096 [debug] [ThreadPool]: On list_dev_h8qz_finance: ROLLBACK
[0m20:59:31.062671 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m20:59:31.063363 [debug] [ThreadPool]: On list_dev_h8qz_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_dbt"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m20:59:31.117386 [debug] [ThreadPool]: On list_dev_h8qz_finance: Close
[0m20:59:31.159757 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.096 seconds
[0m20:59:31.162713 [debug] [ThreadPool]: On list_dev_h8qz_dbt: ROLLBACK
[0m20:59:31.262037 [debug] [ThreadPool]: On list_dev_h8qz_dbt: Close
[0m20:59:31.269321 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:31.269656 [debug] [MainThread]: On master: BEGIN
[0m20:59:31.269869 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:32.287498 [debug] [MainThread]: SQL status: BEGIN in 1.017 seconds
[0m20:59:32.288260 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:32.288783 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:59:32.390638 [debug] [MainThread]: SQL status: SELECT 3 in 0.101 seconds
[0m20:59:32.394927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39a5ee0c-77a9-4f94-a43a-708da45ecc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125bf5c50>]}
[0m20:59:32.395816 [debug] [MainThread]: On master: ROLLBACK
[0m20:59:32.491059 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:32.492232 [debug] [MainThread]: On master: BEGIN
[0m20:59:32.695942 [debug] [MainThread]: SQL status: BEGIN in 0.203 seconds
[0m20:59:32.697206 [debug] [MainThread]: On master: COMMIT
[0m20:59:32.698151 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:32.698990 [debug] [MainThread]: On master: COMMIT
[0m20:59:32.801305 [debug] [MainThread]: SQL status: COMMIT in 0.101 seconds
[0m20:59:32.802648 [debug] [MainThread]: On master: Close
[0m20:59:32.809847 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_full
[0m20:59:32.810896 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt.events_full .................................... [RUN]
[0m20:59:32.811737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_finance, now model.dbt_scooters.events_full)
[0m20:59:32.812292 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_full
[0m20:59:32.822361 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m20:59:32.824043 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_full
[0m20:59:32.849314 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m20:59:32.849859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m20:59:32.850005 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: BEGIN
[0m20:59:32.850123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:33.825894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.975 seconds
[0m20:59:33.827567 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m20:59:33.828771 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_h8qz"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_h8qz"."dbt"."events_clean"
    left join "dev_h8qz"."dbt"."event_types"
        using (type_id)
  );
[0m20:59:33.924568 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.095 seconds
[0m20:59:33.938459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m20:59:33.939048 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_h8qz"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m20:59:34.026951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.087 seconds
[0m20:59:34.035778 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m20:59:34.036695 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_h8qz"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m20:59:34.129779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.092 seconds
[0m20:59:34.147168 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m20:59:34.147565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m20:59:34.147798 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: COMMIT
[0m20:59:34.233112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.085 seconds
[0m20:59:34.242969 [debug] [Thread-1 (]: Applying DROP to: "dev_h8qz"."dbt"."events_full__dbt_backup"
[0m20:59:34.247599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m20:59:34.247991 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_h8qz"."dbt"."events_full__dbt_backup" cascade
[0m20:59:34.334330 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.086 seconds
[0m20:59:34.336981 [debug] [Thread-1 (]: On model.dbt_scooters.events_full: Close
[0m20:59:34.339719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39a5ee0c-77a9-4f94-a43a-708da45ecc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126a106d0>]}
[0m20:59:34.340347 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt.events_full ............................... [[32mCREATE VIEW[0m in 1.53s]
[0m20:59:34.340872 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_full
[0m20:59:34.341632 [debug] [Thread-2 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m20:59:34.341938 [info ] [Thread-2 (]: 2 of 2 START test events_full_is_complete ...................................... [RUN]
[0m20:59:34.342255 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_dbt, now test.dbt_scooters.events_full_is_complete)
[0m20:59:34.342513 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m20:59:34.344880 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m20:59:34.345550 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m20:59:34.359370 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m20:59:34.359980 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m20:59:34.360186 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m20:59:34.360369 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:59:35.754535 [debug] [Thread-2 (]: SQL status: BEGIN in 1.394 seconds
[0m20:59:35.755604 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m20:59:35.756654 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  with source_cte as (
    select count(*) as row_count
    from "dev_h8qz"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_h8qz"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
  
  
      
    ) dbt_internal_test
[0m20:59:38.021932 [debug] [Thread-2 (]: SQL status: SELECT 1 in 2.264 seconds
[0m20:59:38.029307 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m20:59:38.124813 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m20:59:38.127708 [info ] [Thread-2 (]: 2 of 2 PASS events_full_is_complete ............................................ [[32mPASS[0m in 3.79s]
[0m20:59:38.128812 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m20:59:38.131400 [info ] [MainThread]: 
[0m20:59:38.132165 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:38.132677 [debug] [MainThread]: On master: BEGIN
[0m20:59:38.133142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:59:39.146725 [debug] [MainThread]: SQL status: BEGIN in 1.013 seconds
[0m20:59:39.147883 [debug] [MainThread]: On master: COMMIT
[0m20:59:39.148249 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:39.148510 [debug] [MainThread]: On master: COMMIT
[0m20:59:39.249273 [debug] [MainThread]: SQL status: COMMIT in 0.100 seconds
[0m20:59:39.252351 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m20:59:39.259495 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m20:59:39.260462 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:39.260983 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m20:59:39.338005 [debug] [MainThread]: SQL status: GRANT in 0.076 seconds
[0m20:59:39.340538 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.09s]
[0m20:59:39.341374 [debug] [MainThread]: On master: Close
[0m20:59:39.342520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:39.342894 [debug] [MainThread]: Connection 'model.dbt_scooters.events_full' was properly closed.
[0m20:59:39.343248 [debug] [MainThread]: Connection 'test.dbt_scooters.events_full_is_complete' was properly closed.
[0m20:59:39.343712 [info ] [MainThread]: 
[0m20:59:39.344159 [info ] [MainThread]: Finished running 1 project hook, 1 test, 1 view model in 0 hours 0 minutes and 11.30 seconds (11.30s).
[0m20:59:39.345570 [debug] [MainThread]: Command end result
[0m20:59:39.370443 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m20:59:39.371821 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m20:59:39.375916 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m20:59:39.376160 [info ] [MainThread]: 
[0m20:59:39.376392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:59:39.376569 [info ] [MainThread]: 
[0m20:59:39.376737 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m20:59:39.378125 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.717923, "process_in_blocks": "0", "process_kernel_time": 0.133504, "process_mem_max_rss": "142000128", "process_out_blocks": "0", "process_user_time": 1.116753}
[0m20:59:39.378390 [debug] [MainThread]: Command `dbt build` succeeded at 20:59:39.378329 after 11.72 seconds
[0m20:59:39.378610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12560cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126915180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126915390>]}
[0m20:59:39.378814 [debug] [MainThread]: Flushing usage events
[0m20:59:40.377440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:59:46.428272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059974d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e939d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e93b10>]}


============================== 20:59:46.430085 | 49a1e04e-29e9-4ddc-824f-e9c52450c70a ==============================
[0m20:59:46.430085 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:59:46.430359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -s events_clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:59:46.495461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49a1e04e-29e9-4ddc-824f-e9c52450c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106193490>]}
[0m20:59:46.516930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49a1e04e-29e9-4ddc-824f-e9c52450c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d29f20>]}
[0m20:59:46.517342 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:59:46.550471 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:59:46.612027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:59:46.612207 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:59:46.639135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49a1e04e-29e9-4ddc-824f-e9c52450c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b14b50>]}
[0m20:59:46.685170 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m20:59:46.685987 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m20:59:46.696736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49a1e04e-29e9-4ddc-824f-e9c52450c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6fe30>]}
[0m20:59:46.696949 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 7 data tests, 15 sources, 439 macros
[0m20:59:46.697841 [info ] [MainThread]: 
[0m20:59:46.697987 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:59:46.698102 [info ] [MainThread]: 
[0m20:59:46.698303 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:59:46.698658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m20:59:46.715981 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m20:59:46.716173 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m20:59:46.716286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:47.705372 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.989 seconds
[0m20:59:47.708985 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m20:59:47.721212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now list_dev_h8qz_dbt)
[0m20:59:47.728630 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz_finance'
[0m20:59:47.729147 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m20:59:47.730719 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m20:59:47.731058 [debug] [ThreadPool]: On list_dev_h8qz_dbt: BEGIN
[0m20:59:47.731331 [debug] [ThreadPool]: On list_dev_h8qz_finance: BEGIN
[0m20:59:47.731572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:59:47.731804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:48.670601 [debug] [ThreadPool]: SQL status: BEGIN in 0.939 seconds
[0m20:59:48.672008 [debug] [ThreadPool]: SQL status: BEGIN in 0.940 seconds
[0m20:59:48.672861 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m20:59:48.673562 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m20:59:48.674250 [debug] [ThreadPool]: On list_dev_h8qz_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_dbt"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m20:59:48.674936 [debug] [ThreadPool]: On list_dev_h8qz_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_finance"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m20:59:48.772545 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.097 seconds
[0m20:59:48.773286 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.098 seconds
[0m20:59:48.784501 [debug] [ThreadPool]: On list_dev_h8qz_dbt: ROLLBACK
[0m20:59:48.786468 [debug] [ThreadPool]: On list_dev_h8qz_finance: ROLLBACK
[0m20:59:48.841369 [debug] [ThreadPool]: On list_dev_h8qz_finance: Close
[0m20:59:48.842169 [debug] [ThreadPool]: On list_dev_h8qz_dbt: Close
[0m20:59:48.856257 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:48.856723 [debug] [MainThread]: On master: BEGIN
[0m20:59:48.857033 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:49.966249 [debug] [MainThread]: SQL status: BEGIN in 1.109 seconds
[0m20:59:49.967638 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:49.968406 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:59:50.104146 [debug] [MainThread]: SQL status: SELECT 3 in 0.135 seconds
[0m20:59:50.109949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49a1e04e-29e9-4ddc-824f-e9c52450c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107edfd90>]}
[0m20:59:50.111404 [debug] [MainThread]: On master: ROLLBACK
[0m20:59:50.209470 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:50.210601 [debug] [MainThread]: On master: BEGIN
[0m20:59:50.387533 [debug] [MainThread]: SQL status: BEGIN in 0.176 seconds
[0m20:59:50.388669 [debug] [MainThread]: On master: COMMIT
[0m20:59:50.389647 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:50.390532 [debug] [MainThread]: On master: COMMIT
[0m20:59:50.513593 [debug] [MainThread]: SQL status: COMMIT in 0.122 seconds
[0m20:59:50.514887 [debug] [MainThread]: On master: Close
[0m20:59:50.520132 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m20:59:50.520938 [info ] [Thread-1 (]: 1 of 2 START sql incremental model dbt.events_clean ............................ [RUN]
[0m20:59:50.521571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_dbt, now model.dbt_scooters.events_clean)
[0m20:59:50.521994 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m20:59:50.571730 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m20:59:50.572339 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m20:59:50.596907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m20:59:50.597148 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp205950586683"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_h8qz"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_h8qz"."dbt"."events_clean")
    

  );
  
  
[0m20:59:50.597298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:53.281922 [debug] [Thread-1 (]: SQL status: SELECT 0 in 2.684 seconds
[0m20:59:53.299029 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m20:59:53.299525 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m20:59:53.380965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.081 seconds
[0m20:59:53.382153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m20:59:53.383002 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp205950586683'
        
      order by ordinal_position

  
[0m20:59:53.484799 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.101 seconds
[0m20:59:53.497700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m20:59:53.498250 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m20:59:53.585732 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.087 seconds
[0m20:59:53.609532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m20:59:53.609962 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp205950586683'
        
      order by ordinal_position

  
[0m20:59:53.688182 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.077 seconds
[0m20:59:53.696682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m20:59:53.697377 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m20:59:53.790375 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.092 seconds
[0m20:59:53.805194 [debug] [Thread-1 (]: 
    In "dev_h8qz"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:59:53.818884 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m20:59:53.819551 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m20:59:53.819860 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        delete from "dev_h8qz"."dbt"."events_clean" as DBT_INTERNAL_DEST
        where (user_id, timestamp, type_id) in (
            select distinct user_id, timestamp, type_id
            from "events_clean__dbt_tmp205950586683" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_h8qz"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp205950586683"
    )
  
[0m20:59:53.892676 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.072 seconds
[0m20:59:53.910621 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m20:59:53.911064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m20:59:53.911387 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m20:59:53.995455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.083 seconds
[0m20:59:54.001267 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m20:59:54.004283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49a1e04e-29e9-4ddc-824f-e9c52450c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f8e20>]}
[0m20:59:54.005054 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 0[0m in 3.48s]
[0m20:59:54.005668 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m20:59:54.006562 [debug] [Thread-2 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m20:59:54.007064 [info ] [Thread-2 (]: 2 of 2 START test events_full_is_complete ...................................... [RUN]
[0m20:59:54.007578 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_finance, now test.dbt_scooters.events_full_is_complete)
[0m20:59:54.007961 [debug] [Thread-2 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m20:59:54.010716 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m20:59:54.011412 [debug] [Thread-2 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m20:59:54.027013 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m20:59:54.027687 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m20:59:54.027929 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m20:59:54.028116 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:59:56.146040 [debug] [Thread-2 (]: SQL status: BEGIN in 2.117 seconds
[0m20:59:56.147750 [debug] [Thread-2 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m20:59:56.148755 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  with source_cte as (
    select count(*) as row_count
    from "dev_h8qz"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_h8qz"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
  
  
      
    ) dbt_internal_test
[0m20:59:58.401998 [debug] [Thread-2 (]: SQL status: SELECT 1 in 2.252 seconds
[0m20:59:58.409011 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m20:59:58.501169 [debug] [Thread-2 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m20:59:58.503595 [info ] [Thread-2 (]: 2 of 2 PASS events_full_is_complete ............................................ [[32mPASS[0m in 4.50s]
[0m20:59:58.504543 [debug] [Thread-2 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m20:59:58.506663 [info ] [MainThread]: 
[0m20:59:58.507315 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:58.507792 [debug] [MainThread]: On master: BEGIN
[0m20:59:58.508215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:59:59.525042 [debug] [MainThread]: SQL status: BEGIN in 1.016 seconds
[0m20:59:59.526676 [debug] [MainThread]: On master: COMMIT
[0m20:59:59.527759 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:59.528318 [debug] [MainThread]: On master: COMMIT
[0m20:59:59.627411 [debug] [MainThread]: SQL status: COMMIT in 0.098 seconds
[0m20:59:59.632435 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m20:59:59.638375 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m20:59:59.639279 [debug] [MainThread]: Using postgres connection "master"
[0m20:59:59.639771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m20:59:59.729865 [debug] [MainThread]: SQL status: GRANT in 0.089 seconds
[0m20:59:59.732190 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.10s]
[0m20:59:59.732914 [debug] [MainThread]: On master: Close
[0m20:59:59.734091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:59.734498 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m20:59:59.734864 [debug] [MainThread]: Connection 'test.dbt_scooters.events_full_is_complete' was properly closed.
[0m20:59:59.735281 [info ] [MainThread]: 
[0m20:59:59.735674 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook, 1 test in 0 hours 0 minutes and 13.04 seconds (13.04s).
[0m20:59:59.736715 [debug] [MainThread]: Command end result
[0m20:59:59.761109 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m20:59:59.762339 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m20:59:59.766125 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m20:59:59.766341 [info ] [MainThread]: 
[0m20:59:59.766564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:59:59.766732 [info ] [MainThread]: 
[0m20:59:59.766910 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m20:59:59.767868 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 13.365149, "process_in_blocks": "0", "process_kernel_time": 0.133662, "process_mem_max_rss": "139264000", "process_out_blocks": "0", "process_user_time": 1.158567}
[0m20:59:59.768116 [debug] [MainThread]: Command `dbt build` succeeded at 20:59:59.768066 after 13.37 seconds
[0m20:59:59.768317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d74dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ec940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082eccb0>]}
[0m20:59:59.768512 [debug] [MainThread]: Flushing usage events
[0m21:00:00.551069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:29.033320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074174d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089139d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108913b10>]}


============================== 21:00:29.035249 | dedc72eb-7a26-4ba4-ac5c-727a02fe3b1d ==============================
[0m21:00:29.035249 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:00:29.035514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/flerinvs/.dbt', 'log_path': '/Users/flerinvs/dbt_scooters/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build -s events_clean events_full', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:29.098847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dedc72eb-7a26-4ba4-ac5c-727a02fe3b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c17490>]}
[0m21:00:29.119548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dedc72eb-7a26-4ba4-ac5c-727a02fe3b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a9f20>]}
[0m21:00:29.119917 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:00:29.152597 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:00:29.214853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:29.215046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:29.242857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dedc72eb-7a26-4ba4-ac5c-727a02fe3b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109594b50>]}
[0m21:00:29.290805 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:00:29.291667 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:00:29.302430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dedc72eb-7a26-4ba4-ac5c-727a02fe3b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098efe30>]}
[0m21:00:29.302635 [info ] [MainThread]: Found 17 models, 3 seeds, 1 operation, 7 data tests, 15 sources, 439 macros
[0m21:00:29.303687 [info ] [MainThread]: 
[0m21:00:29.303831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:29.303941 [info ] [MainThread]: 
[0m21:00:29.304144 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:00:29.305591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz'
[0m21:00:29.323274 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz"
[0m21:00:29.323482 [debug] [ThreadPool]: On list_dev_h8qz: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz"} */

    select distinct nspname from pg_namespace
  
[0m21:00:29.323616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:30.449825 [debug] [ThreadPool]: SQL status: SELECT 25 in 1.126 seconds
[0m21:00:30.453643 [debug] [ThreadPool]: On list_dev_h8qz: Close
[0m21:00:30.459459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_h8qz, now list_dev_h8qz_finance)
[0m21:00:30.466888 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dev_h8qz_dbt'
[0m21:00:30.468906 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m21:00:30.470975 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m21:00:30.471370 [debug] [ThreadPool]: On list_dev_h8qz_finance: BEGIN
[0m21:00:30.471674 [debug] [ThreadPool]: On list_dev_h8qz_dbt: BEGIN
[0m21:00:30.471916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:30.472147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:31.576238 [debug] [ThreadPool]: SQL status: BEGIN in 1.104 seconds
[0m21:00:31.577699 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_dbt"
[0m21:00:31.578700 [debug] [ThreadPool]: On list_dev_h8qz_dbt: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_dbt"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m21:00:31.678527 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.099 seconds
[0m21:00:31.681460 [debug] [ThreadPool]: On list_dev_h8qz_dbt: ROLLBACK
[0m21:00:31.780965 [debug] [ThreadPool]: On list_dev_h8qz_dbt: Close
[0m21:00:32.293041 [debug] [ThreadPool]: SQL status: BEGIN in 1.821 seconds
[0m21:00:32.294557 [debug] [ThreadPool]: Using postgres connection "list_dev_h8qz_finance"
[0m21:00:32.295431 [debug] [ThreadPool]: On list_dev_h8qz_finance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "list_dev_h8qz_finance"} */
select
      'dev_h8qz' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'finance'
    union all
    select
      'dev_h8qz' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'finance'
  
[0m21:00:32.395339 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.099 seconds
[0m21:00:32.398389 [debug] [ThreadPool]: On list_dev_h8qz_finance: ROLLBACK
[0m21:00:32.497711 [debug] [ThreadPool]: On list_dev_h8qz_finance: Close
[0m21:00:32.508812 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:32.509397 [debug] [MainThread]: On master: BEGIN
[0m21:00:32.509841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:34.443419 [debug] [MainThread]: SQL status: BEGIN in 1.933 seconds
[0m21:00:34.444958 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:34.446299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:00:34.545573 [debug] [MainThread]: SQL status: SELECT 3 in 0.098 seconds
[0m21:00:34.550054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dedc72eb-7a26-4ba4-ac5c-727a02fe3b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b2890>]}
[0m21:00:34.550954 [debug] [MainThread]: On master: ROLLBACK
[0m21:00:34.648133 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:34.649374 [debug] [MainThread]: On master: BEGIN
[0m21:00:34.852754 [debug] [MainThread]: SQL status: BEGIN in 0.202 seconds
[0m21:00:34.854160 [debug] [MainThread]: On master: COMMIT
[0m21:00:34.855165 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:34.855838 [debug] [MainThread]: On master: COMMIT
[0m21:00:34.955303 [debug] [MainThread]: SQL status: COMMIT in 0.099 seconds
[0m21:00:34.956664 [debug] [MainThread]: On master: Close
[0m21:00:34.962966 [debug] [Thread-1 (]: Began running node model.dbt_scooters.events_clean
[0m21:00:34.963839 [info ] [Thread-1 (]: 1 of 3 START sql incremental model dbt.events_clean ............................ [RUN]
[0m21:00:34.964542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_h8qz_finance, now model.dbt_scooters.events_clean)
[0m21:00:34.965028 [debug] [Thread-1 (]: Began compiling node model.dbt_scooters.events_clean
[0m21:00:35.017505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_scooters.events_clean"
[0m21:00:35.018109 [debug] [Thread-1 (]: Began executing node model.dbt_scooters.events_clean
[0m21:00:35.042136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:00:35.042375 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

    
  
    

  create temporary table "events_clean__dbt_tmp210035031964"
  
  
    as
  
  (
    
select distinct
    user_id,
    "timestamp",
    type_id,
    
    now() as updated_at

from
    "dev_h8qz"."scooters_raw"."events"
where

    
        "timestamp" > (select max("timestamp") from "dev_h8qz"."dbt"."events_clean")
    

  );
  
  
[0m21:00:35.042527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:37.720477 [debug] [Thread-1 (]: SQL status: SELECT 0 in 2.677 seconds
[0m21:00:37.744025 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:00:37.744459 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: BEGIN
[0m21:00:37.822521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m21:00:37.823830 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:00:37.824769 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp210035031964'
        
      order by ordinal_position

  
[0m21:00:37.925052 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.099 seconds
[0m21:00:37.938614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:00:37.939260 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:00:38.027779 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.088 seconds
[0m21:00:38.049383 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:00:38.050000 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'events_clean__dbt_tmp210035031964'
        
      order by ordinal_position

  
[0m21:00:38.130111 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.079 seconds
[0m21:00:38.137118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:00:38.137864 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dev_h8qz".INFORMATION_SCHEMA.columns
      where table_name = 'events_clean'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m21:00:38.233541 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.095 seconds
[0m21:00:38.247770 [debug] [Thread-1 (]: 
    In "dev_h8qz"."dbt"."events_clean":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m21:00:38.258236 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_scooters.events_clean"
[0m21:00:38.258811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:00:38.259070 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_clean"} */

      
        delete from "dev_h8qz"."dbt"."events_clean" as DBT_INTERNAL_DEST
        where (user_id, timestamp, type_id) in (
            select distinct user_id, timestamp, type_id
            from "events_clean__dbt_tmp210035031964" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dev_h8qz"."dbt"."events_clean" ("user_id", "timestamp", "type_id", "updated_at")
    (
        select "user_id", "timestamp", "type_id", "updated_at"
        from "events_clean__dbt_tmp210035031964"
    )
  
[0m21:00:38.337510 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.078 seconds
[0m21:00:38.353852 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:00:38.354277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_scooters.events_clean"
[0m21:00:38.354551 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: COMMIT
[0m21:00:38.408221 [debug] [Thread-1 (]: SQL status: COMMIT in 0.053 seconds
[0m21:00:38.411424 [debug] [Thread-1 (]: On model.dbt_scooters.events_clean: Close
[0m21:00:38.414266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dedc72eb-7a26-4ba4-ac5c-727a02fe3b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d74e20>]}
[0m21:00:38.415190 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model dbt.events_clean ....................... [[32mINSERT 0 0[0m in 3.45s]
[0m21:00:38.415846 [debug] [Thread-1 (]: Finished running node model.dbt_scooters.events_clean
[0m21:00:38.416778 [debug] [Thread-2 (]: Began running node model.dbt_scooters.events_full
[0m21:00:38.417303 [info ] [Thread-2 (]: 2 of 3 START sql view model dbt.events_full .................................... [RUN]
[0m21:00:38.417854 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_scooters.events_full'
[0m21:00:38.418182 [debug] [Thread-2 (]: Began compiling node model.dbt_scooters.events_full
[0m21:00:38.420777 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_scooters.events_full"
[0m21:00:38.421567 [debug] [Thread-2 (]: Began executing node model.dbt_scooters.events_full
[0m21:00:38.435908 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_scooters.events_full"
[0m21:00:38.436564 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:00:38.436783 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: BEGIN
[0m21:00:38.436970 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:00:39.461392 [debug] [Thread-2 (]: SQL status: BEGIN in 1.024 seconds
[0m21:00:39.463143 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:00:39.464442 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */

  create view "dev_h8qz"."dbt"."events_full__dbt_tmp"
    
    
  as (
    select
    *
from
    "dev_h8qz"."dbt"."events_clean"
    left join "dev_h8qz"."dbt"."event_types"
        using (type_id)
  );
[0m21:00:39.563791 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.098 seconds
[0m21:00:39.577367 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:00:39.578053 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_h8qz"."dbt"."events_full" rename to "events_full__dbt_backup"
[0m21:00:39.666704 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.087 seconds
[0m21:00:39.674657 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:00:39.675276 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
alter table "dev_h8qz"."dbt"."events_full__dbt_tmp" rename to "events_full"
[0m21:00:39.769754 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.094 seconds
[0m21:00:39.775977 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m21:00:39.776610 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:00:39.777019 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: COMMIT
[0m21:00:39.869606 [debug] [Thread-2 (]: SQL status: COMMIT in 0.092 seconds
[0m21:00:39.881623 [debug] [Thread-2 (]: Applying DROP to: "dev_h8qz"."dbt"."events_full__dbt_backup"
[0m21:00:39.888648 [debug] [Thread-2 (]: Using postgres connection "model.dbt_scooters.events_full"
[0m21:00:39.889214 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "model.dbt_scooters.events_full"} */
drop view if exists "dev_h8qz"."dbt"."events_full__dbt_backup" cascade
[0m21:00:39.973353 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.083 seconds
[0m21:00:39.976935 [debug] [Thread-2 (]: On model.dbt_scooters.events_full: Close
[0m21:00:39.978668 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dedc72eb-7a26-4ba4-ac5c-727a02fe3b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b6e10>]}
[0m21:00:39.979930 [info ] [Thread-2 (]: 2 of 3 OK created sql view model dbt.events_full ............................... [[32mCREATE VIEW[0m in 1.56s]
[0m21:00:39.980980 [debug] [Thread-2 (]: Finished running node model.dbt_scooters.events_full
[0m21:00:39.982606 [debug] [Thread-3 (]: Began running node test.dbt_scooters.events_full_is_complete
[0m21:00:39.983329 [info ] [Thread-3 (]: 3 of 3 START test events_full_is_complete ...................................... [RUN]
[0m21:00:39.984478 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_scooters.events_full_is_complete'
[0m21:00:39.985068 [debug] [Thread-3 (]: Began compiling node test.dbt_scooters.events_full_is_complete
[0m21:00:39.990712 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_scooters.events_full_is_complete"
[0m21:00:39.991680 [debug] [Thread-3 (]: Began executing node test.dbt_scooters.events_full_is_complete
[0m21:00:40.008477 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_scooters.events_full_is_complete"
[0m21:00:40.009243 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m21:00:40.009509 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: BEGIN
[0m21:00:40.009732 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:00:40.997179 [debug] [Thread-3 (]: SQL status: BEGIN in 0.987 seconds
[0m21:00:40.998658 [debug] [Thread-3 (]: Using postgres connection "test.dbt_scooters.events_full_is_complete"
[0m21:00:40.999642 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "node_id": "test.dbt_scooters.events_full_is_complete"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  with source_cte as (
    select count(*) as row_count
    from "dev_h8qz"."dbt"."events_clean"
),
target_cte as (
    select count(*) as row_count
    from "dev_h8qz"."dbt"."events_full"
)
select
    'Row count mismatch' as error_message,
    source_cte.row_count as source_count,
    target_cte.row_count as target_count
from
    source_cte,
    target_cte
where
    source_cte.row_count != target_cte.row_count
  
  
      
    ) dbt_internal_test
[0m21:00:42.944842 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.943 seconds
[0m21:00:42.954206 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: ROLLBACK
[0m21:00:43.045206 [debug] [Thread-3 (]: On test.dbt_scooters.events_full_is_complete: Close
[0m21:00:43.047379 [info ] [Thread-3 (]: 3 of 3 PASS events_full_is_complete ............................................ [[32mPASS[0m in 3.06s]
[0m21:00:43.048499 [debug] [Thread-3 (]: Finished running node test.dbt_scooters.events_full_is_complete
[0m21:00:43.050778 [info ] [MainThread]: 
[0m21:00:43.051363 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:43.051730 [debug] [MainThread]: On master: BEGIN
[0m21:00:43.052051 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:44.171156 [debug] [MainThread]: SQL status: BEGIN in 1.119 seconds
[0m21:00:44.172081 [debug] [MainThread]: On master: COMMIT
[0m21:00:44.172674 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:44.173246 [debug] [MainThread]: On master: COMMIT
[0m21:00:44.273639 [debug] [MainThread]: SQL status: COMMIT in 0.100 seconds
[0m21:00:44.277402 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_scooters.dbt_scooters-on-run-end-0"
[0m21:00:44.282752 [info ] [MainThread]: 1 of 1 START hook: dbt_scooters.on-run-end.0 ................................... [RUN]
[0m21:00:44.283686 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:44.284219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "dbt_scooters", "target_name": "dev", "connection_name": "master"} */
grant usage on schema finance to finance;
[0m21:00:44.376256 [debug] [MainThread]: SQL status: GRANT in 0.091 seconds
[0m21:00:44.378259 [info ] [MainThread]: 1 of 1 OK hook: dbt_scooters.on-run-end.0 ...................................... [[32mOK[0m in 0.10s]
[0m21:00:44.378949 [debug] [MainThread]: On master: Close
[0m21:00:44.380048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:44.380407 [debug] [MainThread]: Connection 'model.dbt_scooters.events_clean' was properly closed.
[0m21:00:44.380711 [debug] [MainThread]: Connection 'list_dev_h8qz_dbt' was properly closed.
[0m21:00:44.380978 [debug] [MainThread]: Connection 'model.dbt_scooters.events_full' was properly closed.
[0m21:00:44.381279 [debug] [MainThread]: Connection 'test.dbt_scooters.events_full_is_complete' was properly closed.
[0m21:00:44.381802 [info ] [MainThread]: 
[0m21:00:44.382153 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook, 1 test, 1 view model in 0 hours 0 minutes and 15.08 seconds (15.08s).
[0m21:00:44.383253 [debug] [MainThread]: Command end result
[0m21:00:44.412674 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/flerinvs/dbt_scooters/target/manifest.json
[0m21:00:44.414223 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/flerinvs/dbt_scooters/target/semantic_manifest.json
[0m21:00:44.418302 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/flerinvs/dbt_scooters/target/run_results.json
[0m21:00:44.418512 [info ] [MainThread]: 
[0m21:00:44.418738 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:44.418911 [info ] [MainThread]: 
[0m21:00:44.419094 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:00:44.420139 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 15.411803, "process_in_blocks": "0", "process_kernel_time": 0.145956, "process_mem_max_rss": "141705216", "process_out_blocks": "0", "process_user_time": 1.243213}
[0m21:00:44.420413 [debug] [MainThread]: Command `dbt build` succeeded at 21:00:44.420357 after 15.41 seconds
[0m21:00:44.420635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ad020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f2ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f2adf0>]}
[0m21:00:44.420847 [debug] [MainThread]: Flushing usage events
[0m21:00:45.301415 [debug] [MainThread]: An error was encountered while trying to flush usage events
