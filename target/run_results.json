{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-11-19T10:11:36.942001Z", "invocation_id": "ff29b740-8ddd-4010-8f7b-c32173ea4253", "invocation_started_at": "2025-11-19T09:46:32.375157Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:46:46.484502Z", "completed_at": "2025-11-19T09:46:46.484507Z"}, {"name": "execute", "started_at": "2025-11-19T09:46:46.488074Z", "completed_at": "2025-11-19T09:46:51.385622Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.939378023147583, "adapter_response": {"_message": "INSERT 8", "code": "INSERT", "rows_affected": 8}, "message": "INSERT 8", "failures": null, "unique_id": "seed.dbt_scooters.age_groups", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:46:46.463688Z", "completed_at": "2025-11-19T09:46:46.503643Z"}, {"name": "execute", "started_at": "2025-11-19T09:46:46.504062Z", "completed_at": "2025-11-19T09:46:53.519712Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 7.064199209213257, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.dbt_scooters.events_clean", "compiled": true, "compiled_code": "\nselect distinct\n    user_id,\n    \"timestamp\",\n    type_id,\n    \n    now() as updated_at\n\nfrom\n    \"dev_m0z9\".\"scooters_raw\".\"events\"\nwhere\n    \n        \n            \"timestamp\" > (select max(\"timestamp\") from \"dev_m0z9\".\"dbt\".\"events_clean\")\n        \n    ", "relation_name": "\"dev_m0z9\".\"dbt\".\"events_clean\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:46:46.474459Z", "completed_at": "2025-11-19T09:46:50.959348Z"}, {"name": "execute", "started_at": "2025-11-19T09:46:50.960111Z", "completed_at": "2025-11-19T09:46:53.521769Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 7.064532995223999, "adapter_response": {"_message": "SELECT 91", "code": "SELECT", "rows_affected": 91}, "message": "SELECT 91", "failures": null, "unique_id": "model.dbt_scooters.time_spine_daily", "compiled": true, "compiled_code": "with days as (\n    \n\n\n    \n\n\n    with rawdata as (\n\n        \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n\n    p1.generated_number * power(2, 1)\n     + \n\n    p2.generated_number * power(2, 2)\n     + \n\n    p3.generated_number * power(2, 3)\n     + \n\n    p4.generated_number * power(2, 4)\n     + \n\n    p5.generated_number * power(2, 5)\n     + \n\n    p6.generated_number * power(2, 6)\n    \n\n    + 1\n    as generated_number\n\n    from\n\n    \n        \n        \n        \n        \n    p as p0\n     cross join \n\n        \n        \n        \n        \n    p as p1\n     cross join \n\n        \n        \n        \n        \n    p as p2\n     cross join \n\n        \n        \n        \n        \n    p as p3\n     cross join \n\n        \n        \n        \n        \n    p as p4\n     cross join \n\n        \n        \n        \n        \n    p as p5\n     cross join \n\n        \n        \n        \n        \n    p as p6\n    \n\n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 91\n    order by generated_number\n\n\n\n    ),\n\n    all_periods as (\n\n        select (\n            \n\ndate '2023-06-01' + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n        ) as date_day\n        from rawdata\n\n    ),\n\n    filtered as (\n\n        select *\n        from all_periods\n        where date_day <= date '2023-08-31'\n\n    )\n\n    select * from filtered\n\n),\n\nfinal as (\n    select cast(date_day as date) as date_day\n    from days\n)\n\nselect *\nfrom final", "relation_name": "\"dev_m0z9\".\"dbt\".\"time_spine_daily\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:46:46.484759Z", "completed_at": "2025-11-19T09:46:46.510324Z"}, {"name": "execute", "started_at": "2025-11-19T09:46:46.525888Z", "completed_at": "2025-11-19T09:46:54.301291Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 7.8411619663238525, "adapter_response": {"_message": "SELECT 91", "code": "SELECT", "rows_affected": 91}, "message": "SELECT 91", "failures": null, "unique_id": "model.dbt_scooters.trips_stat_daily", "compiled": true, "compiled_code": "select\n    date(started_at) as date,\n    count(*) as trips,\n    max(price) / 100 as max_price_rub,\n    avg(distance) / 1000 as avg_distance_km\nfrom\n    scooters_raw.trips\ngroup by\n    1\norder by\n    1", "relation_name": "\"dev_m0z9\".\"dbt\".\"trips_stat_daily\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:46:51.406678Z", "completed_at": "2025-11-19T09:46:51.406682Z"}, {"name": "execute", "started_at": "2025-11-19T09:46:51.406984Z", "completed_at": "2025-11-19T09:46:56.693633Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 5.299937009811401, "adapter_response": {"_message": "INSERT 4", "code": "INSERT", "rows_affected": 4}, "message": "INSERT 4", "failures": null, "unique_id": "seed.dbt_scooters.event_types", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:46:53.532813Z", "completed_at": "2025-11-19T09:46:53.547877Z"}, {"name": "execute", "started_at": "2025-11-19T09:46:53.548152Z", "completed_at": "2025-11-19T09:46:56.698812Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.568612813949585, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b", "compiled": true, "compiled_code": "\n    \n    \n    \n    \n    \n    \n\nwith all_values as (\n\n    select\n        sex as value_field,\n        count(*) as n_records\n\n    from \"dev_m0z9\".\"scooters_raw\".\"users\"\n    group by sex\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:46:53.532470Z", "completed_at": "2025-11-19T09:46:53.532474Z"}, {"name": "execute", "started_at": "2025-11-19T09:46:53.542445Z", "completed_at": "2025-11-19T09:46:57.713109Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.183931112289429, "adapter_response": {"_message": "INSERT 10", "code": "INSERT", "rows_affected": 10}, "message": "INSERT 10", "failures": null, "unique_id": "seed.dbt_scooters.scooters", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:46:54.308677Z", "completed_at": "2025-11-19T09:46:54.319731Z"}, {"name": "execute", "started_at": "2025-11-19T09:46:54.320201Z", "completed_at": "2025-11-19T09:46:57.510728Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.6105000972747803, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"dev_m0z9\".\"scooters_raw\".\"trips\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:46:57.109109Z", "completed_at": "2025-11-19T09:46:57.117092Z"}, {"name": "execute", "started_at": "2025-11-19T09:46:57.117452Z", "completed_at": "2025-11-19T09:47:01.092150Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 4.2909040451049805, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from \"dev_m0z9\".\"scooters_raw\".\"trips\"\n    where user_id is not null\n),\n\nparent as (\n    select id as to_field\n    from \"dev_m0z9\".\"scooters_raw\".\"users\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:46:57.923288Z", "completed_at": "2025-11-19T09:46:57.931660Z"}, {"name": "execute", "started_at": "2025-11-19T09:46:57.932276Z", "completed_at": "2025-11-19T09:47:01.191866Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.581207036972046, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.not_null_age_groups_age_end.36cb13bced", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect age_end\nfrom \"dev_m0z9\".\"dbt\".\"age_groups\"\nwhere age_end is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2025-11-19T09:46:56.709172Z", "completed_at": "2025-11-19T09:46:56.713596Z"}, {"name": "execute", "started_at": "2025-11-19T09:46:56.713857Z", "completed_at": "2025-11-19T09:47:01.502520Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 5.204190015792847, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "Got 216 results, configured to warn if != 0", "failures": 216, "unique_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sex\nfrom \"dev_m0z9\".\"scooters_raw\".\"users\"\nwhere sex is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:46:57.720476Z", "completed_at": "2025-11-19T09:46:57.727345Z"}, {"name": "execute", "started_at": "2025-11-19T09:46:57.727764Z", "completed_at": "2025-11-19T09:47:03.549475Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.137785196304321, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.not_null_age_groups__group_.bc0eed307f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect \"group\"\nfrom \"dev_m0z9\".\"dbt\".\"age_groups\"\nwhere \"group\" is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:01.506968Z", "completed_at": "2025-11-19T09:47:01.516027Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:01.516370Z", "completed_at": "2025-11-19T09:47:06.388681Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 5.191751956939697, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.unique_age_groups__group_.547060b253", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    \"group\" as unique_field,\n    count(*) as n_records\n\nfrom \"dev_m0z9\".\"dbt\".\"age_groups\"\nwhere \"group\" is not null\ngroup by \"group\"\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:01.403401Z", "completed_at": "2025-11-19T09:47:01.410601Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:01.411094Z", "completed_at": "2025-11-19T09:47:06.393656Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 5.29629921913147, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.not_null_age_groups_age_start.c680df771d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect age_start\nfrom \"dev_m0z9\".\"dbt\".\"age_groups\"\nwhere age_start is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:01.917156Z", "completed_at": "2025-11-19T09:47:01.922406Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:01.922775Z", "completed_at": "2025-11-19T09:47:07.442051Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 5.527939081192017, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_scooters.events_full", "compiled": true, "compiled_code": "select *\nfrom\n    \"dev_m0z9\".\"dbt\".\"events_clean\"\nleft join \"dev_m0z9\".\"dbt\".\"event_types\"\n    using (type_id)", "relation_name": "\"dev_m0z9\".\"dbt\".\"events_full\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:03.861201Z", "completed_at": "2025-11-19T09:47:03.866136Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:03.866610Z", "completed_at": "2025-11-19T09:47:08.570663Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.712118864059448, "adapter_response": {"_message": "SELECT 6", "code": "SELECT", "rows_affected": 6}, "message": "SELECT 6", "failures": null, "unique_id": "model.dbt_scooters.companies", "compiled": true, "compiled_code": "select\n    company,\n    count(*) as models,\n    sum(scooters) as scooters\nfrom\n    \"dev_m0z9\".\"dbt\".\"scooters\"\ngroup by\n    1", "relation_name": "\"dev_m0z9\".\"dbt\".\"companies\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:06.710566Z", "completed_at": "2025-11-19T09:47:06.714805Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:06.715711Z", "completed_at": "2025-11-19T09:47:12.255936Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 5.559201002120972, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_scooters.trips_geom", "compiled": true, "compiled_code": "select\n    id,\n    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,\n    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point\nfrom\n    \"dev_m0z9\".\"scooters_raw\".\"trips\"", "relation_name": "\"dev_m0z9\".\"dbt\".\"trips_geom\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:06.704980Z", "completed_at": "2025-11-19T09:47:06.715307Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:06.719524Z", "completed_at": "2025-11-19T09:47:12.461767Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 5.760788917541504, "adapter_response": {"_message": "SELECT 10", "code": "SELECT", "rows_affected": 10}, "message": "SELECT 10", "failures": null, "unique_id": "model.dbt_scooters.trips_concurrency", "compiled": true, "compiled_code": "with\nunnest_cte as (\n    -- Unnest trip to two rows: start and finish events\n    select\n        unnest(array[started_at, finished_at]) as \"timestamp\",\n        unnest(array[1, -1]) as \"increment\"\n    from\n        \"dev_m0z9\".\"scooters_raw\".\"trips\"\n),\n\nsum_cte as (\n    -- Make timestamp unique, group increments, add initial concurrency from history\n    select\n        \"timestamp\",\n        true as preserve_row,  -- \u041f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u043b\u0438 \u043f\u0440\u043e\u0441\u0442\u0443\u044e \u043a\u043e\u043b\u043e\u043d\u043a\u0443 \u043f\u0435\u0440\u0435\u0434 \u0430\u0433\u0440\u0435\u0433\u0430\u0442\u043e\u043c\n        sum(\"increment\") as \"increment\"\n    from\n        unnest_cte\n    where\n        \n            \"timestamp\"\n            < (\n                date '2023-06-01' + interval '7' hour\n            ) at time zone 'Europe/Moscow'\n        \n    group by\n        1\n    \n),\n\ncumsum_cte as (\n    -- Integrate increment to get concurrency\n    select\n        \"timestamp\",\n        preserve_row,\n        sum(\"increment\") over (order by \"timestamp\") as concurrency\n    from\n        sum_cte\n)\n\nselect\n    \"timestamp\",      -- \u041f\u0440\u043e\u0441\u0442\u0430\u044f \u043a\u043e\u043b\u043e\u043d\u043a\u0430\n    concurrency,      -- \u041f\u0440\u043e\u0441\u0442\u0430\u044f \u043a\u043e\u043b\u043e\u043d\u043a\u0430  \n    \n    now() as updated_at\n  -- \u0412\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0435 (\u043c\u0430\u043a\u0440\u043e\u0441) - \u0432 \u043a\u043e\u043d\u0446\u0435\nfrom\n    cumsum_cte\nwhere\n    preserve_row\norder by\n    1\n\n-- \u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u044d\u0442\u0443 \u043f\u0443\u0441\u0442\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443 \u0432 \u043a\u043e\u043d\u0435\u0446 \u0444\u0430\u0439\u043b\u0430", "relation_name": "\"dev_m0z9\".\"dbt\".\"trips_concurrency\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:08.576934Z", "completed_at": "2025-11-19T09:47:08.581566Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:08.581939Z", "completed_at": "2025-11-19T09:47:13.382065Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.807996988296509, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_scooters.users_prep", "compiled": true, "compiled_code": "select\n    id,\n    sex,\n    birth_date\nfrom\n    \"dev_m0z9\".\"scooters_raw\".\"users\"", "relation_name": "\"dev_m0z9\".\"dbt\".\"users_prep\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:07.450667Z", "completed_at": "2025-11-19T09:47:07.455667Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:07.456094Z", "completed_at": "2025-11-19T09:47:13.586747Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 6.139014005661011, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_scooters.trips_prep", "compiled": true, "compiled_code": "select\n    id,\n    user_id,\n    scooter_hw_id,\n    started_at,\n    finished_at,\n    start_lat,\n    start_lon,\n    finish_lat,\n    finish_lon,\n    distance as distance_m,\n    cast(price as decimal(20, 2)) / 100 as price_rub,\n    extract(epoch from (finished_at - started_at)) as duration_s,\n    finished_at <> started_at and price = 0 as is_free,\n    \n    date(started_at at time zone 'Europe/Moscow')\n as \"date\"\nfrom\n    \"dev_m0z9\".\"scooters_raw\".\"trips\"", "relation_name": "\"dev_m0z9\".\"dbt\".\"trips_prep\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:12.267259Z", "completed_at": "2025-11-19T09:47:12.276631Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:12.276952Z", "completed_at": "2025-11-19T09:47:16.352488Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 4.395092010498047, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.events_full_is_complete", "compiled": true, "compiled_code": "with source_cte as (\n    select count(*) as row_count\n    from \"dev_m0z9\".\"dbt\".\"events_clean\"\n),\n\ntarget_cte as (\n    select count(*) as row_count\n    from \"dev_m0z9\".\"dbt\".\"events_full\"\n)\n\nselect\n    'Row count mismatch' as error_message,\n    source_cte.row_count as source_count,\n    target_cte.row_count as target_count\nfrom\n    source_cte,\n    target_cte\nwhere\n    source_cte.row_count != target_cte.row_count", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:13.594388Z", "completed_at": "2025-11-19T09:47:13.601840Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:13.602250Z", "completed_at": "2025-11-19T09:47:20.040626Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 6.448849201202393, "adapter_response": {"_message": "SELECT 6", "code": "SELECT", "rows_affected": 6}, "message": "SELECT 6", "failures": null, "unique_id": "model.dbt_scooters.companies_trips", "compiled": true, "compiled_code": "with trips_cte as (\n    select\n        company,\n        count(*) as trips\n    from\n        \"dev_m0z9\".\"dbt\".\"trips_prep\" as t\n    inner join \"dev_m0z9\".\"dbt\".\"scooters\" as s\n        on t.scooter_hw_id = s.hardware_id\n    group by\n        1\n)\n\nselect\n    company,\n    t.trips,\n    c.scooters,\n    t.trips / cast(c.scooters as float) as trips_per_scooter\nfrom\n    trips_cte as t\ninner join \"dev_m0z9\".\"dbt\".\"companies\" as c\n    using (company)", "relation_name": "\"dev_m0z9\".\"dbt\".\"companies_trips\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:16.666352Z", "completed_at": "2025-11-19T09:47:16.673501Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:16.673966Z", "completed_at": "2025-11-19T09:47:26.110111Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 9.4463050365448, "adapter_response": {"_message": "INSERT 0 3", "code": "INSERT", "rows_affected": 3}, "message": "INSERT 0 3", "failures": null, "unique_id": "model.dbt_scooters.revenue_daily", "compiled": true, "compiled_code": "select\n    sum(price_rub) as revenue_rub,\n    \"date\",\n    \n    now() as updated_at\n\nfrom\n    \"dev_m0z9\".\"dbt\".\"trips_prep\"\n\n    where\n        \"date\" >= (select max(\"date\") - interval '2' day from \"dev_m0z9\".\"dbt\".\"revenue_daily\")\n\ngroup by\n    2,\n    3\norder by\n    2", "relation_name": "\"dev_m0z9\".\"dbt\".\"revenue_daily\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:20.047939Z", "completed_at": "2025-11-19T09:47:20.052549Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:20.052983Z", "completed_at": "2025-11-19T09:47:29.960262Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 9.914463996887207, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "SELECT 1", "failures": null, "unique_id": "model.dbt_scooters.trips_stat", "compiled": true, "compiled_code": "select\n    count(id) as trips,\n    count(distinct user_id) as users,\n    avg(duration_s) / 60 as avg_duration_m,\n    sum(distance_m) / 1000 as sum_distance_km,\n    sum(price_rub) as revenue_rub,\n    count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct\nfrom \"dev_m0z9\".\"dbt\".\"trips_prep\"", "relation_name": "\"dev_m0z9\".\"dbt\".\"trips_stat\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:29.966724Z", "completed_at": "2025-11-19T09:47:29.972146Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:29.972799Z", "completed_at": "2025-11-19T09:47:44.497809Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 14.53342604637146, "adapter_response": {"_message": "SELECT 1997", "code": "SELECT", "rows_affected": 1997}, "message": "SELECT 1997", "failures": null, "unique_id": "model.dbt_scooters.users_class_monthly_trips", "compiled": true, "compiled_code": "with monthly_stat_cte as (\n    /* For each user, we find the monthly trip statistics:\n      trips_per_month - the number of trips per month */\n    select\n        user_id,\n        date_trunc('month', \"date\") as \"month\",\n        count(*) as trips_per_month\n    from\n        \"dev_m0z9\".\"dbt\".\"trips_prep\"\n    group by\n        1,\n        2\n)\n\n/* User profiling based on the number of trips per month:\n  rare - infrequent/occasional trips, no more than 2 trips per month */\nselect\n    user_id,\n    sum(trips_per_month) <= 2 as rare\nfrom\n    monthly_stat_cte\ngroup by\n    1", "relation_name": "\"dev_m0z9\".\"dbt\".\"users_class_monthly_trips\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:26.116357Z", "completed_at": "2025-11-19T09:47:26.122900Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:26.123598Z", "completed_at": "2025-11-19T09:47:50.865029Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 24.752322912216187, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.dbt_scooters.trips_users", "compiled": true, "compiled_code": "select\n    t.*,\n    u.sex,\n    extract(year from t.started_at) - extract(year from u.birth_date) as age,\n    \n    now() as updated_at\n\nfrom\n    \"dev_m0z9\".\"dbt\".\"trips_prep\" as t\nleft join\n    \"dev_m0z9\".\"scooters_raw\".\"users\" as u\n    on t.user_id = u.id\n\n    where\n        t.id > (select max(id) from \"dev_m0z9\".\"dbt\".\"trips_users\")\n    order by\n        t.id\n    limit\n        75000\n", "relation_name": "\"dev_m0z9\".\"dbt\".\"trips_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:12.468195Z", "completed_at": "2025-11-19T09:47:12.473718Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:12.474178Z", "completed_at": "2025-11-19T09:47:51.476487Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 39.010838985443115, "adapter_response": {"_message": "SELECT 464", "code": "SELECT", "rows_affected": 464}, "message": "SELECT 464", "failures": null, "unique_id": "model.dbt_scooters.parking_finish_stat", "compiled": true, "compiled_code": "-- select\n--     st_transform(hex.geom, 4326) as geom,\n--     count(*) as trips\n-- from\n--     \"dev_m0z9\".\"dbt\".\"trips_geom\" as t\n-- cross join\n--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex\n-- where\n--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)\n-- group by\n--     1\n\n\nselect\n    st_transform(hex.geom, 4326) as geom,\n    count(*) as trips\nfrom\n    \"dev_m0z9\".\"dbt\".\"trips_geom\"\ncross join\n    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex\nwhere\n    st_intersects(st_transform(finish_point, 3857), hex.geom)\ngroup by\n    1\n", "relation_name": "\"dev_m0z9\".\"dbt\".\"parking_finish_stat\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:13.390129Z", "completed_at": "2025-11-19T09:47:13.396512Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:13.396903Z", "completed_at": "2025-11-19T09:47:57.721301Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 44.33392906188965, "adapter_response": {"_message": "SELECT 142", "code": "SELECT", "rows_affected": 142}, "message": "SELECT 142", "failures": null, "unique_id": "model.dbt_scooters.parking_start_stat", "compiled": true, "compiled_code": "-- select\n--     st_transform(hex.geom, 4326) as geom,\n--     count(*) as trips\n-- from\n--     \"dev_m0z9\".\"dbt\".\"trips_geom\" as t\n-- cross join\n--     st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex\n-- where\n--     st_intersects(st_transform(t.start_point, 3857), hex.geom)\n-- group by\n--     1\n\nselect\n    st_transform(hex.geom, 4326) as geom,\n    count(*) as trips\nfrom\n    \"dev_m0z9\".\"dbt\".\"trips_geom\"\ncross join\n    st_hexagongrid(500, st_transform(start_point, 3857)) as hex\nwhere\n    st_intersects(st_transform(start_point, 3857), hex.geom)\ngroup by\n    1\n", "relation_name": "\"dev_m0z9\".\"dbt\".\"parking_start_stat\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:50.872983Z", "completed_at": "2025-11-19T09:47:50.878355Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:50.879007Z", "completed_at": "2025-11-19T09:48:00.282791Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 9.412551879882812, "adapter_response": {"_message": "SELECT 1997", "code": "SELECT", "rows_affected": 1997}, "message": "SELECT 1997", "failures": null, "unique_id": "model.dbt_scooters.users_class_weekly_trips", "compiled": true, "compiled_code": "with weekly_stat_cte as (\n    /* For each user, we find the trip statistics by weeks:\n      days_per_week - the number of days with trips per week */\n    select\n        user_id,\n        date_trunc('week', \"date\") as \"week\",\n        count(distinct \"date\") as days_per_week\n    from\n        \"dev_m0z9\".\"dbt\".\"trips_prep\"\n    group by\n        1,\n        2\n)\n\nselect\n    user_id,\n    avg(days_per_week) >= 6 as fan,\n    avg(days_per_week) >= 3 as regular\nfrom\n    weekly_stat_cte\ngroup by\n    1", "relation_name": "\"dev_m0z9\".\"dbt\".\"users_class_weekly_trips\"", "batch_results": null}, {"status": "no-op", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:00.288931Z", "completed_at": "2025-11-19T09:48:00.288936Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:00.289410Z", "completed_at": "2025-11-19T09:48:00.289425Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0019130706787109375, "adapter_response": {}, "message": "NO-OP", "failures": 0, "unique_id": "exposure.dbt_scooters.financial_dashboard", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:00.292690Z", "completed_at": "2025-11-19T09:48:00.298513Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:00.299114Z", "completed_at": "2025-11-19T09:48:04.171984Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 4.187523126602173, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.unique_key_users_class_monthly_trips_user_id.c809757c64", "compiled": true, "compiled_code": "\nselect\n    \n        \"user_id\"::text ||\n    \n    ''\nfrom\n    \"dev_m0z9\".\"dbt\".\"users_class_monthly_trips\"\ngroup by\n    1\nhaving\n    count(*) > 1\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:51.483991Z", "completed_at": "2025-11-19T09:47:51.489913Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:51.490300Z", "completed_at": "2025-11-19T09:48:08.574902Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 17.093379974365234, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "SELECT 1", "failures": null, "unique_id": "model.dbt_scooters.events_stat", "compiled": true, "compiled_code": "select\n    count(\"type\" = 'cancel_search' or null)\n    / cast(count(\"type\" = 'start_search' or null) as float)\n    * 100 as cancel_pct\nfrom\n    \"dev_m0z9\".\"dbt\".\"events_full\"", "relation_name": "\"dev_m0z9\".\"dbt\".\"events_stat\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:57.741081Z", "completed_at": "2025-11-19T09:47:57.744512Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:57.744800Z", "completed_at": "2025-11-19T09:48:08.326450Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 10.863466024398804, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    company as unique_field,\n    count(*) as n_records\n\nfrom \"dev_m0z9\".\"dbt\".\"companies_trips\"\nwhere company is not null\ngroup by company\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:47:44.503422Z", "completed_at": "2025-11-19T09:47:44.507486Z"}, {"name": "execute", "started_at": "2025-11-19T09:47:44.508212Z", "completed_at": "2025-11-19T09:48:09.498788Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 24.998321056365967, "adapter_response": {"_message": "SELECT 1997", "code": "SELECT", "rows_affected": 1997}, "message": "SELECT 1997", "failures": null, "unique_id": "model.dbt_scooters.users_class_weekly_destination_trips", "compiled": true, "compiled_code": "with\ndaily_stat_cte as (\n    /* For each user, we find the trip statistics to each destination\n    for each day:\n      morning_trips - the number of morning trips */\n    select\n        user_id,\n        \"date\",\n        st_snaptogrid(\n            st_makepoint(finish_lon, finish_lat), 0.001\n        ) as destination,\n        count(\n            case when extract(\n                hour from started_at at time zone 'Europe/Moscow'\n            ) between 6 and 10 then 1 end\n        ) as morning_trips\n    from\n        \"dev_m0z9\".\"dbt\".\"trips_prep\"\n    group by\n        1,\n        2,\n        3\n),\n\nweekly_stat_cte as (\n    /* For each user, we find the trip statistics to each destination\n    for each week:\n      morning_trip_days - the number of days with morning trips */\n    select\n        user_id,\n        destination,\n        date_trunc('week', \"date\") as \"week\",\n        count(\n            distinct\n            case when morning_trips > 0 then \"date\" end\n        ) as morning_trip_days\n    from\n        daily_stat_cte\n    group by\n        1,\n        2,\n        3\n),\n\nprep_weekly_destination_trips_cte as (\n    /* Preparing data for profiling users based on trips to a specific destination during the week.\n    For each user, we find the list of unique destinations\n    and the trip statistics to those destinations:\n      avg_morning_trip_days - the average number of days with morning trips per week */\n    select\n        user_id,\n        destination,\n        avg(morning_trip_days) as avg_morning_trip_days\n    from\n        weekly_stat_cte\n    group by\n        1,\n        2\n)\n\nselect\n    user_id,\n    max(avg_morning_trip_days) >= 3 as to_work\nfrom\n    prep_weekly_destination_trips_cte\ngroup by\n    1", "relation_name": "\"dev_m0z9\".\"dbt\".\"users_class_weekly_destination_trips\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:08.606535Z", "completed_at": "2025-11-19T09:48:08.608982Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:08.609207Z", "completed_at": "2025-11-19T09:48:14.207887Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.603488922119141, "adapter_response": {"_message": "SELECT 7049", "code": "SELECT", "rows_affected": 7049}, "message": "SELECT 7049", "failures": null, "unique_id": "model.dbt_scooters.trips_age_daily", "compiled": true, "compiled_code": "select\n    \"date\",\n    age,\n    count(*) as trips,\n    sum(price_rub) as revenue_rub\nfrom\n    \"dev_m0z9\".\"dbt\".\"trips_users\"\ngroup by\n    1,\n    2", "relation_name": "\"dev_m0z9\".\"dbt\".\"trips_age_daily\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:08.581077Z", "completed_at": "2025-11-19T09:48:08.590011Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:08.590657Z", "completed_at": "2025-11-19T09:48:20.739134Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 12.16097116470337, "adapter_response": {"_message": "SELECT 83", "code": "SELECT", "rows_affected": 83}, "message": "SELECT 83", "failures": null, "unique_id": "model.dbt_scooters.sex_age_pivot", "compiled": true, "compiled_code": "select\n    age,\n    \n  \n    sum(\n      \n      case\n      when sex = 'M'\n        then 1\n      else 0\n      end\n    )\n    \n      \n            as \"M\"\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when sex = 'F'\n        then 1\n      else 0\n      end\n    )\n    \n      \n            as \"F\"\n      \n    \n    \n  \n\nfrom\n    \"dev_m0z9\".\"dbt\".\"trips_users\"\ngroup by\n    1\norder by\n    1", "relation_name": "\"dev_m0z9\".\"dbt\".\"sex_age_pivot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:04.483749Z", "completed_at": "2025-11-19T09:48:04.489854Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:04.490728Z", "completed_at": "2025-11-19T09:48:25.267275Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 20.7864089012146, "adapter_response": {"_message": "SELECT 4982", "code": "SELECT", "rows_affected": 4982}, "message": "SELECT 4982", "failures": null, "unique_id": "model.dbt_scooters.revenue_user_monthly", "compiled": true, "compiled_code": "select\n    user_id,\n    date(date_trunc('month', \"date\")) as \"month\",\n    sum(price_rub) as revenue_total\nfrom\n    \"dev_m0z9\".\"dbt\".\"trips_users\"\nwhere\n    not is_free\ngroup by\n    1,\n    2", "relation_name": "\"dev_m0z9\".\"dbt\".\"revenue_user_monthly\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:10.626404Z", "completed_at": "2025-11-19T09:48:10.629348Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:10.629577Z", "completed_at": "2025-11-19T09:48:28.801631Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 18.17740511894226, "adapter_response": {"_message": "SELECT 7", "code": "SELECT", "rows_affected": 7}, "message": "SELECT 7", "failures": null, "unique_id": "model.dbt_scooters.trips_age_group", "compiled": true, "compiled_code": "select\n    ag.\"group\" as age_group,\n    count(*) as trips,\n    sum(price_rub) as revenue_rub\nfrom\n    \"dev_m0z9\".\"dbt\".\"trips_users\" as tu\ncross join \"dev_m0z9\".\"dbt\".\"age_groups\" as ag\nwhere\n    tu.age >= ag.age_start\n    and tu.age <= ag.age_end\ngroup by\n    1", "relation_name": "\"dev_m0z9\".\"dbt\".\"trips_age_group\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:14.215593Z", "completed_at": "2025-11-19T09:48:14.223461Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:14.223884Z", "completed_at": "2025-11-19T09:48:30.181761Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 15.968744993209839, "adapter_response": {"_message": "SELECT 14459", "code": "SELECT", "rows_affected": 14459}, "message": "SELECT 14459", "failures": null, "unique_id": "model.dbt_scooters.trips_age_sex_daily", "compiled": true, "compiled_code": "select\n    \"date\",\n    age,\n    coalesce(sex, 'UNKNOWN') as sex,\n    count(*) as trips,\n    sum(price_rub) as revenue_rub\nfrom\n    \"dev_m0z9\".\"dbt\".\"trips_users\"\ngroup by\n    1,\n    2,\n    3\n", "relation_name": "\"dev_m0z9\".\"dbt\".\"trips_age_sex_daily\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:25.274954Z", "completed_at": "2025-11-19T09:48:25.280456Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:25.281282Z", "completed_at": "2025-11-19T09:48:31.921816Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 6.649230718612671, "adapter_response": {"_message": "SELECT 2706", "code": "SELECT", "rows_affected": 2706}, "message": "SELECT 2706", "failures": null, "unique_id": "model.dbt_scooters.trips_age_sex_weekly", "compiled": true, "compiled_code": "select\n    date_trunc('week', \"date\")::date as \"week\",\n    age,\n    coalesce(sex, 'UNKNOWN') as sex,\n    count(*) as trips,\n    sum(price_rub) as revenue_rub\nfrom\n    \"dev_m0z9\".\"dbt\".\"trips_users\"\ngroup by\n    1,\n    2,\n    3\n", "relation_name": "\"dev_m0z9\".\"dbt\".\"trips_age_sex_weekly\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:20.746753Z", "completed_at": "2025-11-19T09:48:20.753274Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:20.753873Z", "completed_at": "2025-11-19T09:48:34.587618Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 13.843281984329224, "adapter_response": {"_message": "SELECT 644", "code": "SELECT", "rows_affected": 644}, "message": "SELECT 644", "failures": null, "unique_id": "model.dbt_scooters.trips_age_sex_monthly", "compiled": true, "compiled_code": "select\n    date_trunc('month', \"date\")::date as \"month\",\n    age,\n    coalesce(sex, 'UNKNOWN') as sex,\n    count(*) as trips,\n    sum(price_rub) as revenue_rub\nfrom\n    \"dev_m0z9\".\"dbt\".\"trips_users\"\ngroup by\n    1,\n    2,\n    3\n", "relation_name": "\"dev_m0z9\".\"dbt\".\"trips_age_sex_monthly\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:30.189309Z", "completed_at": "2025-11-19T09:48:30.196375Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:30.196811Z", "completed_at": "2025-11-19T09:48:34.996914Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.113682746887207, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.unique_key_users_class_weekly_trips_user_id.448227cbed", "compiled": true, "compiled_code": "\nselect\n    \n        \"user_id\"::text ||\n    \n    ''\nfrom\n    \"dev_m0z9\".\"dbt\".\"users_class_weekly_trips\"\ngroup by\n    1\nhaving\n    count(*) > 1\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:35.305989Z", "completed_at": "2025-11-19T09:48:35.315219Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:35.315914Z", "completed_at": "2025-11-19T09:48:38.886013Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.888495922088623, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date::text || age::text as unique_field,\n    count(*) as n_records\n\nfrom \"dev_m0z9\".\"dbt\".\"trips_age_daily\"\nwhere date::text || age::text is not null\ngroup by date::text || age::text\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:39.197143Z", "completed_at": "2025-11-19T09:48:39.204724Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:39.205214Z", "completed_at": "2025-11-19T09:48:44.723319Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.831844806671143, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.dbt_utils_not_constant_sex_age_pivot_age.9ecbeb855a", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n    \n    \n    \n    count(distinct age) as filler_column\n\nfrom \"dev_m0z9\".\"dbt\".\"sex_age_pivot\"\n\n  \n\nhaving count(distinct age) = 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:31.927398Z", "completed_at": "2025-11-19T09:48:31.932097Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:31.932628Z", "completed_at": "2025-11-19T09:48:46.620933Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 15.151354789733887, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.unique_key_users_class_weekly_destination_trips_user_id.8c217869eb", "compiled": true, "compiled_code": "\nselect\n    \n        \"user_id\"::text ||\n    \n    ''\nfrom\n    \"dev_m0z9\".\"dbt\".\"users_class_weekly_destination_trips\"\ngroup by\n    1\nhaving\n    count(*) > 1\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:34.593113Z", "completed_at": "2025-11-19T09:48:34.601751Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:34.602482Z", "completed_at": "2025-11-19T09:48:48.813632Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 14.532227039337158, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be", "compiled": true, "compiled_code": "\nselect\n    \n        \"date\"::text ||\n    \n        \"age\"::text ||\n    \n    ''\nfrom\n    \"dev_m0z9\".\"dbt\".\"trips_age_daily\"\ngroup by\n    1\nhaving\n    count(*) > 1\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:45.031256Z", "completed_at": "2025-11-19T09:48:45.037868Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:45.038701Z", "completed_at": "2025-11-19T09:48:49.023855Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.300014019012451, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.unique_key_sex_age_pivot_age.335aa775d9", "compiled": true, "compiled_code": "\nselect\n    \n        \"age\"::text ||\n    \n    ''\nfrom\n    \"dev_m0z9\".\"dbt\".\"sex_age_pivot\"\ngroup by\n    1\nhaving\n    count(*) > 1\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:49.334625Z", "completed_at": "2025-11-19T09:48:49.338969Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:49.339510Z", "completed_at": "2025-11-19T09:48:54.044324Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.712399959564209, "adapter_response": {"_message": "SELECT 83", "code": "SELECT", "rows_affected": 83}, "message": "SELECT 83", "failures": null, "unique_id": "model.dbt_scooters.trips_age_daily_stat", "compiled": true, "compiled_code": "select\n    age,\n    avg(trips) as avg_trips,\n    avg(revenue_rub) as avg_revenue_rub\nfrom\n    \"dev_m0z9\".\"dbt\".\"trips_age_daily\"\ngroup by\n    1\norder by\n    1", "relation_name": "\"dev_m0z9\".\"dbt\".\"trips_age_daily_stat\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:47.082706Z", "completed_at": "2025-11-19T09:48:47.090140Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:47.090603Z", "completed_at": "2025-11-19T09:49:01.826368Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 15.15300989151001, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.unique_key_revenue_user_monthly_user_id__month.9e62d1fbf4", "compiled": true, "compiled_code": "\nselect\n    \n        \"user_id\"::text ||\n    \n        \"month\"::text ||\n    \n    ''\nfrom\n    \"dev_m0z9\".\"dbt\".\"revenue_user_monthly\"\ngroup by\n    1\nhaving\n    count(*) > 1\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:49.130142Z", "completed_at": "2025-11-19T09:48:49.136826Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:49.137307Z", "completed_at": "2025-11-19T09:49:05.001039Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 15.875032901763916, "adapter_response": {"_message": "SELECT 2000", "code": "SELECT", "rows_affected": 2000}, "message": "SELECT 2000", "failures": null, "unique_id": "model.dbt_scooters.users_class", "compiled": true, "compiled_code": "select\n    id as user_id,\n    fan,\n    regular,\n    rare,\n    to_work,\n    not(fan or regular or rare or to_work) as no_class\nfrom\n    \"dev_m0z9\".\"dbt\".\"users_prep\"\nfull outer join \"dev_m0z9\".\"dbt\".\"users_class_weekly_trips\"\n    on user_id = id\nfull outer join \"dev_m0z9\".\"dbt\".\"users_class_weekly_destination_trips\"\n    using (user_id)\nfull outer join \"dev_m0z9\".\"dbt\".\"users_class_monthly_trips\"\n    using (user_id)", "relation_name": "\"dev_m0z9\".\"dbt\".\"users_class\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:49:02.240664Z", "completed_at": "2025-11-19T09:49:02.246280Z"}, {"name": "execute", "started_at": "2025-11-19T09:49:02.247172Z", "completed_at": "2025-11-19T09:49:07.866228Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.6283299922943115, "adapter_response": {"_message": "SELECT 3", "code": "SELECT", "rows_affected": 3}, "message": "SELECT 3", "failures": null, "unique_id": "model.dbt_scooters.revenue_monthly", "compiled": true, "compiled_code": "select\n    \"month\",\n    count(*) as \"users\",\n    percentile_cont(0.5) within group (\n        order by revenue_total\n    ) as revenue_median,\n    percentile_cont(0.95) within group (\n        order by revenue_total\n    ) as revenue_95,\n    max(revenue_total) as revenue_max,\n    sum(revenue_total) as revenue_total\nfrom\n    \"dev_m0z9\".\"dbt\".\"revenue_user_monthly\"\ngroup by\n    1", "relation_name": "\"dev_m0z9\".\"dbt\".\"revenue_monthly\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:49:05.009528Z", "completed_at": "2025-11-19T09:49:05.018289Z"}, {"name": "execute", "started_at": "2025-11-19T09:49:05.018679Z", "completed_at": "2025-11-19T09:49:08.582083Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.881211996078491, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.unique_key_users_class_user_id.1a7f5e5d5e", "compiled": true, "compiled_code": "\nselect\n    \n        \"user_id\"::text ||\n    \n    ''\nfrom\n    \"dev_m0z9\".\"dbt\".\"users_class\"\ngroup by\n    1\nhaving\n    count(*) > 1\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:49:07.880675Z", "completed_at": "2025-11-19T09:49:07.885983Z"}, {"name": "execute", "started_at": "2025-11-19T09:49:07.886931Z", "completed_at": "2025-11-19T09:49:12.270263Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 4.709924936294556, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.dbt_utils_expression_is_true_revenue_monthly_not_users_1000_or_revenue_median_500_.69be9d8e45", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dev_m0z9\".\"dbt\".\"revenue_monthly\"\n\nwhere not(not(users < 1000 or revenue_median < 500))\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:49:07.874880Z", "completed_at": "2025-11-19T09:49:07.886465Z"}, {"name": "execute", "started_at": "2025-11-19T09:49:07.888642Z", "completed_at": "2025-11-19T09:49:12.475802Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.938148736953735, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.unique_key_revenue_monthly_month.87abbef701", "compiled": true, "compiled_code": "\nselect\n    \n        \"month\"::text ||\n    \n    ''\nfrom\n    \"dev_m0z9\".\"dbt\".\"revenue_monthly\"\ngroup by\n    1\nhaving\n    count(*) > 1\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:49:08.894567Z", "completed_at": "2025-11-19T09:49:08.899768Z"}, {"name": "execute", "started_at": "2025-11-19T09:49:08.900202Z", "completed_at": "2025-11-19T09:49:14.215474Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 5.323765993118286, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "SELECT 1", "failures": null, "unique_id": "model.dbt_scooters.users_class_stat", "compiled": true, "compiled_code": "select\n    count(fan or null) as fan_count,\n    count(regular or null) as regular_count,\n    count(rare or null) as rare_count,\n    count(to_work or null) as to_work_count,\n    count(no_class or null) as no_class_count,\n    count(*) as total_count\nfrom\n    \"dev_m0z9\".\"dbt\".\"users_class\"", "relation_name": "\"dev_m0z9\".\"dbt\".\"users_class_stat\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:49:12.815005Z", "completed_at": "2025-11-19T09:49:12.822732Z"}, {"name": "execute", "started_at": "2025-11-19T09:49:12.823185Z", "completed_at": "2025-11-19T09:49:20.356216Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 7.543543815612793, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.dbt_scooters.revenue_monthly_report", "compiled": true, "compiled_code": "select *\nfrom\n    \"dev_m0z9\".\"dbt\".\"revenue_monthly\"\nwhere\n    \"month\" < date_trunc('month', current_date)\n        and \"month\" > (select max(\"month\") from \"dev_m0z9\".\"dbt\".\"revenue_monthly_report\")and not (\"users\" < 1000 or revenue_median < 500)", "relation_name": "\"dev_m0z9\".\"dbt\".\"revenue_monthly_report\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-19T09:49:20.362762Z", "completed_at": "2025-11-19T09:49:20.369240Z"}, {"name": "execute", "started_at": "2025-11-19T09:49:20.369782Z", "completed_at": "2025-11-19T09:49:23.841097Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.990225315093994, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.dbt_scooters.unique_key_revenue_monthly_report_month.2020644790", "compiled": true, "compiled_code": "\nselect\n    \n        \"month\"::text ||\n    \n    ''\nfrom\n    \"dev_m0z9\".\"dbt\".\"revenue_monthly_report\"\ngroup by\n    1\nhaving\n    count(*) > 1\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:48:28.808085Z", "completed_at": "2025-11-19T09:48:28.843467Z"}, {"name": "execute", "started_at": "2025-11-19T09:48:28.843716Z", "completed_at": "2025-11-19T10:11:33.749531Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1384.9450480937958, "adapter_response": {"_message": "SELECT 6", "code": "SELECT", "rows_affected": 6}, "message": "SELECT 6", "failures": null, "unique_id": "model.dbt_scooters.book_scooter_retention", "compiled": true, "compiled_code": "\n  \n\n  \n\n  \n  \n  with  __dbt__cte__events_stream as (\n\n  select type as event_type, user_id as user_id, date(\"timestamp\") as event_date\n  from \"dev_m0z9\".\"dbt\".\"events_full\"\n  where 1 = 1\n  \n  \n\n), event_stream as (  select * from  __dbt__cte__events_stream\n    \n    \n    \n   )\n\n  , first_event_users as (\n    select\n      user_id\n      \n      , min(event_date) as first_event_date\n    from event_stream\n    group by 1 \n  )\n\n  , first_events as (\n    select \n    count(*) as unique_users_total\n    from first_event_users\n    \n  )\n\n  \n  , secondary_events_0 as (\n    select 0 as period,\n    \n    count(distinct event_stream.user_id) as unique_users\n    from event_stream\n    inner join first_event_users\n      on event_stream.user_id = first_event_users.user_id\n      \n    where event_type = 'book_scooter'\n    and event_date >= \n\nfirst_event_date + ((interval '1 day') * (0))\n\n\n\n    group by period \n  )\n  \n  , secondary_events_1 as (\n    select 1 as period,\n    \n    count(distinct event_stream.user_id) as unique_users\n    from event_stream\n    inner join first_event_users\n      on event_stream.user_id = first_event_users.user_id\n      \n    where event_type = 'book_scooter'\n    and event_date >= \n\nfirst_event_date + ((interval '1 day') * (1))\n\n\n\n    group by period \n  )\n  \n  , secondary_events_7 as (\n    select 7 as period,\n    \n    count(distinct event_stream.user_id) as unique_users\n    from event_stream\n    inner join first_event_users\n      on event_stream.user_id = first_event_users.user_id\n      \n    where event_type = 'book_scooter'\n    and event_date >= \n\nfirst_event_date + ((interval '1 day') * (7))\n\n\n\n    group by period \n  )\n  \n  , secondary_events_14 as (\n    select 14 as period,\n    \n    count(distinct event_stream.user_id) as unique_users\n    from event_stream\n    inner join first_event_users\n      on event_stream.user_id = first_event_users.user_id\n      \n    where event_type = 'book_scooter'\n    and event_date >= \n\nfirst_event_date + ((interval '1 day') * (14))\n\n\n\n    group by period \n  )\n  \n  , secondary_events_30 as (\n    select 30 as period,\n    \n    count(distinct event_stream.user_id) as unique_users\n    from event_stream\n    inner join first_event_users\n      on event_stream.user_id = first_event_users.user_id\n      \n    where event_type = 'book_scooter'\n    and event_date >= \n\nfirst_event_date + ((interval '1 day') * (30))\n\n\n\n    group by period \n  )\n  \n  , secondary_events_60 as (\n    select 60 as period,\n    \n    count(distinct event_stream.user_id) as unique_users\n    from event_stream\n    inner join first_event_users\n      on event_stream.user_id = first_event_users.user_id\n      \n    where event_type = 'book_scooter'\n    and event_date >= \n\nfirst_event_date + ((interval '1 day') * (60))\n\n\n\n    group by period \n  )\n  \n  , secondary_events_120 as (\n    select 120 as period,\n    \n    count(distinct event_stream.user_id) as unique_users\n    from event_stream\n    inner join first_event_users\n      on event_stream.user_id = first_event_users.user_id\n      \n    where event_type = 'book_scooter'\n    and event_date >= \n\nfirst_event_date + ((interval '1 day') * (120))\n\n\n\n    group by period \n  )\n  \n\n  , final as (\n    select \n      period, \n      \n      unique_users,\n      1.0 * unique_users / unique_users_total as pct_users\n    from first_events\n    left join (\n      \n        select * from secondary_events_0\n        \n          union all\n        \n      \n        select * from secondary_events_1\n        \n          union all\n        \n      \n        select * from secondary_events_7\n        \n          union all\n        \n      \n        select * from secondary_events_14\n        \n          union all\n        \n      \n        select * from secondary_events_30\n        \n          union all\n        \n      \n        select * from secondary_events_60\n        \n          union all\n        \n      \n        select * from secondary_events_120\n        \n      \n    ) secondary_events on  1 = 1\n    \n  )\n\n  select * from final\n", "relation_name": "\"dev_m0z9\".\"dbt\".\"book_scooter_retention\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T10:11:36.628283Z", "completed_at": "2025-11-19T10:11:36.644695Z"}, {"name": "execute", "started_at": "2025-11-19T10:11:36.645611Z", "completed_at": "2025-11-19T10:11:36.937102Z"}], "thread_id": "main", "execution_time": 0.308819, "adapter_response": {}, "message": "dbt_scooters.on-run-end.0 passed", "failures": 0, "unique_id": "operation.dbt_scooters.dbt_scooters-on-run-end-0", "compiled": true, "compiled_code": "grant usage on schema finance to finance;", "relation_name": null, "batch_results": null}], "elapsed_time": 1503.3527460098267, "args": {"require_resource_names_without_spaces": true, "use_colors": true, "strict_mode": false, "resource_types": [], "defer": false, "exclude_resource_types": [], "log_path": "/Users/flerinvs/dbt_scooters/logs", "printer_width": 80, "require_nested_cumulative_type_params": false, "upload_to_artifacts_ingest_api": false, "which": "build", "require_yaml_configuration_for_mf_time_spines": false, "target": "prod", "cache_selected_only": false, "project_dir": "/Users/flerinvs/dbt_scooters", "require_generic_test_arguments_property": true, "require_explicit_package_overrides_for_builtin_materializations": true, "skip_nodes_if_on_run_start_fails": false, "version_check": true, "empty": false, "print": true, "state_modified_compare_more_unrendered_values": false, "source_freshness_run_project_hooks": true, "partial_parse_file_diff": true, "populate_cache": true, "static_parser": true, "validate_macro_args": false, "log_format_file": "debug", "warn_error_options": {"error": [], "warn": [], "silence": []}, "log_level": "info", "log_level_file": "debug", "invocation_command": "dbt build --target prod", "quiet": false, "state_modified_compare_vars": false, "require_batched_execution_for_custom_microbatch_strategy": false, "include_saved_query": false, "indirect_selection": "eager", "write_json": true, "log_file_max_bytes": 10485760, "export_saved_queries": false, "favor_state": false, "partial_parse": true, "macro_debugging": false, "show": false, "log_format": "default", "require_all_warnings_handled_by_warn_error": false, "select": [], "show_all_deprecations": false, "exclude": [], "show_resource_report": false, "profiles_dir": "/Users/flerinvs/dbt_scooters", "use_colors_file": true, "introspect": true, "send_anonymous_usage_stats": true, "vars": {}, "use_fast_test_edges": false}}