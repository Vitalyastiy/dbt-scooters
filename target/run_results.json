{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.6", "generated_at": "2025-08-10T18:58:37.473778Z", "invocation_id": "2551b046-426a-4f39-854f-8729966d45f2", "invocation_started_at": "2025-08-10T18:58:28.509197Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-10T18:58:32.294222Z", "completed_at": "2025-08-10T18:58:32.311854Z"}, {"name": "execute", "started_at": "2025-08-10T18:58:32.368916Z", "completed_at": "2025-08-10T18:58:35.912450Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.648874282836914, "adapter_response": {"_message": "INSERT 0 3", "code": "INSERT", "rows_affected": 3}, "message": "INSERT 0 3", "failures": null, "unique_id": "model.dbt_scooters.revenue_daily", "compiled": true, "compiled_code": "select\n    sum(price_rub) as revenue_rub,\n    \"date\",\n    \n    now() as updated_at\n\nfrom\n    \"dev_ohwk\".\"dbt\".\"trips_prep\"\n\nwhere\n    \"date\" >= (select max(\"date\") - interval '2' day from \"dev_ohwk\".\"dbt\".\"revenue_daily\")\n\ngroup by\n    2,\n    3\norder by\n    2", "relation_name": "\"dev_ohwk\".\"dbt\".\"revenue_daily\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-10T18:58:32.267825Z", "completed_at": "2025-08-10T18:58:32.304638Z"}, {"name": "execute", "started_at": "2025-08-10T18:58:32.312156Z", "completed_at": "2025-08-10T18:58:36.701255Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.439254999160767, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.dbt_scooters.events_clean", "compiled": true, "compiled_code": "select distinct\n    user_id,\n    \"timestamp\",\n    type_id,\n    \n    now() as updated_at\n\nfrom\n    \"dev_ohwk\".\"scooters_raw\".\"events\"\nwhere\n\n    \"timestamp\" > (select max(\"timestamp\") from \"dev_ohwk\".\"dbt\".\"events_clean\")\n", "relation_name": "\"dev_ohwk\".\"dbt\".\"events_clean\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-10T18:58:32.290418Z", "completed_at": "2025-08-10T18:58:32.305158Z"}, {"name": "execute", "started_at": "2025-08-10T18:58:32.366846Z", "completed_at": "2025-08-10T18:58:36.753379Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.489886999130249, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.dbt_scooters.trips_users", "compiled": true, "compiled_code": "select\n    t.*,\n    u.sex,\n    extract(year from t.started_at) - extract(year from u.birth_date) as age,\n    \n    now() as updated_at\n\nfrom\n    \"dev_ohwk\".\"dbt\".\"trips_prep\" as t\nleft join\n    \"dev_ohwk\".\"scooters_raw\".\"users\" as u\n    on t.user_id = u.id\n\n    where\n        t.id > (select max(id) from \"dev_ohwk\".\"dbt\".\"trips_users\")\n    order by\n        t.id\n    limit\n        75000\n", "relation_name": "\"dev_ohwk\".\"dbt\".\"trips_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-10T18:58:32.285232Z", "completed_at": "2025-08-10T18:58:32.298458Z"}, {"name": "execute", "started_at": "2025-08-10T18:58:32.298785Z", "completed_at": "2025-08-10T18:58:36.801133Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 4.53791618347168, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.dbt_scooters.trips_concurrency", "compiled": true, "compiled_code": "with\nunnest_cte as (\n    -- Unnest trip to two rows: start and finish events\n    select\n        unnest(array[started_at, finished_at]) as \"timestamp\",\n        unnest(array[1, -1]) as increment\n    from\n        \"dev_ohwk\".\"scooters_raw\".\"trips\"\n),\nsum_cte as (\n    -- Make timestamp unique, group increments, add initial concurrency from history\n    select\n        \"timestamp\",\n        sum(increment) as increment,\n        true as preserve_row\n    from\n        unnest_cte\n    where\n    \n        \"timestamp\" > (select max(\"timestamp\") from \"dev_ohwk\".\"dbt\".\"trips_concurrency\")\n    \n    group by\n        1\n    \n    union all\n    select\n        \"timestamp\",\n        concurrency as increment,\n        false as preserve_row\n    from\n        \"dev_ohwk\".\"dbt\".\"trips_concurrency\"\n    where\n        \"timestamp\" = (select max(\"timestamp\") from \"dev_ohwk\".\"dbt\".\"trips_concurrency\")\n    \n),\ncumsum_cte as (\n    -- Integrate increment to get concurrency\n    select\n        \"timestamp\",\n        sum(increment) over (order by \"timestamp\") as concurrency,\n        preserve_row\n    from\n        sum_cte\n)\nselect\n    \"timestamp\",\n    concurrency,\n    \n    now() as updated_at\n\nfrom\n    cumsum_cte\nwhere\n    preserve_row\norder by\n    1", "relation_name": "\"dev_ohwk\".\"dbt\".\"trips_concurrency\"", "batch_results": null}], "elapsed_time": 8.701064109802246, "args": {"use_colors": true, "printer_width": 80, "require_batched_execution_for_custom_microbatch_strategy": false, "resource_types": [], "require_generic_test_arguments_property": false, "use_colors_file": true, "static_parser": true, "validate_macro_args": false, "populate_cache": true, "partial_parse_file_diff": true, "require_nested_cumulative_type_params": false, "exclude_resource_types": [], "show_resource_report": false, "state_modified_compare_more_unrendered_values": false, "empty": false, "require_yaml_configuration_for_mf_time_spines": false, "which": "build", "defer": false, "log_path": "/Users/flerinvs/dbt_scooters/logs", "export_saved_queries": false, "include_saved_query": false, "strict_mode": false, "vars": {}, "log_format_file": "debug", "log_level_file": "debug", "use_fast_test_edges": false, "partial_parse": true, "select": ["config.materialized:incremental"], "write_json": true, "exclude": [], "show_all_deprecations": false, "log_format": "default", "warn_error_options": {"error": [], "warn": [], "silence": []}, "version_check": true, "introspect": true, "log_level": "info", "profiles_dir": "/Users/flerinvs/.dbt", "require_all_warnings_handled_by_warn_error": false, "quiet": false, "macro_debugging": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": true, "skip_nodes_if_on_run_start_fails": false, "upload_to_artifacts_ingest_api": false, "state_modified_compare_vars": false, "send_anonymous_usage_stats": true, "cache_selected_only": false, "favor_state": false, "log_file_max_bytes": 10485760, "invocation_command": "dbt build -s config.materialized:incremental", "project_dir": "/Users/flerinvs/dbt_scooters", "indirect_selection": "eager", "show": false, "source_freshness_run_project_hooks": true, "print": true}}