{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.6", "generated_at": "2025-08-16T18:36:41.128966Z", "invocation_id": "502f8149-2376-4d58-b933-5b34fa36b901", "invocation_started_at": "2025-08-16T18:36:14.406294Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-16T18:36:18.043152Z", "completed_at": "2025-08-16T18:36:18.053167Z"}, {"name": "execute", "started_at": "2025-08-16T18:36:18.053592Z", "completed_at": "2025-08-16T18:36:19.046272Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.005363941192627, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_scooters.trips_prep", "compiled": true, "compiled_code": "select id,\nuser_id,\nscooter_hw_id,\nstarted_at\t,\nfinished_at\t,\nstart_lat,\t\nstart_lon,\nfinish_lat,\t\nfinish_lon,\t\ndistance\tas distance_m,\ncast(price as decimal(20,2))/ 100 as price_rub,\nextract(epoch from(finished_at - started_at)) duration_s,\nfinished_at <> started_at and price = 0 as is_free,\ndate(started_at) as \"date\"\nfrom\n\"dev_ohwk\".\"scooters_raw\".\"trips\"", "relation_name": "\"dev_ohwk\".\"dbt\".\"trips_prep\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-16T18:36:19.100785Z", "completed_at": "2025-08-16T18:36:19.104057Z"}, {"name": "execute", "started_at": "2025-08-16T18:36:19.127444Z", "completed_at": "2025-08-16T18:36:22.940247Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.8857319355010986, "adapter_response": {"_message": "INSERT 0 3", "code": "INSERT", "rows_affected": 3}, "message": "INSERT 0 3", "failures": null, "unique_id": "model.dbt_scooters.revenue_daily", "compiled": true, "compiled_code": "select\n    sum(price_rub) as revenue_rub,\n    \"date\",\n    \n    now() as updated_at\n\nfrom\n    \"dev_ohwk\".\"dbt\".\"trips_prep\"\n\nwhere\n    \"date\" >= (select max(\"date\") - interval '2' day from \"dev_ohwk\".\"dbt\".\"revenue_daily\")\n\ngroup by\n    2,\n    3\norder by\n    2", "relation_name": "\"dev_ohwk\".\"dbt\".\"revenue_daily\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-16T18:36:19.057537Z", "completed_at": "2025-08-16T18:36:19.103552Z"}, {"name": "execute", "started_at": "2025-08-16T18:36:19.104187Z", "completed_at": "2025-08-16T18:36:23.251176Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 4.197772026062012, "adapter_response": {"_message": "SELECT 6", "code": "SELECT", "rows_affected": 6}, "message": "SELECT 6", "failures": null, "unique_id": "model.dbt_scooters.companies_trips", "compiled": true, "compiled_code": "with trips_cte as (\n    select\n        company,\n        count(*) as trips\n    from\n        \"dev_ohwk\".\"dbt\".\"trips_prep\" as t\n        join \"dev_ohwk\".\"dbt\".\"scooters\" as s\n            on t.scooter_hw_id = s.hardware_id\n    group by\n        1\n)\nselect\n    company,\n    t.trips,\n    c.scooters,\n    t.trips / cast(c.scooters as float) as trips_per_scooter\nfrom\n    trips_cte as t\n    join \"dev_ohwk\".\"dbt\".\"companies\" as c\n        using (company)", "relation_name": "\"dev_ohwk\".\"dbt\".\"companies_trips\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-16T18:36:19.096480Z", "completed_at": "2025-08-16T18:36:19.103918Z"}, {"name": "execute", "started_at": "2025-08-16T18:36:19.115347Z", "completed_at": "2025-08-16T18:36:27.341310Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 8.292788982391357, "adapter_response": {"_message": "INSERT 0 30901", "code": "INSERT", "rows_affected": 30901}, "message": "INSERT 0 30901", "failures": null, "unique_id": "model.dbt_scooters.trips_users", "compiled": true, "compiled_code": "select\n    t.*,\n    u.sex,\n    extract(year from t.started_at) - extract(year from u.birth_date) as age,\n    \n    now() as updated_at\n\nfrom\n    \"dev_ohwk\".\"dbt\".\"trips_prep\" as t\nleft join\n    \"dev_ohwk\".\"scooters_raw\".\"users\" as u\n    on t.user_id = u.id\n\n    where\n        t.id > (select max(id) from \"dev_ohwk\".\"dbt\".\"trips_users\")\n    order by\n        t.id\n    limit\n        75000\n", "relation_name": "\"dev_ohwk\".\"dbt\".\"trips_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-16T18:36:19.102290Z", "completed_at": "2025-08-16T18:36:19.103746Z"}, {"name": "execute", "started_at": "2025-08-16T18:36:19.114095Z", "completed_at": "2025-08-16T18:36:27.440509Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 8.385295867919922, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "SELECT 1", "failures": null, "unique_id": "model.dbt_scooters.trips_stat", "compiled": true, "compiled_code": "select count(id) trips, count(distinct user_id) users\n, avg(duration_s) / 60 avg_duration_m\n, sum(distance_m) / 1000 as sum_distance_km\n, sum(price_rub) revenue_rub\n, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct\nfrom \"dev_ohwk\".\"dbt\".\"trips_prep\"", "relation_name": "\"dev_ohwk\".\"dbt\".\"trips_stat\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-16T18:36:27.358503Z", "completed_at": "2025-08-16T18:36:27.361409Z"}, {"name": "execute", "started_at": "2025-08-16T18:36:27.361864Z", "completed_at": "2025-08-16T18:36:32.543662Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 5.191366195678711, "adapter_response": {"_message": "SELECT 7049", "code": "SELECT", "rows_affected": 7049}, "message": "SELECT 7049", "failures": null, "unique_id": "model.dbt_scooters.trips_age_daily", "compiled": true, "compiled_code": "select\n    \"date\",\n    age,\n    count(*) as trips,\n    sum(price_rub) as revenue_rub\nfrom\n    \"dev_ohwk\".\"dbt\".\"trips_users\"\ngroup by\n    1,\n    2", "relation_name": "\"dev_ohwk\".\"dbt\".\"trips_age_daily\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-16T18:36:32.550072Z", "completed_at": "2025-08-16T18:36:32.554673Z"}, {"name": "execute", "started_at": "2025-08-16T18:36:32.555023Z", "completed_at": "2025-08-16T18:36:34.637905Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.0906219482421875, "adapter_response": {"_message": "SELECT 83", "code": "SELECT", "rows_affected": 83}, "message": "SELECT 83", "failures": null, "unique_id": "model.dbt_scooters.trips_age_daily_stat", "compiled": true, "compiled_code": "select\n    age,\n    avg(trips) as avg_trips,\n    avg(revenue_rub) as avg_revenue_rub\nfrom\n    \"dev_ohwk\".\"dbt\".\"trips_age_daily\"\ngroup by\n    1\norder by\n    1", "relation_name": "\"dev_ohwk\".\"dbt\".\"trips_age_daily_stat\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-16T18:36:27.354733Z", "completed_at": "2025-08-16T18:36:27.365455Z"}, {"name": "execute", "started_at": "2025-08-16T18:36:27.365795Z", "completed_at": "2025-08-16T18:36:40.238243Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 12.88671588897705, "adapter_response": {"_message": "SELECT 7", "code": "SELECT", "rows_affected": 7}, "message": "SELECT 7", "failures": null, "unique_id": "model.dbt_scooters.trips_age_group", "compiled": true, "compiled_code": "select\n    ag.\"group\" as age_group,\n    count(*) as trips,\n    sum(price_rub) as revenue_rub\nfrom\n    \"dev_ohwk\".\"dbt\".\"trips_users\" as tu\n    cross join \"dev_ohwk\".\"dbt\".\"age_groups\" as ag\nwhere\n    tu.age >= ag.age_start\n    and tu.age <= ag.age_end\ngroup by\n    1", "relation_name": "\"dev_ohwk\".\"dbt\".\"trips_age_group\"", "batch_results": null}], "elapsed_time": 26.482731819152832, "args": {"validate_macro_args": false, "static_parser": true, "require_nested_cumulative_type_params": false, "state_modified_compare_more_unrendered_values": false, "strict_mode": false, "require_yaml_configuration_for_mf_time_spines": false, "printer_width": 80, "use_colors_file": true, "empty": false, "require_batched_execution_for_custom_microbatch_strategy": false, "write_json": true, "skip_nodes_if_on_run_start_fails": false, "profiles_dir": "/Users/flerinvs/.dbt", "use_colors": true, "favor_state": false, "print": true, "cache_selected_only": false, "populate_cache": true, "select": ["trips_prep+"], "introspect": true, "require_all_warnings_handled_by_warn_error": false, "resource_types": [], "use_fast_test_edges": false, "log_format_file": "debug", "exclude_resource_types": [], "require_explicit_package_overrides_for_builtin_materializations": true, "upload_to_artifacts_ingest_api": false, "show": false, "version_check": true, "exclude": [], "log_level_file": "debug", "log_path": "/Users/flerinvs/dbt_scooters/logs", "log_level": "info", "macro_debugging": false, "defer": false, "partial_parse": true, "require_generic_test_arguments_property": false, "which": "build", "quiet": false, "require_resource_names_without_spaces": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "partial_parse_file_diff": true, "vars": {}, "invocation_command": "dbt build -s trips_prep+", "indirect_selection": "eager", "show_all_deprecations": false, "export_saved_queries": false, "log_file_max_bytes": 10485760, "log_format": "default", "project_dir": "/Users/flerinvs/dbt_scooters", "source_freshness_run_project_hooks": true, "include_saved_query": false, "show_resource_report": false, "state_modified_compare_vars": false, "send_anonymous_usage_stats": true}}