{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.6", "generated_at": "2025-10-09T15:53:02.952576Z", "invocation_id": "17b61912-db2f-4b04-a82c-df78cd4f571d", "invocation_started_at": "2025-10-09T15:52:58.752937Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.819469Z", "completed_at": "2025-10-09T15:53:02.844011Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.845014Z", "completed_at": "2025-10-09T15:53:02.845024Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03008723258972168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.trips_prep", "compiled": true, "compiled_code": "select id,\nuser_id,\nscooter_hw_id,\nstarted_at\t,\nfinished_at\t,\nstart_lat,\t\nstart_lon,\nfinish_lat,\t\nfinish_lon,\t\ndistance\tas distance_m,\ncast(price as decimal(20,2))/ 100 as price_rub,\nextract(epoch from(finished_at - started_at)) duration_s,\nfinished_at <> started_at and price = 0 as is_free,\n\n    date(started_at at time zone 'Europe/Moscow')\n as \"date\" \nfrom\n\"dev_h8qz\".\"scooters_raw\".\"trips\"", "relation_name": "\"dev_h8qz\".\"dbt\".\"trips_prep\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.829555Z", "completed_at": "2025-10-09T15:53:02.844305Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.845510Z", "completed_at": "2025-10-09T15:53:02.845515Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029725074768066406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.trips_geom", "compiled": true, "compiled_code": "select\n    id,\n    st_setsrid(st_makepoint(start_lon, start_lat), 4326) as start_point,\n    st_setsrid(st_makepoint(finish_lon, finish_lat), 4326) as finish_point\nfrom\n    \"dev_h8qz\".\"scooters_raw\".\"trips\"", "relation_name": "\"dev_h8qz\".\"dbt\".\"trips_geom\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.840539Z", "completed_at": "2025-10-09T15:53:02.844589Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.845909Z", "completed_at": "2025-10-09T15:53:02.845912Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02895808219909668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.trips_concurrency", "compiled": true, "compiled_code": "with\nunnest_cte as (\n    -- Unnest trip to two rows: start and finish events\n    select\n        unnest(array[started_at, finished_at]) as \"timestamp\",\n        unnest(array[1, -1]) as increment\n    from\n        \"dev_h8qz\".\"scooters_raw\".\"trips\"\n),\nsum_cte as (\n    -- Make timestamp unique, group increments, add initial concurrency from history\n    select\n        \"timestamp\",\n        sum(increment) as increment,\n        true as preserve_row\n    from\n        unnest_cte\n    where\n    \n        \"timestamp\" < (date '2023-06-01' + interval '7' hour) at time zone 'Europe/Moscow'\n    \n    group by\n        1\n    \n),\ncumsum_cte as (\n    -- Integrate increment to get concurrency\n    select\n        \"timestamp\",\n        sum(increment) over (order by \"timestamp\") as concurrency,\n        preserve_row\n    from\n        sum_cte\n)\nselect\n    \"timestamp\",\n    concurrency,\n    \n    now() as updated_at\n\nfrom\n    cumsum_cte\nwhere\n    preserve_row\norder by\n    1", "relation_name": "\"dev_h8qz\".\"dbt\".\"trips_concurrency\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.832046Z", "completed_at": "2025-10-09T15:53:02.844808Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.846293Z", "completed_at": "2025-10-09T15:53:02.846296Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029835939407348633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.events_clean", "compiled": true, "compiled_code": "\nselect distinct\n    user_id,\n    \"timestamp\",\n    type_id,\n    \n    now() as updated_at\n\nfrom\n    \"dev_h8qz\".\"scooters_raw\".\"events\"\nwhere\n\n    \n        \"timestamp\" > (select max(\"timestamp\") from \"dev_h8qz\".\"dbt\".\"events_clean\")\n    \n", "relation_name": "\"dev_h8qz\".\"dbt\".\"events_clean\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.851946Z", "completed_at": "2025-10-09T15:53:02.852639Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.853815Z", "completed_at": "2025-10-09T15:53:02.853819Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005333900451660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_scooters.age_groups", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.852846Z", "completed_at": "2025-10-09T15:53:02.853487Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.854230Z", "completed_at": "2025-10-09T15:53:02.854233Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005535125732421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_scooters.event_types", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.849712Z", "completed_at": "2025-10-09T15:53:02.854566Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.855416Z", "completed_at": "2025-10-09T15:53:02.855419Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.007412910461425781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.trips_stat_daily", "compiled": true, "compiled_code": "select\n    date(started_at) as date,\n    count(*) as trips,\n    max(price) / 100 as max_price_rub,\n    avg(distance) / 1000 as avg_distance_km\nfrom\n    scooters_raw.trips\ngroup by\n    1\norder by\n    1", "relation_name": "\"dev_h8qz\".\"dbt\".\"trips_stat_daily\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.850663Z", "completed_at": "2025-10-09T15:53:02.854938Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.855981Z", "completed_at": "2025-10-09T15:53:02.855983Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007693052291870117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.dbt_scooters.dbt_scooters-on-run-end-0", "compiled": true, "compiled_code": "grant usage on schema finance to finance;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.857582Z", "completed_at": "2025-10-09T15:53:02.858547Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.865274Z", "completed_at": "2025-10-09T15:53:02.865277Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009544849395751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_scooters.scooters", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.858927Z", "completed_at": "2025-10-09T15:53:02.872002Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.872420Z", "completed_at": "2025-10-09T15:53:02.872424Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01618814468383789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_scooters.source_accepted_values_scooters_raw_users_sex__M__F.86d0634f4b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        sex as value_field,\n        count(*) as n_records\n\n    from \"dev_h8qz\".\"scooters_raw\".\"users\"\n    group by sex\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'M','F'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.865756Z", "completed_at": "2025-10-09T15:53:02.876576Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.877093Z", "completed_at": "2025-10-09T15:53:02.877096Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019793987274169922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_scooters.source_not_null_scooters_raw_trips_user_id.beb953ba62", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"dev_h8qz\".\"scooters_raw\".\"trips\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.870286Z", "completed_at": "2025-10-09T15:53:02.876730Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.877342Z", "completed_at": "2025-10-09T15:53:02.877346Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018652915954589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_scooters.source_not_null_scooters_raw_users_sex.2fde08f9ee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sex\nfrom \"dev_h8qz\".\"scooters_raw\".\"users\"\nwhere sex is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.873156Z", "completed_at": "2025-10-09T15:53:02.877786Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.879932Z", "completed_at": "2025-10-09T15:53:02.879934Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007776021957397461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_scooters.source_relationships_scooters_raw_trips_user_id__id__source_scooters_raw_users_.0e2c815691", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from \"dev_h8qz\".\"scooters_raw\".\"trips\"\n    where user_id is not null\n),\n\nparent as (\n    select id as to_field\n    from \"dev_h8qz\".\"scooters_raw\".\"users\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.878278Z", "completed_at": "2025-10-09T15:53:02.881002Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.883686Z", "completed_at": "2025-10-09T15:53:02.883688Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0068340301513671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.revenue_daily", "compiled": true, "compiled_code": "select\n    sum(price_rub) as revenue_rub,\n    \"date\",\n    \n    now() as updated_at\n\nfrom\n    \"dev_h8qz\".\"dbt\".\"trips_prep\"\n\nwhere\n    \"date\" >= (select max(\"date\") - interval '2' day from \"dev_h8qz\".\"dbt\".\"revenue_daily\")\n\ngroup by\n    2,\n    3\norder by\n    2", "relation_name": "\"dev_h8qz\".\"dbt\".\"revenue_daily\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.882288Z", "completed_at": "2025-10-09T15:53:02.888312Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.888758Z", "completed_at": "2025-10-09T15:53:02.888761Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008452177047729492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.trips_users", "compiled": true, "compiled_code": "select\n    t.*,\n    u.sex,\n    extract(year from t.started_at) - extract(year from u.birth_date) as age,\n    \n    now() as updated_at\n\nfrom\n    \"dev_h8qz\".\"dbt\".\"trips_prep\" as t\nleft join\n    \"dev_h8qz\".\"scooters_raw\".\"users\" as u\n    on t.user_id = u.id\n\n    where\n        t.id > (select max(id) from \"dev_h8qz\".\"dbt\".\"trips_users\")\n    order by\n        t.id\n    limit\n        75000\n", "relation_name": "\"dev_h8qz\".\"dbt\".\"trips_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.881318Z", "completed_at": "2025-10-09T15:53:02.888475Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.889012Z", "completed_at": "2025-10-09T15:53:02.889014Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008861064910888672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.trips_stat", "compiled": true, "compiled_code": "select count(id) trips, count(distinct user_id) users\n, avg(duration_s) / 60 avg_duration_m\n, sum(distance_m) / 1000 as sum_distance_km\n, sum(price_rub) revenue_rub\n, count(is_free or null) / cast(count(*) as real) * 100 as free_trips_pct\nfrom \"dev_h8qz\".\"dbt\".\"trips_prep\"", "relation_name": "\"dev_h8qz\".\"dbt\".\"trips_stat\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.884297Z", "completed_at": "2025-10-09T15:53:02.889236Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.890834Z", "completed_at": "2025-10-09T15:53:02.890836Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009723186492919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.parking_finish_stat", "compiled": true, "compiled_code": "-- select\n--     st_transform(hex.geom, 4326) as geom,\n--     count(*) as trips\n-- from\n--     \"dev_h8qz\".\"dbt\".\"trips_geom\" as t\n-- cross join\n--     st_hexagongrid(10, st_transform(t.finish_point, 3857)) as hex\n-- where\n--     st_intersects(st_transform(t.finish_point, 3857), hex.geom)\n-- group by\n--     1\n\n\nselect\n    st_transform(hex.geom, 4326) as geom,\n    count(*) as trips\nfrom\n    \"dev_h8qz\".\"dbt\".\"trips_geom\"\ncross join\n    st_hexagongrid(10, st_transform(finish_point, 3857)) as hex\nwhere\n    st_intersects(st_transform(finish_point, 3857), hex.geom)\ngroup by\n    1\n", "relation_name": "\"dev_h8qz\".\"dbt\".\"parking_finish_stat\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.889354Z", "completed_at": "2025-10-09T15:53:02.891559Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.892104Z", "completed_at": "2025-10-09T15:53:02.892106Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00397491455078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.parking_start_stat", "compiled": true, "compiled_code": "-- select\n--     st_transform(hex.geom, 4326) as geom,\n--     count(*) as trips\n-- from\n--     \"dev_h8qz\".\"dbt\".\"trips_geom\" as t\n-- cross join\n--     st_hexagongrid(500, st_transform(t.start_point, 3857)) as hex\n-- where\n--     st_intersects(st_transform(t.start_point, 3857), hex.geom)\n-- group by\n--     1\n\nselect\n    st_transform(hex.geom, 4326) as geom,\n    count(*) as trips\nfrom\n    \"dev_h8qz\".\"dbt\".\"trips_geom\"\ncross join\n    st_hexagongrid(500, st_transform(start_point, 3857)) as hex\nwhere\n    st_intersects(st_transform(start_point, 3857), hex.geom)\ngroup by\n    1\n", "relation_name": "\"dev_h8qz\".\"dbt\".\"parking_start_stat\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.922760Z", "completed_at": "2025-10-09T15:53:02.926094Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.928617Z", "completed_at": "2025-10-09T15:53:02.928621Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03740692138671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_scooters.not_null_age_groups_age_end.36cb13bced", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect age_end\nfrom \"dev_h8qz\".\"dbt\".\"age_groups\"\nwhere age_end is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.892336Z", "completed_at": "2025-10-09T15:53:02.926225Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.928857Z", "completed_at": "2025-10-09T15:53:02.928860Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03780484199523926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_scooters.not_null_age_groups__group_.bc0eed307f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect \"group\"\nfrom \"dev_h8qz\".\"dbt\".\"age_groups\"\nwhere \"group\" is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.924449Z", "completed_at": "2025-10-09T15:53:02.929089Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.929604Z", "completed_at": "2025-10-09T15:53:02.929605Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03768301010131836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_scooters.not_null_age_groups_age_start.c680df771d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect age_start\nfrom \"dev_h8qz\".\"dbt\".\"age_groups\"\nwhere age_start is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.926333Z", "completed_at": "2025-10-09T15:53:02.929836Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.930417Z", "completed_at": "2025-10-09T15:53:02.930419Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004743099212646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_scooters.unique_age_groups__group_.547060b253", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    \"group\" as unique_field,\n    count(*) as n_records\n\nfrom \"dev_h8qz\".\"dbt\".\"age_groups\"\nwhere \"group\" is not null\ngroup by \"group\"\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.931184Z", "completed_at": "2025-10-09T15:53:02.934515Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.935822Z", "completed_at": "2025-10-09T15:53:02.935825Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0058939456939697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.events_full", "compiled": true, "compiled_code": "select\n    *\nfrom\n    \"dev_h8qz\".\"dbt\".\"events_clean\"\n    left join \"dev_h8qz\".\"dbt\".\"event_types\"\n        using (type_id)", "relation_name": "\"dev_h8qz\".\"dbt\".\"events_full\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.932183Z", "completed_at": "2025-10-09T15:53:02.934648Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.936063Z", "completed_at": "2025-10-09T15:53:02.936066Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005988121032714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.companies", "compiled": true, "compiled_code": "select\n    company,\n    count(*) as models,\n    sum(scooters) as scooters\nfrom\n    \"dev_h8qz\".\"dbt\".\"scooters\"\ngroup by\n    1", "relation_name": "\"dev_h8qz\".\"dbt\".\"companies\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.933501Z", "completed_at": "2025-10-09T15:53:02.936296Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.936880Z", "completed_at": "2025-10-09T15:53:02.936882Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0060079097747802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.trips_age_daily", "compiled": true, "compiled_code": "select\n    \"date\",\n    age,\n    count(*) as trips,\n    sum(price_rub) as revenue_rub\nfrom\n    \"dev_h8qz\".\"dbt\".\"trips_users\"\ngroup by\n    1,\n    2", "relation_name": "\"dev_h8qz\".\"dbt\".\"trips_age_daily\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.934776Z", "completed_at": "2025-10-09T15:53:02.937257Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.937851Z", "completed_at": "2025-10-09T15:53:02.937853Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00456690788269043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.trips_age_group", "compiled": true, "compiled_code": "select\n    ag.\"group\" as age_group,\n    count(*) as trips,\n    sum(price_rub) as revenue_rub\nfrom\n    \"dev_h8qz\".\"dbt\".\"trips_users\" as tu\n    cross join \"dev_h8qz\".\"dbt\".\"age_groups\" as ag\nwhere\n    tu.age >= ag.age_start\n    and tu.age <= ag.age_end\ngroup by\n    1", "relation_name": "\"dev_h8qz\".\"dbt\".\"trips_age_group\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.938350Z", "completed_at": "2025-10-09T15:53:02.941961Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.943251Z", "completed_at": "2025-10-09T15:53:02.943253Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006169795989990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.events_stat", "compiled": true, "compiled_code": "select\n    count(\"type\" = 'cancel_search' or null)\n      / cast(count(\"type\" = 'start_search' or null) as float)\n      * 100 as cancel_pct\nfrom\n    \"dev_h8qz\".\"dbt\".\"events_full\"", "relation_name": "\"dev_h8qz\".\"dbt\".\"events_stat\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.939522Z", "completed_at": "2025-10-09T15:53:02.943114Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.943648Z", "completed_at": "2025-10-09T15:53:02.943651Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006284952163696289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_scooters.events_full_is_complete", "compiled": true, "compiled_code": "with source_cte as (\n    select count(*) as row_count\n    from \"dev_h8qz\".\"dbt\".\"events_clean\"\n),\ntarget_cte as (\n    select count(*) as row_count\n    from \"dev_h8qz\".\"dbt\".\"events_full\"\n)\nselect\n    'Row count mismatch' as error_message,\n    source_cte.row_count as source_count,\n    target_cte.row_count as target_count\nfrom\n    source_cte,\n    target_cte\nwhere\n    source_cte.row_count != target_cte.row_count", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.940838Z", "completed_at": "2025-10-09T15:53:02.943524Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.944059Z", "completed_at": "2025-10-09T15:53:02.944061Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005883932113647461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.companies_trips", "compiled": true, "compiled_code": "with trips_cte as (\n    select\n        company,\n        count(*) as trips\n    from\n        \"dev_h8qz\".\"dbt\".\"trips_prep\" as t\n        join \"dev_h8qz\".\"dbt\".\"scooters\" as s\n            on t.scooter_hw_id = s.hardware_id\n    group by\n        1\n)\nselect\n    company,\n    t.trips,\n    c.scooters,\n    t.trips / cast(c.scooters as float) as trips_per_scooter\nfrom\n    trips_cte as t\n    join \"dev_h8qz\".\"dbt\".\"companies\" as c\n        using (company)", "relation_name": "\"dev_h8qz\".\"dbt\".\"companies_trips\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.942142Z", "completed_at": "2025-10-09T15:53:02.944282Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.944752Z", "completed_at": "2025-10-09T15:53:02.944754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0041539669036865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_scooters.trips_age_daily_stat", "compiled": true, "compiled_code": "select\n    age,\n    avg(trips) as avg_trips,\n    avg(revenue_rub) as avg_revenue_rub\nfrom\n    \"dev_h8qz\".\"dbt\".\"trips_age_daily\"\ngroup by\n    1\norder by\n    1", "relation_name": "\"dev_h8qz\".\"dbt\".\"trips_age_daily_stat\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.945667Z", "completed_at": "2025-10-09T15:53:02.950608Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.950754Z", "completed_at": "2025-10-09T15:53:02.950757Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.006231069564819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_scooters.unique_key_trips_age_daily_date__age.98014a80be", "compiled": true, "compiled_code": "\nselect\n    \n        \"date\"::text ||\n    \n        \"age\"::text ||\n    \n    ''\nfrom\n    \"dev_h8qz\".\"dbt\".\"trips_age_daily\"\ngroup by\n    1\nhaving\n    count(*) > 1\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.949129Z", "completed_at": "2025-10-09T15:53:02.951023Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.951155Z", "completed_at": "2025-10-09T15:53:02.951157Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005797147750854492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_scooters.unique_companies_trips_company.cc4c6c79b0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    company as unique_field,\n    count(*) as n_records\n\nfrom \"dev_h8qz\".\"dbt\".\"companies_trips\"\nwhere company is not null\ngroup by company\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-09T15:53:02.947893Z", "completed_at": "2025-10-09T15:53:02.951370Z"}, {"name": "execute", "started_at": "2025-10-09T15:53:02.951523Z", "completed_at": "2025-10-09T15:53:02.951525Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006448268890380859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_scooters.unique_trips_age_daily_date_text_age_text.253564ea3e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date::text || age::text as unique_field,\n    count(*) as n_records\n\nfrom \"dev_h8qz\".\"dbt\".\"trips_age_daily\"\nwhere date::text || age::text is not null\ngroup by date::text || age::text\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 3.9696598052978516, "args": {"introspect": true, "log_file_max_bytes": 10485760, "require_generic_test_arguments_property": false, "log_level": "info", "source_freshness_run_project_hooks": true, "require_batched_execution_for_custom_microbatch_strategy": false, "partial_parse": true, "upload_to_artifacts_ingest_api": false, "which": "generate", "vars": {}, "require_nested_cumulative_type_params": false, "use_colors_file": true, "quiet": false, "require_yaml_configuration_for_mf_time_spines": false, "show_resource_report": false, "macro_debugging": false, "profiles_dir": "/Users/flerinvs/.dbt", "send_anonymous_usage_stats": true, "print": true, "project_dir": "/Users/flerinvs/dbt_scooters", "show_all_deprecations": false, "favor_state": false, "require_resource_names_without_spaces": true, "select": [], "exclude": [], "printer_width": 80, "indirect_selection": "eager", "require_all_warnings_handled_by_warn_error": false, "strict_mode": false, "static": false, "static_parser": true, "use_colors": true, "cache_selected_only": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "use_fast_test_edges": false, "log_path": "/Users/flerinvs/dbt_scooters/logs", "skip_nodes_if_on_run_start_fails": false, "validate_macro_args": false, "state_modified_compare_vars": false, "defer": false, "log_format_file": "debug", "log_level_file": "debug", "partial_parse_file_diff": true, "populate_cache": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "version_check": true, "write_json": true, "compile": true, "empty_catalog": false, "state_modified_compare_more_unrendered_values": false, "invocation_command": "dbt docs generate"}}